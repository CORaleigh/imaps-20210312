self.webpackChunkRemoteClient([7,161],{111:function(e,t,r){"use strict";var n=r(14),s=r(41),i=r(18),a=r(23);class o{constructor(){this._emitter=new o.EventEmitter(this)}emit(e,t){return this._emitter.emit(e,t)}on(e,t){return this._emitter.on(e,t)}once(e,t){return this._emitter.once(e,t)}hasEventListener(e){return this._emitter.hasEventListener(e)}}!function(e){class t{constructor(e=null){this.target=e,this._listenersMap=null}clear(){this._listenersMap&&this._listenersMap.clear()}emit(e,t){const r=this._listenersMap&&this._listenersMap.get(e);if(!r)return!1;const n=this.target||this;return[...r].forEach((e=>{e.call(n,t)})),r.length>0}on(e,t){if(Array.isArray(e)){const r=e.map((e=>this.on(e,t)));return Object(s.a)(r)}if(e.indexOf(",")>-1)throw new TypeError("Evented.on() with a comma delimited string of event types is not supported");this._listenersMap||(this._listenersMap=new Map);const r=this._listenersMap.get(e)||[];return r.push(t),this._listenersMap.set(e,r),{remove:()=>{const r=this._listenersMap&&this._listenersMap.get(e)||[],n=r.indexOf(t);n>=0&&r.splice(n,1)}}}once(e,t){const r=this.on(e,(e=>{r.remove(),t.call(null,e)}));return r}hasEventListener(e){const t=this._listenersMap&&this._listenersMap.get(e);return null!=t&&t.length>0}}e.EventEmitter=t,e.EventedMixin=e=>{let r=class extends e{constructor(){super(...arguments),this._emitter=new t}emit(e,t){return this._emitter.emit(e,t)}on(e,t){return this._emitter.on(e,t)}once(e,t){return this._emitter.once(e,t)}hasEventListener(e){return this._emitter.hasEventListener(e)}};return r=Object(n.a)([Object(i.a)("esri.core.Evented")],r),r};let r=class extends a.a{constructor(){super(...arguments),this._emitter=new o.EventEmitter(this)}emit(e,t){return this._emitter.emit(e,t)}on(e,t){return this._emitter.on(e,t)}once(e,t){return this._emitter.once(e,t)}hasEventListener(e){return this._emitter.hasEventListener(e)}};r=Object(n.a)([Object(i.a)("esri.core.Evented")],r),e.EventedAccessor=r}(o||(o={}));var u=o;t.a=u},136:function(e,t,r){"use strict";function n(e){return"date"===e.type||"esriFieldTypeDate"===e.type}function s(e){return e.toLowerCase().trim()}t.a=class{constructor(e){if(this.fields=e,this._fieldsMap=new Map,this._dateFieldsSet=new Set,this.dateFields=[],!e)return;const t=[];for(const r of e){const e=r&&r.name;if(e){const i=s(e);this._fieldsMap.set(e,r),this._fieldsMap.set(i,r),t.push(i),n(r)&&(this.dateFields.push(r),this._dateFieldsSet.add(r))}}t.sort(),this.uid=t.join(",")}destroy(){this._fieldsMap.clear()}has(e){return null!=this.get(e)}get(e){return null!=e?this._fieldsMap.get(e)||this._fieldsMap.get(s(e)):void 0}isDateField(e){return this._dateFieldsSet.has(this.get(e))}normalizeFieldName(e){const t=this.get(e);if(t)return t.name}}},137:function(e,t,r){"use strict";r.d(t,"a",(function(){return D})),r.d(t,"b",(function(){return Z})),r.d(t,"c",(function(){return Q})),r.d(t,"d",(function(){return q})),r.d(t,"e",(function(){return G})),r.d(t,"f",(function(){return k})),r.d(t,"g",(function(){return V})),r.d(t,"h",(function(){return Y})),r.d(t,"i",(function(){return A})),r.d(t,"j",(function(){return _})),r.d(t,"k",(function(){return C})),r.d(t,"l",(function(){return E})),r.d(t,"m",(function(){return se})),r.d(t,"n",(function(){return $})),r.d(t,"o",(function(){return K})),r.d(t,"p",(function(){return ne})),r.d(t,"q",(function(){return X})),r.d(t,"r",(function(){return U})),r.d(t,"s",(function(){return y})),r.d(t,"t",(function(){return v})),r.d(t,"u",(function(){return te})),r.d(t,"v",(function(){return J})),r.d(t,"w",(function(){return ee}));var n=r(2),s=r(16),i=r(63),a=r(201),o=r(263),u=r(154);function c(e,t){return e?t?4:3:t?3:2}const l=n.a.getLogger("esri.tasks.support.optimizedFeatureSet"),h={esriGeometryPoint:0,esriGeometryPolyline:2,esriGeometryPolygon:3,esriGeometryMultipoint:0},f=(e,t,r,n,s,i)=>{e[r]=s,e[r+1]=i},d=(e,t,r,n,s,i)=>{e[r]=s,e[r+1]=i,e[r+2]=t[n+2]},p=(e,t,r,n,s,i)=>{e[r]=s,e[r+1]=i,e[r+2]=t[n+3]},m=(e,t,r,n,s,i)=>{e[r]=s,e[r+1]=i,e[r+2]=t[n+2],e[r+3]=t[n+3]};function g(e,t,r,n){if(e){if(r)return t&&n?m:d;if(t&&n)return p}else if(t&&n)return d;return f}function y({scale:e,translate:t},r){return Math.round((r-t[0])/e[0])}function v({scale:e,translate:t},r){return Math.round((t[1]-r)/e[1])}function b({scale:e,translate:t},r){return r*e[0]+t[0]}function x({scale:e,translate:t},r){return t[1]-r*e[1]}function _(e,t,r){return e?t?r?T(e):S(e):r?M(e):w(e):null}function w(e){const t=e.coords;return{x:t[0],y:t[1]}}function I(e,t){return e.coords[0]=t.x,e.coords[1]=t.y,e}function S(e){const t=e.coords;return{x:t[0],y:t[1],z:t[2]}}function N(e,t){return e.coords[0]=t.x,e.coords[1]=t.y,e.coords[2]=t.z,e}function M(e){const t=e.coords;return{x:t[0],y:t[1],m:t[2]}}function O(e,t){return e.coords[0]=t.x,e.coords[1]=t.y,e.coords[2]=t.m,e}function T(e){const t=e.coords;return{x:t[0],y:t[1],z:t[2],m:t[3]}}function F(e,t){return e.coords[0]=t.x,e.coords[1]=t.y,e.coords[2]=t.z,e.coords[3]=t.m,e}function R(e,t){return e&&t?F:e?N:t?O:I}function A(e,t,r){if(!e)return null;const n=c(t,r),s=[];for(let t=0;t<e.coords.length;t+=n){const r=[];for(let s=0;s<n;s++)r.push(e.coords[t+s]);s.push(r)}return t?r?{points:s,hasZ:t,hasM:r}:{points:s,hasZ:t}:r?{points:s,hasM:r}:{points:s}}function j(e,t,r=c(t.hasZ,t.hasM)){e.lengths[0]=t.points.length;const n=e.coords;let s=0;for(const e of t.points)for(let t=0;t<r;t++)n[s++]=e[t];return e}function E(e,t,r){if(!e)return null;const n=c(t,r),{coords:s,lengths:i}=e,a=[];let o=0;for(const e of i){const t=[];for(let r=0;r<e;r++){const e=[];for(let t=0;t<n;t++)e.push(s[o++]);t.push(e)}a.push(t)}return t?r?{paths:a,hasZ:t,hasM:r}:{paths:a,hasZ:t}:r?{paths:a,hasM:r}:{paths:a}}function P(e,t,r=c(t.hasZ,t.hasM)){const{lengths:n,coords:s}=e;let i=0;for(const e of t.paths){for(const t of e)for(let e=0;e<r;e++)s[i++]=t[e];n.push(e.length)}return e}function C(e,t,r){if(!e)return null;const n=c(t,r),{coords:s,lengths:i}=e,a=[];let o=0;for(const e of i){const t=[];for(let r=0;r<e;r++){const e=[];for(let t=0;t<n;t++)e.push(s[o++]);t.push(e)}a.push(t)}return t?r?{rings:a,hasZ:t,hasM:r}:{rings:a,hasZ:t}:r?{rings:a,hasM:r}:{rings:a}}function G(e,t,r=t.hasZ,n=t.hasM){return function(e,t,r,n){const s=c(r,n),{lengths:i,coords:a}=e;let o=0;i.length=a.length=0;for(const e of t){for(const t of e)for(let e=0;e<s;e++)a[o++]=t[e];i.push(e.length)}}(e,t.rings,r,n),e}const z=[],L=[];function D(e,t,r,n,s){z[0]=e;const[i]=Q(L,z,t,r,n,s);return z.length=L.length=0,i}function Q(e,t,r,n,i,o){if(e.length=0,!r){for(const r of t){const t=r.attributes[o];e.push(new a.a(null,r.attributes,null,t))}return e}switch(r){case"esriGeometryPoint":return function(e,t,r,n,s){const i=R(r,n);for(const r of t){const{geometry:t,attributes:n}=r;let o;t&&(o=i(new u.a,t)),e.push(new a.a(o,n,null,n[s]))}return e}(e,t,n,i,o);case"esriGeometryMultipoint":return function(e,t,r,n,s){const i=c(r,n);for(const r of t){const t=r.geometry,n=r.attributes;let o;t&&(o=j(new u.a,t,i)),e.push(new a.a(o,n,null,n[s]))}return e}(e,t,n,i,o);case"esriGeometryPolyline":return function(e,t,r,n,s){const i=c(r,n);for(const r of t){const t=r.geometry,n=r.attributes;let o;t&&(o=P(new u.a,t,i)),e.push(new a.a(o,n,null,n[s]))}return e}(e,t,n,i,o);case"esriGeometryPolygon":return function(e,t,r,n,s){for(const i of t){const t=i.geometry,o=i.centroid,c=i.attributes;let l;t&&(l=G(new u.a,t,r,n)),o?e.push(new a.a(l,c,I(new u.a,o),c[s])):e.push(new a.a(l,c,null,c[s]))}return e}(e,t,n,i,o);default:l.error("convertToFeatureSet:unknown-geometry",new s.a(`Unable to parse unknown geometry type '${r}'`)),e.length=0}return e}function k(e,t,r,n){L[0]=e,B(z,L,t,r,n);const s=z[0];return z.length=L.length=0,s}function q(e,t,r){if(!e)return null;const n=new u.a;return"hasZ"in e&&null==t&&(t=e.hasZ),"hasM"in e&&null==r&&(r=e.hasM),Object(i.f)(e)?R(null!=t?t:null!=e.z,null!=r?r:null!=e.m)(n,e):Object(i.g)(e)?G(n,e,t,r):Object(i.h)(e)?P(n,e,c(t,r)):Object(i.e)(e)?j(n,e,c(t,r)):void l.error("convertFromGeometry:unknown-geometry",new s.a(`Unable to parse unknown geometry type '${e}'`))}function Y(e,t,r,n){const i=e&&("coords"in e?e:e.geometry);if(!i)return null;switch(t){case"esriGeometryPoint":{let e=w;return r&&n?e=T:r?e=S:n&&(e=M),e(i)}case"esriGeometryMultipoint":return A(i,r,n);case"esriGeometryPolyline":return E(i,r,n);case"esriGeometryPolygon":return C(i,r,n);default:return void l.error("convertToGeometry:unknown-geometry",new s.a(`Unable to parse unknown geometry type '${t}'`))}}function B(e,t,r,n,i){switch(e.length=0,r){case"esriGeometryPoint":return function(e,t,r,n){let s=w;r&&n?s=T:r?s=S:n&&(s=M);for(const r of t){const{geometry:t,attributes:n}=r,i=t?s(t):null;e.push({attributes:n,geometry:i})}return e}(e,t,n,i);case"esriGeometryMultipoint":return function(e,t,r,n){for(const s of t){const{geometry:t,attributes:i}=s;let a;t&&(a=A(t,r,n)),e.push({attributes:i,geometry:a})}return e}(e,t,n,i);case"esriGeometryPolyline":return function(e,t,r,n){for(const s of t){const{geometry:t,attributes:i}=s;let a;t&&(a=E(t,r,n)),e.push({attributes:i,geometry:a})}return e}(e,t,n,i);case"esriGeometryPolygon":return function(e,t,r,n){for(const s of t){const{geometry:t,attributes:i,centroid:a}=s;let o;if(t&&(o=C(t,r,n)),a){const t=w(a);e.push({attributes:i,centroid:t,geometry:o})}else e.push({attributes:i,geometry:o})}return e}(e,t,n,i);default:l.error("convertToFeatureSet:unknown-geometry",new s.a(`Unable to parse unknown geometry type '${r}'`))}return e}function V(e){const{objectIdFieldName:t,spatialReference:r,transform:n,fields:s,hasM:i,hasZ:a,features:o,geometryType:u,exceededTransferLimit:c,uniqueIdField:l,queryGeometry:h,queryGeometryType:f}=e,d={features:B([],o,u,a,i),fields:s,geometryType:u,objectIdFieldName:t,spatialReference:r,uniqueIdField:l,queryGeometry:Y(h,f,!1,!1)};return n&&(d.transform=n),c&&(d.exceededTransferLimit=c),i&&(d.hasM=i),a&&(d.hasZ=a),d}function Z(e,t){const r=new o.a,{hasM:n,hasZ:i,features:a,objectIdFieldName:u,spatialReference:c,geometryType:h,exceededTransferLimit:f,transform:d,fields:p}=e;return p&&(r.fields=p),r.geometryType=h,r.objectIdFieldName=u||t,r.spatialReference=c,r.objectIdFieldName?(a&&Q(r.features,a,h,i,n,r.objectIdFieldName),f&&(r.exceededTransferLimit=f),n&&(r.hasM=n),i&&(r.hasZ=i),d&&(r.transform=d),r):(l.error(new s.a("optimized-features:invalid-objectIdFieldName","objectIdFieldName is missing")),r)}function J(e){const{transform:t,features:r,hasM:n,hasZ:s}=e;if(!t)return e;for(const e of r)e.geometry&&ee(e.geometry,e.geometry,n,s,t),e.centroid&&ee(e.centroid,e.centroid,n,s,t);return e.transform=null,e}function X(e,t){const{geometryType:r,features:n,hasM:s,hasZ:i}=t;if(!e)return t;for(let t=0;t<n.length;t++){const a=n[t],o=a.weakClone();o.geometry=new u.a,U(o.geometry,a.geometry,s,i,r,e),a.centroid&&(o.centroid=new u.a,U(o.centroid,a.centroid,s,i,"esriGeometryPoint",e)),n[t]=o}return t.transform=e,t}function U(e,t,r,n,s,i,a=r,o=n){if(e.lengths.length&&(e.lengths.length=0),e.coords.length&&(e.coords.length=0),!t||!t.coords.length)return null;const u=h[s],{coords:l,lengths:f}=t,d=c(r,n),p=c(r&&a,n&&o),m=g(r,n,a,o);if(!f.length)return m(e.coords,l,0,0,y(i,l[0]),v(i,l[1])),e.lengths.length&&(e.lengths.length=0),e.coords.length=d,e;let b,x,_,w,I=0,S=0,N=S;for(const t of f){if(t<u)continue;let r=0;S=N,_=b=y(i,l[I]),w=x=v(i,l[I+1]),m(e.coords,l,S,I,_,w),r++,I+=d,S+=p;for(let n=1;n<t;n++,I+=d)_=y(i,l[I]),w=v(i,l[I+1]),_===b&&w===x||(m(e.coords,l,S,I,_-b,w-x),S+=p,r++,b=_,x=w);r>=u&&(e.lengths.push(r),N=S)}return e.coords.length=N,e.coords.length?e:null}function $(e,t,r,n,s,i,a=r,o=n){if(e.lengths.length&&(e.lengths.length=0),e.coords.length&&(e.coords.length=0),!t||!t.coords.length)return null;const u=h[s],{coords:l,lengths:f}=t,d=c(r,n),p=c(r&&a,n&&o),m=g(r,n,a,o);if(!f.length)return m(e.coords,l,0,0,l[0],l[1]),e.lengths.length&&(e.lengths.length=0),e.coords.length=d,e;let y=0;const v=i*i;for(const t of f){if(t<u){y+=t*d;continue}const r=e.coords.length/p,n=y,s=y+(t-1)*d;m(e.coords,l,e.coords.length,n,l[n],l[n+1]),W(e.coords,l,d,v,m,n,s),m(e.coords,l,e.coords.length,s,l[s],l[s+1]);const i=e.coords.length/p-r;i>=u?e.lengths.push(i):e.coords.length=r*p,y+=t*d}return e.coords.length?e:null}function H(e,t,r,n){const s=e[t],i=e[t+1],a=e[r],o=e[r+1],u=e[n],c=e[n+1];let l=a,h=o,f=u-l,d=c-h;if(0!==f||0!==d){const e=((s-l)*f+(i-h)*d)/(f*f+d*d);e>1?(l=u,h=c):e>0&&(l+=f*e,h+=d*e)}return f=s-l,d=i-h,f*f+d*d}function W(e,t,r,n,s,i,a){let o,u=n,c=0;for(let e=i+r;e<a;e+=r)o=H(t,e,i,a),o>u&&(c=e,u=o);u>n&&(c-i>r&&W(e,t,r,n,s,i,c),s(e,t,e.length,c,t[c],t[c+1]),a-c>r&&W(e,t,r,n,s,c,a))}function K(e,t,r,n){if(!t||!t.coords||!t.coords.length)return null;const s=c(r,n);let i=Number.POSITIVE_INFINITY,a=Number.POSITIVE_INFINITY,o=Number.NEGATIVE_INFINITY,u=Number.NEGATIVE_INFINITY;if(t&&t.coords){const e=t.coords;for(let t=0;t<e.length;t+=s){const r=e[t],n=e[t+1];i=Math.min(i,r),o=Math.max(o,r),a=Math.min(a,n),u=Math.max(u,n)}}return e[0]=i,e[1]=a,e[2]=o,e[3]=u,e}function ee(e,t,r,n,s){const{coords:i,lengths:a}=t,o=r?n?m:d:n?d:f,u=c(r,n);if(!i.length)return e!==t&&(e.lengths.length=0,e.coords.length=0),e;if(!a.length)return o(e.coords,i,0,0,b(s,i[0]),x(s,i[1])),e!==t&&(e.lengths.length=0,e.coords.length=u),e;const[l,h]=s.scale;let p=0;for(let t=0;t<a.length;t++){const r=a[t];e.lengths[t]=r;let n=b(s,i[p]),c=x(s,i[p+1]);o(e.coords,i,p,p,n,c),p+=u;for(let t=1;t<r;t++,p+=u)n+=i[p]*l,c-=i[p+1]*h,o(e.coords,i,p,p,n,c)}return e!==t&&(e.lengths.length=a.length,e.coords.length=i.length),e}function te(e,t,r,n,s,i){const a=c(r,n),o=g(r,n,s,i),u=t.coords;e.coords.length=0,e.lengths.length=0,e.lengths.push(...t.lengths);for(let t=0;t<u.length;t+=a)o(e.coords,u,e.coords.length,t,u[t],u[t+1]);return e}function re(e,t,r,n){let s=0,i=e[n*t],a=e[n*(t+1)];for(let o=1;o<r;o++){const r=i+e[n*(t+o)],u=a+e[n*(t+o)+1],c=(r-i)*(u+a);i=r,a=u,s+=c}return.5*s}function ne(e,t){const{coords:r,lengths:n}=e;let s=0,i=0;for(let e=0;e<n.length;e++)i+=re(r,s,n[e],t),s+=e;return Math.abs(i)}function se(e,t){const r=e.clone(),n=e.coords,s=e.lengths;let i=0;for(let e=0;e<s.length;e++){const a=s[e];let o=n[t*i],u=n[t*i+1];for(let e=1;e<a;e++){const s=o+n[t*(i+e)],a=u+n[t*(i+e)+1];r.coords[t*(i+e)]=s,r.coords[t*(i+e)+1]=a,o=s,u=a}i+=a}return r}},154:function(e,t,r){"use strict";class n{constructor(e=[],t=[],r=!1){this.lengths=null!=e?e:[],this.coords=null!=t?t:[],this.hasIndeterminateRingOrder=r}get isPoint(){return 0===this.lengths.length}forEachVertex(e){let t=0;this.lengths.length||e(this.coords[0],this.coords[1]);for(let r=0;r<this.lengths.length;r++){const n=this.lengths[r];for(let r=0;r<n;r++)e(this.coords[2*(r+t)],this.coords[2*(r+t)+1]);t+=n}}clone(){return new n(this.lengths.slice(),this.coords.slice(),this.hasIndeterminateRingOrder)}}t.a=n},163:function(e,t,r){"use strict";r.d(t,"a",(function(){return i})),r.d(t,"b",(function(){return s})),r.d(t,"c",(function(){return a}));var n=r(55);function s(e){return"point"===e||"multipoint"===e||"polyline"===e||"polygon"===e}const i=Object(n.b)()({esriGeometryPoint:"point",esriGeometryMultipoint:"multipoint",esriGeometryPolyline:"polyline",esriGeometryPolygon:"polygon"}),a=Object(n.b)()({esriGeometryPoint:"point",esriGeometryMultipoint:"multipoint",esriGeometryPolyline:"polyline",esriGeometryPolygon:"polygon",esriGeometryEnvelope:"extent",mesh:"mesh"})},175:function(e,t,r){"use strict";r.r(t),r.d(t,"WhereClause",(function(){return _})),r.d(t,"defaultAttributeAdapter",(function(){return G}));var n=r(4);const s={min:{minParams:1,maxParams:1,evaluate:e=>null==e[0]?null:Math.min.apply(Math,e[0])},max:{minParams:1,maxParams:1,evaluate:e=>null==e[0]?null:Math.max.apply(Math,e[0])},avg:{minParams:1,maxParams:1,evaluate:e=>null==e[0]?null:i(e[0])},sum:{minParams:1,maxParams:1,evaluate:e=>null==e[0]?null:function(e){let t=0;for(let r=0;r<e.length;r++)t+=e[r];return t}(e[0])},stddev:{minParams:1,maxParams:1,evaluate:e=>null==e[0]?null:Math.sqrt(a(e[0]))},count:{minParams:1,maxParams:1,evaluate:e=>null==e[0]?null:e[0].length},var:{minParams:1,maxParams:1,evaluate:e=>null==e[0]?null:a(e[0])}};function i(e){let t=0;for(let r=0;r<e.length;r++)t+=e[r];return t/e.length}function a(e){const t=i(e),r=e.length;let n=0;for(const r of e)n+=(r-t)**2;return r>1?n/(r-1):0}var o=r(39);class u{constructor(){this.op="+",this.day=0,this.second=0,this.hour=0,this.month=0,this.year=0,this.minute=0}static fixDefaults(e){if(null!==e.precision||null!==e.secondary)throw new Error("Primary and Secondary SqlInterval qualifiers not supported")}static createFromMilliseconds(e){const t=new u;return t.second=e/1e3,t}static createFromValueAndQualifer(e,t,r){let n=null;const s=new u;if(s.op="-"===r?"-":"+","interval-period"===t.type){u.fixDefaults(t);const r=new RegExp("^[0-9]{1,}$");if("year"===t.period||"month"===t.period)throw new Error("Year-Month Intervals not supported");if(!r.test(e))throw new Error("Illegal Interval");s[t.period]=parseFloat(e)}else{if(u.fixDefaults(t.start),u.fixDefaults(t.end),"year"===t.start.period||"month"===t.start.period)throw new Error("Year-Month Intervals not supported");if("year"===t.end.period||"month"===t.end.period)throw new Error("Year-Month Intervals not supported");switch(t.start.period){case"day":switch(t.end.period){case"hour":if(n=new RegExp("^[0-9]{1,} [0-9]{1,}$"),!n.test(e))throw new Error("Illegal Interval");s[t.start.period]=parseFloat(e.split(" ")[0]),s[t.end.period]=parseFloat(e.split(" ")[1]);break;case"minute":if(n=new RegExp("^[0-9]{1,} [0-9]{1,2}:[0-9]{1,}$"),!n.test(e))throw new Error("Illegal Interval");{s[t.start.period]=parseFloat(e.split(" ")[0]);const r=e.split(" ")[1].split(":");s.hour=parseFloat(r[0]),s.minute=parseFloat(r[1])}break;case"second":if(n=new RegExp("^[0-9]{1,} [0-9]{1,2}:[0-9]{1,2}:[0-9]{1,}([.]{1}[0-9]{1,}){0,1}$"),!n.test(e))throw new Error("Illegal Interval");{s[t.start.period]=parseFloat(e.split(" ")[0]);const r=e.split(" ")[1].split(":");s.hour=parseFloat(r[0]),s.minute=parseFloat(r[1]),s.second=parseFloat(r[2])}break;default:throw"Invalid Interval."}break;case"hour":switch(t.end.period){case"minute":if(n=new RegExp("^[0-9]{1,}:[0-9]{1,}$"),!n.test(e))throw new Error("Illegal Interval");s.hour=parseFloat(e.split(":")[0]),s.minute=parseFloat(e.split(":")[1]);break;case"second":if(n=new RegExp("^[0-9]{1,}:[0-9]{1,2}:[0-9]{1,}([.]{1}[0-9]{1,}){0,1}$"),!n.test(e))throw new Error("Illegal Interval");{const t=e.split(":");s.hour=parseFloat(t[0]),s.minute=parseFloat(t[1]),s.second=parseFloat(t[2])}break;default:throw"Invalid Interval."}break;case"minute":switch(t.end.period){case"second":if(n=new RegExp("^[0-9]{1,}:[0-9]{1,}([.]{1}[0-9]{1,}){0,1}$"),!n.test(e))throw new Error("Illegal Interval");{const t=e.split(":");s.minute=parseFloat(t[0]),s.second=parseFloat(t[1])}break;default:throw"Invalid Interval."}break;default:throw"Invalid Interval."}}return s}valueInMilliseconds(){return("-"===this.op?-1:1)*(1e3*this.second+60*this.minute*1e3+60*this.hour*60*1e3+24*this.day*60*60*1e3+this.month*(365/12)*24*60*60*1e3+365*this.year*24*60*60*1e3)}}function c(e,t){const r=l[e.toLowerCase()];if(null==r)throw new Error("Function Not Recognised");if(t.length<r.minParams||t.length>r.maxParams)throw new Error("Invalid Parameter count for call to "+e.toUpperCase());return r.evaluate(t)}const l={extract:{minParams:2,maxParams:2,evaluate:([e,t])=>{if(null==t)return null;if(t instanceof Date)switch(e.toUpperCase()){case"SECOND":return t.getSeconds();case"MINUTE":return t.getMinutes();case"HOUR":return t.getHours();case"DAY":return t.getDate();case"MONTH":return t.getMonth()+1;case"YEAR":return t.getFullYear()}throw new Error("Invalid Parameter for call to EXTRACT")}},substring:{minParams:2,maxParams:3,evaluate:e=>{if(2===e.length){const[t,r]=e;return null==t||null==r?null:t.toString().substring(r-1)}if(3===e.length){const[t,r,n]=e;return null==t||null==r||null==n?null:n<=0?"":t.toString().substring(r-1,r+n-1)}}},position:{minParams:2,maxParams:2,evaluate:([e,t])=>null==e||null==t?null:t.indexOf(e)+1},trim:{minParams:2,maxParams:3,evaluate:e=>{const t=3===e.length,r=t?e[1]:" ",n=t?e[2]:e[1];if(null==r||null==n)return null;const s=`(${Object(o.a)(r)})`;switch(e[0]){case"BOTH":return n.replace(new RegExp(`^${s}*|${s}*$`,"g"),"");case"LEADING":return n.replace(new RegExp(`^${s}*`,"g"),"");case"TRAILING":return n.replace(new RegExp(s+"*$","g"),"")}throw new Error("Invalid Parameter for call to TRIM")}},abs:{minParams:1,maxParams:1,evaluate:e=>null==e[0]?null:Math.abs(e[0])},ceiling:{minParams:1,maxParams:1,evaluate:e=>null==e[0]?null:Math.ceil(e[0])},floor:{minParams:1,maxParams:1,evaluate:e=>null==e[0]?null:Math.floor(e[0])},log:{minParams:1,maxParams:1,evaluate:e=>null==e[0]?null:Math.log(e[0])},log10:{minParams:1,maxParams:1,evaluate:e=>null==e[0]?null:Math.log(e[0])*Math.LOG10E},sin:{minParams:1,maxParams:1,evaluate:e=>null==e[0]?null:Math.sin(e[0])},cos:{minParams:1,maxParams:1,evaluate:e=>null==e[0]?null:Math.cos(e[0])},tan:{minParams:1,maxParams:1,evaluate:e=>null==e[0]?null:Math.tan(e[0])},asin:{minParams:1,maxParams:1,evaluate:e=>null==e[0]?null:Math.asin(e[0])},acos:{minParams:1,maxParams:1,evaluate:e=>null==e[0]?null:Math.acos(e[0])},atan:{minParams:1,maxParams:1,evaluate:e=>null==e[0]?null:Math.atan(e[0])},sign:{minParams:1,maxParams:1,evaluate:e=>null==e[0]?null:e[0]>0?1:e[1]<0?-1:0},power:{minParams:2,maxParams:2,evaluate:e=>null==e[0]||null==e[1]?null:e[0]**e[1]},mod:{minParams:2,maxParams:2,evaluate:e=>null==e[0]||null==e[1]?null:e[0]%e[1]},round:{minParams:1,maxParams:2,evaluate:e=>{const t=e[0],r=2===e.length?10**e[1]:1;return null==t?null:Math.round(t*r)/r}},truncate:{minParams:1,maxParams:2,evaluate:e=>null==e[0]?null:1===e.length?parseInt(e[0].toFixed(0),10):parseFloat(e[0].toFixed(e[1]))},char_length:{minParams:1,maxParams:1,evaluate:e=>"string"==typeof e[0]||e[0]instanceof String?e[0].length:0},concat:{minParams:1,maxParams:1/0,evaluate:e=>{let t="";for(let r=0;r<e.length;r++){if(null==e[r])return null;t+=e[r].toString()}return t}},lower:{minParams:1,maxParams:1,evaluate:e=>null==e[0]?null:e[0].toString().toLowerCase()},upper:{minParams:1,maxParams:1,evaluate:e=>null==e[0]?null:e[0].toString().toUpperCase()}};var h=r(75),f=Object(h.b)((function(e){var t;t=function(){function e(t,r,n,s){this.message=t,this.expected=r,this.found=n,this.location=s,this.name="SyntaxError","function"==typeof Error.captureStackTrace&&Error.captureStackTrace(this,e)}return function(e,t){function r(){this.constructor=e}r.prototype=t.prototype,e.prototype=new r}(e,Error),e.buildMessage=function(e,t){var r={literal:function(e){return'"'+s(e.text)+'"'},class:function(e){var t,r="";for(t=0;t<e.parts.length;t++)r+=e.parts[t]instanceof Array?i(e.parts[t][0])+"-"+i(e.parts[t][1]):i(e.parts[t]);return"["+(e.inverted?"^":"")+r+"]"},any:function(e){return"any character"},end:function(e){return"end of input"},other:function(e){return e.description}};function n(e){return e.charCodeAt(0).toString(16).toUpperCase()}function s(e){return e.replace(/\\/g,"\\\\").replace(/"/g,'\\"').replace(/\0/g,"\\0").replace(/\t/g,"\\t").replace(/\n/g,"\\n").replace(/\r/g,"\\r").replace(/[\x00-\x0F]/g,(function(e){return"\\x0"+n(e)})).replace(/[\x10-\x1F\x7F-\x9F]/g,(function(e){return"\\x"+n(e)}))}function i(e){return e.replace(/\\/g,"\\\\").replace(/\]/g,"\\]").replace(/\^/g,"\\^").replace(/-/g,"\\-").replace(/\0/g,"\\0").replace(/\t/g,"\\t").replace(/\n/g,"\\n").replace(/\r/g,"\\r").replace(/[\x00-\x0F]/g,(function(e){return"\\x0"+n(e)})).replace(/[\x10-\x1F\x7F-\x9F]/g,(function(e){return"\\x"+n(e)}))}function a(e){return r[e.type](e)}return"Expected "+function(e){var t,r,n=new Array(e.length);for(t=0;t<e.length;t++)n[t]=a(e[t]);if(n.sort(),n.length>0){for(t=1,r=1;t<n.length;t++)n[t-1]!==n[t]&&(n[r]=n[t],r++);n.length=r}switch(n.length){case 1:return n[0];case 2:return n[0]+" or "+n[1];default:return n.slice(0,-1).join(", ")+", or "+n[n.length-1]}}(e)+" but "+function(e){return e?'"'+s(e)+'"':"end of input"}(t)+" found."},{SyntaxError:e,parse:function(t,r){r=void 0!==r?r:{};var n,s={},i={start:Be},a=Be,o=function(e,t){return lr(e,t)},u=De("!",!1),c=De("=",!1),l=De(">=",!1),h=De(">",!1),f=De("<=",!1),d=De("<>",!1),p=De("<",!1),m=De("!=",!1),g=function(e){return e[0]+" "+e[2]},y=De("+",!1),v=De("-",!1),b=De("*",!1),x=De("/",!1),_=function(e,t){return e+t.join("")},w=/^[A-Za-z_\x80-\uFFFF]/,I=Qe([["A","Z"],["a","z"],"_",["","￿"]],!1,!1),S=/^[A-Za-z0-9_]/,N=Qe([["A","Z"],["a","z"],["0","9"],"_"],!1,!1),M=/^[A-Za-z0-9_.\x80-\uFFFF]/,O=Qe([["A","Z"],["a","z"],["0","9"],"_",".",["","￿"]],!1,!1),T=De("@",!1),F=function(e){return{type:"interval-period",period:e.value,precision:null,secondary:null}},R=function(e,t){return{type:"interval-period",period:"second",precision:e,secondary:t}},A=function(e){return parseFloat(e)},j=De("'",!1),E=De("N'",!1),P=De("''",!1),C=/^[^']/,G=Qe(["'"],!0,!1),z=function(e,t){return{type:"when_clause",operand:e,value:t}},L=De(".",!1),D=/^[0-9]/,Q=Qe([["0","9"]],!1,!1),k=/^[eE]/,q=Qe(["e","E"],!1,!1),Y=/^[+\-]/,B=Qe(["+","-"],!1,!1),V=De("NULL",!0),Z=De("TRUE",!0),J=De("FALSE",!0),X=De("IN",!0),U=De("IS",!0),$=De("LIKE",!0),H=De("ESCAPE",!0),W=De("NOT",!0),K=De("AND",!0),ee=De("OR",!0),te=De("BETWEEN",!0),re=De("FROM",!0),ne=De("FOR",!0),se=De("SUBSTRING",!0),ie=De("EXTRACT",!0),ae=De("TRIM",!0),oe=De("POSITION",!0),ue=De("TIMESTAMP",!0),ce=De("DATE",!0),le=De("LEADING",!0),he=De("TRAILING",!0),fe=De("BOTH",!0),de=De("TO",!0),pe=De("INTERVAL",!0),me=De("YEAR",!0),ge=De("MONTH",!0),ye=De("DAY",!0),ve=De("HOUR",!0),be=De("MINUTE",!0),xe=De("SECOND",!0),_e=De("CASE",!0),we=De("END",!0),Ie=De("WHEN",!0),Se=De("THEN",!0),Ne=De("ELSE",!0),Me=De(",",!1),Oe=De("(",!1),Te=De(")",!1),Fe=/^[ \t\n\r]/,Re=Qe([" ","\t","\n","\r"],!1,!1),Ae=De("`",!1),je=/^[^`]/,Ee=Qe(["`"],!0,!1),Pe=0,Ce=[{line:1,column:1}],Ge=0,ze=[],Le=0;if("startRule"in r){if(!(r.startRule in i))throw new Error("Can't start parsing from rule \""+r.startRule+'".');a=i[r.startRule]}function De(e,t){return{type:"literal",text:e,ignoreCase:t}}function Qe(e,t,r){return{type:"class",parts:e,inverted:t,ignoreCase:r}}function ke(e){var r,n=Ce[e];if(n)return n;for(r=e-1;!Ce[r];)r--;for(n={line:(n=Ce[r]).line,column:n.column};r<e;)10===t.charCodeAt(r)?(n.line++,n.column=1):n.column++,r++;return Ce[e]=n,n}function qe(e,t){var r=ke(e),n=ke(t);return{start:{offset:e,line:r.line,column:r.column},end:{offset:t,line:n.line,column:n.column}}}function Ye(e){Pe<Ge||(Pe>Ge&&(Ge=Pe,ze=[]),ze.push(e))}function Be(){var e,t;return e=Pe,ar()!==s&&(t=Ze())!==s&&ar()!==s?e=t:(Pe=e,e=s),e}function Ve(){var e,t,r,n,i,a,o,u;if(e=Pe,(t=Ze())!==s){for(r=[],n=Pe,(i=ar())!==s&&(a=nr())!==s&&(o=ar())!==s&&(u=Ze())!==s?n=i=[i,a,o,u]:(Pe=n,n=s);n!==s;)r.push(n),n=Pe,(i=ar())!==s&&(a=nr())!==s&&(o=ar())!==s&&(u=Ze())!==s?n=i=[i,a,o,u]:(Pe=n,n=s);r!==s?e=t=function(e,t){var r={type:"expr_list"},n=function(e,t,r){return function(e,t){for(var r=[e],n=0;n<t.length;n++)r.push(t[n][3]);return r}(e,t)}(e,t);return r.value=n,r}(t,r):(Pe=e,e=s)}else Pe=e,e=s;return e}function Ze(){var e,t,r,n,i,a,u,c;if(e=Pe,(t=Je())!==s){for(r=[],n=Pe,(i=ar())!==s&&(a=Pt())!==s&&(u=ar())!==s&&(c=Je())!==s?n=i=[i,a,u,c]:(Pe=n,n=s);n!==s;)r.push(n),n=Pe,(i=ar())!==s&&(a=Pt())!==s&&(u=ar())!==s&&(c=Je())!==s?n=i=[i,a,u,c]:(Pe=n,n=s);r!==s?e=t=o(t,r):(Pe=e,e=s)}else Pe=e,e=s;return e}function Je(){var e,t,r,n,i,a,u,c;if(e=Pe,(t=Xe())!==s){for(r=[],n=Pe,(i=ar())!==s&&(a=Et())!==s&&(u=ar())!==s&&(c=Xe())!==s?n=i=[i,a,u,c]:(Pe=n,n=s);n!==s;)r.push(n),n=Pe,(i=ar())!==s&&(a=Et())!==s&&(u=ar())!==s&&(c=Xe())!==s?n=i=[i,a,u,c]:(Pe=n,n=s);r!==s?e=t=o(t,r):(Pe=e,e=s)}else Pe=e,e=s;return e}function Xe(){var e,r,n,i,a;return e=Pe,(r=jt())===s&&(r=Pe,33===t.charCodeAt(Pe)?(n="!",Pe++):(n=s,0===Le&&Ye(u)),n!==s?(i=Pe,Le++,61===t.charCodeAt(Pe)?(a="=",Pe++):(a=s,0===Le&&Ye(c)),Le--,a===s?i=void 0:(Pe=i,i=s),i!==s?r=n=[n,i]:(Pe=r,r=s)):(Pe=r,r=s)),r!==s&&(n=ar())!==s&&(i=Xe())!==s?e=r=function(e){return function(e,t){return{type:"unary_expr",operator:"NOT",expr:t}}(0,e)}(i):(Pe=e,e=s),e===s&&(e=function(){var e,t,r;return e=Pe,(t=We())!==s&&ar()!==s?((r=function(){var e;return(e=function(){var e,t,r,n,i,a;if(e=[],t=Pe,(r=ar())!==s&&(n=Ue())!==s&&(i=ar())!==s&&(a=We())!==s?t=r=[r,n,i,a]:(Pe=t,t=s),t!==s)for(;t!==s;)e.push(t),t=Pe,(r=ar())!==s&&(n=Ue())!==s&&(i=ar())!==s&&(a=We())!==s?t=r=[r,n,i,a]:(Pe=t,t=s);else e=s;return e!==s&&(e=function(e){return{type:"arithmetic",tail:e}}(e)),e}())===s&&(e=function(){var e,t,r,n;return e=Pe,(t=He())!==s&&ar()!==s&&(r=sr())!==s&&ar()!==s&&(n=Ve())!==s&&ar()!==s&&ir()!==s?e=t=function(e,t){return{op:e,right:t}}(t,n):(Pe=e,e=s),e===s&&(e=Pe,(t=He())!==s&&ar()!==s&&(r=sr())!==s&&ar()!==s&&(n=ir())!==s?e=t=function(e){return{op:e,right:{type:"expr_list",value:[]}}}(t):(Pe=e,e=s),e===s&&(e=Pe,(t=He())!==s&&ar()!==s&&(r=ot())!==s?e=t=function(e,t){return{op:e,right:t}}(t,r):(Pe=e,e=s))),e}())===s&&(e=function(){var e,t,r,n,i,a;return e=Pe,(t=jt())!==s&&ar()!==s&&(r=Ct())!==s&&ar()!==s&&(n=We())!==s&&ar()!==s&&(i=Et())!==s&&ar()!==s&&(a=We())!==s?e=t=function(e,t,r){return{op:"NOT"+e,right:{type:"expr_list",value:[t,r]}}}(r,n,a):(Pe=e,e=s),e===s&&(e=Pe,(t=Ct())!==s&&ar()!==s&&(r=We())!==s&&ar()!==s&&(n=Et())!==s&&ar()!==s&&(i=We())!==s?e=t=function(e,t,r){return{op:e,right:{type:"expr_list",value:[t,r]}}}(t,r,i):(Pe=e,e=s)),e}())===s&&(e=function(){var e,t,r,n;return e=Pe,(t=Ft())!==s&&ar()!==s&&(r=jt())!==s&&ar()!==s&&(n=We())!==s?e=t=function(e,t){return{op:e+"NOT",right:t}}(t,n):(Pe=e,e=s),e===s&&(e=Pe,(t=Ft())!==s&&ar()!==s&&(r=We())!==s?e=t=function(e,t){return{op:e,right:t}}(t,r):(Pe=e,e=s)),e}())===s&&(e=function(){var e,t,r,n;return e=Pe,(t=$e())!==s&&ar()!==s&&(r=pt())!==s&&ar()!==s&&At()!==s&&ar()!==s&&(n=mt())!==s?e=t=function(e,t,r){return{op:e,right:t,escape:r.value}}(t,r,n):(Pe=e,e=s),e===s&&(e=Pe,(t=$e())!==s&&ar()!==s&&(r=pt())!==s?e=t=function(e,t){return{op:e,right:t,escape:""}}(t,r):(Pe=e,e=s)),e}()),e}())===s&&(r=null),r!==s?e=t=function(e,t){return""==t||null==t||null==t?e:"arithmetic"==t.type?lr(e,t.tail):cr(t.op,e,t.right,t.escape)}(t,r):(Pe=e,e=s)):(Pe=e,e=s),e}()),e}function Ue(){var e;return">="===t.substr(Pe,2)?(e=">=",Pe+=2):(e=s,0===Le&&Ye(l)),e===s&&(62===t.charCodeAt(Pe)?(e=">",Pe++):(e=s,0===Le&&Ye(h)),e===s&&("<="===t.substr(Pe,2)?(e="<=",Pe+=2):(e=s,0===Le&&Ye(f)),e===s&&("<>"===t.substr(Pe,2)?(e="<>",Pe+=2):(e=s,0===Le&&Ye(d)),e===s&&(60===t.charCodeAt(Pe)?(e="<",Pe++):(e=s,0===Le&&Ye(p)),e===s&&(61===t.charCodeAt(Pe)?(e="=",Pe++):(e=s,0===Le&&Ye(c)),e===s&&("!="===t.substr(Pe,2)?(e="!=",Pe+=2):(e=s,0===Le&&Ye(m)))))))),e}function $e(){var e,t,r,n,i;return e=Pe,t=Pe,(r=jt())!==s&&(n=ar())!==s&&(i=Rt())!==s?t=r=[r,n,i]:(Pe=t,t=s),t!==s&&(t=g(t)),(e=t)===s&&(e=Rt()),e}function He(){var e,t,r,n,i;return e=Pe,t=Pe,(r=jt())!==s&&(n=ar())!==s&&(i=Tt())!==s?t=r=[r,n,i]:(Pe=t,t=s),t!==s&&(t=g(t)),(e=t)===s&&(e=Tt()),e}function We(){var e,t,r,n,i,a,u,c;if(e=Pe,(t=et())!==s){for(r=[],n=Pe,(i=ar())!==s&&(a=Ke())!==s&&(u=ar())!==s&&(c=et())!==s?n=i=[i,a,u,c]:(Pe=n,n=s);n!==s;)r.push(n),n=Pe,(i=ar())!==s&&(a=Ke())!==s&&(u=ar())!==s&&(c=et())!==s?n=i=[i,a,u,c]:(Pe=n,n=s);r!==s?e=t=o(t,r):(Pe=e,e=s)}else Pe=e,e=s;return e}function Ke(){var e;return 43===t.charCodeAt(Pe)?(e="+",Pe++):(e=s,0===Le&&Ye(y)),e===s&&(45===t.charCodeAt(Pe)?(e="-",Pe++):(e=s,0===Le&&Ye(v))),e}function et(){var e,t,r,n,i,a,o,u;if(e=Pe,(t=rt())!==s){for(r=[],n=Pe,(i=ar())!==s&&(a=tt())!==s&&(o=ar())!==s&&(u=rt())!==s?n=i=[i,a,o,u]:(Pe=n,n=s);n!==s;)r.push(n),n=Pe,(i=ar())!==s&&(a=tt())!==s&&(o=ar())!==s&&(u=rt())!==s?n=i=[i,a,o,u]:(Pe=n,n=s);r!==s?e=t=function(e,t){return lr(e,t)}(t,r):(Pe=e,e=s)}else Pe=e,e=s;return e}function tt(){var e;return 42===t.charCodeAt(Pe)?(e="*",Pe++):(e=s,0===Le&&Ye(b)),e===s&&(47===t.charCodeAt(Pe)?(e="/",Pe++):(e=s,0===Le&&Ye(x))),e}function rt(){var e,t;return(e=function(){var e;return(e=mt())===s&&(e=function(){var e,t,r,n;return e=Pe,(t=function(){var e,t,r,n;return e=Pe,(t=bt())!==s&&(r=xt())!==s&&(n=_t())!==s?e=t=function(e,t,r){return parseFloat(e+t+r)}(t,r,n):(Pe=e,e=s),e===s&&(e=Pe,(t=bt())!==s&&(r=xt())!==s?e=t=function(e,t){return parseFloat(e+t)}(t,r):(Pe=e,e=s),e===s&&(e=Pe,(t=bt())!==s&&(r=_t())!==s?e=t=function(e,t){return parseFloat(e+t)}(t,r):(Pe=e,e=s),e===s&&(e=Pe,(t=bt())!==s&&(t=function(e){return parseFloat(e)}(t)),e=t))),e}())!==s?(r=Pe,Le++,n=st(),Le--,n===s?r=void 0:(Pe=r,r=s),r!==s?e=t=function(e){return{type:"number",value:e}}(t):(Pe=e,e=s)):(Pe=e,e=s),e}())===s&&(e=function(){var e,t;return e=Pe,(t=Mt())!==s&&(t={type:"bool",value:!0}),(e=t)===s&&(e=Pe,(t=Ot())!==s&&(t={type:"bool",value:!1}),e=t),e}())===s&&(e=function(){var e;return(e=Nt())!==s&&(e={type:"null",value:null}),e}())===s&&(e=function(){var e,t;return e=Pe,Yt()!==s&&ar()!==s&&(t=pt())!==s?e=function(e){return{type:"date",value:e.value}}(t):(Pe=e,e=s),e}())===s&&(e=function(){var e,t;return e=Pe,qt()!==s&&ar()!==s&&(t=pt())!==s?e=function(e){return{type:"timestamp",value:e.value}}(t):(Pe=e,e=s),e}())===s&&(e=ct()),e}())===s&&(e=function(){var e,t,r;return e=Pe,Dt()!==s&&ar()!==s&&sr()!==s&&ar()!==s&&(t=function(){var e;return(e=Zt())===s&&(e=Jt())===s&&(e=Xt())===s&&(e=Ut())===s&&(e=$t())===s&&(e=Ht()),e}())!==s&&ar()!==s&&Gt()!==s&&ar()!==s&&(r=Ze())!==s&&ar()!==s&&ir()!==s?e=function(e,t){return{type:"function",name:"extract",args:{type:"expr_list",value:[{type:"string",value:e},t]}}}(t,r):(Pe=e,e=s),e}())===s&&(e=function(){var e,t,r,n,i,a,o,u;return e=Pe,Lt()!==s&&ar()!==s&&sr()!==s&&ar()!==s&&(t=Ze())!==s&&ar()!==s&&Gt()!==s&&ar()!==s&&(r=Ze())!==s&&ar()!==s?(n=Pe,(i=zt())!==s&&(a=ar())!==s&&(o=Ze())!==s&&(u=ar())!==s?n=i=[i,a,o,u]:(Pe=n,n=s),n===s&&(n=null),n!==s&&(i=ir())!==s?e=function(e,t,r){return{type:"function",name:"substring",args:{type:"expr_list",value:r?[e,t,r[2]]:[e,t]}}}(t,r,n):(Pe=e,e=s)):(Pe=e,e=s),e}())===s&&(e=function(){var e,t,r,n;return e=Pe,Qt()!==s&&ar()!==s&&sr()!==s&&ar()!==s?((t=ut())===s&&(t=null),t!==s&&ar()!==s&&(r=Ze())!==s&&ar()!==s&&Gt()!==s&&ar()!==s&&(n=Ze())!==s&&ar()!==s&&ir()!==s?e=function(e,t,r){return{type:"function",name:"trim",args:{type:"expr_list",value:[{type:"string",value:null==e?"BOTH":e},t,r]}}}(t,r,n):(Pe=e,e=s)):(Pe=e,e=s),e===s&&(e=Pe,Qt()!==s&&ar()!==s&&sr()!==s&&ar()!==s?((t=ut())===s&&(t=null),t!==s&&ar()!==s&&(r=Ze())!==s&&ar()!==s&&ir()!==s?e=function(e,t){return{type:"function",name:"trim",args:{type:"expr_list",value:[{type:"string",value:null==e?"BOTH":e},t]}}}(t,r):(Pe=e,e=s)):(Pe=e,e=s)),e}())===s&&(e=function(){var e,t,r;return e=Pe,kt()!==s&&ar()!==s&&sr()!==s&&ar()!==s&&(t=Ze())!==s&&ar()!==s&&Tt()!==s&&ar()!==s&&(r=Ze())!==s&&ar()!==s&&ir()!==s?e=function(e,t){return{type:"function",name:"position",args:{type:"expr_list",value:[e,t]}}}(t,r):(Pe=e,e=s),e}())===s&&(e=function(){var e,t,r;return e=Pe,(t=ur())!==s&&ar()!==s&&sr()!==s&&ar()!==s?((r=Ve())===s&&(r=null),r!==s&&ar()!==s&&ir()!==s?e=t=function(e,t){return{type:"function",name:e,args:t||{type:"expr_list",value:[]}}}(t,r):(Pe=e,e=s)):(Pe=e,e=s),e}())===s&&(e=function(){var e;return(e=function(){var e,t,r,n,i;if(e=Pe,Wt()!==s)if(ar()!==s)if((t=Ze())!==s)if(ar()!==s){for(r=[],n=yt();n!==s;)r.push(n),n=yt();r!==s&&(n=ar())!==s&&(i=Kt())!==s?e=function(e,t){return{type:"case_expression",format:"simple",operand:e,clauses:t,else:null}}(t,r):(Pe=e,e=s)}else Pe=e,e=s;else Pe=e,e=s;else Pe=e,e=s;else Pe=e,e=s;if(e===s)if(e=Pe,Wt()!==s)if(ar()!==s)if((t=Ze())!==s)if(ar()!==s){for(r=[],n=yt();n!==s;)r.push(n),n=yt();r!==s&&(n=ar())!==s&&(i=vt())!==s&&ar()!==s&&Kt()!==s?e=function(e,t,r){return{type:"case_expression",format:"simple",operand:e,clauses:t,else:r.value}}(t,r,i):(Pe=e,e=s)}else Pe=e,e=s;else Pe=e,e=s;else Pe=e,e=s;else Pe=e,e=s;return e}())===s&&(e=function(){var e,t,r,n;if(e=Pe,Wt()!==s)if(ar()!==s){for(t=[],r=gt();r!==s;)t.push(r),r=gt();t!==s&&(r=ar())!==s&&(n=Kt())!==s?e=function(e){return{type:"case_expression",format:"searched",clauses:e,else:null}}(t):(Pe=e,e=s)}else Pe=e,e=s;else Pe=e,e=s;if(e===s)if(e=Pe,Wt()!==s)if(ar()!==s){for(t=[],r=gt();r!==s;)t.push(r),r=gt();t!==s&&(r=ar())!==s&&(n=vt())!==s&&ar()!==s&&Kt()!==s?e=function(e,t){return{type:"case_expression",format:"searched",clauses:e,else:t.value}}(t,n):(Pe=e,e=s)}else Pe=e,e=s;else Pe=e,e=s;return e}()),e}())===s&&(e=function(){var e;return(e=function(){var e;return(e=function(){var e,t,r,n;if(e=Pe,(t=st())!==s){for(r=[],n=at();n!==s;)r.push(n),n=at();r!==s?e=t=_(t,r):(Pe=e,e=s)}else Pe=e,e=s;return e}())!==s&&(e=e),e}())!==s&&(e=function(e){return/^CURRENT_DATE$/i.test(e)?{type:"current_time",mode:"date"}:/^CURRENT_TIMESTAMP$/i.test(e)?{type:"current_time",mode:"timestamp"}:{type:"column_ref",table:"",column:e}}(e)),e}())===s&&(e=ot())===s&&(e=Pe,sr()!==s&&ar()!==s&&(t=Ze())!==s&&ar()!==s&&ir()!==s?e=function(e){return e.paren=!0,e}(t):(Pe=e,e=s)),e}function nt(){var e,t,r,n;if(e=Pe,(t=st())!==s){for(r=[],n=it();n!==s;)r.push(n),n=it();r!==s?e=t=_(t,r):(Pe=e,e=s)}else Pe=e,e=s;return e}function st(){var e;return w.test(t.charAt(Pe))?(e=t.charAt(Pe),Pe++):(e=s,0===Le&&Ye(I)),e}function it(){var e;return S.test(t.charAt(Pe))?(e=t.charAt(Pe),Pe++):(e=s,0===Le&&Ye(N)),e}function at(){var e;return M.test(t.charAt(Pe))?(e=t.charAt(Pe),Pe++):(e=s,0===Le&&Ye(O)),e}function ot(){var e,r,n;return e=Pe,64===t.charCodeAt(Pe)?(r="@",Pe++):(r=s,0===Le&&Ye(T)),r!==s&&(n=nt())!==s?e=r=[r,n]:(Pe=e,e=s),e!==s&&(e=function(e){return{type:"param",value:e[1]}}(e)),e}function ut(){var e;return(e=function(){var e,r,n,i;return e=Pe,"leading"===t.substr(Pe,7).toLowerCase()?(r=t.substr(Pe,7),Pe+=7):(r=s,0===Le&&Ye(le)),r!==s?(n=Pe,Le++,i=it(),Le--,i===s?n=void 0:(Pe=n,n=s),n!==s?e=r="LEADING":(Pe=e,e=s)):(Pe=e,e=s),e}())===s&&(e=function(){var e,r,n,i;return e=Pe,"trailing"===t.substr(Pe,8).toLowerCase()?(r=t.substr(Pe,8),Pe+=8):(r=s,0===Le&&Ye(he)),r!==s?(n=Pe,Le++,i=it(),Le--,i===s?n=void 0:(Pe=n,n=s),n!==s?e=r="TRAILING":(Pe=e,e=s)):(Pe=e,e=s),e}())===s&&(e=function(){var e,r,n,i;return e=Pe,"both"===t.substr(Pe,4).toLowerCase()?(r=t.substr(Pe,4),Pe+=4):(r=s,0===Le&&Ye(fe)),r!==s?(n=Pe,Le++,i=it(),Le--,i===s?n=void 0:(Pe=n,n=s),n!==s?e=r="BOTH":(Pe=e,e=s)):(Pe=e,e=s),e}()),e}function ct(){var e,r,n,i;return e=Pe,Vt()!==s&&ar()!==s?(45===t.charCodeAt(Pe)?(r="-",Pe++):(r=s,0===Le&&Ye(v)),r===s&&(43===t.charCodeAt(Pe)?(r="+",Pe++):(r=s,0===Le&&Ye(y))),r!==s&&ar()!==s&&(n=pt())!==s&&ar()!==s&&(i=lt())!==s?e=function(e,t,r){return{type:"interval",value:t,qualifier:r,op:e}}(r,n,i):(Pe=e,e=s)):(Pe=e,e=s),e===s&&(e=Pe,Vt()!==s&&ar()!==s&&(r=pt())!==s&&ar()!==s&&(n=lt())!==s?e=function(e,t){return{type:"interval",value:e,qualifier:t,op:""}}(r,n):(Pe=e,e=s)),e}function lt(){var e,t,r;return e=Pe,(t=function(){var e,t,r;return e=Pe,(t=ht())!==s&&ar()!==s&&sr()!==s&&ar()!==s&&(r=dt())!==s&&ar()!==s&&ir()!==s?e=t=function(e,t){return{type:"interval-period",period:e.value,precision:t,secondary:null}}(t,r):(Pe=e,e=s),e===s&&(e=Pe,(t=ht())!==s&&(t=F(t)),e=t),e}())!==s&&ar()!==s&&Bt()!==s&&ar()!==s&&(r=function(){var e,t,r,n;return e=Pe,(t=ht())!==s&&(t=function(e){return{type:"interval-period",period:e.value,precision:null,secondary:null}}(t)),(e=t)===s&&(e=Pe,(t=Ht())!==s&&ar()!==s&&sr()!==s&&ar()!==s&&(r=dt())!==s&&ar()!==s&&nr()!==s&&ar()!==s&&(n=ft())!==s&&ar()!==s&&ir()!==s?e=t=R(r,n):(Pe=e,e=s),e===s&&(e=Pe,(t=Ht())!==s&&ar()!==s&&sr()!==s&&ar()!==s&&(r=dt())!==s&&ar()!==s&&ir()!==s?e=t=function(e){return{type:"interval-period",period:"second",precision:e,secondary:null}}(r):(Pe=e,e=s),e===s&&(e=Pe,(t=Ht())!==s&&(t={type:"interval-period",period:"second",precision:null,secondary:null}),e=t))),e}())!==s?e=t=function(e,t){return{type:"interval-qualifier",start:e,end:t}}(t,r):(Pe=e,e=s),e===s&&(e=function(){var e,t,r,n;return e=Pe,(t=ht())!==s&&ar()!==s&&sr()!==s&&ar()!==s&&(r=ft())!==s&&ar()!==s&&ir()!==s?e=t=function(e,t){return{type:"interval-period",period:e.value,precision:t,secondary:null}}(t,r):(Pe=e,e=s),e===s&&(e=Pe,(t=ht())!==s&&(t=F(t)),(e=t)===s&&(e=Pe,(t=Ht())!==s&&ar()!==s&&sr()!==s&&ar()!==s&&(r=dt())!==s&&ar()!==s&&nr()!==s&&ar()!==s&&(n=ft())!==s&&ar()!==s&&ir()!==s?e=t=R(r,n):(Pe=e,e=s),e===s&&(e=Pe,(t=Ht())!==s&&ar()!==s&&sr()!==s&&ar()!==s&&(r=ft())!==s&&ar()!==s&&ir()!==s?e=t=function(e){return{type:"interval-period",period:"second",precision:e,secondary:null}}(r):(Pe=e,e=s),e===s&&(e=Pe,(t=Ht())!==s&&(t={type:"interval-period",period:"second",precision:null,secondary:null}),e=t)))),e}()),e}function ht(){var e,t;return e=Pe,(t=Xt())!==s&&(t={type:"string",value:"day"}),(e=t)===s&&(e=Pe,(t=Ut())!==s&&(t={type:"string",value:"hour"}),(e=t)===s&&(e=Pe,(t=$t())!==s&&(t={type:"string",value:"minute"}),(e=t)===s&&(e=Pe,(t=Jt())!==s&&(t={type:"string",value:"month"}),(e=t)===s&&(e=Pe,(t=Zt())!==s&&(t={type:"string",value:"year"}),e=t)))),e}function ft(){var e;return(e=wt())!==s&&(e=A(e)),e}function dt(){var e;return(e=wt())!==s&&(e=A(e)),e}function pt(){var e;return(e=mt())===s&&(e=ot()),e}function mt(){var e,r,n,i,a;if(e=Pe,39===t.charCodeAt(Pe)?(r="'",Pe++):(r=s,0===Le&&Ye(j)),r===s&&("N'"===t.substr(Pe,2)?(r="N'",Pe+=2):(r=s,0===Le&&Ye(E))),r!==s){for(n=[],i=Pe,"''"===t.substr(Pe,2)?(a="''",Pe+=2):(a=s,0===Le&&Ye(P)),a!==s&&(a="'"),(i=a)===s&&(C.test(t.charAt(Pe))?(i=t.charAt(Pe),Pe++):(i=s,0===Le&&Ye(G)));i!==s;)n.push(i),i=Pe,"''"===t.substr(Pe,2)?(a="''",Pe+=2):(a=s,0===Le&&Ye(P)),a!==s&&(a="'"),(i=a)===s&&(C.test(t.charAt(Pe))?(i=t.charAt(Pe),Pe++):(i=s,0===Le&&Ye(G)));n!==s?(39===t.charCodeAt(Pe)?(i="'",Pe++):(i=s,0===Le&&Ye(j)),i!==s?e=r=function(e){return{type:"string",value:e.join("")}}(n):(Pe=e,e=s)):(Pe=e,e=s)}else Pe=e,e=s;return e}function gt(){var e,t,r;return e=Pe,er()!==s&&ar()!==s&&(t=Ze())!==s&&ar()!==s&&tr()!==s&&ar()!==s&&(r=Ze())!==s?e=z(t,r):(Pe=e,e=s),e}function yt(){var e,t,r;return e=Pe,er()!==s&&ar()!==s&&(t=Ze())!==s&&ar()!==s&&tr()!==s&&ar()!==s&&(r=Ze())!==s?e=z(t,r):(Pe=e,e=s),e}function vt(){var e,t;return e=Pe,rr()!==s&&ar()!==s&&(t=Ze())!==s?e=function(e){return{type:"else_clause",value:e}}(t):(Pe=e,e=s),e}function bt(){var e,r,n;return(e=wt())===s&&(e=Pe,45===t.charCodeAt(Pe)?(r="-",Pe++):(r=s,0===Le&&Ye(v)),r===s&&(43===t.charCodeAt(Pe)?(r="+",Pe++):(r=s,0===Le&&Ye(y))),r!==s&&(n=wt())!==s?e=r=function(e,t){return e[0]+t}(r,n):(Pe=e,e=s)),e}function xt(){var e,r,n;return e=Pe,46===t.charCodeAt(Pe)?(r=".",Pe++):(r=s,0===Le&&Ye(L)),r!==s?((n=wt())===s&&(n=null),n!==s?e=r=function(e){return"."+(null!=e?e:"")}(n):(Pe=e,e=s)):(Pe=e,e=s),e}function _t(){var e,t,r;return e=Pe,(t=St())!==s&&(r=wt())!==s?e=t=function(e,t){return e+t}(t,r):(Pe=e,e=s),e}function wt(){var e,t;if(e=[],(t=It())!==s)for(;t!==s;)e.push(t),t=It();else e=s;return e!==s&&(e=function(e){return e.join("")}(e)),e}function It(){var e;return D.test(t.charAt(Pe))?(e=t.charAt(Pe),Pe++):(e=s,0===Le&&Ye(Q)),e}function St(){var e,r,n;return e=Pe,k.test(t.charAt(Pe))?(r=t.charAt(Pe),Pe++):(r=s,0===Le&&Ye(q)),r!==s?(Y.test(t.charAt(Pe))?(n=t.charAt(Pe),Pe++):(n=s,0===Le&&Ye(B)),n===s&&(n=null),n!==s?e=r=function(e,t){return"e"+(null===t?"":t)}(0,n):(Pe=e,e=s)):(Pe=e,e=s),e}function Nt(){var e,r,n,i;return e=Pe,"null"===t.substr(Pe,4).toLowerCase()?(r=t.substr(Pe,4),Pe+=4):(r=s,0===Le&&Ye(V)),r!==s?(n=Pe,Le++,i=it(),Le--,i===s?n=void 0:(Pe=n,n=s),n!==s?e=r=[r,n]:(Pe=e,e=s)):(Pe=e,e=s),e}function Mt(){var e,r,n,i;return e=Pe,"true"===t.substr(Pe,4).toLowerCase()?(r=t.substr(Pe,4),Pe+=4):(r=s,0===Le&&Ye(Z)),r!==s?(n=Pe,Le++,i=it(),Le--,i===s?n=void 0:(Pe=n,n=s),n!==s?e=r=[r,n]:(Pe=e,e=s)):(Pe=e,e=s),e}function Ot(){var e,r,n,i;return e=Pe,"false"===t.substr(Pe,5).toLowerCase()?(r=t.substr(Pe,5),Pe+=5):(r=s,0===Le&&Ye(J)),r!==s?(n=Pe,Le++,i=it(),Le--,i===s?n=void 0:(Pe=n,n=s),n!==s?e=r=[r,n]:(Pe=e,e=s)):(Pe=e,e=s),e}function Tt(){var e,r,n,i;return e=Pe,"in"===t.substr(Pe,2).toLowerCase()?(r=t.substr(Pe,2),Pe+=2):(r=s,0===Le&&Ye(X)),r!==s?(n=Pe,Le++,i=it(),Le--,i===s?n=void 0:(Pe=n,n=s),n!==s?e=r="IN":(Pe=e,e=s)):(Pe=e,e=s),e}function Ft(){var e,r,n,i;return e=Pe,"is"===t.substr(Pe,2).toLowerCase()?(r=t.substr(Pe,2),Pe+=2):(r=s,0===Le&&Ye(U)),r!==s?(n=Pe,Le++,i=it(),Le--,i===s?n=void 0:(Pe=n,n=s),n!==s?e=r="IS":(Pe=e,e=s)):(Pe=e,e=s),e}function Rt(){var e,r,n,i;return e=Pe,"like"===t.substr(Pe,4).toLowerCase()?(r=t.substr(Pe,4),Pe+=4):(r=s,0===Le&&Ye($)),r!==s?(n=Pe,Le++,i=it(),Le--,i===s?n=void 0:(Pe=n,n=s),n!==s?e=r="LIKE":(Pe=e,e=s)):(Pe=e,e=s),e}function At(){var e,r,n,i;return e=Pe,"escape"===t.substr(Pe,6).toLowerCase()?(r=t.substr(Pe,6),Pe+=6):(r=s,0===Le&&Ye(H)),r!==s?(n=Pe,Le++,i=it(),Le--,i===s?n=void 0:(Pe=n,n=s),n!==s?e=r="ESCAPE":(Pe=e,e=s)):(Pe=e,e=s),e}function jt(){var e,r,n,i;return e=Pe,"not"===t.substr(Pe,3).toLowerCase()?(r=t.substr(Pe,3),Pe+=3):(r=s,0===Le&&Ye(W)),r!==s?(n=Pe,Le++,i=it(),Le--,i===s?n=void 0:(Pe=n,n=s),n!==s?e=r="NOT":(Pe=e,e=s)):(Pe=e,e=s),e}function Et(){var e,r,n,i;return e=Pe,"and"===t.substr(Pe,3).toLowerCase()?(r=t.substr(Pe,3),Pe+=3):(r=s,0===Le&&Ye(K)),r!==s?(n=Pe,Le++,i=it(),Le--,i===s?n=void 0:(Pe=n,n=s),n!==s?e=r="AND":(Pe=e,e=s)):(Pe=e,e=s),e}function Pt(){var e,r,n,i;return e=Pe,"or"===t.substr(Pe,2).toLowerCase()?(r=t.substr(Pe,2),Pe+=2):(r=s,0===Le&&Ye(ee)),r!==s?(n=Pe,Le++,i=it(),Le--,i===s?n=void 0:(Pe=n,n=s),n!==s?e=r="OR":(Pe=e,e=s)):(Pe=e,e=s),e}function Ct(){var e,r,n,i;return e=Pe,"between"===t.substr(Pe,7).toLowerCase()?(r=t.substr(Pe,7),Pe+=7):(r=s,0===Le&&Ye(te)),r!==s?(n=Pe,Le++,i=it(),Le--,i===s?n=void 0:(Pe=n,n=s),n!==s?e=r="BETWEEN":(Pe=e,e=s)):(Pe=e,e=s),e}function Gt(){var e,r,n,i;return e=Pe,"from"===t.substr(Pe,4).toLowerCase()?(r=t.substr(Pe,4),Pe+=4):(r=s,0===Le&&Ye(re)),r!==s?(n=Pe,Le++,i=it(),Le--,i===s?n=void 0:(Pe=n,n=s),n!==s?e=r="FROM":(Pe=e,e=s)):(Pe=e,e=s),e}function zt(){var e,r,n,i;return e=Pe,"for"===t.substr(Pe,3).toLowerCase()?(r=t.substr(Pe,3),Pe+=3):(r=s,0===Le&&Ye(ne)),r!==s?(n=Pe,Le++,i=it(),Le--,i===s?n=void 0:(Pe=n,n=s),n!==s?e=r="FOR":(Pe=e,e=s)):(Pe=e,e=s),e}function Lt(){var e,r,n,i;return e=Pe,"substring"===t.substr(Pe,9).toLowerCase()?(r=t.substr(Pe,9),Pe+=9):(r=s,0===Le&&Ye(se)),r!==s?(n=Pe,Le++,i=it(),Le--,i===s?n=void 0:(Pe=n,n=s),n!==s?e=r="SUBSTRING":(Pe=e,e=s)):(Pe=e,e=s),e}function Dt(){var e,r,n,i;return e=Pe,"extract"===t.substr(Pe,7).toLowerCase()?(r=t.substr(Pe,7),Pe+=7):(r=s,0===Le&&Ye(ie)),r!==s?(n=Pe,Le++,i=it(),Le--,i===s?n=void 0:(Pe=n,n=s),n!==s?e=r="EXTRACT":(Pe=e,e=s)):(Pe=e,e=s),e}function Qt(){var e,r,n,i;return e=Pe,"trim"===t.substr(Pe,4).toLowerCase()?(r=t.substr(Pe,4),Pe+=4):(r=s,0===Le&&Ye(ae)),r!==s?(n=Pe,Le++,i=it(),Le--,i===s?n=void 0:(Pe=n,n=s),n!==s?e=r="TRIM":(Pe=e,e=s)):(Pe=e,e=s),e}function kt(){var e,r,n,i;return e=Pe,"position"===t.substr(Pe,8).toLowerCase()?(r=t.substr(Pe,8),Pe+=8):(r=s,0===Le&&Ye(oe)),r!==s?(n=Pe,Le++,i=it(),Le--,i===s?n=void 0:(Pe=n,n=s),n!==s?e=r="POSITION":(Pe=e,e=s)):(Pe=e,e=s),e}function qt(){var e,r,n,i;return e=Pe,"timestamp"===t.substr(Pe,9).toLowerCase()?(r=t.substr(Pe,9),Pe+=9):(r=s,0===Le&&Ye(ue)),r!==s?(n=Pe,Le++,i=it(),Le--,i===s?n=void 0:(Pe=n,n=s),n!==s?e=r="TIMESTAMP":(Pe=e,e=s)):(Pe=e,e=s),e}function Yt(){var e,r,n,i;return e=Pe,"date"===t.substr(Pe,4).toLowerCase()?(r=t.substr(Pe,4),Pe+=4):(r=s,0===Le&&Ye(ce)),r!==s?(n=Pe,Le++,i=it(),Le--,i===s?n=void 0:(Pe=n,n=s),n!==s?e=r="DATE":(Pe=e,e=s)):(Pe=e,e=s),e}function Bt(){var e,r,n,i;return e=Pe,"to"===t.substr(Pe,2).toLowerCase()?(r=t.substr(Pe,2),Pe+=2):(r=s,0===Le&&Ye(de)),r!==s?(n=Pe,Le++,i=it(),Le--,i===s?n=void 0:(Pe=n,n=s),n!==s?e=r="TO":(Pe=e,e=s)):(Pe=e,e=s),e}function Vt(){var e,r,n,i;return e=Pe,"interval"===t.substr(Pe,8).toLowerCase()?(r=t.substr(Pe,8),Pe+=8):(r=s,0===Le&&Ye(pe)),r!==s?(n=Pe,Le++,i=it(),Le--,i===s?n=void 0:(Pe=n,n=s),n!==s?e=r="INTERVAL":(Pe=e,e=s)):(Pe=e,e=s),e}function Zt(){var e,r,n,i;return e=Pe,"year"===t.substr(Pe,4).toLowerCase()?(r=t.substr(Pe,4),Pe+=4):(r=s,0===Le&&Ye(me)),r!==s?(n=Pe,Le++,i=it(),Le--,i===s?n=void 0:(Pe=n,n=s),n!==s?e=r="YEAR":(Pe=e,e=s)):(Pe=e,e=s),e}function Jt(){var e,r,n,i;return e=Pe,"month"===t.substr(Pe,5).toLowerCase()?(r=t.substr(Pe,5),Pe+=5):(r=s,0===Le&&Ye(ge)),r!==s?(n=Pe,Le++,i=it(),Le--,i===s?n=void 0:(Pe=n,n=s),n!==s?e=r="MONTH":(Pe=e,e=s)):(Pe=e,e=s),e}function Xt(){var e,r,n,i;return e=Pe,"day"===t.substr(Pe,3).toLowerCase()?(r=t.substr(Pe,3),Pe+=3):(r=s,0===Le&&Ye(ye)),r!==s?(n=Pe,Le++,i=it(),Le--,i===s?n=void 0:(Pe=n,n=s),n!==s?e=r="DAY":(Pe=e,e=s)):(Pe=e,e=s),e}function Ut(){var e,r,n,i;return e=Pe,"hour"===t.substr(Pe,4).toLowerCase()?(r=t.substr(Pe,4),Pe+=4):(r=s,0===Le&&Ye(ve)),r!==s?(n=Pe,Le++,i=it(),Le--,i===s?n=void 0:(Pe=n,n=s),n!==s?e=r="HOUR":(Pe=e,e=s)):(Pe=e,e=s),e}function $t(){var e,r,n,i;return e=Pe,"minute"===t.substr(Pe,6).toLowerCase()?(r=t.substr(Pe,6),Pe+=6):(r=s,0===Le&&Ye(be)),r!==s?(n=Pe,Le++,i=it(),Le--,i===s?n=void 0:(Pe=n,n=s),n!==s?e=r="MINUTE":(Pe=e,e=s)):(Pe=e,e=s),e}function Ht(){var e,r,n,i;return e=Pe,"second"===t.substr(Pe,6).toLowerCase()?(r=t.substr(Pe,6),Pe+=6):(r=s,0===Le&&Ye(xe)),r!==s?(n=Pe,Le++,i=it(),Le--,i===s?n=void 0:(Pe=n,n=s),n!==s?e=r="SECOND":(Pe=e,e=s)):(Pe=e,e=s),e}function Wt(){var e,r,n,i;return e=Pe,"case"===t.substr(Pe,4).toLowerCase()?(r=t.substr(Pe,4),Pe+=4):(r=s,0===Le&&Ye(_e)),r!==s?(n=Pe,Le++,i=it(),Le--,i===s?n=void 0:(Pe=n,n=s),n!==s?e=r="CASE":(Pe=e,e=s)):(Pe=e,e=s),e}function Kt(){var e,r,n,i;return e=Pe,"end"===t.substr(Pe,3).toLowerCase()?(r=t.substr(Pe,3),Pe+=3):(r=s,0===Le&&Ye(we)),r!==s?(n=Pe,Le++,i=it(),Le--,i===s?n=void 0:(Pe=n,n=s),n!==s?e=r="END":(Pe=e,e=s)):(Pe=e,e=s),e}function er(){var e,r,n,i;return e=Pe,"when"===t.substr(Pe,4).toLowerCase()?(r=t.substr(Pe,4),Pe+=4):(r=s,0===Le&&Ye(Ie)),r!==s?(n=Pe,Le++,i=it(),Le--,i===s?n=void 0:(Pe=n,n=s),n!==s?e=r="WHEN":(Pe=e,e=s)):(Pe=e,e=s),e}function tr(){var e,r,n,i;return e=Pe,"then"===t.substr(Pe,4).toLowerCase()?(r=t.substr(Pe,4),Pe+=4):(r=s,0===Le&&Ye(Se)),r!==s?(n=Pe,Le++,i=it(),Le--,i===s?n=void 0:(Pe=n,n=s),n!==s?e=r="THEN":(Pe=e,e=s)):(Pe=e,e=s),e}function rr(){var e,r,n,i;return e=Pe,"else"===t.substr(Pe,4).toLowerCase()?(r=t.substr(Pe,4),Pe+=4):(r=s,0===Le&&Ye(Ne)),r!==s?(n=Pe,Le++,i=it(),Le--,i===s?n=void 0:(Pe=n,n=s),n!==s?e=r="ELSE":(Pe=e,e=s)):(Pe=e,e=s),e}function nr(){var e;return 44===t.charCodeAt(Pe)?(e=",",Pe++):(e=s,0===Le&&Ye(Me)),e}function sr(){var e;return 40===t.charCodeAt(Pe)?(e="(",Pe++):(e=s,0===Le&&Ye(Oe)),e}function ir(){var e;return 41===t.charCodeAt(Pe)?(e=")",Pe++):(e=s,0===Le&&Ye(Te)),e}function ar(){var e,t;for(e=[],t=or();t!==s;)e.push(t),t=or();return e}function or(){var e;return Fe.test(t.charAt(Pe))?(e=t.charAt(Pe),Pe++):(e=s,0===Le&&Ye(Re)),e}function ur(){var e,r,n,i;if(e=Pe,(r=nt())!==s&&(r=r),(e=r)===s)if(e=Pe,96===t.charCodeAt(Pe)?(r="`",Pe++):(r=s,0===Le&&Ye(Ae)),r!==s){if(n=[],je.test(t.charAt(Pe))?(i=t.charAt(Pe),Pe++):(i=s,0===Le&&Ye(Ee)),i!==s)for(;i!==s;)n.push(i),je.test(t.charAt(Pe))?(i=t.charAt(Pe),Pe++):(i=s,0===Le&&Ye(Ee));else n=s;n!==s?(96===t.charCodeAt(Pe)?(i="`",Pe++):(i=s,0===Le&&Ye(Ae)),i!==s?e=r=function(e){return e.join("")}(n):(Pe=e,e=s)):(Pe=e,e=s)}else Pe=e,e=s;return e}function cr(e,t,r,n){var s={type:"binary_expr",operator:e,left:t,right:r};return void 0!==n&&(s.escape=n),s}function lr(e,t){for(var r=e,n=0;n<t.length;n++)r=cr(t[n][1],r,t[n][3]);return r}if((n=a())!==s&&Pe===t.length)return n;throw n!==s&&Pe<t.length&&Ye({type:"end"}),function(t,r,n){return new e(e.buildMessage(t,r),t,r,n)}(ze,Ge<t.length?t.charAt(Ge):null,Ge<t.length?qe(Ge,Ge+1):qe(Ge,Ge))}}},e.exports&&(e.exports=t())}));const d=/^(\d{4})-(\d{1,2})-(\d{1,2})$/,p=/^(\d{4})-(\d{1,2})-(\d{1,2}) (\d{1,2}):(\d{1,2}):(\d{1,2}(\.[0-9]+)?)$/,m=/^(\d{4})-(\d{1,2})-(\d{1,2}) (\d{1,2}):(\d{1,2}):(\d{1,2}(\.[0-9]+)?)(\+|\-)(\d{1,2}):(\d{1,2})$/,g=/^(\d{4})-(\d{1,2})-(\d{1,2}) (\d{1,2}):(\d{1,2})(\+|\-)(\d{1,2}):(\d{1,2})$/,y=/^(\d{4})-(\d{1,2})-(\d{1,2}) (\d{1,2}):(\d{1,2})$/;function v(e,t){return(e+="").length>=t?e:new Array(t-e.length+1).join("0")+e}function b(e,t,r="0",n="0",s="0",i="0",a="",o="0",u="0"){if("+"===a||"-"===a){const c=`${v(parseInt(e,10),4)}-${v(parseInt(t,10),2)}-${v(parseInt(r,10),2)}`;let l="";parseFloat(i)<10&&(l="0");const h=`${v(parseInt(n,10),2)}:${v(parseInt(s,10),2)}:${l+parseFloat(i).toString()}`,f=`${a}${v(parseInt(o,10),2)}:${v(parseInt(u,10),2)}`;return new Date(c+"T"+h+f)}return new Date(parseInt(e,10),parseInt(t,10)-1,parseInt(r,10),parseInt(n,10),parseInt(s,10),parseFloat(i))}class x{static makeBool(e){return S(e)}static featureValue(e,t,r,n){return C(e,t,r,n)}static equalsNull(e){return null===e}static applyLike(e,t,r){return R(e,t,r)}static ensureArray(e){return N(e)}static applyIn(e,t){return F(e,t)}static currentDate(){const e=new Date;return e.setHours(0,0,0,0),e}static makeSqlInterval(e,t,r){return u.createFromValueAndQualifer(e,t,r)}static convertInterval(e){return e instanceof u?e.valueInMilliseconds():e}static currentTimestamp(){return new Date}static compare(e,t,r){return j(e,t,r)}static calculate(e,t,r){return P(e,t,r)}static makeComparable(e){return A(e)}static evaluateFunction(e,t){return c(e,t)}static lookup(e,t){const r=t[e];return void 0===r?null:r}static between(e,t){return null==e||null==t[0]||null==t[1]?null:e>=t[0]&&e<=t[1]}static notbetween(e,t){return null==e||null==t[0]||null==t[1]?null:e<t[0]||e>t[1]}static ternaryNot(e){return M(e)}static ternaryAnd(e,t){return O(e,t)}static ternaryOr(e,t){return T(e,t)}}class _{constructor(e,t){this.fieldsIndex=t,this.datefields={},this.parameters={},this.parseTree=class{static parse(e){return f.parse(e)}}.parse(e);const{isStandardized:r,isAggregate:n,referencedFieldNames:s}=this.extractExpressionInfo(t);this.referencedFieldNames=s,this.isStandardized=r,this.isAggregate=n}static create(e,t){return new _(e,t)}get fieldNames(){return this.referencedFieldNames}testSet(e,t=G){const r={};for(const n of this.fieldNames)r[n]=e.map((e=>t.getAttribute(e,n)));return!!this.evaluateNode(this.parseTree,{attributes:r},G)}calculateValue(e,t=G){const r=this.evaluateNode(this.parseTree,e,t);return r instanceof u?r.valueInMilliseconds()/864e5:r}calculateValueCompiled(e,t=G){return null!=this.parseTree._compiledVersion?this.parseTree._compiledVersion(e,this.parameters,t,this.datefields):Object(n.a)("csp-restrictions")?this.calculateValue(e,t):(this.compileMe(),this.parseTree._compiledVersion(e,this.parameters,t,this.datefields))}testFeature(e,t=G){return!!this.evaluateNode(this.parseTree,e,t)}testFeatureCompiled(e,t=G){return null!=this.parseTree._compiledVersion?!!this.parseTree._compiledVersion(e,this.parameters,t,this.datefields):Object(n.a)("csp-restrictions")?this.testFeature(e,t):(this.compileMe(),!!this.parseTree._compiledVersion(e,this.parameters,t,this.datefields))}getFunctions(){const e=[];return this.visitAll(this.parseTree,(t=>{"function"===t.type&&e.push(t.name.toLowerCase())})),E(e)}getExpressions(){const e=new Map;return this.visitAll(this.parseTree,(t=>{if("function"===t.type){const r=t.name.toLowerCase(),n=t.args.value[0];if("column_ref"===n.type){const t=n.column,s=`${r}-${t}`;e.has(s)||e.set(s,{aggregateType:r,field:t})}}})),[...e.values()]}getVariables(){const e=[];return this.visitAll(this.parseTree,(t=>{"param"===t.type&&e.push(t.value.toLowerCase())})),E(e)}compileMe(){const e="return this.convertInterval("+this.evaluateNodeToJavaScript(this.parseTree)+")";this.parseTree._compiledVersion=new Function("feature","lookups","attributeAdapter","datefields",e).bind(x)}extractExpressionInfo(e){const t=[];let r=!0,n=!0;return this.visitAll(this.parseTree,(i=>{switch(i.type){case"column_ref":{const r=e.get(i.column),n=r&&r.name;!r||"date"!==r.type&&"esriFieldTypeDate"!==r.type||(this.datefields[r.name]=1),void 0!==n?(t.push(n),i.column=n):t.push(i.column);break}case"function":{const{name:e,args:t}=i,a=t.value.length;r&&(r=function(e,t){const r=l[e.toLowerCase()];return null!=r&&t>=r.minParams&&t<=r.maxParams}(e,a)),n&&(n=function(e,t){const r=s[e.toLowerCase()];return null!=r&&t>=r.minParams&&t<=r.maxParams}(e,a));break}}})),{referencedFieldNames:E(t),isStandardized:r,isAggregate:n}}visitAll(e,t){if(null!=e)switch(t(e),e.type){case"when_clause":this.visitAll(e.operand,t),this.visitAll(e.value,t);break;case"case_expression":for(const r of e.clauses)this.visitAll(r,t);"simple"===e.format&&this.visitAll(e.operand,t),null!==e.else&&this.visitAll(e.else,t);break;case"expr_list":for(const r of e.value)this.visitAll(r,t);break;case"unary_expr":this.visitAll(e.expr,t);break;case"binary_expr":this.visitAll(e.left,t),this.visitAll(e.right,t);break;case"function":this.visitAll(e.args,t)}}evaluateNodeToJavaScript(e){switch(e.type){case"interval":return"this.makeSqlInterval("+this.evaluateNodeToJavaScript(e.value)+", "+JSON.stringify(e.qualifier)+","+JSON.stringify(e.op)+")";case"case_expression":{let t="";if("simple"===e.format){const r="this.makeComparable("+this.evaluateNodeToJavaScript(e.operand)+")";t="( ";for(let n=0;n<e.clauses.length;n++)t+=" ("+r+" === this.makeComparable("+this.evaluateNodeToJavaScript(e.clauses[n].operand)+")) ? ("+this.evaluateNodeToJavaScript(e.clauses[n].value)+") : ";null!==e.else?t+=this.evaluateNodeToJavaScript(e.else):t+="null",t+=" )"}else{t="( ";for(let r=0;r<e.clauses.length;r++)t+=" this.makeBool("+this.evaluateNodeToJavaScript(e.clauses[r].operand)+")===true ? ("+this.evaluateNodeToJavaScript(e.clauses[r].value)+") : ";null!==e.else?t+=this.evaluateNodeToJavaScript(e.else):t+="null",t+=" )"}return t}case"param":return"this.lookup("+JSON.stringify(e.value.toLowerCase())+",lookups)";case"expr_list":{let t="[";for(const r of e.value)"["!==t&&(t+=","),t+=this.evaluateNodeToJavaScript(r);return t+="]",t}case"unary_expr":return"this.ternaryNot("+this.evaluateNodeToJavaScript(e.expr)+")";case"binary_expr":switch(e.operator){case"AND":return"this.ternaryAnd("+this.evaluateNodeToJavaScript(e.left)+","+this.evaluateNodeToJavaScript(e.right)+" )";case"OR":return"this.ternaryOr("+this.evaluateNodeToJavaScript(e.left)+","+this.evaluateNodeToJavaScript(e.right)+" )";case"IS":if("null"!==e.right.type)throw new Error("Unsupported RHS for IS");return"this.equalsNull("+this.evaluateNodeToJavaScript(e.left)+")";case"ISNOT":if("null"!==e.right.type)throw new Error("Unsupported RHS for IS");return"(!(this.equalsNull("+this.evaluateNodeToJavaScript(e.left)+")))";case"IN":return"this.applyIn("+this.evaluateNodeToJavaScript(e.left)+",this.ensureArray("+this.evaluateNodeToJavaScript(e.right)+"))";case"NOT IN":return"this.ternaryNot(this.applyIn("+this.evaluateNodeToJavaScript(e.left)+",this.ensureArray("+this.evaluateNodeToJavaScript(e.right)+")))";case"BETWEEN":return"this.between("+this.evaluateNodeToJavaScript(e.left)+","+this.evaluateNodeToJavaScript(e.right)+")";case"NOTBETWEEN":return"this.notbetween("+this.evaluateNodeToJavaScript(e.left)+","+this.evaluateNodeToJavaScript(e.right)+")";case"LIKE":return"this.applyLike("+this.evaluateNodeToJavaScript(e.left)+","+this.evaluateNodeToJavaScript(e.right)+","+JSON.stringify(e.escape)+")";case"NOT LIKE":return"this.ternaryNot(this.applyLike("+this.evaluateNodeToJavaScript(e.left)+","+this.evaluateNodeToJavaScript(e.right)+","+JSON.stringify(e.escape)+"))";case"<>":case"<":case">":case">=":case"<=":case"=":return"this.compare("+JSON.stringify(e.operator)+","+this.evaluateNodeToJavaScript(e.left)+","+this.evaluateNodeToJavaScript(e.right)+")";case"*":case"-":case"+":case"/":return"this.calculate("+JSON.stringify(e.operator)+","+this.evaluateNodeToJavaScript(e.left)+","+this.evaluateNodeToJavaScript(e.right)+")"}throw new Error("Not Supported Operator "+e.operator);case"null":case"bool":case"string":case"number":return JSON.stringify(e.value);case"date":return"(new Date("+I(e.value).getTime().toString()+"))";case"timestamp":return"(new Date("+w(e.value).getTime().toString()+"))";case"current_time":return"date"===e.mode?"this.currentDate()":"this.currentTimestamp()";case"column_ref":return"this.featureValue(feature,"+JSON.stringify(e.column)+",datefields,attributeAdapter)";case"function":return"this.evaluateFunction("+JSON.stringify(e.name)+","+this.evaluateNodeToJavaScript(e.args)+")"}throw new Error("Unsupported sql syntax "+e.type)}evaluateNode(e,t,r){switch(e.type){case"interval":{const n=this.evaluateNode(e.value,t,r);return u.createFromValueAndQualifer(n,e.qualifier,e.op)}case"case_expression":if("simple"===e.format){const n=A(this.evaluateNode(e.operand,t,r));for(let s=0;s<e.clauses.length;s++)if(n===A(this.evaluateNode(e.clauses[s].operand,t,r)))return this.evaluateNode(e.clauses[s].value,t,r);if(null!==e.else)return this.evaluateNode(e.else,t,r)}else{for(let n=0;n<e.clauses.length;n++)if(S(this.evaluateNode(e.clauses[n].operand,t,r)))return this.evaluateNode(e.clauses[n].value,t,r);if(null!==e.else)return this.evaluateNode(e.else,t,r)}return null;case"param":return this.parameters[e.value.toLowerCase()];case"expr_list":{const n=[];for(const s of e.value)n.push(this.evaluateNode(s,t,r));return n}case"unary_expr":return M(this.evaluateNode(e.expr,t,r));case"binary_expr":switch(e.operator){case"AND":return O(this.evaluateNode(e.left,t,r),this.evaluateNode(e.right,t,r));case"OR":return T(this.evaluateNode(e.left,t,r),this.evaluateNode(e.right,t,r));case"IS":if("null"!==e.right.type)throw new Error("Unsupported RHS for IS");return null===this.evaluateNode(e.left,t,r);case"ISNOT":if("null"!==e.right.type)throw new Error("Unsupported RHS for IS");return null!==this.evaluateNode(e.left,t,r);case"IN":{const n=N(this.evaluateNode(e.right,t,r));return F(this.evaluateNode(e.left,t,r),n)}case"NOT IN":{const n=N(this.evaluateNode(e.right,t,r));return M(F(this.evaluateNode(e.left,t,r),n))}case"BETWEEN":{const n=this.evaluateNode(e.left,t,r),s=this.evaluateNode(e.right,t,r);return null==n||null==s[0]||null==s[1]?null:n>=A(s[0])&&n<=A(s[1])}case"NOTBETWEEN":{const n=this.evaluateNode(e.left,t,r),s=this.evaluateNode(e.right,t,r);return null==n||null==s[0]||null==s[1]?null:n<A(s[0])||n>A(s[1])}case"LIKE":return R(this.evaluateNode(e.left,t,r),this.evaluateNode(e.right,t,r),e.escape);case"NOT LIKE":return M(R(this.evaluateNode(e.left,t,r),this.evaluateNode(e.right,t,r),e.escape));case"<>":case"<":case">":case">=":case"<=":case"=":return j(e.operator,this.evaluateNode(e.left,t,r),this.evaluateNode(e.right,t,r));case"-":case"+":case"*":case"/":return P(e.operator,this.evaluateNode(e.left,t,r),this.evaluateNode(e.right,t,r))}case"null":case"bool":case"string":case"number":return e.value;case"date":return I(e.value);case"timestamp":return w(e.value);case"current_time":{const t=new Date;return"date"===e.mode&&t.setHours(0,0,0,0),t}case"column_ref":return C(t,e.column,this.datefields,r);case"function":{const n=this.evaluateNode(e.args,t,r);return this.isAggregate?function(e,t){const r=s[e.toLowerCase()];if(null==r)throw new Error("Function Not Recognised");if(t.length<r.minParams||t.length>r.maxParams)throw new Error("Invalid Parameter count for call to "+e.toUpperCase());return r.evaluate(t)}(e.name,n):c(e.name,n)}}throw new Error("Unsupported sql syntax "+e.type)}}function w(e){let t=p.exec(e);if(null!==t){const[,e,r,n,s,i,a]=t;return b(e,r,n,s,i,a)}if(t=m.exec(e),null!==t){const[,e,r,n,s,i,a,o,u,c]=t;return b(e,r,n,s,i,a,o,u,c)}if(t=g.exec(e),null!==t){const[,e,r,n,s,i,a,o,u]=t;return b(e,r,n,s,i,"0",a,o,u)}if(t=y.exec(e),null!==t){const[,e,r,n,s,i]=t;return b(e,r,n,s,i)}if(t=d.exec(e),null!==t){const[,e,r,n]=t;return b(e,r,n)}throw new Error("SQL Invalid Timestamp")}function I(e){const t=d.exec(e);if(null===t)throw new Error("SQL Invalid Date");const[,r,n,s]=t;return new Date(parseInt(r,10),parseInt(n,10)-1,parseInt(s,10))}function S(e){return!0===e}function N(e){return Array.isArray(e)?e:[e]}function M(e){return null!==e?!0!==e:null}function O(e,t){return null!=e&&null!=t?!0===e&&!0===t:!1!==e&&!1!==t&&null}function T(e,t){return null!=e&&null!=t?!0===e||!0===t:!0===e||!0===t||null}function F(e,t){if(null==e)return null;let r=!1;for(const n of t)if(null==n)r=null;else if(e===n){r=!0;break}return r}function R(e,t,r){if(null==e)return null;const n=t,s=r;let i="";const a="-[]/{}()*+?.\\^$|";let o=0;for(let e=0;e<n.length;e++){const t=n.charAt(e);switch(o){case 0:t===s?o=1:a.indexOf(t)>=0?i+="\\"+t:i+="%"===t?".*":"_"===t?".":t;break;case 1:a.indexOf(t)>=0?i+="\\"+t:i+=t,o=0}}return new RegExp("^"+i+"$").test(e)}function A(e){return e instanceof Date?e.valueOf():e}function j(e,t,r){if(null==t||null==r)return null;const n=A(t),s=A(r);switch(e){case"<>":return n!==s;case"=":return n===s;case">":return n>s;case"<":return n<s;case">=":return n>=s;case"<=":return n<=s}}function E(e){const t=[],r={};for(const n of e){const e=n.toLowerCase();void 0===r[e]&&(t.push(n),r[e]=1)}return t}function P(e,t,r){if(t instanceof u)if(r instanceof Date)switch(e){case"+":return new Date(t.valueInMilliseconds()+r.getTime());case"-":return t.valueInMilliseconds()-r.getTime();case"*":return t.valueInMilliseconds()*r.getTime();case"/":return t.valueInMilliseconds()/r.getTime()}else if(r instanceof u)switch(e){case"+":return u.createFromMilliseconds(t.valueInMilliseconds()+r.valueInMilliseconds());case"-":return u.createFromMilliseconds(t.valueInMilliseconds()-r.valueInMilliseconds());case"*":return t.valueInMilliseconds()*r.valueInMilliseconds();case"/":return t.valueInMilliseconds()/r.valueInMilliseconds()}else t=t.valueInMilliseconds();else if(r instanceof u)if(t instanceof Date)switch(e){case"+":return new Date(r.valueInMilliseconds()+t.getTime());case"-":return new Date(t.getTime()-r.valueInMilliseconds());case"*":return t.getTime()*r.valueInMilliseconds();case"/":return t.getTime()/r.valueInMilliseconds()}else r=r.valueInMilliseconds();else if(t instanceof Date&&"number"==typeof r)switch(r=24*r*60*60*1e3,t=t.getTime(),e){case"+":return new Date(t+r);case"-":return new Date(t-r);case"*":return new Date(t*r);case"/":return new Date(t/r)}else if(r instanceof Date&&"number"==typeof t)switch(t=24*t*60*60*1e3,r=r.getTime(),e){case"+":return new Date(t+r);case"-":return new Date(t-r);case"*":return new Date(t*r);case"/":return new Date(t/r)}switch(e){case"+":return t+r;case"-":return t-r;case"*":return t*r;case"/":return t/r}}function C(e,t,r,n){const s=n.getAttribute(e,t);return null!=s&&1===r[t]?new Date(s):s}const G={getAttribute:(e,t)=>(function(e){return e&&"object"==typeof e.attributes}(e)?e.attributes:e)[t]}},201:function(e,t,r){"use strict";class n{constructor(e=null,t={},r,n){this.displayId=0,this.geohashIndexed=!1,this.geohashX=0,this.geohashY=0,this.geometry=e,t&&(this.attributes=t),r&&(this.centroid=r),null!=n&&(this.objectId=n)}get hasGeometry(){return!(!this.geometry||!this.geometry.coords||!this.geometry.coords.length)}weakClone(){const e=new n(this.geometry,this.attributes,this.centroid,this.objectId);return e.displayId=this.displayId,e.geohashIndexed=this.geohashIndexed,e.geohashX=this.geohashX,e.geohashY=this.geohashY,e}}t.a=n},216:function(e,t,r){"use strict";r.d(t,"a",(function(){return x})),r.d(t,"b",(function(){return _}));var n=r(19),s=r(0),i=r(2),a=r(16),o=r(93),u=r(165),c=r(114),l=r(135),h=r(501),f=r(25),d=r(63),p=(r(59),r(58));const m=i.a.getLogger("esri.geometry.support.normalizeUtils");function g(e){return"polygon"===e[0].type}function y(e){return"polyline"===e[0].type}function v(e,t,r){if(t){const t=function(e,t){if(!(e instanceof l.a||e instanceof c.a)){const e="straightLineDensify: the input geometry is neither polyline nor polygon";throw m.error(e),new a.a(e)}const r=Object(h.b)(e),n=[];for(const e of r){const r=[];n.push(r),r.push([e[0][0],e[0][1]]);for(let n=0;n<e.length-1;n++){const s=e[n][0],i=e[n][1],a=e[n+1][0],o=e[n+1][1],u=Math.sqrt((a-s)*(a-s)+(o-i)*(o-i)),c=(o-i)/u,l=(a-s)/u,h=u/t;if(h>1){for(let e=1;e<=h-1;e++){const n=e*t,a=l*n+s,o=c*n+i;r.push([a,o])}const e=(u+Math.floor(h-1)*t)/2,n=l*e+s,a=c*e+i;r.push([n,a])}r.push([a,o])}}return function(e){return"polygon"===e.type}(e)?new c.a({rings:n,spatialReference:e.spatialReference}):new l.a({paths:n,spatialReference:e.spatialReference})}(e,1e6);e=Object(u.e)(t,!0)}return r&&(e=Object(h.e)(e,r)),e}function b(e,t,r){if(Array.isArray(e)){const n=e[0];if(n>t){const r=Object(h.d)(n,t);e[0]=n+r*(-2*t)}else if(n<r){const t=Object(h.d)(n,r);e[0]=n+t*(-2*r)}}else{const n=e.x;if(n>t){const r=Object(h.d)(n,t);e=e.clone().offset(r*(-2*t),0)}else if(n<r){const t=Object(h.d)(n,r);e=e.clone().offset(t*(-2*r),0)}}return e}async function x(e,t,r){if(!Array.isArray(e))return x([e],t);const i=t?t.url:n.a.geometryServiceUrl;let a,m,_,w,I,S,N,M,O=0;const T=[],F=[];for(const t of e)if(Object(s.g)(t))F.push(t);else if(a||(a=t.spatialReference,m=Object(o.d)(a),_=a.isWebMercator,S=_?102100:4326,w=h.a[S].maxX,I=h.a[S].minX,N=h.a[S].plus180Line,M=h.a[S].minus180Line),m)if("mesh"===t.type)F.push(t);else if("point"===t.type)F.push(b(t.clone(),w,I));else if("multipoint"===t.type){const e=t.clone();e.points=e.points.map((e=>b(e,w,I))),F.push(e)}else if("extent"===t.type){const e=t.clone()._normalize(!1,!1,m);F.push(e.rings?new c.a(e):e)}else if(t.extent){const e=t.extent,r=Object(h.d)(e.xmin,I)*(2*w);let n=0===r?t.clone():Object(h.e)(t.clone(),r);e.offset(r,0),e.intersects(N)&&e.xmax!==w?(O=e.xmax>O?e.xmax:O,n=v(n,_),T.push(n),F.push("cut")):e.intersects(M)&&e.xmin!==I?(O=e.xmax*(2*w)>O?e.xmax*(2*w):O,n=v(n,_,360),T.push(n),F.push("cut")):F.push(n)}else F.push(t.clone());else F.push(t);let R=Object(h.d)(O,w),A=-90;const j=R,E=new l.a;for(;R>0;){const e=360*R-180;E.addPath([[e,A],[e,-1*A]]),A*=-1,R--}if(T.length>0&&j>0){const t=function(e,t){let r=-1;for(let n=0;n<t.cutIndexes.length;n++){const s=t.cutIndexes[n],i=t.geometries[n],a=Object(h.b)(i);for(let e=0;e<a.length;e++){const t=a[e];t.some((r=>{if(r[0]<180)return!0;{let r=0;for(let e=0;e<t.length;e++){const n=t[e][0];r=n>r?n:r}r=Number(r.toFixed(9));const n=-360*Object(h.d)(r,180);for(let r=0;r<t.length;r++){const t=i.getPoint(e,r);i.setPoint(e,r,t.clone().offset(n,0))}return!0}}))}if(s===r){if(g(e))for(const t of Object(h.b)(i))e[s]=e[s].addRing(t);else if(y(e))for(const t of Object(h.b)(i))e[s]=e[s].addPath(t)}else r=s,e[s]=i}return e}(T,await async function(e,t,r,n){const s="string"==typeof e?Object(f.I)(e):e,i=t[0].spatialReference,a={...n,query:{...s.query,f:"json",sr:JSON.stringify(i),target:JSON.stringify({geometryType:Object(d.c)(t[0]),geometries:t}),cutter:JSON.stringify(r)}},o=await Object(p.default)(s.path+"/cut",a),{cutIndexes:u,geometries:c=[]}=o.data;return{cutIndexes:u,geometries:c.map((e=>{const t=Object(d.a)(e);return t.spatialReference=i,t}))}}(i,T,E,r)),n=[],a=[];for(let r=0;r<F.length;r++){const i=F[r];if("cut"!==i)a.push(i);else{const i=t.shift(),o=e[r];Object(s.h)(o)&&"polygon"===o.type&&o.rings&&o.rings.length>1&&i.rings.length>=o.rings.length?(n.push(i),a.push("simplify")):a.push(_?Object(u.b)(i):i)}}if(!n.length)return a;const o=await async function(e,t,r){const n="string"==typeof e?Object(f.I)(e):e,s=t[0].spatialReference,i=Object(d.c)(t[0]),a={...r,query:{...n.query,f:"json",sr:s.wkid?s.wkid:JSON.stringify(s),geometries:JSON.stringify((o=t,{geometryType:Object(d.c)(o[0]),geometries:o.map((e=>e.toJSON()))}))}};var o;return function(e,t,r){const n=Object(d.b)(t);return e.map((e=>{const t=n.fromJSON(e);return t.spatialReference=r,t}))}((await Object(p.default)(n.path+"/simplify",a)).data,i,s)}(i,n,r),c=[];for(let e=0;e<a.length;e++){const t=a[e];"simplify"!==t?c.push(t):c.push(_?Object(u.b)(o.shift()):o.shift())}return c}const P=[];for(let e=0;e<F.length;e++){const t=F[e];if("cut"!==t)P.push(t);else{const e=T.shift();P.push(!0===_?Object(u.b)(e):e)}}return Promise.resolve(P)}function _(e,t){const r=Object(o.d)(t);if(r){const[t,n]=r.valid,s=n-t;if(e<t)for(;e<t;)e+=s;if(e>n)for(;e>n;)e-=s}return e}},217:function(e,t,r){"use strict";r.d(t,"a",(function(){return y})),r.d(t,"b",(function(){return s})),r.d(t,"c",(function(){return d})),r.d(t,"d",(function(){return g})),r.d(t,"e",(function(){return a})),r.d(t,"f",(function(){return u})),r.d(t,"g",(function(){return o})),r.d(t,"h",(function(){return p})),r.d(t,"i",(function(){return i})),r.d(t,"j",(function(){return f})),r.d(t,"k",(function(){return h})),r.d(t,"l",(function(){return l})),r.d(t,"m",(function(){return c}));var n=r(0);function s(e=v){return[e[0],e[1],e[2],e[3],e[4],e[5]]}function i(e,t,r,n,i,a,o=s()){return o[0]=e,o[1]=t,o[2]=r,o[3]=n,o[4]=i,o[5]=a,o}function a(e,t){e[0]=Math.min(e[0],t[0]),e[1]=Math.min(e[1],t[1]),e[2]=Math.min(e[2],t[2]),e[3]=Math.max(e[3],t[3]),e[4]=Math.max(e[4],t[4]),e[5]=Math.max(e[5],t[5])}function o(e,t){e[0]=Math.min(e[0],t[0]),e[1]=Math.min(e[1],t[1]),e[2]=Math.min(e[2],t[2]),e[3]=Math.max(e[3],t[0]),e[4]=Math.max(e[4],t[1]),e[5]=Math.max(e[5],t[2])}function u(e,t,r){const n=t.length;let s=e[0],i=e[1],a=e[2],o=e[3],u=e[4],c=e[5];if(r)for(let e=0;e<n;e++){const r=t[e];s=Math.min(s,r[0]),i=Math.min(i,r[1]),a=Math.min(a,r[2]),o=Math.max(o,r[0]),u=Math.max(u,r[1]),c=Math.max(c,r[2])}else for(let e=0;e<n;e++){const r=t[e];s=Math.min(s,r[0]),i=Math.min(i,r[1]),o=Math.max(o,r[0]),u=Math.max(u,r[1])}e[0]=s,e[1]=i,e[2]=a,e[3]=o,e[4]=u,e[5]=c}function c(e,t=[0,0,0]){return t[0]=function(e){return e[0]>=e[3]?0:e[3]-e[0]}(e),t[1]=function(e){return e[1]>=e[4]?0:e[4]-e[1]}(e),t[2]=function(e){return e[2]>=e[5]?0:e[5]-e[2]}(e),t}function l(e,t,r=e){return r[0]=t[0],r[1]=t[1],r[2]=t[2],r!==e&&(r[3]=e[3],r[4]=e[4],r[5]=e[5]),r}function h(e,t,r=e){return r[3]=t[0],r[4]=t[1],r[5]=t[2],r!==e&&(r[0]=e[0],r[1]=e[1],r[2]=e[2]),e}function f(e,t){return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e[4]=t[4],e[5]=t[5],e}function d(e){return e?f(e,y):s(y)}function p(e,t){return e[0]=t[0],e[1]=t[1],e[2]=Number.NEGATIVE_INFINITY,e[3]=t[2],e[4]=t[3],e[5]=Number.POSITIVE_INFINITY,e}function m(e){return 6===e.length}function g(e,t,r){if(Object(n.g)(e)||Object(n.g)(t))return e===t;if(!m(e)||!m(t))return!1;if(r){for(let n=0;n<e.length;n++)if(!r(e[n],t[n]))return!1}else for(let r=0;r<e.length;r++)if(e[r]!==t[r])return!1;return!0}r(60),r(145);const y=[1/0,1/0,1/0,-1/0,-1/0,-1/0],v=[0,0,0,0,0,0];s()},263:function(e,t,r){"use strict";class n{constructor(){this.objectIdFieldName=null,this.globalIdFieldName=null,this.geohashFieldName=null,this.geometryProperties=null,this.geometryType=null,this.spatialReference=null,this.hasZ=!1,this.hasM=!1,this.features=[],this.fields=[],this.transform=null,this.exceededTransferLimit=!1,this.uniqueIdField=null,this.queryGeometryType=null,this.queryGeometry=null}weakClone(){const e=new n;return e.objectIdFieldName=this.objectIdFieldName,e.globalIdFieldName=this.globalIdFieldName,e.geohashFieldName=this.geohashFieldName,e.geometryProperties=this.geometryProperties,e.geometryType=this.geometryType,e.spatialReference=this.spatialReference,e.hasZ=this.hasZ,e.hasM=this.hasM,e.features=this.features,e.fields=this.fields,e.transform=this.transform,e.exceededTransferLimit=this.exceededTransferLimit,e.uniqueIdField=this.uniqueIdField,e.queryGeometry=this.queryGeometry,e.queryGeometryType=this.queryGeometryType,e}}t.a=n},264:function(e,t,r){"use strict";r.d(t,"a",(function(){return s})),r.d(t,"b",(function(){return i}));var n=r(20);class s{constructor(e,t,r){this._namespace=e,this._storage=t,this._removeFunc=!1,this._hit=0,this._miss=0,this._storage.register(this),this._namespace+=":",r&&(this._storage.registerRemoveFunc(this._namespace,r),this._removeFunc=!0)}get namespace(){return this._namespace.slice(0,-1)}get hitRate(){return this._hit/(this._hit+this._miss)}get size(){return this._storage.size}get maxSize(){return this._storage.maxSize}resetHitRate(){this._hit=this._miss=0}destroy(){this._storage.clear(this._namespace),this._removeFunc&&this._storage.deregisterRemoveFunc(this._namespace),this._storage.deregister(this)}put(e,t,r,n=0){this._storage.put(this._namespace+e,t,r,n)}get(e){const t=this._storage.get(this._namespace+e);return void 0===t?++this._miss:++this._hit,t}pop(e){const t=this._storage.pop(this._namespace+e);return void 0===t?++this._miss:++this._hit,t}updateSize(e,t,r){this._storage.updateSize(this._namespace+e,t,r)}clear(){this._storage.clear(this._namespace)}clearAll(){this._storage.clearAll()}getStats(){return this._storage.getStats()}resetStats(){this._storage.resetStats()}}class i{constructor(e=10485760){this._maxSize=e,this._db=new Map,this._size=0,this._hit=0,this._miss=0,this._removeFuncs=[],this._users=new n.a}register(e){this._users.push(e)}deregister(e){this._users.removeUnordered(e)}registerRemoveFunc(e,t){this._removeFuncs.push([e,t])}deregisterRemoveFunc(e){this._removeFuncs=this._removeFuncs.filter((t=>t[0]!==e))}get size(){return this._size}get maxSize(){return this._maxSize}set maxSize(e){this._maxSize=Math.max(e,0),this._checkSizeLimit()}put(e,t,r,n){const s=this._db.get(e);if(s&&(this._size-=s.size,this._db.delete(e),s.entry!==t&&this._notifyRemoved(e,s.entry)),r>this._maxSize)return void this._notifyRemoved(e,t);if(void 0===t)return void console.warn("Refusing to cache undefined entry ");if(!r||r<0)return void console.warn("Refusing to cache entry with invalid size "+r);const i=1+Math.max(n,-3)- -3;this._db.set(e,{entry:t,size:r,lifetime:i,lives:i}),this._size+=r,this._checkSizeLimit()}updateSize(e,t,r){const n=this._db.get(e);if(n&&n.entry===t){if(this._size-=n.size,r>this._maxSize)return this._db.delete(e),void this._notifyRemoved(e,t);n.size=r,this._size+=r,this._checkSizeLimit()}}pop(e){const t=this._db.get(e);if(t)return this._size-=t.size,this._db.delete(e),++this._hit,t.entry;++this._miss}get(e){const t=this._db.get(e);if(void 0!==t)return this._db.delete(e),t.lives=t.lifetime,this._db.set(e,t),++this._hit,t.entry;++this._miss}getStats(){const e={Size:Math.round(this._size/1048576)+"/"+Math.round(this._maxSize/1048576)+"MB","Hit rate":Math.round(100*this._getHitRate())+"%",Entries:this._db.size.toString()},t={},r=new Array;this._db.forEach(((e,n)=>{const s=e.lifetime;r[s]=(r[s]||0)+e.size,this._users.forAll((r=>{const s=r.namespace;if(n.startsWith(s)){const r=t[s]||0;t[s]=r+e.size}}))}));const n={};this._users.forAll((e=>{const r=e.namespace;if(!isNaN(e.hitRate)&&e.hitRate>0){const s=t[r]||0;t[r]=s,n[r]=Math.round(100*e.hitRate)+"%"}else n[r]="0%"}));const s=Object.keys(t);s.forEach((e=>t[e]=t[e]/this._size*100)),s.sort(((e,r)=>t[r]-t[e])),s.forEach((r=>e[r]=Math.round(t[r])+"% / "+n[r]));for(let t=r.length-1;t>=0;--t){const n=r[t];n&&(e["Priority "+(t+-3-1)]=Math.round(n/this.size*100)+"%")}return e}resetStats(){this._hit=this._miss=0,this._users.forAll((e=>e.resetHitRate()))}clear(e){this._db.forEach(((t,r)=>{r.startsWith(e)&&(this._size-=t.size,this._db.delete(r),this._notifyRemoved(r,t.entry))}))}clearAll(){this._db.forEach(((e,t)=>this._notifyRemoved(t,e.entry))),this._size=0,this._db.clear()}_getHitRate(){return this._hit/(this._hit+this._miss)}_notifyRemoved(e,t){this._removeFuncs.forEach((r=>{e.startsWith(r[0])&&r[1](t)}))}_checkSizeLimit(){if(!(this._size<=this._maxSize))for(const[e,t]of this._db)if(this._db.delete(e),t.lives<=1?(this._size-=t.size,this._notifyRemoved(e,t.entry)):(--t.lives,this._db.set(e,t)),this._size<=.9*this.maxSize)return}}},298:function(e,t,r){"use strict";r.d(t,"a",(function(){return s}));var n=r(450);function s(e,t){if(!(this instanceof s))return new s(e,t);this._maxEntries=Math.max(4,e||9),this._minEntries=Math.max(2,Math.ceil(.4*this._maxEntries)),t&&("function"==typeof t?this.toBBox=t:this._initFormat(t)),this.clear()}function i(e,t,r){if(!r)return t.indexOf(e);for(var n=0;n<t.length;n++)if(r(e,t[n]))return n;return-1}function a(e,t){o(e,0,e.children.length,t,e)}function o(e,t,r,n,s){s||(s=y(null)),s.minX=1/0,s.minY=1/0,s.maxX=-1/0,s.maxY=-1/0;for(var i,a=t;a<r;a++)i=e.children[a],u(s,e.leaf?n(i):i);return s}function u(e,t){return e.minX=Math.min(e.minX,t.minX),e.minY=Math.min(e.minY,t.minY),e.maxX=Math.max(e.maxX,t.maxX),e.maxY=Math.max(e.maxY,t.maxY),e}function c(e,t){return e.minX-t.minX}function l(e,t){return e.minY-t.minY}function h(e){return(e.maxX-e.minX)*(e.maxY-e.minY)}function f(e){return e.maxX-e.minX+(e.maxY-e.minY)}function d(e,t){return(Math.max(t.maxX,e.maxX)-Math.min(t.minX,e.minX))*(Math.max(t.maxY,e.maxY)-Math.min(t.minY,e.minY))}function p(e,t){var r=Math.max(e.minX,t.minX),n=Math.max(e.minY,t.minY),s=Math.min(e.maxX,t.maxX),i=Math.min(e.maxY,t.maxY);return Math.max(0,s-r)*Math.max(0,i-n)}function m(e,t){return e.minX<=t.minX&&e.minY<=t.minY&&t.maxX<=e.maxX&&t.maxY<=e.maxY}function g(e,t){return t.minX<=e.maxX&&t.minY<=e.maxY&&t.maxX>=e.minX&&t.maxY>=e.minY}function y(e){return{children:e,height:1,leaf:!0,minX:1/0,minY:1/0,maxX:-1/0,maxY:-1/0}}function v(e,t,r,s,i){for(var a,o=[t,r];o.length;)(r=o.pop())-(t=o.pop())<=s||(a=t+Math.ceil((r-t)/s/2)*s,Object(n.a)(e,a,t,r,i),o.push(t,a,a,r))}s.prototype={all:function(){return this._all(this.data,[])},search:function(e){var t=this.data,r=[],n=this.toBBox;if(!g(e,t))return r;for(var s,i,a,o,u=[];t;){for(s=0,i=t.children.length;s<i;s++)a=t.children[s],g(e,o=t.leaf?n(a):a)&&(t.leaf?r.push(a):m(e,o)?this._all(a,r):u.push(a));t=u.pop()}return r},collides:function(e){var t=this.data,r=this.toBBox;if(!g(e,t))return!1;for(var n,s,i,a,o=[];t;){for(n=0,s=t.children.length;n<s;n++)if(i=t.children[n],g(e,a=t.leaf?r(i):i)){if(t.leaf||m(e,a))return!0;o.push(i)}t=o.pop()}return!1},load:function(e){if(!e||!e.length)return this;if(e.length<this._minEntries){for(var t=0,r=e.length;t<r;t++)this.insert(e[t]);return this}var n=this._build(e.slice(),0,e.length-1,0);if(this.data.children.length)if(this.data.height===n.height)this._splitRoot(this.data,n);else{if(this.data.height<n.height){var s=this.data;this.data=n,n=s}this._insert(n,this.data.height-n.height-1,!0)}else this.data=n;return this},insert:function(e){return e&&this._insert(e,this.data.height-1),this},clear:function(){return this.data=y([]),this},remove:function(e,t){if(!e)return this;for(var r,n,s,a,o=this.data,u=this.toBBox(e),c=[],l=[];o||c.length;){if(o||(o=c.pop(),n=c[c.length-1],r=l.pop(),a=!0),o.leaf&&-1!==(s=i(e,o.children,t)))return o.children.splice(s,1),c.push(o),this._condense(c),this;a||o.leaf||!m(o,u)?n?(r++,o=n.children[r],a=!1):o=null:(c.push(o),l.push(r),r=0,n=o,o=o.children[0])}return this},toBBox:function(e){return e},compareMinX:c,compareMinY:l,toJSON:function(){return this.data},fromJSON:function(e){return this.data=e,this},_all:function(e,t){for(var r=[];e;)e.leaf?t.push.apply(t,e.children):r.push.apply(r,e.children),e=r.pop();return t},_build:function(e,t,r,n){var s,i=r-t+1,o=this._maxEntries;if(i<=o)return a(s=y(e.slice(t,r+1)),this.toBBox),s;n||(n=Math.ceil(Math.log(i)/Math.log(o)),o=Math.ceil(i/Math.pow(o,n-1))),(s=y([])).leaf=!1,s.height=n;var u,c,l,h,f=Math.ceil(i/o),d=f*Math.ceil(Math.sqrt(o));for(v(e,t,r,d,this.compareMinX),u=t;u<=r;u+=d)for(v(e,u,l=Math.min(u+d-1,r),f,this.compareMinY),c=u;c<=l;c+=f)h=Math.min(c+f-1,l),s.children.push(this._build(e,c,h,n-1));return a(s,this.toBBox),s},_chooseSubtree:function(e,t,r,n){for(var s,i,a,o,u,c,l,f;n.push(t),!t.leaf&&n.length-1!==r;){for(l=f=1/0,s=0,i=t.children.length;s<i;s++)u=h(a=t.children[s]),(c=d(e,a)-u)<f?(f=c,l=u<l?u:l,o=a):c===f&&u<l&&(l=u,o=a);t=o||t.children[0]}return t},_insert:function(e,t,r){var n=this.toBBox,s=r?e:n(e),i=[],a=this._chooseSubtree(s,this.data,t,i);for(a.children.push(e),u(a,s);t>=0&&i[t].children.length>this._maxEntries;)this._split(i,t),t--;this._adjustParentBBoxes(s,i,t)},_split:function(e,t){var r=e[t],n=r.children.length,s=this._minEntries;this._chooseSplitAxis(r,s,n);var i=this._chooseSplitIndex(r,s,n),o=y(r.children.splice(i,r.children.length-i));o.height=r.height,o.leaf=r.leaf,a(r,this.toBBox),a(o,this.toBBox),t?e[t-1].children.push(o):this._splitRoot(r,o)},_splitRoot:function(e,t){this.data=y([e,t]),this.data.height=e.height+1,this.data.leaf=!1,a(this.data,this.toBBox)},_chooseSplitIndex:function(e,t,r){var n,s,i,a,u,c,l,f;for(c=l=1/0,n=t;n<=r-t;n++)a=p(s=o(e,0,n,this.toBBox),i=o(e,n,r,this.toBBox)),u=h(s)+h(i),a<c?(c=a,f=n,l=u<l?u:l):a===c&&u<l&&(l=u,f=n);return f},_chooseSplitAxis:function(e,t,r){var n=e.leaf?this.compareMinX:c,s=e.leaf?this.compareMinY:l;this._allDistMargin(e,t,r,n)<this._allDistMargin(e,t,r,s)&&e.children.sort(n)},_allDistMargin:function(e,t,r,n){e.children.sort(n);var s,i,a=this.toBBox,c=o(e,0,t,a),l=o(e,r-t,r,a),h=f(c)+f(l);for(s=t;s<r-t;s++)i=e.children[s],u(c,e.leaf?a(i):i),h+=f(c);for(s=r-t-1;s>=t;s--)i=e.children[s],u(l,e.leaf?a(i):i),h+=f(l);return h},_adjustParentBBoxes:function(e,t,r){for(var n=r;n>=0;n--)u(t[n],e)},_condense:function(e){for(var t,r=e.length-1;r>=0;r--)0===e[r].children.length?r>0?(t=e[r-1].children).splice(t.indexOf(e[r]),1):this.clear():a(e[r],this.toBBox)},_initFormat:function(e){var t=["return a"," - b",";"];this.compareMinX=new Function("a","b",t.join(e[0])),this.compareMinY=new Function("a","b",t.join(e[1])),this.toBBox=new Function("a","return {minX: a"+e[0]+", minY: a"+e[1]+", maxX: a"+e[2]+", maxY: a"+e[3]+"};")}}},299:function(e,t,r){"use strict";function n(e,t){return e?t?4:3:t?3:2}function s(e,t,r,s,o){if(!t||!t.lengths.length)return null;const u="upperLeft"===(null==o?void 0:o.originPosition)?-1:1;e.lengths.length&&(e.lengths.length=0),e.coords.length&&(e.coords.length=0);const c=e.coords,l=[],h=r?[Number.POSITIVE_INFINITY,Number.NEGATIVE_INFINITY,Number.POSITIVE_INFINITY,Number.NEGATIVE_INFINITY,Number.POSITIVE_INFINITY,Number.NEGATIVE_INFINITY]:[Number.POSITIVE_INFINITY,Number.NEGATIVE_INFINITY,Number.POSITIVE_INFINITY,Number.NEGATIVE_INFINITY],{lengths:f,coords:d}=t,p=n(r,s);let m=0;for(const e of f){const t=i(h,d,m,e,r,s,u);t&&l.push(t),m+=e*p}if(l.sort(((e,t)=>{let n=u*e[2]-u*t[2];return 0===n&&r&&(n=e[4]-t[4]),n})),l.length){let e=6*l[0][2];c[0]=l[0][0]/e,c[1]=l[0][1]/e,r&&(e=6*l[0][4],c[2]=0!==e?l[0][3]/e:0),(c[0]<h[0]||c[0]>h[1]||c[1]<h[2]||c[1]>h[3]||r&&(c[2]<h[4]||c[2]>h[5]))&&(c.length=0)}if(!c.length){const e=t.lengths[0]?a(d,0,f[0],r,s):null;if(!e)return null;c[0]=e[0],c[1]=e[1],r&&e.length>2&&(c[2]=e[2])}return e}function i(e,t,r,s,i,a,o=1){const u=n(i,a);let c=r,l=r+u,h=0,f=0,d=0,p=0,m=0;for(let r=0,n=s-1;r<n;r++,c+=u,l+=u){const r=t[c],n=t[c+1],s=t[c+2],a=t[l],o=t[l+1],u=t[l+2];let g=r*o-a*n;p+=g,h+=(r+a)*g,f+=(n+o)*g,i&&(g=r*u-a*s,d+=(s+u)*g,m+=g),r<e[0]&&(e[0]=r),r>e[1]&&(e[1]=r),n<e[2]&&(e[2]=n),n>e[3]&&(e[3]=n),i&&(s<e[4]&&(e[4]=s),s>e[5]&&(e[5]=s))}if(p*o>0&&(p*=-1),m*o>0&&(m*=-1),!p)return null;const g=[h,f,.5*p];return i&&(g[3]=d,g[4]=.5*m),g}function a(e,t,r,s,i){const a=n(s,i);let h=t,f=t+a,d=0,p=0,m=0,g=0;for(let t=0,n=r-1;t<n;t++,h+=a,f+=a){const t=e[h],r=e[h+1],n=e[h+2],i=e[f],a=e[f+1],y=e[f+2],v=s?u(t,r,n,i,a,y):o(t,r,i,a);if(v)if(d+=v,s){const e=l(t,r,n,i,a,y);p+=v*e[0],m+=v*e[1],g+=v*e[2]}else{const e=c(t,r,i,a);p+=v*e[0],m+=v*e[1]}}return d>0?s?[p/d,m/d,g/d]:[p/d,m/d]:r>0?s?[e[t],e[t+1],e[t+2]]:[e[t],e[t+1]]:null}function o(e,t,r,n){const s=r-e,i=n-t;return Math.sqrt(s*s+i*i)}function u(e,t,r,n,s,i){const a=n-e,o=s-t,u=i-r;return Math.sqrt(a*a+o*o+u*u)}function c(e,t,r,n){return[e+.5*(r-e),t+.5*(n-t)]}function l(e,t,r,n,s,i){return[e+.5*(n-e),t+.5*(s-t),r+.5*(i-r)]}r.d(t,"a",(function(){return s}))},300:function(e,t,r){"use strict";r.d(t,"a",(function(){return h})),r.d(t,"b",(function(){return p})),r.d(t,"c",(function(){return g}));var n=r(93),s=r(165),i=r(316),a=r(322);const o=[0,0];function u(e,t){if(!t)return null;if("x"in t){const r={x:0,y:0};return[r.x,r.y]=e(t.x,t.y,o),null!=t.z&&(r.z=t.z),null!=t.m&&(r.m=t.m),r}if("xmin"in t){const r={xmin:0,ymin:0,xmax:0,ymax:0};return[r.xmin,r.ymin]=e(t.xmin,t.ymin,o),[r.xmax,r.ymax]=e(t.xmax,t.ymax,o),t.hasZ&&(r.zmin=t.zmin,r.zmax=t.zmax,r.hasZ=!0),t.hasM&&(r.mmin=t.mmin,r.mmax=t.mmax,r.hasM=!0),r}return"rings"in t?{rings:c(t.rings,e),hasM:t.hasM,hasZ:t.hasZ}:"paths"in t?{paths:c(t.paths,e),hasM:t.hasM,hasZ:t.hasZ}:"points"in t?{points:l(t.points,e),hasM:t.hasM,hasZ:t.hasZ}:void 0}function c(e,t){const r=[];for(const n of e)r.push(l(n,t));return r}function l(e,t){const r=[];for(const n of e){const e=t(n[0],n[1],[0,0]);r.push(e),n.length>2&&e.push(n[2]),n.length>3&&e.push(n[3])}return r}async function h(e,t){if(!t)return;const r=Array.isArray(e)?e.map((e=>{var t;return null==(t=e.geometry)?void 0:t.spatialReference})):[e];await Object(i.c)(r.map((e=>({source:e,dest:t}))))}const f=u.bind(null,s.c),d=u.bind(null,s.f);function p(e,t,r){return e?(r||(r=t,t=e.spatialReference),Object(n.i)(t)&&Object(n.i)(r)&&!Object(n.c)(t,r)?Object(s.a)(t,r)?Object(n.m)(r)?f(e):d(e):Object(i.i)(a.a,[e],t,r,null)[0]:e):e}const m=new class{constructor(){this._jobs=[],this._timer=null,this._process=this._process.bind(this)}async push(e,t,r){!e||!e.length||!t||!r||Object(n.c)(t,r);const s={geometries:e,inSpatialReference:t,outSpatialReference:r,resolve:null};return this._jobs.push(s),new Promise((e=>{s.resolve=e,null===this._timer&&(this._timer=setTimeout(this._process,10))}))}_process(){this._timer=null;const e=this._jobs.shift();if(!e)return;const{geometries:t,inSpatialReference:r,outSpatialReference:o,resolve:u}=e;Object(s.a)(r,o)?Object(n.m)(o)?u(t.map(f)):u(t.map(d)):u(Object(i.i)(a.a,t,r,o,null)),this._jobs.length>0&&(this._timer=setTimeout(this._process,10))}};async function g(e,t,r){return m.push(e,t,r)}},322:function(e,t,r){"use strict";r.d(t,"a",(function(){return n}));const n={convertToGEGeometry:function(e,t){return null==t?null:e.convertJSONToGeometry(t)},exportPoint:function(e,t,r){const n=new s(e.getPointX(t),e.getPointY(t),r),i=e.hasZ(t),a=e.hasM(t);return i&&(n.z=e.getPointZ(t)),a&&(n.m=e.getPointM(t)),n},exportPolygon:function(e,t,r){return new i(e.exportPaths(t),r,e.hasZ(t),e.hasM(t))},exportPolyline:function(e,t,r){return new a(e.exportPaths(t),r,e.hasZ(t),e.hasM(t))},exportMultipoint:function(e,t,r){return new o(e.exportPoints(t),r,e.hasZ(t),e.hasM(t))},exportExtent:function(e,t,r){const n=e.hasZ(t),s=e.hasM(t),i=new u(e.getXMin(t),e.getYMin(t),e.getXMax(t),e.getYMax(t),r);if(n){const r=e.getZExtent(t);i.zmin=r.vmin,i.zmax=r.vmax}if(s){const r=e.getMExtent(t);i.mmin=r.vmin,i.mmax=r.vmax}return i}};class s{constructor(e,t,r){this.x=e,this.y=t,this.spatialReference=r,this.z=void 0,this.m=void 0}}class i{constructor(e,t,r,n){this.rings=e,this.spatialReference=t,this.hasZ=void 0,this.hasM=void 0,r&&(this.hasZ=r),n&&(this.hasM=n)}}class a{constructor(e,t,r,n){this.paths=e,this.spatialReference=t,this.hasZ=void 0,this.hasM=void 0,r&&(this.hasZ=r),n&&(this.hasM=n)}}class o{constructor(e,t,r,n){this.points=e,this.spatialReference=t,this.hasZ=void 0,this.hasM=void 0,r&&(this.hasZ=r),n&&(this.hasM=n)}}class u{constructor(e,t,r,n,s){this.xmin=e,this.ymin=t,this.xmax=r,this.ymax=n,this.spatialReference=s,this.zmin=void 0,this.zmax=void 0,this.mmin=void 0,this.mmax=void 0}}},389:function(e,t,r){"use strict";var n=r(6),s=r(0),i=r(16),a=r(93),o=r(261),u=r(63),c=r(69),l=r(216),h=r(264),f=r(145),d=r(217),p=r(47),m=r(136),g=r(502),y=r(409),v=r(175);const b=new class{constructor(e,t){this._cache=new y.a(e),this._invalidCache=new y.a(t)}get(e,t){const r=`${t.uid}:${e}`,n=this._cache.get(r);if(n)return n;if(void 0!==this._invalidCache.get(r))return null;try{const n=v.WhereClause.create(e,t);return this._cache.put(r,n),n}catch{return this._invalidCache.put(r,null),null}}}(50,500),x="feature-store:unsupported-query",_=new Set(["esriFieldTypeOID","esriFieldTypeSmallInteger","esriFieldTypeInteger","esriFieldTypeSingle","esriFieldTypeDouble","esriFieldTypeLong","esriFieldTypeDate"]);function w(e,t){return e?b.get(e,t):null}function I(e,t,r,n=!0){const s=[];for(const r of t)if("*"!==r&&!e.has(r))if(n){const t=S(r);try{const r=w(t,e);if(!r)throw new i.a(x,"invalid SQL expression",{where:t});if(!r.isStandardized)throw new i.a(x,"expression is not standard",{clause:r});I(e,r.fieldNames,"expression contains missing fields")}catch(e){const t=e&&e.details;if(t&&(t.clause||t.where))throw e;t&&t.missingFields?s.push(...t.missingFields):s.push(r)}}else s.push(r);if(s.length)throw new i.a(x,r,{missingFields:s})}function S(e){return e.split(" as ")[0]}function N(e,t){const r=t.get(e);return!!r&&!_.has(r.type)}var M=r(300),O=r(451),T=r(495),F=r(410),R=r(137),A=class{constructor(e,t,r){this._fieldDataCache=new Map,this._returnDistinctMap=new Map,this.returnDistinctValues=e.returnDistinctValues,this.fieldsIndex=r,this.featureAdapter=t;const n=e.outFields;if(n&&-1===n.indexOf("*")){this.outFields=n;let e=0;for(const t of n){const n=S(t),s=this.fieldsIndex.get(n),i=s?null:w(n,r),a=s?s.name:t.split(" as ")[1]||"FIELD_EXP_"+e++;this._fieldDataCache.set(t,{alias:a,clause:i})}}}countDistinctValues(e){return this.returnDistinctValues?(e.forEach((e=>this.getAttributes(e))),this._returnDistinctMap.size):e.length}getAttributes(e){const t=this._processAttributesForOutFields(e);return this._processAttributesForDistinctValues(t)}getFieldValue(e,t,r){const n=r?r.name:t;let s=null;return this._fieldDataCache.has(n)?s=this._fieldDataCache.get(n).clause:r||(s=w(t,this.fieldsIndex),this._fieldDataCache.set(n,{alias:n,clause:s})),r?this.featureAdapter.getAttribute(e,n):s.calculateValue(e,this.featureAdapter)}validateItem(e,t){return this._fieldDataCache.has(t)||this._fieldDataCache.set(t,{alias:t,clause:w(t,this.fieldsIndex)}),this._fieldDataCache.get(t).clause.testFeature(e,this.featureAdapter)}validateItems(e,t){return this._fieldDataCache.has(t)||this._fieldDataCache.set(t,{alias:t,clause:w(t,this.fieldsIndex)}),this._fieldDataCache.get(t).clause.testSet(e,this.featureAdapter)}_processAttributesForOutFields(e){const t=this.outFields;if(!t||!t.length)return this.featureAdapter.getAttributes(e);const r={};for(const n of t){const{alias:t,clause:s}=this._fieldDataCache.get(n);r[t]=s?s.calculateValue(e,this.featureAdapter):this.featureAdapter.getAttribute(e,t)}return r}_processAttributesForDistinctValues(e){if(Object(s.g)(e)||!this.returnDistinctValues)return e;const t=this.outFields,r=[];if(t)for(const n of t){const{alias:t}=this._fieldDataCache.get(n);r.push(e[t])}else for(const t in e)r.push(e[t]);const n=`${(t||["*"]).join(",")}=${r.join(",")}`;let i=this._returnDistinctMap.get(n)||0;return this._returnDistinctMap.set(n,++i),i>1?null:e}};function j(e){return e.substr(24,12)+e.substr(19,4)+e.substr(16,2)+e.substr(14,2)+e.substr(11,2)+e.substr(9,2)+e.substr(6,2)+e.substr(4,2)+e.substr(2,2)+e.substr(0,2)}function E(e,t,r){return(r?e>t:e<t)?-1:(r?e<t:e>t)?1:0}function P(e,t,r){return r?t-e:e-t}function C(e,t,r,n){if(r&&"esriFieldTypeDate"===r.type){const r=new Date(e).getTime(),s=new Date(t).getTime();if(!isNaN(r)&&!isNaN(s))return P(r,s,n)}if("number"==typeof e&&"number"==typeof t)return P(e,t,n);if("string"==typeof e&&"string"==typeof t){const s=e.toUpperCase(),i=t.toUpperCase();return!r||"esriFieldTypeGUID"!==r.type&&"esriFieldTypeGlobalID"!==r.type?E(s,i,n):E(j(s),j(i),n)}return n?1:-1}class G{constructor(e,t,r){this.items=e,this.queryGeometry=t,this.definitionExpression=r.definitionExpression,this.geometryType=r.geometryType,this.hasM=r.hasM,this.hasZ=r.hasZ,this.objectIdField=r.objectIdField,this.spatialReference=r.spatialReference,this.fieldsIndex=r.fieldsIndex,this.timeInfo=r.timeInfo,this.featureAdapter=r.featureAdapter,this.aggregateAdapter=r.aggregateAdapter}get size(){return this.items.length}createQueryResponseForCount(e){const t=new A(e,this.featureAdapter,this.fieldsIndex);if(!e.outStatistics)return t.countDistinctValues(this.items);const{groupByFieldsForStatistics:r,having:n}=e;if(!(null==r?void 0:r.length))return 1;const s=new Map,i=new Map,a=new Set,o=e.outStatistics;for(const e of o){const{statisticType:o}=e,u="exceedslimit"!==o?e.onStatisticField:void 0;if(!i.has(u)){const e=[];for(const n of r){const r=this._getAttributeValues(t,n,s);e.push(r)}i.set(u,this._calculateUniqueValues(e))}const c=i.get(u);for(const e in c){const{data:r,items:s}=c[e],i=r.join(",");n&&!t.validateItems(s,n)||a.add(i)}}return a.size}createQueryResponse(e){let t;return t=e.outStatistics?e.outStatistics.some((e=>"exceedslimit"===e.statisticType))?this._createExceedsLimitQueryResponse(e):this._createStatisticsQueryResponse(e):this._createFeatureQueryResponse(e),e.returnQueryGeometry&&(Object(a.i)(e.outSR)&&!Object(a.c)(this.queryGeometry.spatialReference,e.outSR)?t.queryGeometry=Object(T.d)({spatialReference:e.outSR,...Object(M.b)(this.queryGeometry,this.queryGeometry.spatialReference,e.outSR)}):t.queryGeometry=Object(T.d)({spatialReference:e.outSR,...this.queryGeometry})),t}createSnappingResponse(e,t){const r=this.featureAdapter,n=function(e,t){return e?t?4:3:t?3:2}(this.hasZ,this.hasM),{x:s,y:i}=e.point,a="number"==typeof e.distance?e.distance:e.distance.x,o="number"==typeof e.distance?e.distance:e.distance.y,u={candidates:[]},c="esriGeometryPolygon"===this.geometryType,l=this.getPointCreator(e.point,this.spatialReference,t);for(const t of this.items){const h=r.getGeometry(t);if(!h)continue;const{coords:f,lengths:d}=h;if(1&e.types){let e=0;for(let c=0;c<d.length;c++){const h=d[c];for(let c=0;c<h;c++,e+=n){const d=f[e],p=f[e+1];if(c!==h-1){const c=f[e+n],h=f[e+n+1],{x:m,y:g}=z(s,i,d,p,c,h),y=(s-m)/a,v=(i-g)/o,b=y*y+v*v;b<=1&&u.candidates.push({type:"edge",objectId:r.getObjectId(t),distance:Math.sqrt(b),target:l(m,g),start:l(d,p),end:l(c,h)})}}}}if(2&e.types){const e=c?f.length-n:f.length;for(let c=0;c<e;c+=n){const e=f[c],n=f[c+1],h=(s-e)/a,d=(i-n)/o,p=h*h+d*d;p<=1&&u.candidates.push({type:"vertex",objectId:r.getObjectId(t),distance:Math.sqrt(p),target:l(e,n)})}}}return u.candidates.sort(((e,t)=>e.distance-t.distance)),u}getPointCreator(e,t,r){const n=Object(s.h)(r)&&!Object(a.c)(t,r)?e=>Object(M.b)(e,t,r):e=>e;return null!=e.z&&null!=e.m?(t,r)=>n({x:t,y:r,z:e.z,m:e.m}):null!=e.z?(t,r)=>n({x:t,y:r,z:e.z}):null!=e.m?(t,r)=>n({x:t,y:r,m:e.m}):(e,t)=>n({x:e,y:t})}executeAttributesQuery(e){const t=w(e.where,this.fieldsIndex);if(!t)return Promise.resolve(this);if(t.isStandardized){let r=0;const n=[];for(const e of this.items)t.testFeature(e,this.featureAdapter)&&(n[r++]=e);const s=new G(n,this.queryGeometry,this);return s.definitionExpression=e.where,Promise.resolve(s)}return Promise.reject(new TypeError("Where clause is not standardized"))}executeAggregateIdsQuery(e){if(!e.aggregateIds||!e.aggregateIds.length||Object(s.g)(this.aggregateAdapter))return Promise.resolve(this);const t=new Set;for(const r of e.aggregateIds)this.aggregateAdapter.getFeatureObjectIds(r).forEach((e=>t.add(e)));const r=this.featureAdapter.getObjectId;return Promise.resolve(new G(this.items.filter((e=>t.has(r(e)))),this.queryGeometry,this))}executeObjectIdsQuery(e){if(!e.objectIds||!e.objectIds.length)return Promise.resolve(this);const t=new Set(e.objectIds),r=this.featureAdapter.getObjectId;return Promise.resolve(new G(this.items.filter((e=>t.has(r(e)))),this.queryGeometry,this))}executeTimeQuery(e){const t=Object(O.b)(this.timeInfo,e.timeExtent,this.featureAdapter);if(!Object(s.h)(t))return Promise.resolve(this);const r=this.items.filter(t);return Promise.resolve(new G(r,this.queryGeometry,this))}filterLatest(){const{trackIdField:e,startTimeField:t,endTimeField:r}=this.timeInfo,n=r||t,s=new Map,i=this.featureAdapter.getAttribute;for(const t of this.items){const r=i(t,e),a=i(t,n),o=s.get(r);(!o||a>i(o,n))&&s.set(r,t)}const a=Array.from(s.values());return Promise.resolve(new G(a,this.queryGeometry,this))}async project(e){if(!e||Object(a.c)(this.spatialReference,e))return this;const t=this.featureAdapter,r=(await Object(M.c)(this.items.map((e=>Object(T.e)(this.geometryType,this.hasZ,this.hasM,t.getGeometry(e)))),this.spatialReference,e)).map(((e,r)=>t.cloneWithGeometry(this.items[r],Object(R.d)(e,this.hasZ,this.hasM))));return new G(r,this.queryGeometry,{definitionExpression:this.definitionExpression,geometryType:this.geometryType,hasM:this.hasM,hasZ:this.hasZ,objectIdField:this.objectIdField,spatialReference:e,fieldsIndex:this.fieldsIndex,timeInfo:this.timeInfo,featureAdapter:this.featureAdapter})}_sortFeatures(e,t,r){if(e.length>1&&t&&t.length)for(const n of t.reverse()){const t=n.split(" "),s=t[0],i=this.fieldsIndex.get(s),a=t[1]&&"desc"===t[1].toLowerCase();e.sort(((e,t)=>C(r(e,s,i),r(t,s,i),i,a)))}}_createFeatureQueryResponse(e){const t=this.items,{geometryType:r,hasM:n,hasZ:s,objectIdField:i,spatialReference:a}=this,{outFields:o,outSR:u,quantizationParameters:c,resultRecordCount:l,resultOffset:h,returnZ:f,returnM:d}=e,p=null!=l&&t.length>(h||0)+l,m=o&&(o.indexOf("*")>-1?[...this.fieldsIndex.fields]:o.map((e=>this.fieldsIndex.get(e))));return{exceededTransferLimit:p,features:this._createFeatures(e,t),fields:m,geometryType:r,hasM:n&&d,hasZ:s&&f,objectIdFieldName:i,spatialReference:Object(T.d)(u||a),transform:c&&Object(F.a)(c)||null}}_createFeatures(e,t){const r=new A(e,this.featureAdapter,this.fieldsIndex),{hasM:n,hasZ:s}=this,{orderByFields:i,quantizationParameters:a,returnGeometry:o,returnCentroid:u,maxAllowableOffset:c,resultOffset:l,resultRecordCount:h,returnZ:f=!1,returnM:d=!1}=e,p=s&&f,m=n&&d;let g=[],y=0;const v=[...t];if(this._sortFeatures(v,i,((e,t,n)=>r.getFieldValue(e,t,n))),o||u){const e=Object(F.a)(a);if(o&&!u)for(const t of v)g[y++]={attributes:r.getAttributes(t),geometry:Object(T.e)(this.geometryType,this.hasZ,this.hasM,this.featureAdapter.getGeometry(t),c,e,p,m)};else if(!o&&u)for(const t of v)g[y++]={attributes:r.getAttributes(t),centroid:Object(T.i)(this,this.featureAdapter.getCentroid(t,this),e)};else for(const t of v)g[y++]={attributes:r.getAttributes(t),centroid:Object(T.i)(this,this.featureAdapter.getCentroid(t,this),e),geometry:Object(T.e)(this.geometryType,this.hasZ,this.hasM,this.featureAdapter.getGeometry(t),c,e,p,m)}}else for(const e of v){const t=r.getAttributes(e);t&&(g[y++]={attributes:t})}const b=l||0;if(null!=h){const e=b+h;g=g.slice(b,Math.min(g.length,e))}return g}_createExceedsLimitQueryResponse(e){let t=!1,r=Number.POSITIVE_INFINITY,n=Number.POSITIVE_INFINITY,s=Number.POSITIVE_INFINITY;for(const t of e.outStatistics)if("exceedslimit"===t.statisticType){r=null!=t.maxPointCount?t.maxPointCount:Number.POSITIVE_INFINITY,n=null!=t.maxRecordCount?t.maxRecordCount:Number.POSITIVE_INFINITY,s=null!=t.maxVertexCount?t.maxVertexCount:Number.POSITIVE_INFINITY;break}if("esriGeometryPoint"===this.geometryType)t=this.items.length>r;else if(this.items.length>n)t=!0;else{const e=this.hasZ?this.hasM?4:3:this.hasM?3:2,r=this.featureAdapter;t=this.items.reduce(((e,t)=>{const n=r.getGeometry(t);return e+(n&&n.coords.length||0)}),0)/e>s}return{fields:[{name:"exceedslimit",type:"esriFieldTypeInteger",alias:"exceedslimit",sqlType:"sqlTypeInteger",domain:null,defaultValue:null}],features:[{attributes:{exceedslimit:Number(t)}}]}}_createStatisticsQueryResponse(e){const t={attributes:{}},r=[],n=new Map,s=new Map,i=new Map,a=new Map,o=new A(e,this.featureAdapter,this.fieldsIndex),u=e.outStatistics,{groupByFieldsForStatistics:c,having:l,orderByFields:h}=e,f=c&&c.length,d=!!f,p=d&&c[0],m=d&&!this.fieldsIndex.get(p);for(const e of u){const{outStatisticFieldName:u,statisticType:h}=e,g=e,y="exceedslimit"!==h?e.onStatisticField:void 0,v="percentile_disc"===h||"percentile_cont"===h,b=d&&1===f&&(y===p||m)&&"count"===h;if(d){if(!i.has(y)){const e=[];for(const t of c){const r=this._getAttributeValues(o,t,n);e.push(r)}i.set(y,this._calculateUniqueValues(e))}const e=i.get(y);for(const t in e){const{count:r,data:s,items:i,itemPositions:h}=e[t],f=s.join(",");if(!l||o.validateItems(i,l)){const e=a.get(f)||{attributes:{}};let t=null;if(b)t=r;else{const e=this._getAttributeValues(o,y,n),r=h.map((t=>e[t]));t=v&&"statisticParameters"in g?this._getPercentileValue(g,r):this._getStatisticValue(g,r)}e.attributes[u]=t,c.forEach(((t,r)=>e.attributes[this.fieldsIndex.get(t)?t:"EXPR_"+(r+1)]=s[r])),a.set(f,e)}}}else{const e=this._getAttributeValues(o,y,n);t.attributes[u]=v&&"statisticParameters"in g?this._getPercentileValue(g,e):this._getStatisticValue(g,e,s)}r.push({name:u,alias:u,type:"esriFieldTypeDouble"})}const g=d?Array.from(a.values()):[t];return this._sortFeatures(g,h,((e,t)=>e.attributes[t])),{fields:r,features:g}}_getStatisticValue(e,t,r){const{onStatisticField:n,statisticType:s}=e,i=r&&r.has(n)?r.get(n):this._calculateStatistics(t);return r&&r.set(n,i),i["var"===s?"variance":s]}_getPercentileValue(e,t){const{onStatisticField:r,statisticParameters:n,statisticType:s}=e,{value:i,orderBy:a}=n,o="desc"===a,u=this.fieldsIndex.get(r),c=[...t].filter((e=>null!=e)).sort(((e,t)=>C(e,t,u,o)));return this._calculatePercentile(c,i,"percentile_disc"===s)}_getAttributeValues(e,t,r){if(r.has(t))return r.get(t);const n=this.fieldsIndex.get(t),s=this.items.map((r=>e.getFieldValue(r,t,n)));return r.set(t,s),s}_calculateStatistics(e){let t=Number.POSITIVE_INFINITY,r=Number.NEGATIVE_INFINITY,n=null,s=null,i=null,a=null;const o=[];let u=0;for(const s of e)"string"==typeof s?u++:null==s||isNaN(s)||(n+=s,t=Math.min(t,s),r=Math.max(r,s),o.push(s),u++);if(u){s=n/u;let e=0;for(const t of o)e+=(t-s)**2;a=u>1?e/(u-1):0,i=Math.sqrt(a)}else t=null,r=null;return{avg:s,count:u,max:r,min:t,stddev:i,sum:n,variance:a}}_calculateUniqueValues(e){const t={},r=this.items,n=r.length;for(let s=0;s<n;s++){const n=r[s],i=[];for(const t of e)i.push(t[s]);const a=i.join(",");null==t[a]?t[a]={count:1,data:i,items:[n],itemPositions:[s]}:(t[a].count++,t[a].items.push(n),t[a].itemPositions.push(s))}return t}_calculatePercentile(e,t,r){if(0===e.length)return null;if(t<=0)return e[0];if(t>=1)return e[e.length-1];const n=(e.length-1)*t,s=Math.floor(n),i=s+1,a=n%1,o=e[s],u=e[i];return i>=e.length||r||"string"==typeof o||"string"==typeof u?o:o*(1-a)+u*a}}function z(e,t,r,n,s,i){const a=s-r,o=i-n,u=a*a+o*o,c=(e-r)*a+(t-n)*o,l=Math.min(1,Math.max(0,c/u));return{x:r+a*l,y:n+o*l}}var L=G;const D="feature-store:unsupported-query",Q=new Set,k=new h.b(2e6);let q=0;const Y=Object(d.b)(),B=Object(d.b)();t.a=class{constructor(e){this.capabilities={query:g.a},this.geometryType=e.geometryType,this.hasM=e.hasM,this.hasZ=e.hasZ,this.objectIdField=e.objectIdField,this.spatialReference=e.spatialReference,this.definitionExpression=e.definitionExpression,this.featureStore=e.featureStore,this.aggregateAdapter=e.aggregateAdapter,this._changeHandle=this.featureStore.events.on("changed",(()=>this.clearCache())),this.timeInfo=e.timeInfo,e.cacheSpatialQueries&&(this._geometryQueryCache=new h.a(q+++"$$",k)),this.fieldsIndex=new m.a(e.fields),e.scheduler&&e.task&&(this._frameQueue=new p.a,this._frameTask=e.scheduler.registerTask(e.task,(e=>this._update(e)),(()=>this._frameQueue.length>0)))}destroy(){this._frameTask&&(this._frameTask.remove(),this._frameTask=null,this._frameQueue.cancelAll(),this._frameQueue=null),this.clearCache(),this._geometryQueryCache&&this._geometryQueryCache.destroy(),this._changeHandle&&(this._changeHandle.remove(),this._changeHandle=null),this.fieldsIndex.destroy()}get featureAdapter(){return this.featureStore.featureAdapter}get fullExtent(){const e=this.featureStore.fullBounds;return e?{xmin:e[0],ymin:e[1],xmax:e[2],ymax:e[3],spatialReference:Object(T.d)(this.spatialReference)}:null}get timeExtent(){return this.timeInfo?(this._timeExtent||(this._timeExtent=Object(O.a)(this.timeInfo,this.featureStore)),this._timeExtent):null}clearCache(){this._geometryQueryCache&&this._geometryQueryCache.clear(),this._allItems=null,this._timeExtent=null}async executeQuery(e={},t){let r,s=Object(n.a)(e);try{s=await this._schedule((()=>Object(T.h)(s,this.definitionExpression,this.spatialReference)),t),s=await this._reschedule((()=>this._checkQuerySupport(s)),t),r=await this._reschedule((()=>this._executeGeometryQuery(s,t)),t),r=await this._reschedule((()=>r.executeAggregateIdsQuery(s)),t),r=await this._reschedule((()=>r.executeObjectIdsQuery(s)),t),r=await this._reschedule((()=>r.executeTimeQuery(s)),t),r=await this._reschedule((()=>r.executeAttributesQuery(s)),t)}catch(e){if(e!==T.a)throw e;r=new L([],null,this)}return r.createQueryResponse(s)}async executeQueryForCount(e={},t){let r,s=Object(n.a)(e);s.returnGeometry=!1,s.returnCentroid=!1,s.outSR=null;try{s=await this._schedule((()=>Object(T.h)(s,this.definitionExpression,this.spatialReference)),t),s=await this._reschedule((()=>this._checkQuerySupport(s)),t),r=await this._reschedule((()=>this._executeGeometryQuery(s,t)),t),r=await this._reschedule((()=>r.executeAggregateIdsQuery(s)),t),r=await this._reschedule((()=>r.executeObjectIdsQuery(s)),t),r=await this._reschedule((()=>r.executeTimeQuery(s)),t),r=await this._reschedule((()=>r.executeAttributesQuery(s)),t)}catch(e){if(e!==T.a)throw e;return 0}return r.createQueryResponseForCount(s)}async executeQueryForExtent(e={},t){let r,s=Object(n.a)(e);const i=s.outSR;try{s=await this._schedule((()=>Object(T.h)(s,this.definitionExpression,this.spatialReference)),t),s=await this._reschedule((()=>this._checkQuerySupport(s)),t),s.returnGeometry=!0,s.returnCentroid=!1,s.outSR=null,r=await this._reschedule((()=>this._executeGeometryQuery(s,t)),t),r=await this._reschedule((()=>r.executeAggregateIdsQuery(s)),t),r=await this._reschedule((()=>r.executeObjectIdsQuery(s)),t),r=await this._reschedule((()=>r.executeTimeQuery(s)),t),r=await this._reschedule((()=>r.executeAttributesQuery(s)),t);const e=r.size;if(!e)return{count:e,extent:null};Object(d.j)(B,d.a),this.featureStore.forEachBounds(r.items,(e=>Object(d.e)(B,e)),Y);const n={xmin:B[0],ymin:B[1],xmax:B[3],ymax:B[4],spatialReference:Object(T.d)(this.spatialReference)};this.hasZ&&isFinite(B[2])&&isFinite(B[5])&&(n.zmin=B[2],n.zmax=B[5]);const a=Object(M.b)(n,r.spatialReference,i);if(a.spatialReference=Object(T.d)(i||this.spatialReference),a.xmax-a.xmin==0){const e=Object(c.c)(a.spatialReference);a.xmin-=e,a.xmax+=e}if(a.ymax-a.ymin==0){const e=Object(c.c)(a.spatialReference);a.ymin-=e,a.ymax+=e}if(this.hasZ&&null!=a.zmin&&null!=a.zmax&&a.zmax-a.zmin==0){const e=Object(c.c)(a.spatialReference);a.zmin-=e,a.zmax+=e}return{count:e,extent:a}}catch(e){if(e===T.a)return{count:0,extent:null};throw e}}async executeQueryForIds(e={},t){return this.executeQueryForIdSet(e,t).then((e=>Array.from(e)))}async executeQueryForIdSet(e={},t){let r,s=Object(n.a)(e);s.returnGeometry=!1,s.returnCentroid=!1,s.outSR=null;try{s=await this._schedule((()=>Object(T.h)(s,this.definitionExpression,this.spatialReference)),t),s=await this._reschedule((()=>this._checkQuerySupport(s)),t),r=await this._reschedule((()=>this._executeGeometryQuery(s,t)),t),r=await this._reschedule((()=>r.executeAggregateIdsQuery(s)),t),r=await this._reschedule((()=>r.executeObjectIdsQuery(s)),t),r=await this._reschedule((()=>r.executeTimeQuery(s)),t),r=await this._reschedule((()=>r.executeAttributesQuery(s)),t);const e=r.items,n=new Set;return await this._reschedule((()=>{for(const t of e)n.add(r.featureAdapter.getObjectId(t))}),t),n}catch(e){if(e===T.a)return new Set;throw e}}async executeQueryForSnapping(e,t){const{point:r,distance:n,types:i}=e;if(0===i)return{candidates:[]};const o=await this._reschedule((()=>this._checkQuerySupport(e.query)),t),c=!Object(a.c)(r.spatialReference,this.spatialReference);c&&await Object(M.a)(r.spatialReference,this.spatialReference);const h="number"==typeof n?n:n.x,f="number"==typeof n?n:n.y,d={xmin:r.x-h,xmax:r.x+h,ymin:r.y-f,ymax:r.y+f,spatialReference:r.spatialReference},p=c?Object(M.b)(d,this.spatialReference):d;if(!p)return{candidates:[]};const m=(await Object(l.a)(Object(u.a)(r),null,{signal:t}))[0],g=(await Object(l.a)(Object(u.a)(p),null,{signal:t}))[0];if(Object(s.g)(m)||Object(s.g)(g))return{candidates:[]};let y=new L(this._searchFeatures(this._getQueryBBoxes(g.toJSON())),null,this);y=await this._reschedule((()=>y.executeObjectIdsQuery(o)),t),y=await this._reschedule((()=>y.executeTimeQuery(o)),t),y=await this._reschedule((()=>y.executeAttributesQuery(o)),t);const v=m.toJSON(),b=c?Object(M.b)(v,this.spatialReference):v,x=c?Math.max(p.xmax-p.xmin,p.ymax-p.ymin)/2:n;return y.createSnappingResponse({...e,point:b,distance:x},r.spatialReference)}async executeQueryForLatestObservations(e={},t){if(!this.timeInfo||!this.timeInfo.trackIdField)throw new i.a(D,"Missing timeInfo or timeInfo.trackIdField",{query:e,timeInfo:this.timeInfo});let r,s=Object(n.a)(e);try{s=await this._schedule((()=>Object(T.h)(s,this.definitionExpression,this.spatialReference)),t),s=await this._reschedule((()=>this._checkQuerySupport(s)),t),r=await this._reschedule((()=>this._executeGeometryQuery(s,t)),t),r=await this._reschedule((()=>r.executeAggregateIdsQuery(s)),t),r=await this._reschedule((()=>r.executeObjectIdsQuery(s)),t),r=await this._reschedule((()=>r.executeTimeQuery(s)),t),r=await this._reschedule((()=>r.executeAttributesQuery(s)),t),r=await this._reschedule((()=>r.filterLatest()),t)}catch(e){if(e!==T.a)throw e;r=new L([],null,this)}return r.createQueryResponse(s)}async _schedule(e,t){return this._frameQueue?this._frameQueue.push(e,t):e()}async _reschedule(e,t){return this._frameQueue?this._frameQueue.unshift(e,t):e()}_update(e){for(this._budget=e;!e.done&&this._frameQueue&&this._frameQueue.process();)e.madeProgress();this._budget=null}_getAll(){if(!this._allItems){const e=[];this.featureStore.forEach((t=>e.push(t))),this._allItems=new L(e,null,this)}return this._allItems}async _executeGeometryQuery(e,t){const{geometry:r,outSR:n,spatialRel:i}=e,o=Object(a.i)(n)&&!Object(a.c)(this.spatialReference,n),u=this._geometryQueryCache?o?JSON.stringify({geometry:r,spatialRelationship:i,outSpatialReference:n}):JSON.stringify({geometry:r,spatialRelationship:i}):null;if(u){const e=this._geometryQueryCache.get(u);if(!Object(s.i)(e))return e}const c=async t=>{if(o&&(e.returnGeometry||e.returnCentroid)){const e=await t.project(n);return u&&this._geometryQueryCache.put(u,e,e.size||1),e}return u&&this._geometryQueryCache.put(u,t,t.size||1),t};if(!r)return c(this._getAll());const l=this.featureAdapter;if("esriSpatialRelDisjoint"===i){const e=this._searchFeatures(this._getQueryBBoxes(r));if(!e.length)return c(this._getAll());let n,s;const a=new Set;for(const t of e)a.add(l.getObjectId(t));return await this._reschedule((()=>{let e=0;n=new Array(a.size),this.featureStore.forEach((t=>n[e++]=t)),s=a}),t),c(await this._reschedule((async()=>{const e=await Object(T.g)(i,r,this.geometryType,this.hasZ,this.hasM);return new L(await this._runSpatialFilter(n,(t=>!s.has(l.getObjectId(t))||e(l.getGeometry(t))),t),r,this)}),t))}const h=this._searchFeatures(this._getQueryBBoxes(r));if(!h.length){const e=new L([],r,this);return u&&this._geometryQueryCache.put(u,e,e.size||1),e}if(this._canExecuteSoloPass(r,e))return c(new L(h,r,this));const f=await Object(T.g)(i,r,this.geometryType,this.hasZ,this.hasM),d=await this._runSpatialFilter(h,(e=>f(l.getGeometry(e))),t);return c(new L(d,r,this))}async _runSpatialFilter(e,t,r){if(!t)return e;if(!this._budget)return e.filter((e=>t(e)));let n=0;const s=new Array,i=async()=>{for(;n<e.length;){const a=e[n];t(a)&&s.push(a),this._budget.done&&await this._reschedule((()=>i()),r),++n}};return this._reschedule((()=>i()),r).then((()=>s))}_canExecuteSoloPass(e,t){const{geometryType:r}=this,{spatialRel:n}=t;return Object(T.b)(e)&&("esriSpatialRelEnvelopeIntersects"===n||"esriGeometryPoint"===r&&("esriSpatialRelIntersects"===n||"esriSpatialRelContains"===n||"esriSpatialRelWithin"===n))}_getQueryBBoxes(e){if(Object(T.b)(e)){if(Object(u.d)(e))return[Object(f.h)(e.xmin,e.ymin,e.xmax,e.ymax)];if(Object(u.g)(e))return e.rings.map((e=>Object(f.h)(Math.min(e[0][0],e[2][0]),Math.min(e[0][1],e[2][1]),Math.max(e[0][0],e[2][0]),Math.max(e[0][1],e[2][1]))))}return[Object(o.a)(Object(f.c)(),e)]}_searchFeatures(e){for(const t of e)this.featureStore.forEachInBounds(t,(e=>{Q.add(e)}));const t=new Array(Q.size);let r=0;return Q.forEach((e=>t[r++]=e)),Q.clear(),t}async _checkQuerySupport(e){if(e.distance<0||null!=e.geometryPrecision||e.multipatchOption||e.pixelSize||e.relationParam||e.text)throw new i.a(D,"Unsupported query options",{query:e});return Promise.all([this._checkAttributesQuerySupport(e),this._checkStatisticsQuerySupport(e),Object(T.c)(e,this.geometryType,this.spatialReference),Object(M.a)(this.spatialReference,e.outSR)]).then((()=>e))}_checkAttributesQuerySupport(e){const{outFields:t,orderByFields:r,returnDistinctValues:n,outStatistics:s}=e,a=s?s.map((e=>e.outStatisticFieldName&&e.outStatisticFieldName.toLowerCase())):[];if(r&&r.length>0){const e=" asc",t=" desc",n=r.map((r=>{const n=r.toLowerCase();return n.indexOf(e)>-1?n.split(e)[0]:n.indexOf(t)>-1?n.split(t)[0]:r})).filter((e=>-1===a.indexOf(e)));I(this.fieldsIndex,n,"orderByFields contains missing fields")}if(t&&t.length>0)I(this.fieldsIndex,t,"outFields contains missing fields");else if(n)throw new i.a(D,"outFields should be specified for returnDistinctValues",{query:e});!function(e,t){if(!t)return!0;const r=b.get(t,e);if(!r)throw new i.a(x,"invalid SQL expression",{where:t});if(!r.isStandardized)throw new i.a(x,"where clause is not standard",{where:t});I(e,r.fieldNames,"where clause contains missing fields")}(this.fieldsIndex,e.where)}async _checkStatisticsQuerySupport(e){const{outStatistics:t,groupByFieldsForStatistics:r,having:n}=e,s=r&&r.length,a=t&&t.length;if(n){if(!s||!a)throw new i.a(D,"outStatistics and groupByFieldsForStatistics should be specified with having",{query:e});!function(e,t,r){if(!t)return!0;const n=b.get(t,e);if(!n)throw new i.a(x,"invalid SQL expression",{having:t});if(!n.isAggregate)throw new i.a(x,"having does not contain a valid aggregate function",{having:t});const s=n.fieldNames;if(I(e,s,"having contains missing fields"),!n.getExpressions().every((t=>{const{aggregateType:n,field:s}=t,i=e.has(s)&&e.get(s).name;return r.some((t=>{const{onStatisticField:r,statisticType:s}=t;return(e.has(r)&&e.get(r).name)===i&&s.toLowerCase().trim()===n}))})))throw new i.a(x,"expressions in having should also exist in outStatistics",{having:t})}(this.fieldsIndex,n,t)}if(a){if(!function(e){return e.every((e=>"exceedslimit"!==e.statisticType))}(t))return;const n=t.map((e=>e.onStatisticField));I(this.fieldsIndex,n,"onStatisticFields contains missing fields"),s&&I(this.fieldsIndex,r,"groupByFieldsForStatistics contains missing fields");for(const r of t){const{onStatisticField:t,statisticType:n}=r;if("percentile_disc"!==n&&"percentile_cont"!==n||!("statisticParameters"in r)){if("count"!==n&&t&&N(t,this.fieldsIndex))throw new i.a(D,"outStatistics contains non-numeric fields",{definition:r,query:e})}else{const{statisticParameters:t}=r;if(!t)throw new i.a(D,"statisticParamters should be set for percentile type",{definition:r,query:e})}}}}}},409:function(e,t,r){"use strict";var n=r(264);t.a=class{constructor(e,t){this._storage=new n.b,this._storage.maxSize=e,t&&this._storage.registerRemoveFunc("",t)}put(e,t){this._storage.put(e,t,1,1)}pop(e){return this._storage.pop(e)}get(e){return this._storage.get(e)}clear(){this._storage.clearAll()}destroy(){this._storage.clearAll()}}},410:function(e,t,r){"use strict";r.d(t,"a",(function(){return a})),r.d(t,"b",(function(){return h})),r.d(t,"c",(function(){return f})),r.d(t,"d",(function(){return d})),r.d(t,"e",(function(){return p})),r(63);const n=(e,t,r)=>[t,r],s=(e,t,r)=>[t,r,e[2]],i=(e,t,r)=>[t,r,e[2],e[3]];function a(e){return e?{originPosition:"upper-left"===e.originPosition?"upperLeft":"lower-left"===e.originPosition?"lowerLeft":e.originPosition,scale:e.tolerance?[e.tolerance,e.tolerance]:[1,1],translate:e.extent?[e.extent.xmin,e.extent.ymax]:[0,0]}:null}function o({scale:e,translate:t},r){return r*e[0]+t[0]}function u({scale:e,translate:t},r){return t[1]-r*e[1]}function c(e,t,r){const n=new Array(r.length);if(!r.length)return n;const[s,i]=e.scale;let a=o(e,r[0][0]),c=u(e,r[0][1]);n[0]=t(r[0],a,c);for(let e=1;e<r.length;e++){const o=r[e];a+=o[0]*s,c-=o[1]*i,n[e]=t(o,a,c)}return n}function l(e,t,r){const n=new Array(r.length);for(let s=0;s<r.length;s++)n[s]=c(e,t,r[s]);return n}function h(e,t,r,a,o){return t.points=function(e,t,r,a){return c(e,r?a?i:s:a?s:n,t)}(e,r.points,a,o),t}function f(e,t,r,n,s){return t.x=o(e,r.x),t.y=u(e,r.y),t!==r&&(n&&(t.z=r.z),s&&(t.m=r.m)),t}function d(e,t,r,a,o){return t.rings=function(e,t,r,a){return l(e,r?a?i:s:a?s:n,t)}(e,r.rings,a,o),t}function p(e,t,r,a,o){return t.paths=function(e,t,r,a){return l(e,r?a?i:s:a?s:n,t)}(e,r.paths,a,o),t}},450:function(e,t,r){"use strict";r.d(t,"a",(function(){return s}));var n=r(75),s=Object(n.b)((function(e){var t;void 0!==(t=function(){function e(r,n,s,i,a){for(;i>s;){if(i-s>600){var o=i-s+1,u=n-s+1,c=Math.log(o),l=.5*Math.exp(2*c/3),h=.5*Math.sqrt(c*l*(o-l)/o)*(u-o/2<0?-1:1);e(r,n,Math.max(s,Math.floor(n-u*l/o+h)),Math.min(i,Math.floor(n+(o-u)*l/o+h)),a)}var f=r[n],d=s,p=i;for(t(r,s,n),a(r[i],f)>0&&t(r,s,i);d<p;){for(t(r,d,p),d++,p--;a(r[d],f)<0;)d++;for(;a(r[p],f)>0;)p--}0===a(r[s],f)?t(r,s,p):t(r,++p,i),p<=n&&(s=p+1),n<=p&&(i=p-1)}}function t(e,t,r){var n=e[t];e[t]=e[r],e[r]=n}function r(e,t){return e<t?-1:e>t?1:0}return function(t,n,s,i,a){e(t,n,s||0,i||t.length-1,a||r)}}())&&(e.exports=t)}))},451:function(e,t,r){"use strict";function n(e,t){if(!e)return null;const r=t.featureAdapter,{startTimeField:n,endTimeField:s}=e;let i=Number.POSITIVE_INFINITY,a=Number.NEGATIVE_INFINITY;if(n&&s)t.forEach((e=>{const t=r.getAttribute(e,n),o=r.getAttribute(e,s);null==t||isNaN(t)||(i=Math.min(i,t)),null==o||isNaN(o)||(a=Math.max(a,o))}));else{const e=n||s;t.forEach((t=>{const n=r.getAttribute(t,e);null==n||isNaN(n)||(i=Math.min(i,n),a=Math.max(a,n))}))}return{start:i,end:a}}function s(e,t,r){if(!t||!e)return null;const{startTimeField:n,endTimeField:s}=e;if(!n&&!s)return null;const{start:i,end:a}=t;return null===i&&null===a?null:void 0===i&&void 0===a?()=>!1:n&&s?function(e,t,r,n,s){return null!=n&&null!=s?i=>{const a=e.getAttribute(i,t),o=e.getAttribute(i,r);return(null==a||a<=s)&&(null==o||o>=n)}:null!=n?t=>{const s=e.getAttribute(t,r);return null==s||s>=n}:null!=s?r=>{const n=e.getAttribute(r,t);return null==n||n<=s}:void 0}(r,n,s,i,a):function(e,t,r,n){return null!=r&&null!=n&&r===n?n=>e.getAttribute(n,t)===r:null!=r&&null!=n?s=>{const i=e.getAttribute(s,t);return i>=r&&i<=n}:null!=r?n=>e.getAttribute(n,t)>=r:null!=n?r=>e.getAttribute(r,t)<=n:void 0}(r,n||s,i,a)}r.d(t,"a",(function(){return n})),r.d(t,"b",(function(){return s}))},495:function(e,t,r){"use strict";r.d(t,"a",(function(){return F})),r.d(t,"b",(function(){return O})),r.d(t,"c",(function(){return M})),r.d(t,"d",(function(){return L})),r.d(t,"e",(function(){return C})),r.d(t,"f",(function(){return z})),r.d(t,"g",(function(){return N})),r.d(t,"h",(function(){return G})),r.d(t,"i",(function(){return P}));var n=r(0),s=r(55),i=r(16),a=r(93),o=r(323),u=r(405),c=r(449),l=r(63),h=r(69),f=r(216),d=r(154),p=r(137),m=(r(299),r(300));function g(e,t){return e?t?4:3:t?3:2}function y(e,t,r,n,s){if(!e)return!1;const i=g(t,r),{coords:a,lengths:o}=e;let u=!1,c=0;for(const e of o)u=v(u,a,i,c,e,n,s),c+=e*i;return u}function v(e,t,r,n,s,i,a){let o=e,u=n;for(let e=n,c=n+s*r;e<c;e+=r){u=e+r,u===c&&(u=n);const s=t[e],l=t[e+1],h=t[u],f=t[u+1];(l<a&&f>=a||f<a&&l>=a)&&s+(a-l)/(f-l)*(h-s)<i&&(o=!o)}return o}const b="feature-store:unsupported-query",x={esriSpatialRelIntersects:"intersects",esriSpatialRelContains:"contains",esriSpatialRelCrosses:"crosses",esriSpatialRelDisjoint:"disjoint",esriSpatialRelEnvelopeIntersects:"intersects",esriSpatialRelIndexIntersects:null,esriSpatialRelOverlaps:"overlaps",esriSpatialRelTouches:"touches",esriSpatialRelWithin:"within",esriSpatialRelRelation:null},_={esriSpatialRelIntersects:!0,esriSpatialRelContains:!0,esriSpatialRelWithin:!0,esriSpatialRelCrosses:!0,esriSpatialRelDisjoint:!0,esriSpatialRelTouches:!0,esriSpatialRelOverlaps:!0,esriSpatialRelEnvelopeIntersects:!0,esriSpatialRelIndexIntersects:!1,esriSpatialRelRelation:!1},w={esriGeometryPoint:!0,esriGeometryMultipoint:!0,esriGeometryPolyline:!0,esriGeometryPolygon:!0,esriGeometryEnvelope:!0},I={esriGeometryPoint:!0,esriGeometryMultipoint:!0,esriGeometryPolyline:!0,esriGeometryPolygon:!0,esriGeometryEnvelope:!1};function S(){return Promise.all([r.e(8),r.e(21)]).then(r.bind(null,521))}function N(e,t,r,n,s){if(Object(l.g)(t)&&"esriGeometryPoint"===r&&("esriSpatialRelIntersects"===e||"esriSpatialRelContains"===e)){const e=Object(p.e)(new d.a,t,!1,!1);return Promise.resolve((t=>function(e,t,r,n){return y(e,!1,!1,n.coords[0],n.coords[1])}(e,0,0,t)))}if(Object(l.g)(t)&&"esriGeometryMultipoint"===r){const r=Object(p.e)(new d.a,t,!1,!1);if("esriSpatialRelContains"===e)return Promise.resolve((e=>function(e,t,r,n,s,i){const a=g(s,i),{coords:o,lengths:u}=n;if(!u)return!1;for(let t=0,r=0;t<u.length;t++,r+=a)if(!y(e,false,false,o[r],o[r+1]))return!1;return!0}(r,0,0,e,n,s)))}if(Object(l.d)(t)&&"esriGeometryPoint"===r&&("esriSpatialRelIntersects"===e||"esriSpatialRelContains"===e))return Promise.resolve((e=>Object(o.e)(t,C(r,n,s,e))));if(Object(l.d)(t)&&"esriGeometryMultipoint"===r&&"esriSpatialRelContains"===e)return Promise.resolve((e=>Object(o.d)(t,C(r,n,s,e))));if(Object(l.d)(t)&&"esriSpatialRelIntersects"===e){const e=Object(u.a)(r);return Promise.resolve((i=>e(t,C(r,n,s,i))))}return S().then((i=>{const a=i[x[e]].bind(null,t.spatialReference,t);return e=>a(C(r,n,s,e))}))}async function M(e,t,r){const{spatialRel:n,geometry:s}=e;if(s){if(!function(e){return!0===_[e]}(n))throw new i.a(b,"Unsupported query spatial relationship",{query:e});if(Object(a.i)(s.spatialReference)&&Object(a.i)(r)){if(!function(e){return!0===w[Object(l.c)(e)]}(s))throw new i.a(b,"Unsupported query geometry type",{query:e});if(!function(e){return!0===I[e]}(t))throw new i.a(b,"Unsupported layer geometry type",{query:e});if(e.outSR)return Object(m.a)(e.geometry&&e.geometry.spatialReference,e.outSR)}}}function O(e){if(Object(l.d)(e))return!0;if(Object(l.g)(e)){for(const t of e.rings){if(5!==t.length)return!1;if(t[0][0]!==t[1][0]||t[0][0]!==t[4][0]||t[2][0]!==t[3][0]||t[0][1]!==t[3][1]||t[0][1]!==t[4][1]||t[1][1]!==t[2][1])return!1}return!0}return!1}const T=new s.a({esriSRUnit_Meter:"meters",esriSRUnit_Kilometer:"kilometers",esriSRUnit_Foot:"feet",esriSRUnit_StatuteMile:"miles",esriSRUnit_NauticalMile:"nautical-miles",esriSRUnit_USNauticalMile:"us-nautical-miles"}),F=Object.freeze({}),R=new d.a,A=new d.a,j=new d.a,E={esriGeometryPoint:p.j,esriGeometryPolyline:p.l,esriGeometryPolygon:p.k,esriGeometryMultipoint:p.i};function P(e,t,r,n=e.hasZ,s=e.hasM){const i=e.hasZ&&n,a=e.hasM&&s;if(r){const o=Object(p.r)(j,t,e.hasZ,e.hasM,"esriGeometryPoint",r,n,s);return Object(p.j)(o,i,a)}return Object(p.j)(t,i,a)}function C(e,t,r,n,s,i,a=t,o=r){const u=t&&a,c=r&&o,l=n?"coords"in n?n:n.geometry:null;if(!l)return null;if(s){let n=Object(p.n)(A,l,t,r,e,s,a,o);return i&&(n=Object(p.r)(j,n,u,c,e,i)),E[e](n,u,c)}if(i){const n=Object(p.r)(j,l,t,r,e,i,a,o);return E[e](n,u,c)}return Object(p.u)(R,l,t,r,a,o),E[e](R,u,c)}async function G(e,t,r){const{outFields:n,orderByFields:s,groupByFieldsForStatistics:i,outStatistics:a}=e;if(n)for(let e=0;e<n.length;e++)n[e]=n[e].trim();if(s)for(let e=0;e<s.length;e++)s[e]=s[e].trim();if(i)for(let e=0;e<i.length;e++)i[e]=i[e].trim();if(a)for(let e=0;e<a.length;e++)a[e].onStatisticField&&(a[e].onStatisticField=a[e].onStatisticField.trim());return e.geometry&&!e.outSR&&(e.outSR=e.geometry.spatialReference),z(e,t,r)}async function z(e,t,r){if(!e)return null;let{where:s}=e;if(e.where=s=s&&s.trim(),(!s||/^1 *= *1$/.test(s)||t&&t===s)&&(e.where=null),!e.geometry)return e;let i=await async function(e){const{geometry:t,distance:r,units:n}=e;if(null==r||"vertexAttributes"in t)return t;const s=t.spatialReference,i=n?T.fromJSON(n):Object(h.e)(s),o=s&&(Object(a.f)(s)||Object(a.m)(s))?t:await Object(m.a)(s,a.a).then((()=>Object(m.b)(t,a.a)));return(await S().then((e=>e.geodesicBuffer)))(o.spatialReference,o,r,i)}(e);if(e.distance=0,e.units=null,"esriSpatialRelEnvelopeIntersects"===e.spatialRel){const{spatialReference:t}=e.geometry;i=Object(c.a)(i),i.spatialReference=t}e.geometry=i,await Object(m.a)(i.spatialReference,r);const o=(await Object(f.a)(Object(l.a)(i)))[0];if(Object(n.g)(o))throw F;const u=o.toJSON(),d=await Object(m.b)(u,u.spatialReference,r);if(!d)throw F;return d.spatialReference=r,e.geometry=d,e}function L(e){return e&&D in e?JSON.parse(JSON.stringify(e,Q)):e}const D="_geVersion",Q=(e,t)=>e!==D?t:void 0},501:function(e,t,r){"use strict";r.d(t,"a",(function(){return a})),r.d(t,"b",(function(){return c})),r.d(t,"c",(function(){return l})),r.d(t,"d",(function(){return o})),r.d(t,"e",(function(){return u}));var n=r(57),s=r(135),i=r(63);const a={102100:{maxX:20037508.342788905,minX:-20037508.342788905,plus180Line:new s.a({paths:[[[20037508.342788905,-20037508.342788905],[20037508.342788905,20037508.342788905]]],spatialReference:n.a.WebMercator}),minus180Line:new s.a({paths:[[[-20037508.342788905,-20037508.342788905],[-20037508.342788905,20037508.342788905]]],spatialReference:n.a.WebMercator})},4326:{maxX:180,minX:-180,plus180Line:new s.a({paths:[[[180,-180],[180,180]]],spatialReference:n.a.WGS84}),minus180Line:new s.a({paths:[[[-180,-180],[-180,180]]],spatialReference:n.a.WGS84})}};function o(e,t){return Math.ceil((e-t)/(2*t))}function u(e,t){const r=c(e);for(const e of r)for(const r of e)r[0]+=t;return e}function c(e){return Object(i.g)(e)?e.rings:e.paths}function l(e){const t=(null==e?void 0:e.isWebMercator)?102100:4326;return[a[t].minX,a[t].maxX]}},502:function(e,t,r){"use strict";r.d(t,"a",(function(){return n}));const n={supportsStatistics:!0,supportsPercentileStatistics:!0,supportsCentroid:!0,supportsCacheHint:!1,supportsDistance:!0,supportsDistinct:!0,supportsExtent:!0,supportsGeometryProperties:!1,supportsHavingClause:!0,supportsOrderBy:!0,supportsPagination:!0,supportsQuantization:!0,supportsQuantizationEditMode:!1,supportsQueryGeometry:!0,supportsResultType:!1,supportsSqlExpression:!0,supportsMaxRecordCountFactor:!1,supportsStandardizedQueriesOnly:!0,supportsQueryByOthers:!0,supportsHistoricMoment:!1,supportsFormatPBF:!1,supportsDisjointSpatialRelationship:!0,maxRecordCountFactor:void 0,maxRecordCount:void 0,standardMaxRecordCount:void 0,tileMaxRecordCount:void 0}},59:function(e,t,r){"use strict";r.d(t,"a",(function(){return l}));var n=r(5),s=(r(57),r(162)),i=r(71),a=r(60),o=r(183),u=r(114),c=r(135);r(163),r(63);const l={base:s.a,key:"type",typeMap:{extent:a.a,multipoint:o.a,point:i.a,polyline:c.a,polygon:u.a}};Object(n.k)(l)},63:function(e,t,r){"use strict";r.d(t,"a",(function(){return p})),r.d(t,"b",(function(){return y})),r.d(t,"c",(function(){return m})),r.d(t,"d",(function(){return c})),r.d(t,"e",(function(){return l})),r.d(t,"f",(function(){return h})),r.d(t,"g",(function(){return d})),r.d(t,"h",(function(){return f}));var n=r(162),s=r(71),i=r(60),a=r(183),o=r(114),u=r(135);function c(e){return void 0!==e.xmin&&void 0!==e.ymin&&void 0!==e.xmax&&void 0!==e.ymax}function l(e){return void 0!==e.points}function h(e){return void 0!==e.x&&void 0!==e.y}function f(e){return void 0!==e.paths}function d(e){return void 0!==e.rings}function p(e){return e?e instanceof n.a?e:h(e)?s.a.fromJSON(e):f(e)?u.a.fromJSON(e):d(e)?o.a.fromJSON(e):l(e)?a.a.fromJSON(e):c(e)?i.a.fromJSON(e):null:null}function m(e){return e?h(e)?"esriGeometryPoint":f(e)?"esriGeometryPolyline":d(e)?"esriGeometryPolygon":c(e)?"esriGeometryEnvelope":l(e)?"esriGeometryMultipoint":null:null}const g={esriGeometryPoint:s.a,esriGeometryPolyline:u.a,esriGeometryPolygon:o.a,esriGeometryEnvelope:i.a,esriGeometryMultipoint:a.a};function y(e){return e&&g[e]||null}},75:function(e,t,r){"use strict";(function(e){function n(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}function s(e,t,r){return e(r={path:t,exports:{},require:function(e,t){return i(null==t&&r.path)}},r.exports),r.exports}function i(){throw new Error("Dynamic requires are not currently supported by @rollup/plugin-commonjs")}r.d(t,"a",(function(){return i})),r.d(t,"b",(function(){return s})),r.d(t,"c",(function(){return n})),"undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:void 0!==e||"undefined"!=typeof self&&self}).call(this,r(49))}});