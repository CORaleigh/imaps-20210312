(self.webpackChunkimaps=self.webpackChunkimaps||[]).push([[5834],{42738:(e,t,i)=>{"use strict";i.d(t,{a:()=>n,b:()=>c,f:()=>l,i:()=>r,m:()=>o,r:()=>a,s:()=>h,t:()=>d});var s=i(60418);function r(e){return e[0]=1,e[1]=0,e[2]=0,e[3]=1,e[4]=0,e[5]=0,e}function n(e,t){const i=t[0],s=t[1],r=t[2],n=t[3],o=t[4],a=t[5];let h=i*n-s*r;return h?(h=1/h,e[0]=n*h,e[1]=-s*h,e[2]=-r*h,e[3]=i*h,e[4]=(r*a-n*o)*h,e[5]=(s*o-i*a)*h,e):null}function o(e,t,i){const s=t[0],r=t[1],n=t[2],o=t[3],a=t[4],h=t[5],d=i[0],c=i[1],l=i[2],p=i[3],u=i[4],v=i[5];return e[0]=s*d+n*c,e[1]=r*d+o*c,e[2]=s*l+n*p,e[3]=r*l+o*p,e[4]=s*u+n*v+a,e[5]=r*u+o*v+h,e}function a(e,t,i){const s=t[0],r=t[1],n=t[2],o=t[3],a=t[4],h=t[5],d=Math.sin(i),c=Math.cos(i);return e[0]=s*c+n*d,e[1]=r*c+o*d,e[2]=s*-d+n*c,e[3]=r*-d+o*c,e[4]=a,e[5]=h,e}function h(e,t,i){const s=t[0],r=t[1],n=t[2],o=t[3],a=t[4],h=t[5],d=i[0],c=i[1];return e[0]=s*d,e[1]=r*d,e[2]=n*c,e[3]=o*c,e[4]=a,e[5]=h,e}function d(e,t,i){const s=t[0],r=t[1],n=t[2],o=t[3],a=t[4],h=t[5],d=i[0],c=i[1];return e[0]=s,e[1]=r,e[2]=n,e[3]=o,e[4]=s*d+n*c+a,e[5]=r*d+o*c+h,e}function c(e,t){const i=Math.sin(t),s=Math.cos(t);return e[0]=s,e[1]=i,e[2]=-i,e[3]=s,e[4]=0,e[5]=0,e}function l(e,t){return e[0]=t[0],e[1]=0,e[2]=0,e[3]=t[1],e[4]=0,e[5]=0,e}function p(e,t,i){return e[0]=t[0]-i[0],e[1]=t[1]-i[1],e[2]=t[2]-i[2],e[3]=t[3]-i[3],e[4]=t[4]-i[4],e[5]=t[5]-i[5],e}const u=o,v=p;Object.freeze({__proto__:null,copy:function(e,t){return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e[4]=t[4],e[5]=t[5],e},identity:r,set:function(e,t,i,s,r,n,o){return e[0]=t,e[1]=i,e[2]=s,e[3]=r,e[4]=n,e[5]=o,e},invert:n,determinant:function(e){return e[0]*e[3]-e[1]*e[2]},multiply:o,rotate:a,scale:h,translate:d,fromRotation:c,fromScaling:l,fromTranslation:function(e,t){return e[0]=1,e[1]=0,e[2]=0,e[3]=1,e[4]=t[0],e[5]=t[1],e},str:function(e){return"mat2d("+e[0]+", "+e[1]+", "+e[2]+", "+e[3]+", "+e[4]+", "+e[5]+")"},frob:function(e){return Math.sqrt(e[0]**2+e[1]**2+e[2]**2+e[3]**2+e[4]**2+e[5]**2+1)},add:function(e,t,i){return e[0]=t[0]+i[0],e[1]=t[1]+i[1],e[2]=t[2]+i[2],e[3]=t[3]+i[3],e[4]=t[4]+i[4],e[5]=t[5]+i[5],e},subtract:p,multiplyScalar:function(e,t,i){return e[0]=t[0]*i,e[1]=t[1]*i,e[2]=t[2]*i,e[3]=t[3]*i,e[4]=t[4]*i,e[5]=t[5]*i,e},multiplyScalarAndAdd:function(e,t,i,s){return e[0]=t[0]+i[0]*s,e[1]=t[1]+i[1]*s,e[2]=t[2]+i[2]*s,e[3]=t[3]+i[3]*s,e[4]=t[4]+i[4]*s,e[5]=t[5]+i[5]*s,e},exactEquals:function(e,t){return e[0]===t[0]&&e[1]===t[1]&&e[2]===t[2]&&e[3]===t[3]&&e[4]===t[4]&&e[5]===t[5]},equals:function(e,t){const i=e[0],r=e[1],n=e[2],o=e[3],a=e[4],h=e[5],d=t[0],c=t[1],l=t[2],p=t[3],u=t[4],v=t[5];return Math.abs(i-d)<=s.E*Math.max(1,Math.abs(i),Math.abs(d))&&Math.abs(r-c)<=s.E*Math.max(1,Math.abs(r),Math.abs(c))&&Math.abs(n-l)<=s.E*Math.max(1,Math.abs(n),Math.abs(l))&&Math.abs(o-p)<=s.E*Math.max(1,Math.abs(o),Math.abs(p))&&Math.abs(a-u)<=s.E*Math.max(1,Math.abs(a),Math.abs(u))&&Math.abs(h-v)<=s.E*Math.max(1,Math.abs(h),Math.abs(v))},mul:u,sub:v})},75384:(e,t,i)=>{"use strict";function s(){return[1,0,0,1,0,0]}function r(e){return[e[0],e[1],e[2],e[3],e[4],e[5]]}i.d(t,{a:()=>r,c:()=>s});Object.freeze({__proto__:null,create:s,clone:r,fromValues:function(e,t,i,s,r,n){return[e,t,i,s,r,n]},createView:function(e,t){return new Float64Array(e,t,6)}})},77293:(e,t,i)=>{"use strict";function s(e,t){for(const[i,s]of e)if(t(s,i))return!0;return!1}i.d(t,{o:()=>s})},77195:(e,t,i)=>{"use strict";i.d(t,{q:()=>a});var s=i(36544),r=i(39105),n=i(92673);const o=s.Z.getLogger("esri.core.workers.WorkerHandle");class a{constructor(e,t,i,s={}){this._mainMethod=t,this._promise=(0,n.bA)(e,{...s,scheduler:i}).then((e=>{void 0===this._thread?(this._thread=e,this._promise=null,s.hasInitialize&&this.broadcast({},"initialize")):e.close()})),this._promise.catch((t=>o.error(`Failed to initialize ${e} worker: ${t}`)))}destroy(){this._thread&&(this._thread.close(),this._thread=null),this._promise=null}invoke(e,t){return this.invokeMethod(this._mainMethod,e,t)}invokeMethod(e,t,i){if(this._thread){const s=this.getTransferList(t,e);return this._thread.invoke(e,t,{transferList:s,signal:i})}return this._promise?this._promise.then((()=>((0,r.throwIfAborted)(i),this.invokeMethod(e,t,i)))):Promise.reject(null)}broadcast(e,t){return this._thread?Promise.all(this._thread.broadcast(t,e)).then((()=>{})):this._promise?this._promise.then((()=>this.broadcast(e,t))):Promise.reject()}get promise(){return this._promise}}},98675:(e,t,i)=>{"use strict";i.r(t),i.d(t,{directGeodeticSolver:()=>f,geodesicAreas:()=>v,geodesicDensify:()=>m,geodesicDistance:()=>y,geodesicLengths:()=>g,inverseGeodeticSolver:()=>_,isSupported:()=>u,pointFromDistance:()=>w});var s=i(32656),r=i(73032),n=i(61106),o=i(53817),a=i(93833),h=(i(36348),i(93533)),d=i(64249);function c(e){if(!e)return null;if(e.isGeographic&&e.wkid){const t=d.Dg[e.wkid];if(t)return t}if(e.wkt){const t=d.yB.exec(e.wkt);if(!t||2!==t.length)return null;const i=t[1].split(",");if(!i||i.length<3)return null;const s=parseFloat(i[1]),r=parseFloat(i[2]);return isNaN(s)||isNaN(r)?null:{a:s,f:0===r?0:1/r}}return null}function l(e){const t=c(e||r.Z.WGS84);if(function(e){return"b"in e&&"eSq"in e&&"radius"in e}(t))return t;const i=t.a*(1-t.f);return Object.assign(t,{b:i,eSq:1-(i/t.a)**2,radius:(2*t.a+i)/3,densificationRatio:1e4/((2*t.a+i)/3)})}function p(e,t,i){const{a:s,eSq:r}=l(i),n=Math.sqrt(r),o=Math.sin(t[1]*d.Yr),a=s*t[0]*d.Yr;let h;return h=r>0?s*((1-r)*(o/(1-r*(o*o))-1/(2*n)*Math.log((1-n*o)/(1+n*o))))*.5:s*o,e[0]=a,e[1]=h,e}function u(e){return null!==c(e)}function v(e,t="square-meters"){if(e.some((e=>!u(e.spatialReference))))throw new s.Z("geodesic-areas:invalid-spatial-reference","the input geometries spatial reference is not supported");const i=[];for(let t=0;t<e.length;t++){const s=e[t],r=s.spatialReference,{radius:n,densificationRatio:o}=l(r),a=n*o;i.push(m(s,a))}const r=[],n=[0,0],o=[0,0];for(let e=0;e<i.length;e++){const{rings:s,spatialReference:a}=i[e];let d=0;for(let e=0;e<s.length;e++){const t=s[e];p(n,t[0],a),p(o,t[t.length-1],a);let i=o[0]*n[1]-n[0]*o[1];for(let e=0;e<t.length-1;e++)p(n,t[e+1],a),p(o,t[e],a),i+=o[0]*n[1]-n[0]*o[1];d+=i}d=(0,h.En)(d,"square-meters",t),r.push(d/-2)}return r}function g(e,t="meters"){const i=e,r=e;if(!i&&!r)throw new s.Z("geodesic-lengths:invalid-geometries","the input geometries type is not supported");if(i?i.some((e=>!u(e.spatialReference))):r.some((e=>!u(e.spatialReference))))throw new s.Z("geodesic-lengths:invalid-spatial-reference","the input geometries spatial reference is not supported");const n=[];for(let i=0;i<e.length;i++){const s=e[i],{spatialReference:r}=s,o="polyline"===s.type?s.paths:s.rings;let a=0;for(let e=0;e<o.length;e++){const t=o[e];let i=0;for(let e=1;e<t.length;e++){const s=t[e-1][0],n=t[e][0],o=t[e-1][1],a=t[e][1];if(o!==a||s!==n){const e={distance:null};_(e,[s,o],[n,a],r),i+=e.distance}}a+=i}a=(0,h.En)(a,"meters",t),n.push(a)}return n}function m(e,t){if("polyline"!==e.type&&"polygon"!==e.type)throw new s.Z("geodesic-densify:invalid-geometry","the input geometry is neither polyline nor polygon");const{spatialReference:i}=e;if(!u(i))throw new s.Z("geodesic-densify:invalid-spatial-reference","the input geometry spatial reference is not supported");const r="polyline"===e.type?e.paths:e.rings,n=[],h=[0,0],d={distance:null};for(const e of r){const s=[];n.push(s),s.push([e[0][0],e[0][1]]);let r,o,a=e[0][0],c=e[0][1];for(let n=0;n<e.length-1;n++){if(r=e[n+1][0],o=e[n+1][1],a===r&&c===o)continue;const l=[a,c];_(d,[a,c],[r,o],i);const{azimuth:p,distance:u}=d,v=u/t;if(v>1){for(let e=1;e<=v-1;e++)f(h,l,p,e*t,i),s.push(h.slice(0));f(h,l,p,(u+Math.floor(v-1)*t)/2,i),s.push(h.slice(0))}f(h,l,p,u,i),s.push(h.slice(0)),a=h[0],c=h[1]}}return"polyline"===e.type?new a.Z({paths:n,spatialReference:i}):new o.Z({rings:n,spatialReference:i})}function f(e,t,i,s,r){const n=t[0],o=t[1],a=n*d.Yr,h=o*d.Yr,c=i*d.Yr,{a:p,b:u,f:v}=l(r),g=Math.sin(c),m=Math.cos(c),f=(1-v)*Math.tan(h),_=1/Math.sqrt(1+f*f),y=f*_,w=Math.atan2(f,m),x=_*g,C=x*x,b=1-C,T=b*(p*p-u*u)/(u*u),S=1+T/16384*(4096+T*(T*(320-175*T)-768)),P=T/1024*(256+T*(T*(74-47*T)-128));let V,H,E,I,M=s/(u*S),O=2*Math.PI;for(;Math.abs(M-O)>1e-12;)E=Math.cos(2*w+M),V=Math.sin(M),H=Math.cos(M),I=P*V*(E+P/4*(H*(2*E*E-1)-P/6*E*(4*V*V-3)*(4*E*E-3))),O=M,M=s/(u*S)+I;const k=y*V-_*H*m,D=Math.atan2(y*H+_*V*m,(1-v)*Math.sqrt(C+k*k)),R=Math.atan2(V*g,_*H-y*V*m),A=v/16*b*(4+v*(4-3*b)),Z=D/d.Yr,L=(a+(R-(1-A)*v*x*(M+A*V*(E+A*H*(2*E*E-1)))))/d.Yr;return e.splice(0,e.length),e.push(L,Z),e}function _(e,t,i,s){const r=t[0]*d.Yr,n=t[1]*d.Yr,o=i[0]*d.Yr,a=i[1]*d.Yr,{a:h,b:c,f:p,radius:u}=l(s),v=o-r,g=Math.atan((1-p)*Math.tan(n)),m=Math.atan((1-p)*Math.tan(a)),f=Math.sin(g),_=Math.cos(g),y=Math.sin(m),w=Math.cos(m);let x,C,b,T,S,P,V,H,E,I,M=1e3,O=v;do{if(V=Math.sin(O),H=Math.cos(O),b=Math.sqrt(w*V*(w*V)+(_*y-f*w*H)*(_*y-f*w*H)),0===b)return{distance:0};S=f*y+_*w*H,P=Math.atan2(b,S),E=_*w*V/b,C=1-E*E,T=S-2*f*y/C,isNaN(T)&&(T=0),I=p/16*C*(4+p*(4-3*C)),x=O,O=v+(1-I)*p*E*(P+I*b*(T+I*S*(2*T*T-1)))}while(Math.abs(O-x)>1e-12&&--M>0);if(0===M){const e=u,t=Math.acos(Math.sin(n)*Math.sin(a)+Math.cos(n)*Math.cos(a)*Math.cos(o-r))*e,i=o-r,s=Math.sin(i)*Math.cos(a),h=Math.cos(n)*Math.sin(a)-Math.sin(n)*Math.cos(a)*Math.cos(i);return{azimuth:Math.atan2(s,h)/d.Yr,distance:t}}const k=C*(h*h-c*c)/(c*c),D=k/1024*(256+k*(k*(74-47*k)-128)),R=c*(1+k/16384*(4096+k*(k*(320-175*k)-768)))*(P-D*b*(T+D/4*(S*(2*T*T-1)-D/6*T*(4*b*b-3)*(4*T*T-3)))),A=Math.atan2(w*Math.sin(O),_*y-f*w*Math.cos(O)),Z=Math.atan2(_*Math.sin(O),_*y*Math.cos(O)-f*w);return e.azimuth=A/d.Yr,e.distance=R,e.reverseAzimuth=Z/d.Yr,e}function y(e,t,i="meters"){if(!e||!t)throw new s.Z("geodesic-distance:missing-parameters","one or both input parameters are missing");if(!e.spatialReference||!t.spatialReference)throw new s.Z("geodesic-distance:invalid-parameters","one or both input points do not have a spatial reference");if(!e.spatialReference.equals(t.spatialReference))throw new s.Z("geodesic-distance:invalid-parameters","spatial references of input parameters do not match");const{spatialReference:r}=e;if(!u(r))throw new s.Z("geodesic-distance:not-supported","input geometry spatial reference is not supported");if(e.equals(t))return{distance:0,azimuth:0,reverseAzimuth:0};const n={distance:null};return _(n,[e.x,e.y],[t.x,t.y],r),n.distance=(0,h.En)(n.distance,"meters",i),n}function w(e,t,i){if(!e||null==t||null==i)throw new s.Z("point-from-distance:missing-parameters","one or more input parameters are missing or undefined");if(i<0||i>360)throw new s.Z("point-from-distance:-of-bounds","azimuth is restricted to angles between, and including, 0° to 360° degrees");if(!e.spatialReference)throw new s.Z("point-from-distance:missing-spatial-reference","the input point must have a spatial reference");const{spatialReference:r}=e;if(!u(r))throw new s.Z("geodesic-distance:not-supported","input geometry spatial reference is not supported");const o=[0,0];return f(o,[e.x,e.y],i,t,r),new n.Z({x:o[0],y:o[1],spatialReference:r})}},94394:(e,t,i)=>{"use strict";i.r(t),i.d(t,{default:()=>p});var s=i(56140),r=(i(95830),i(36544),i(68055),i(79881)),n=i(87566),o=(i(10923),i(57002),i(86035),i(56700)),a=i(79710),h=i(57407),d=i(10113),c=i(99322);let l=class extends((0,h.h)((0,d.M)(o.Z))){constructor(e){super(e),this.elevationInfo=null,this.graphics=new c.ZP,this.screenSizePerspectiveEnabled=!0,this.type="graphics"}destroy(){this.removeAll()}add(e){return this.graphics.add(e),this}addMany(e){return this.graphics.addMany(e),this}removeAll(){return this.graphics.removeAll(),this}remove(e){this.graphics.remove(e)}removeMany(e){this.graphics.removeMany(e)}on(e,t){return super.on(e,t)}graphicChanged(e){this.emit("graphic-update",e)}};(0,s._)([(0,r.Cb)({type:a.Z})],l.prototype,"elevationInfo",void 0),(0,s._)([(0,r.Cb)((0,c.$o)())],l.prototype,"graphics",void 0),(0,s._)([(0,r.Cb)({type:["show","hide"]})],l.prototype,"listMode",void 0),(0,s._)([(0,r.Cb)()],l.prototype,"screenSizePerspectiveEnabled",void 0),(0,s._)([(0,r.Cb)({readOnly:!0})],l.prototype,"type",void 0),l=(0,s._)([(0,n.j)("esri.layers.GraphicsLayer")],l);const p=l},77142:(e,t,i)=>{"use strict";i.d(t,{Z:()=>_});var s=i(59472),r=i(36544),n=i(32656),o=i(35470),a=i(50897),h=i(69996),d=i(31036),c=i(95830),l=i(96233);const p={minX:0,minY:0,maxX:0,maxY:0};class u{constructor(){this._indexInvalid=!1,this._boundsToLoad=[],this._boundsById=new Map,this._idByBounds=new Map,this._index=(0,l.r)(9,(0,c.Z)("csp-restrictions")?e=>({minX:e[0],minY:e[1],maxX:e[2],maxY:e[3]}):["[0]","[1]","[2]","[3]"]),this._loadIndex=()=>{if(this._indexInvalid){const e=new Array(this._idByBounds.size);let t=0;this._idByBounds.forEach(((i,s)=>{e[t++]=s})),this._indexInvalid=!1,this._index.clear(),this._index.load(e)}else this._boundsToLoad.length&&(this._index.load(this._boundsToLoad.filter((e=>this._idByBounds.has(e)))),this._boundsToLoad.length=0)}}clear(){this._indexInvalid=!1,this._boundsToLoad.length=0,this._boundsById.clear(),this._idByBounds.clear(),this._index.clear()}delete(e){const t=this._boundsById.get(e);this._boundsById.delete(e),t&&(this._idByBounds.delete(t),this._indexInvalid||this._index.remove(t))}forEachInBounds(e,t){this._loadIndex();for(const i of function(e,t){return p.minX=t[0],p.minY=t[1],p.maxX=t[2],p.maxY=t[3],e.search(p)}(this._index,e))t(this._idByBounds.get(i))}get(e){return this._boundsById.get(e)}has(e){return this._boundsById.has(e)}invalidateIndex(){this._indexInvalid||(this._indexInvalid=!0,this._boundsToLoad.length=0)}set(e,t){if(!this._indexInvalid){const t=this._boundsById.get(e);t&&(this._index.remove(t),this._idByBounds.delete(t))}this._boundsById.set(e,t),t&&(this._idByBounds.set(t,e),this._indexInvalid||(this._boundsToLoad.push(t),this._boundsToLoad.length>5e4&&this._loadIndex()))}}var v=i(44195),g=i(73127),m=i(24179);const f={getObjectId:e=>e.objectId,getAttributes:e=>e.attributes,getAttribute:(e,t)=>e.attributes[t],cloneWithGeometry:(e,t)=>new v.Z(t,e.attributes,null,e.objectId),getGeometry:e=>e.geometry,getCentroid:(e,t)=>(e.centroid||(e.centroid=(0,m.Y)(new g.Z,e.geometry,t.hasZ,t.hasM)),e.centroid)};const _=class{constructor(e){this.geometryInfo=e,this._boundsStore=new u,this._featuresById=new Map,this._markedIds=new Set,this.events=new o.Z,this.featureAdapter=f}get geometryType(){return this.geometryInfo.geometryType}get hasM(){return this.geometryInfo.hasM}get hasZ(){return this.geometryInfo.hasZ}get numFeatures(){return this._featuresById.size}get fullBounds(){if(!this.numFeatures)return null;const e=(0,a.Ue)(a.Gv);return this._featuresById.forEach((t=>{const i=this._boundsStore.get(t.objectId);i&&(e[0]=Math.min(i[0],e[0]),e[1]=Math.min(i[1],e[1]),e[2]=Math.max(i[2],e[2]),e[3]=Math.max(i[3],e[3]))})),e}get storeStatistics(){let e=0;return this._featuresById.forEach((t=>{t.geometry&&t.geometry.coords&&(e+=t.geometry.coords.length)})),{featureCount:this._featuresById.size,vertexCount:e/(this.hasZ?this.hasM?4:3:this.hasM?3:2)}}add(e){this._add(e),this._emitChanged()}addMany(e){for(const t of e)this._add(t);this._emitChanged()}clear(){this._featuresById.clear(),this._boundsStore.clear(),this._emitChanged()}removeById(e){const t=this._featuresById.get(e);return t?(this._remove(t),this._emitChanged(),t):null}removeManyById(e){this._boundsStore.invalidateIndex();for(const t of e){const e=this._featuresById.get(t);e&&this._remove(e)}this._emitChanged()}forEachBounds(e,t,i){for(const s of e){const e=this._boundsStore.get(s.objectId);e&&t((0,h.JR)(i,e))}}getFeature(e){return this._featuresById.get(e)}has(e){return this._featuresById.has(e)}forEach(e){this._featuresById.forEach((t=>e(t)))}forEachInBounds(e,t){this._boundsStore.forEachInBounds(e,(e=>{t(this._featuresById.get(e))}))}startMarkingUsedFeatures(){this._boundsStore.invalidateIndex(),this._markedIds.clear()}sweep(){let e=!1;this._featuresById.forEach(((t,i)=>{this._markedIds.has(i)||(e=!0,this._remove(t))})),this._markedIds.clear(),e&&this._emitChanged()}_emitChanged(){this.events.emit("changed",void 0)}_add(e){if(!e)return;const t=e.objectId;if(null==t)return void r.Z.getLogger("esri.layers.graphics.data.FeatureStore").error(new n.Z("featurestore:invalid-feature","feature id is missing",{feature:e}));const i=this._featuresById.get(t);let o;if(this._markedIds.add(t),i?(e.displayId=i.displayId,o=this._boundsStore.get(t),this._boundsStore.delete(t)):(0,s.pC)(this.onFeatureAdd)&&this.onFeatureAdd(e),!e.geometry||!e.geometry.coords||!e.geometry.coords.length)return this._boundsStore.set(t,null),void this._featuresById.set(t,e);o=(0,d.$)(o||(0,a.Ue)(),e.geometry,this.geometryInfo.hasZ,this.geometryInfo.hasM),this._boundsStore.set(t,o),this._featuresById.set(t,e)}_remove(e){return(0,s.pC)(this.onFeatureRemove)&&this.onFeatureRemove(e),this._markedIds.delete(e.objectId),this._boundsStore.delete(e.objectId),this._featuresById.delete(e.objectId),e}}},99322:(e,t,i)=>{"use strict";i.d(t,{ZP:()=>u,JN:()=>l,$o:()=>p});var s=i(56140),r=(i(95830),i(36544)),n=(i(68055),i(79881)),o=i(87566),a=(i(10923),i(57002),i(86035),i(28293)),h=i(32105),d=i(15988);const c=a.Z.ofType(d.default);r.Z.getLogger("esri.support.GraphicsCollection");let l=class extends c{constructor(e){super(e),this.on("before-add",(e=>{e.item||e.preventDefault()})),this.on("after-add",(e=>this._own(e.item))),this.on("after-remove",(({item:e})=>{e.layer=null}))}destroy(){this._unownAll()}get owner(){return this._get("owner")}set owner(e){e!==this._get("owner")&&(this._unownAll(),this._set("owner",e),this._ownAll())}_createNewInstance(e){return new c(e)}_ownAll(){this.items.forEach((e=>this._own(e)))}_own(e){e.layer&&"remove"in e.layer&&e.layer!==this.owner&&e.layer.remove(e),e.layer=this.owner}_unownAll(){this.items.forEach((e=>this._unown(e)))}_unown(e){e.layer===this.owner&&(e.layer=null)}};(0,s._)([(0,n.Cb)()],l.prototype,"owner",null),l=(0,s._)([(0,o.j)("esri.support.GraphicsCollection")],l);const p=(e="graphics")=>({type:l,cast:h.R,set(t){const i=(0,h.Z)(t,this._get(e),l);i.owner=this,this._set(e,i)}});const u=l},92078:(e,t,i)=>{"use strict";i.d(t,{n:()=>h});var s=i(59472),r=i(39105),n=i(73321),o=i(53640),a=i(49659);class h{constructor(){this.next=new o.hM}createSnapDragEventPipelineStep({predicate:e=(()=>!0),cancel:t,snappingManager:i,snappingContext:h}){let d=null,c=null;const l=()=>{d=(0,s.IM)(d),i.doneSnapping(),c=null};return t.next((e=>(l(),e))),this.next=new o.hM,t=>{if(!e(t))return t;if(d=(0,s.IM)(d),"start"===t.action&&(c={context:new a.N({geometry:h.geometry,elevationInfo:h.elevationInfo,pointer:h.pointer,vertexHandle:(0,s.pC)(t.info)?t.info.handle:null}),originalPos:(0,s.pC)(t.info)?h.coordinateHelper.createDehydratedPoint(t.info.handle.pos):t.mapStart}),(0,s.pC)(c)){const e=c.context.coordinateHelper.createDehydratedPoint(c.context.coordinateHelper.fromArray([c.originalPos.x,c.originalPos.y,c.originalPos.z]));e.x+=t.mapEnd.x-t.mapStart.x,e.y+=t.mapEnd.y-t.mapStart.y;const s=t.mapStart.x-c.originalPos.x,o=t.mapStart.y-c.originalPos.y,a={...t},h=c.context,l=i.update(e,c.context);t.mapEnd.x=l.x+s,t.mapEnd.y=l.y+o,d=(0,r.createTask)((async t=>{const r=await i.snap(e,h,t);if(r.valid){const e=r.apply();a.mapEnd.x=e.x+s,a.mapEnd.y=e.y+o,(0,n.k)(e,l)||this.next.execute(a)}}))}return"end"===t.action&&l(),t}}}},88958:(e,t,i)=>{"use strict";i.d(t,{w:()=>b});var s=i(56140),r=(i(95830),i(59472)),n=(i(36544),i(68055),i(79881),i(87566)),o=(i(10923),i(57002),i(86035),i(39105)),a=i(61106),h=(i(36348),i(35470)),d=i(96071),c=i(59691),l=i(80621),p=i(73321),u=i(42039),v=i(97450),g=i(46896),m=i(80532),f=i(53640),_=i(49659),y=i(92078);class w{constructor({grabbableForEvent:e}){this.events=new h.Z,this.interactive=!0,this.selectable=!1,this.cursor=null,this.grabbable=!0,this.grabbableForEvent=e}intersectionDistance(e,t){return 0}attach(){}detach(){}}var x=i(84678),C=i(636);let b=class extends h.Z{constructor(e){super(),this._manipulator=null,this._stagedVertex=null,this.geometryType=null,this.elevationInfo=null,this.snapToSceneEnabled=null,this._handles=new c.Z,this._defaultZ=0,this._elevationDrawSurface=null,this._snappingDrawSurface=null,this._snappingEnabled=!1,this._snappingPipeline=new y.n,this._createOperationCompleted=!1,this._pointerDownStates=new Set,this._snappingTask=null,this.view=e.view,this.drawingMode=(0,r.Pt)(e.drawingMode,C.n),this.geometryType=e.geometryType,this.elevationInfo=e.elevationInfo,this.coordinateHelper=(0,u.Y6)(e.hasZ,e.hasM,this.view.spatialReference,this.view.viewingMode),this._defaultZ=e.defaultZ,this.snapToSceneEnabled=e.snapToSceneEnabled,this._snappingManager=new m.N({view:this.view,options:e.snappingOptions,visualizer:e.snappingVisualizer}),this._snappingEnabled=e.snappingOptions.selfEnabled,this._handles.add((0,l.watch)(e.snappingOptions,"selfEnabled",(()=>{this._snappingEnabled=e.snappingOptions.selfEnabled}))),this._snappingDrawSurface=(0,r.Wg)(e.snappingDrawSurface),this._elevationDrawSurface=new x.a(this.elevationInfo,this._defaultZ,this.view),this._editGeometry=new g.hE(new v.XE(this.coordinateHelper),"segment"===this.geometryType?"polyline":this.geometryType),this._activeComponent=new v.wA(this._editGeometry.editGeometry),this._editGeometry.editGeometry.components.push(this._activeComponent),this._editGeometry.on(["vertex-add","vertex-update","vertex-remove"],(e=>{const t=e.vertices.map((e=>({componentIndex:0,vertexIndex:e.index,coordinates:this.coordinateHelper.toArray(e.pos)}))),i=t.map((e=>e.coordinates));switch(e.type){case"vertex-add":this.emit(e.type,{...e,added:i,vertices:t});break;case"vertex-update":this.emit(e.type,{...e,updated:i,vertices:t});break;case"vertex-remove":this.emit(e.type,{...e,removed:i,vertices:t})}})),this._manipulator=new w({grabbableForEvent:e=>"click"!==this.drawingMode||"touch"===e.pointerType&&this._snappingEnabled&&1===this._pointerDownStates.size}),e.manipulators.add(this._manipulator),this._manipulator.grabbable="point"!==this.geometryType;const t=this.createManipulatorDragPipeline(this._manipulator),i=this._manipulator.events.on("immediate-double-click",(e=>{this._manipulator.dragging||"point"===this.geometryType||(this.complete(),e.stopPropagation())})),s=this._manipulator.events.on("immediate-click",(e=>{if(this._manipulator.dragging)return;const t=this._activeComponent,i=this._closeOnClickVertexIndex(e.screenPoint);if((0,r.pC)(i))this.discardStagedVertex(),this.complete();else{const i=this._screenToMap(e.screenPoint);if((0,r.pC)(i))switch(this.drawingMode){case"freehand":break;case"click":case"hybrid":this._snappingTask=(0,r.IM)(this._snappingTask),this.hasStagedVertex?this.commitStagedVertex():this._editGeometry.appendVertex(this.coordinateHelper.fromPoint(i)),("point"===this.geometryType||"segment"===this.geometryType&&2===t.vertices.length||"segment"===this.geometryType&&"hybrid"===this.drawingMode&&1===t.vertices.length)&&this.complete()}}e.stopPropagation()}));this._handles.add([t,s,i])}get isCompleted(){return this._createOperationCompleted}createManipulatorDragPipeline(e){switch(this.drawingMode){case"click":return this.createManipulatorDragPipelineClick(e);case"freehand":return this.createManipulatorDragPipelineFreehand(e);case"hybrid":return this.createManipulatorDragPipelineHybrid(e)}}createManipulatorDragPipelineClick(e){return(0,f.Xd)(e,((e,t,i,s)=>{const r="touch"===s&&this._snappingEnabled;!this.isCompleted&&r&&(t.next(this._screenToMapDragEventStep()).next((e=>("start"===e.action&&(this.stagedVertex=e.mapStart,("segment"===this.geometryType||r&&0===this.vertices.length)&&this.commitStagedVertex()),{...e,info:null}))).next(this._snappingPipeline.createSnapDragEventPipelineStep({predicate:()=>r,cancel:i,snappingManager:this._snappingManager,snappingContext:new _.N({geometry:this._editGeometry,elevationInfo:this.elevationInfo,pointer:s})}),this._snappingPipeline.next).next((e=>(r&&(this.stagedVertex=e.mapEnd,"end"===e.action&&this.commitStagedVertex()),e))).next((e=>("end"===e.action&&("segment"!==this.geometryType&&"point"!==this.geometryType||this.complete()),e))),i.next((()=>{r&&this._snappingManager.doneSnapping()})))}))}createManipulatorDragPipelineFreehand(e){return(0,f.Xd)(e,((e,t)=>{this.isCompleted||t.next(this._screenToMapDragEventStep()).next((e=>("start"===e.action&&(this.stagedVertex=e.mapStart,"segment"===this.geometryType&&this.commitStagedVertex()),e))).next((e=>{switch(e.action){case"start":case"update":this.stagedVertex=e.mapEnd,"polygon"!==this.geometryType&&"polyline"!==this.geometryType||this.commitStagedVertex();break;case"end":this.complete()}return e}))}))}createManipulatorDragPipelineHybrid(e){return(0,f.Xd)(e,((e,t)=>{this.isCompleted||t.next(this._screenToMapDragEventStep()).next((e=>("start"===e.action&&(this.stagedVertex=e.mapStart,this.commitStagedVertex()),e))).next((e=>{switch(e.action){case"start":case"update":this.stagedVertex=e.mapEnd,"polygon"!==this.geometryType&&"polyline"!==this.geometryType||this.commitStagedVertex();break;case"end":"segment"!==this.geometryType&&"point"!==this.geometryType||this.complete()}return e}))}))}destroy(){this._handles.destroy(),this._handles=null}onInputEvent(e){switch(e.type){case"pointer-down":this._pointerDownStates.add(e.pointerId);break;case"pointer-up":this._pointerDownStates.delete(e.pointerId)}switch(e.type){case"pointer-move":return this._onPointerMove(e);case"hold":return this._onHold(e)}}get canRedo(){return this._editGeometry.canRedo}redo(){this._editGeometry.redo()}get canUndo(){return this._editGeometry.canUndo}undo(){this._snappingManager.doneSnapping(),this._editGeometry.undo()}complete(e=!1){(0,r.IM)(this._snappingTask),this.commitStagedVertex(),this._createOperationCompleted=!0,this._snappingManager.doneSnapping(),this.emit("complete",{vertices:this.vertices.map(((e,t)=>({componentIndex:0,vertexIndex:t,coordinates:e}))),aborted:e,type:"complete"})}cancel(){this.complete(!0)}get interactive(){return this._manipulator.interactive}set interactive(e){this._manipulator.interactive=e}get numVertices(){return(0,r.pC)(this._stagedVertex)?this._activeComponent.vertices.length+1:this._activeComponent.vertices.length}get numCommittedVertices(){return this._activeComponent.vertices.length}get vertices(){const e=this._activeComponent.vertices.map((e=>this.coordinateHelper.toArray(e.pos)));return(0,r.pC)(this._stagedVertex)&&e.push(this.coordinateHelper.pointToArray(this._stagedVertex)),e}get spatialReference(){return this.view.spatialReference}get hasStagedVertex(){return(0,r.pC)(this._stagedVertex)}get stagedVertex(){return this._stagedVertex}set stagedVertex(e){if((0,r.Wi)(e))return void this.discardStagedVertex();if((0,r.pC)(this._stagedVertex)&&(0,p.k)(this._stagedVertex,e))return;this._stagedVertex=e;const t={componentIndex:0,vertexIndex:this._activeComponent.vertices.length,coordinates:this.coordinateHelper.pointToArray(e)};this.emit("cursor-update",{updated:null,vertices:[t],operation:"apply",type:"vertex-update"})}commitStagedVertex(){if(this._snappingTask=(0,r.IM)(this._snappingTask),(0,r.pC)(this._stagedVertex)){const e=this._stagedVertex;this._stagedVertex=null,this._editGeometry.appendVertex(this.coordinateHelper.fromPoint(e))}}discardStagedVertex(){this._stagedVertex=null}_onPointerMove(e){if((0,r.IM)(this._snappingTask),this._manipulator.dragging||this._pointerDownStates.has(e.pointerId)||this._manipulator.grabbing||!this._manipulator.interactive)return;const t=(0,d.vW)(e.x,e.y),i=this._closeOnClickVertexIndex(t);if((0,r.pC)(i)){this.discardStagedVertex();const e={componentIndex:0,vertexIndex:i,coordinates:this.coordinateHelper.toArray(this._activeComponent.vertices[i].pos)};this.emit("cursor-update",{updated:null,vertices:[e],operation:"apply",type:"vertex-update"})}else{const i=this._screenToMap(t);if(this._manipulator.cursor=(0,r.pC)(i)?"crosshair":null,(0,r.pC)(i)){const t=new _.N({geometry:this._editGeometry,elevationInfo:this.elevationInfo,pointer:e.pointerType});this.stagedVertex=this._snappingManager.update(i,t),this._snappingTask=(0,o.createTask)((async e=>{const s=await this._snappingManager.snap(i,t,e);s.valid&&(this.stagedVertex=s.apply())}))}}e.stopPropagation()}_onHold(e){(0,r.IM)(this._snappingTask),"click"===this.drawingMode&&"touch"===e.pointerType&&this._snappingEnabled&&(this.stagedVertex=e.mapPoint),e.stopPropagation()}_screenToMapDragEventStep(){let e=null;return t=>{if("start"===t.action&&(e=this._screenToMap(t.screenStart)),(0,r.Wi)(e))return null;const i=this._screenToMap(t.screenEnd);return(0,r.pC)(i)?{...t,mapStart:e,mapEnd:i}:null}}_screenToMap(e){return this._getDrawSurface().screenToMap(e)}_mapToScreen(e){return this._getDrawSurface().mapToScreen(e)}_getDrawSurface(){let e=null;if(this.coordinateHelper.hasZ){let t=this._defaultZ,i=!1;(0,r.pC)(this.elevationInfo)&&"absolute-height"===this.elevationInfo.mode&&(i=!0),(0,r.pC)(this.snapToSceneEnabled)&&(i=this.snapToSceneEnabled),(0,r.pC)(this.elevationInfo)&&"on-the-ground"===this.elevationInfo.mode&&(i=!1);const s=this._activeComponent.vertices.length;("segment"===this.geometryType||"polygon"===this.geometryType)&&s>0&&(t=this.coordinateHelper.getZ(this._activeComponent.vertices[0].pos),i=!1),i?e=this._snappingDrawSurface:(this._elevationDrawSurface.defaultZ=t,e=this._elevationDrawSurface)}else this._elevationDrawSurface.defaultZ=null,e=this._elevationDrawSurface;return e}_vertexWithinPointerDistance(e,t){const i=this._mapToScreen(e);return!!(0,r.pC)(i)&&function(e,t,i){const s=e.x-t.x,r=e.y-t.y;return s*s+r*r<=i}(i,t,25)}_closeOnClickVertexIndex(e){const t=this._activeComponent;if("polygon"===this.geometryType&&t.vertices.length>2){if(this._vertexWithinPointerDistance(this.coordinateHelper.toPoint(t.vertices[0].pos,T),e))return 0;if(this._vertexWithinPointerDistance(this.coordinateHelper.toPoint(t.vertices[t.vertices.length-1].pos,T),e))return t.vertices.length-1}return null}};b=(0,s._)([(0,n.j)("esri.views.3d.interactive.editingTools.draw3D.DrawOperation")],b);const T=new a.Z({x:0,y:0,z:0})},84678:(e,t,i)=>{"use strict";i.d(t,{a:()=>a,i:()=>h});var s=i(59472),r=i(96071),n=i(45201),o=i(46970);class a{constructor(e,t,i){this.elevationInfo=e,this.defaultZ=t,this.view=i}screenToMap(e){if((0,s.pC)(this.defaultZ))return this.view.sceneIntersectionHelper.intersectElevationFromScreen((0,r.s1)(e.x,e.y),this.elevationInfo,this.defaultZ);const t=this.view.sceneIntersectionHelper.intersectElevationFromScreen((0,r.s1)(e.x,e.y),this.elevationInfo,0);return(0,s.pC)(t)&&(t.z=void 0),t}mapToScreen(e){const t=(0,n.Tx)(e.x,e.y,(0,o.vQ)(this.view,e,this.elevationInfo),e.spatialReference);return this.view.toScreen(t)}}class h{constructor(e,t,i=[]){this.view=e,this.elevationInfo=t,this.exclude=i}screenToMap(e){const t=this.view.toMap(e,{exclude:this.exclude});return(0,s.pC)(t)&&(t.z=(0,o.Ou)(t,this.view,this.elevationInfo)),t}mapToScreen(e){let t=e;return(0,s.pC)(this.elevationInfo)&&(t=(0,n.Tx)(e.x,e.y,(0,o.vQ)(this.view,e,this.elevationInfo),e.spatialReference)),this.view.toScreen(t)}}},70573:(e,t,i)=>{"use strict";i.d(t,{Z:()=>B});var s=i(56140),r=(i(95830),i(36544)),n=(i(68055),i(79881)),o=i(87566),a=(i(10923),i(57002),i(86035),i(82677)),h=i(59472),d=i(59691),c=i(69948),l=i(2887),p=i(35470),u=i(96071),v=i(42039),g=i(97450),m=i(46896),f=i(9434),_=i(80532);let y=class extends p.Z.EventedAccessor{constructor(e){var t,i;super(e),this._hasZ=null,this._stagedVertex=null,this._nativeEventHistory={undoStack:[],redoStack:[]},this.interactiveUndoDisabled=!1,this.history=[],this.redoHistory=[],this.snapToScene=!1,this.view=null,this.elevationInfo=null,this.defaultZ=0,this.enableWithinFeatureSnapping=!1,this._coordinateHelper=(0,v.Y6)(e.hasZ,!1,e.view.spatialReference,"local"),this.snappingManager=new _.N({view:e.view,options:new f.g({selfEnabled:null!=(t=e.enableWithinFeatureSnapping)&&t})}),this._editGeometry=new m.hE(new g.XE(this._coordinateHelper),null!=(i=e.editGeometryType)?i:"polygon"),this._activeComponent=new g.wA(this._editGeometry.editGeometry),this._editGeometry.editGeometry.components.push(this._activeComponent)}get _committedVertices(){return this._editGeometry.editGeometry.components[0].vertices.map((e=>e.pos))}get vertices(){return(0,h.pC)(this._stagedVertex)?[...this._committedVertices,this._stagedVertex]:this._committedVertices}get hasZ(){return(0,h.pC)(this._hasZ)?this._hasZ:"3d"===this.view.type}set hasZ(e){this._hasZ=e,this.notifyChange("hasZ")}canUndo(){return this._editGeometry.editGeometry.canUndo}canRedo(){return this._editGeometry.editGeometry.canRedo}undo(){this.canUndo()&&this._editGeometry.undo()}redo(){this.canRedo()&&this._editGeometry.redo()}getCoordsFromScreenPoint(e){const t=this.screenToMap(e);return(0,h.pC)(t)?t.hasZ?[t.x,t.y,t.z]:[t.x,t.y]:null}getCoordsAndPointFromScreenPoint(e){const t=this.screenToMap(e);return(0,h.pC)(t)?t.hasZ?{vertex:[t.x,t.y,t.z],mapPoint:t}:{vertex:[t.x,t.y],mapPoint:t}:null}isDuplicateVertex(e,t){if(e.length){const[i,s]=e[e.length-1];return i===t[0]&&s===t[1]}return!1}getGeometryZValue(){return this.defaultZ}screenToMap(e){let t=null;if("3d"===this.view.type)if(this.hasZ){const i=(0,h.Pt)(this.elevationInfo,w);t=this.view.sceneIntersectionHelper.intersectElevationFromScreen((0,u.s1)(e.x,e.y),i,this.getGeometryZValue())}else{const i=(0,h.Pt)(this.elevationInfo,x);t=this.view.sceneIntersectionHelper.intersectElevationFromScreen((0,u.s1)(e.x,e.y),i,0),(0,h.pC)(t)&&(t.z=void 0)}else t=this.view.toMap(e),(0,h.pC)(t)&&(t.z=this.hasZ?this.getGeometryZValue():void 0);return t}};(0,s._)([(0,n.Cb)({readOnly:!0})],y.prototype,"vertices",null),(0,s._)([(0,n.Cb)({type:Boolean,nonNullable:!0})],y.prototype,"interactiveUndoDisabled",void 0),(0,s._)([(0,n.Cb)({readOnly:!0})],y.prototype,"history",void 0),(0,s._)([(0,n.Cb)({readOnly:!0})],y.prototype,"redoHistory",void 0),(0,s._)([(0,n.Cb)()],y.prototype,"snapToScene",void 0),(0,s._)([(0,n.Cb)()],y.prototype,"view",void 0),(0,s._)([(0,n.Cb)()],y.prototype,"elevationInfo",void 0),(0,s._)([(0,n.Cb)({nonNullable:!0})],y.prototype,"defaultZ",void 0),(0,s._)([(0,n.Cb)()],y.prototype,"hasZ",null),(0,s._)([(0,n.Cb)()],y.prototype,"enableWithinFeatureSnapping",void 0),(0,s._)([(0,n.Cb)()],y.prototype,"snappingManager",void 0),y=(0,s._)([(0,o.j)("esri.views.draw.DrawAction")],y);const w={mode:"absolute-height",offset:0},x={mode:"on-the-ground",offset:0};const C=y;class b{constructor(e,t,i,s){this.view=e,this.native=t,this.vertexIndex=i,this.vertices=s,this.defaultPrevented=!1,this.type="vertex-add"}preventDefault(){this.defaultPrevented=!0}}class T{constructor(e,t,i,s){this.view=e,this.native=t,this.vertexIndex=i,this.vertices=s,this.defaultPrevented=!1,this.type="vertex-update"}preventDefault(){this.defaultPrevented=!0}}class S{constructor(e,t,i,s){this.view=e,this.native=t,this.vertexIndex=i,this.vertices=s,this.defaultPrevented=!1,this.type="vertex-remove"}preventDefault(){this.defaultPrevented=!0}}class P{constructor(e,t,i,s,r=null){this.view=e,this.native=t,this.vertexIndex=i,this.vertices=s,this.mapPoint=r,this.coordinates=null,this.defaultPrevented=!1,this.type="cursor-update",this.coordinates=1===s.length?s[0]:null}preventDefault(){this.defaultPrevented=!0}}class V{constructor(e,t){this.native=e,this.vertices=t,this.coordinates=null,this.defaultPrevented=!1,this.type="draw-complete",this.coordinates=1===t.length?t[0]:null}preventDefault(){this.defaultPrevented=!0}}const H="c",E="r",I="z",M="f",O=" ";let k=class extends C{constructor(){super(...arguments),this._cursorMoved=!1,this._popVertexOnPointerMove=!1,this._cursorScreenPoint=null,this._dragEnabled=!0,this._pointerDownEvent=null,this._viewHandles=new d.Z,this._undoRedoHandles=new d.Z}initialize(){this._addViewHandles(),this._addUndoRedoHandles()}destroy(){this._removeViewHandles(),this._viewHandles.destroy(),this._removeUndoRedoHandles(),this._undoRedoHandles.destroy(),this.emit("destroy")}addVertex(e,t){isNaN(t)?(t=this.vertices.length,this.vertices.push(e)):this.vertices.splice(t,0,e);const i={vertex:e,vertexIndex:t,undo:()=>this._undoVertexAdd(null,t),redo:()=>this._redoVertexAdd(null,e,t)};this.history.push(i),this._set("redoHistory",[]);const s=new b(this.view,null,t,this.vertices);this.emit("vertex-add",s),s.defaultPrevented&&(this._cursorMoved=!0,this.history.pop())}removeVertex(e){const t=this.vertices.splice(e,1)[0],i={vertex:t,vertexIndex:e,undo:()=>this._undoVertexRemove(null,t,e),redo:()=>this._redoVertexRemove(null,e)};this.history.push(i),this._set("redoHistory",[]),this.emit("vertex-remove",new S(this.view,null,e,this.vertices))}updateVertex(e,t){const i=this.vertices[t];this.vertices[t]=e;const s={vertex:e,vertexIndex:t,undo:()=>this._undoVertexUpdate(null,i,t),redo:()=>this._redoVertexUpdate(null,e,t)};this.history.push(s),this._set("redoHistory",[]),this.emit("vertex-update",new T(this.view,null,t,this.vertices))}complete(){this._completeDrawing()}_addViewHandles(){this._removeViewHandles(),this._viewHandles.add([this.view.on("click",(e=>{e.stopPropagation()}),c.f.TOOL),this.view.on("pointer-down",(e=>{this._cursorMoved&&this.vertices.pop(),this._pointerDownEvent=e,this._cursorMoved=!1,this._cursorScreenPoint=(0,l.vT)(e)}),c.f.TOOL),this.view.on("pointer-move",(e=>{this._cursorMoved&&(this.undo(),this.vertices.pop()),this._popVertexOnPointerMove&&(this._editGeometry.editGeometry.undo(),this._popVertexOnPointerMove=!1),this._cursorMoved=!0,this._cursorScreenPoint=(0,l.vT)(e),this._cursorUpdateHandler(e)}),c.f.TOOL),this.view.on("pointer-up",(e=>{if(this._pointerDownEvent){if(this._cursorMoved)return this.vertices.pop(),void(this._cursorMoved=!1);this._pointerDownEvent=null,this._vertexAddHandler(e)}}),c.f.TOOL),this.view.on("drag",(e=>{this._dragEnabled&&this._pointerDownEvent&&e.stopPropagation()}),c.f.TOOL),this.view.on("drag",["Shift"],(e=>{e.stopPropagation()}),c.f.TOOL),this.view.on("double-click",(e=>{e.stopPropagation(),this._drawCompleteHandler(e)}),c.f.TOOL),this.view.on("double-click",["Control"],(e=>{e.stopPropagation(),this._drawCompleteHandler(e)}),c.f.TOOL),this.view.on("key-down",(e=>{e.key===M&&!e.repeat&&this._cursorScreenPoint?(this._cursorMoved&&(this.vertices.pop(),this._cursorMoved=!1),this._vertexAddHandler(e)):e.key===H&&!e.repeat&&this._cursorScreenPoint?(this._cursorMoved&&(this.vertices.pop(),this._cursorMoved=!1),this._vertexAddHandler(e),this._drawCompleteHandler(e)):e.key!==I||this.interactiveUndoDisabled||e.repeat?e.key!==E||this.interactiveUndoDisabled||e.repeat||(e.stopPropagation(),this.redo()):(e.stopPropagation(),this.undo())}),c.f.TOOL)])}_addUndoRedoHandles(){this._removeUndoRedoHandles(),this._undoRedoHandles.add([this._editGeometry.on("vertex-remove",(e=>{if(this.notifyChange("vertices"),"undo"===e.operation){const t=this._nativeEventHistory.undoStack.pop();this._nativeEventHistory.redoStack.push(t);const i=[...this._committedVertices];(0,h.pC)(this._stagedVertex)&&i.push(this._coordinateHelper.toArray(this._stagedVertex)),this.emit("undo",new S(this.view,t,e.vertices[0].index,i))}})),this._editGeometry.on("vertex-add",(e=>{if(this.notifyChange("vertices"),"apply"===e.operation){const e=this._nativeEventHistory.undoStack[this._nativeEventHistory.undoStack.length],t=this._committedVertices.length-1,i=new b(this.view,e,t,this.vertices);this.emit("vertex-add",i),i.defaultPrevented&&(this._popVertexOnPointerMove=!0)}else if("redo"===e.operation){const t=this._nativeEventHistory.redoStack.pop();this._nativeEventHistory.undoStack.push(t);const i=[...this._committedVertices];(0,h.pC)(this._stagedVertex)&&i.push(this._coordinateHelper.toArray(this._stagedVertex)),this.emit("redo",new b(this.view,t,e.vertices[0].index,i))}}))])}_removeViewHandles(){this._viewHandles.removeAll()}_removeUndoRedoHandles(){this._undoRedoHandles.removeAll()}_addVertex(e,t){const i=this._coordinateHelper.fromArray(e);this._editGeometry.appendVertex(i);const s=t||new Event("placeholder");this._nativeEventHistory.undoStack.push(s)}_updateCursor(e,t){this.vertices.push(e);const i=this.vertices.indexOf(e),s=new P(this.view,t,i,this.vertices);this.emit("cursor-update",s)}_completeDrawing(e){if(this._cursorMoved=!1,this._pointerDownEvent=null,this.vertices.length<1)return;const t=new V(e,this.vertices);this.emit("draw-complete",t),t.defaultPrevented?this._cursorMoved=!0:this._removeViewHandles()}_undoVertexAdd(e,t){this.vertices.splice(t,1),this.emit("undo",new S(this.view,e,t,this.vertices))}_redoVertexAdd(e,t,i){this.vertices.splice(i,0,t),this.emit("redo",new b(this.view,e,i,this.vertices))}_undoVertexRemove(e,t,i){this.vertices.splice(i,0,t),this.emit("undo",new b(this.view,e,i,this.vertices))}_redoVertexRemove(e,t){this.vertices.splice(t,1),this.emit("redo",new S(this.view,e,t,this.vertices))}_undoVertexUpdate(e,t,i){this.vertices[i]=t,this.emit("undo",new T(this.view,e,i,this.vertices))}_redoVertexUpdate(e,t,i){this.vertices[i]=t,this.emit("redo",new T(this.view,e,i,this.vertices))}_vertexAddHandler(e){const t=this.getCoordsFromScreenPoint(this._cursorScreenPoint);(0,h.pC)(t)&&this._addVertex(t,e.native)}_cursorUpdateHandler(e){const t=this.getCoordsFromScreenPoint(this._cursorScreenPoint);(0,h.pC)(t)&&this._updateCursor(t,e.native)}_drawCompleteHandler(e){this._completeDrawing(e.native)}};k=(0,s._)([(0,o.j)("esri.views.draw.MultipointDrawAction")],k);Object.freeze({__proto__:null,get MultipointDrawAction(){return k}});var D=i(87765),R=i(94535),A=i(84678),Z=i(88958),L=i(76916);let G=class extends(p.Z.EventedMixin(L.m)){constructor(e){super(e),this.drawOperation=null,this.hasZ=!0,this.defaultZ=0,this.elevationInfo=null,this.snapToScene=null,this.snappingOptions=new f.g,this.mode=null,this.geometryType=null,this.type="draw-3d"}initialize(){const e=(0,h.Pt)(this.elevationInfo,{mode:this.hasZ?"absolute-height":"on-the-ground",offset:0});this.drawOperation=new Z.w({view:this.view,manipulators:this.manipulators,geometryType:this.geometryType,drawingMode:this.mode,hasZ:this.hasZ,defaultZ:this.defaultZ,snapToSceneEnabled:this.snapToScene,snappingDrawSurface:new A.i(this.view,e),hasM:!1,elevationInfo:e,snappingOptions:this.snappingOptions}),this.drawOperation.on("vertex-add",(e=>this.onVertexAdd(e))),this.drawOperation.on("vertex-remove",(e=>this.onVertexRemove(e))),this.drawOperation.on("vertex-update",(e=>this.onVertexUpdate(e))),this.drawOperation.on("cursor-update",(e=>this.onCursorUpdate(e))),this.drawOperation.on("complete",(e=>this.onComplete(e)))}destroy(){this.drawOperation.destroy(),this.drawOperation=null,this._set("view",null)}onInputEvent(e){this.drawOperation.onInputEvent(e)}set enabled(e){this.drawOperation.interactive=e,this._set("enabled",e)}reset(){}get canRedo(){return this.drawOperation.canRedo}redo(){this.drawOperation.redo()}get canUndo(){return this.drawOperation.canUndo}undo(){this.drawOperation.undo()}completeCreateOperation(){this.drawOperation.complete()}activate(){}deactivate(){this.drawOperation.isCompleted||this.drawOperation.cancel()}getVertexCoords(){return this.drawOperation.vertices}onVertexAdd(e){this.emit("vertex-add",e)}onVertexRemove(e){this.emit("vertex-remove",e)}onVertexUpdate(e){this.emit("vertex-update",e)}onCursorUpdate(e){this.emit("cursor-update",e)}onComplete(e){this.emit("complete",e)}};(0,s._)([(0,n.Cb)({constructOnly:!0,nonNullable:!0})],G.prototype,"view",void 0),(0,s._)([(0,n.Cb)({value:!0})],G.prototype,"enabled",null),(0,s._)([(0,n.Cb)({constructOnly:!0})],G.prototype,"hasZ",void 0),(0,s._)([(0,n.Cb)({constructOnly:!0,nonNullable:!0})],G.prototype,"defaultZ",void 0),(0,s._)([(0,n.Cb)({constructOnly:!0})],G.prototype,"elevationInfo",void 0),(0,s._)([(0,n.Cb)()],G.prototype,"snapToScene",void 0),(0,s._)([(0,n.Cb)({constructOnly:!0})],G.prototype,"snappingOptions",void 0),(0,s._)([(0,n.Cb)({constructOnly:!0})],G.prototype,"mode",void 0),(0,s._)([(0,n.Cb)({constructOnly:!0})],G.prototype,"geometryType",void 0),(0,s._)([(0,n.Cb)({readOnly:!0})],G.prototype,"type",void 0),G=(0,s._)([(0,o.j)("esri.views.3d.interactive.editingTools.draw.DrawTool")],G);let F=class extends C{constructor(){super(...arguments),this._clickDelay=R.M.maximumClickDelay,this._cursorMoved=!1,this._cursorScreenPoint=null,this._pointerDownEvent=null,this._viewHandles=new d.Z}initialize(){"2d"===this.view.type?this._addViewHandles():this._addDrawTool(this.view)}destroy(){"2d"===this.view.type?(this._removeViewHandles(),this._viewHandles.destroy(),this.emit("destroy")):(this._removeDrawTool(),this.emit("destroy"))}get coordinates(){return(0,D.Mr)(r.Z.getLogger("esri.views.draw.PointDrawAction"),"coordinates",{replacement:"vertices",version:"4.19"}),this.vertices[0]}complete(){if("2d"===this.view.type){if(this._cursorScreenPoint){const e=this.getCoordsFromScreenPoint(this._cursorScreenPoint);(0,h.pC)(e)&&(this._set("coordinates",e),this._appendEditGeometryVertex(e),this._completeDrawing())}}else this._drawTool.completeCreateOperation()}_addViewHandles(){this._removeViewHandles(),this._viewHandles.add([this.view.on("click",(e=>{e.stopPropagation();const t=this.getCoordsFromScreenPoint(e.screenPoint);(0,h.pC)(t)&&(this._appendEditGeometryVertex(t),this._drawCompleteHandler(e))}),c.f.TOOL),this.view.on("pointer-down",(e=>{this._pointerDownEvent=e,this._cursorMoved=!1}),c.f.TOOL),this.view.on("pointer-move",(e=>{this._cursorMoved=!0,this._cursorScreenPoint=(0,l.vT)(e),this._cursorUpdateHandler(e)}),c.f.TOOL),this.view.on("pointer-up",(e=>{if(this._pointerDownEvent&&!this._cursorMoved&&e.timestamp-this._pointerDownEvent.timestamp>this._clickDelay){this._cursorScreenPoint=(0,l.vT)(e);const t=this.getCoordsFromScreenPoint(this._cursorScreenPoint);(0,h.pC)(t)&&(this._appendEditGeometryVertex(t),this._drawCompleteHandler(e))}}),c.f.TOOL),this.view.on("key-down",(e=>{if(e.key===H&&this._cursorScreenPoint){const t=this.getCoordsFromScreenPoint(this._cursorScreenPoint);(0,h.pC)(t)&&(this._appendEditGeometryVertex(t),this._drawCompleteHandler(e))}}),c.f.TOOL)])}_removeViewHandles(){this._viewHandles.removeAll()}_addDrawTool(e){this._drawTool=new G({view:e,elevationInfo:this.elevationInfo,hasZ:this.hasZ,geometryType:"point",mode:"click"}),this.view.toolViewManager.tools.push(this._drawTool),this.view.activeTool=this._drawTool,this._drawTool.on("cursor-update",(e=>{1===e.vertices.length&&this.emit("cursor-update",new P(this.view,null,e.vertices[0].vertexIndex,this._drawTool.getVertexCoords()))})),this._drawTool.on("complete",(e=>{this.emit("draw-complete",new V(null,this._drawTool.getVertexCoords())),this._removeDrawTool()}))}_removeDrawTool(){(0,h.pC)(this._drawTool)&&(this.view.tools.remove(this._drawTool),this._drawTool.destroy(),this._drawTool=null)}_appendEditGeometryVertex(e){this._editGeometry.appendVertex(this._coordinateHelper.fromArray(e))}_updateCursor(e,t){(0,h.pC)(e)?this.emit("cursor-update",new P(this.view,t,0,[e])):this.emit("cursor-update",new P(this.view,t,null,null))}_completeDrawing(e){this._cursorMoved=!1,this._pointerDownEvent=null;const t=new V(e,this.vertices);this.emit("draw-complete",t),t.defaultPrevented||this._removeViewHandles()}_cursorUpdateHandler(e){this._updateCursor(this.getCoordsFromScreenPoint(this._cursorScreenPoint),e.native)}_drawCompleteHandler(e){this._completeDrawing(e.native)}};(0,s._)([(0,n.Cb)({readOnly:!0})],F.prototype,"coordinates",null),F=(0,s._)([(0,o.j)("esri.views.draw.PointDrawAction")],F);var z=i(636);let j=class extends C{constructor(){super(...arguments),this._cursorScreenPoint=null,this._panEnabled=!1,this._cursorVertexAdded=!1,this._popVertexOnPointerMove=!1,this._addVertexOnPointerUp=!1,this._activePointerId=null,this._viewHandles=new d.Z,this._undoRedoHandles=new d.Z,this.mode=z.n}initialize(){"2d"===this.view.type?(this._addViewHandles(),this._addUndoRedoHandles()):this._addDrawTool(this.view)}destroy(){"2d"===this.view.type?(this._removeViewHandles(),this._viewHandles.destroy(),this._removeUndoRedoHandles(),this._undoRedoHandles.destroy()):this._removeDrawTool(),this.emit("destroy")}get _clickEnabled(){return"click"===this.mode||"hybrid"===this.mode}get _dragEnabled(){return"freehand"===this.mode||"hybrid"===this.mode}undo(){super.undo(),this.notifyChange("vertices")}redo(){super.redo(),this.notifyChange("vertices")}addVertex(e,t){this.vertices.splice(t,0,e);const i={vertex:e,vertexIndex:t,undo:()=>this._undoVertexAdd(null,t),redo:()=>this._redoVertexAdd(null,t)};this.history.push(i),this._set("redoHistory",[]);const s=new b(this.view,null,t,this.vertices);this.emit("vertex-add",s),s.defaultPrevented&&(this._popVertexOnPointerMove=!0)}removeVertex(e){const t={vertex:this.vertices.splice(e,1)[0],vertexIndex:e,undo:()=>this._undoVertexRemove(null,e),redo:()=>this._redoVertexRemove(null,e)};this.history.push(t),this._set("redoHistory",[]),this.emit("vertex-remove",new S(this.view,null,e,this.vertices))}updateVertex(e,t){this.vertices[t]=e;const i={vertex:e,vertexIndex:t,undo:()=>this._undoVertexUpdate(null,t),redo:()=>this._redoVertexUpdate(null,t)};this.history.push(i),this._set("redoHistory",[]),this.emit("vertex-update",new T(this.view,null,t,this.vertices))}complete(){"2d"===this.view.type?this._completeDrawing():this._drawTool.completeCreateOperation()}getGeometryZValue(){return this.vertices.length>0&&this.vertices[0].length>2?this.vertices[0][2]:this._get("defaultZ")}_addViewHandles(){this._removeViewHandles(),this._viewHandles.add([this.view.on("click",(e=>{e.stopPropagation()}),c.f.TOOL),this.view.on("pointer-down",(e=>{this._shouldHandlePointerEvent(e)&&!this._panEnabled&&(this._activePointerId=e.pointerId,this._addVertexOnPointerUp=!0,this._cursorScreenPoint=(0,l.vT)(e),"touch"===e.pointerType&&this._updateCursor(e.native))}),c.f.TOOL),this.view.on("pointer-move",(e=>{this._popVertexOnPointerMove&&(this.undo(),this._popVertexOnPointerMove=!1),this._cursorScreenPoint=(0,l.vT)(e),"touch"!==e.pointerType&&this._updateCursor(e.native)}),c.f.TOOL),this.view.on("pointer-drag",(e=>{this._shouldHandlePointerEvent(e)&&(this._cursorScreenPoint=(0,l.vT)(e),this._dragEnabled&&!this._panEnabled?this._vertexAddHandler(e):this._addVertexOnPointerUp=!1)}),c.f.TOOL),this.view.on("pointer-up",(e=>{if(this._shouldHandlePointerEvent(e))if(this._activePointerId=null,this._addVertexOnPointerUp){if(!this._clickEnabled)return 1===this.vertices.length&&this.vertices.pop(),void this._drawCompleteHandler(e);this._vertexAddHandler(e)}else{const t="touch"===e.pointerType;this._updateCursor(e.native,t)}}),c.f.TOOL),this.view.on("drag",(e=>{this._dragEnabled&&(0,h.pC)(this._activePointerId)&&!this._panEnabled&&e.stopPropagation()}),c.f.TOOL),this.view.on("drag",["Shift"],(e=>{e.stopPropagation()}),c.f.TOOL),this.view.on("double-click",(e=>{e.stopPropagation(),this._drawCompleteHandler(e)}),c.f.TOOL),this.view.on("double-click",["Control"],(e=>{e.stopPropagation(),this._drawCompleteHandler(e)}),c.f.TOOL),this.view.on("key-down",(e=>{const{key:t,repeat:i}=e;t===M&&!i&&this._cursorScreenPoint?(e.stopPropagation(),this._vertexAddHandler(e)):t===H&&!i&&this._cursorScreenPoint&&this.vertices.length>2?(e.stopPropagation(),this._vertexAddHandler(e),this._drawCompleteHandler(e)):t!==I||this.interactiveUndoDisabled||i?t!==E||this.interactiveUndoDisabled||i?t!==O||i||(e.stopPropagation(),this._panEnabled=!0):(e.stopPropagation(),this.redo()):(e.stopPropagation(),this.undo())}),c.f.TOOL),this.view.on("key-up",(e=>{e.key===O&&(e.stopPropagation(),this._panEnabled=!1)}),c.f.TOOL)])}_addUndoRedoHandles(){this._removeUndoRedoHandles(),this._undoRedoHandles.add([this._editGeometry.on("vertex-remove",(e=>{if(this.notifyChange("vertices"),"undo"===e.operation){const t=this._nativeEventHistory.undoStack.pop();this._nativeEventHistory.redoStack.push(t);const i=[...this._committedVertices];(0,h.pC)(this._stagedVertex)&&i.push(this._coordinateHelper.toArray(this._stagedVertex)),this.emit("undo",new S(this.view,t,e.vertices[0].index,i))}})),this._editGeometry.on("vertex-add",(e=>{if(this.notifyChange("vertices"),"apply"===e.operation){const e=this._nativeEventHistory.undoStack[this._nativeEventHistory.undoStack.length],t=this._committedVertices.length-1,i=new b(this.view,e,t,this.vertices);this.emit("vertex-add",i),i.defaultPrevented&&(this._popVertexOnPointerMove=!0)}else if("redo"===e.operation){const t=this._nativeEventHistory.redoStack.pop();this._nativeEventHistory.undoStack.push(t);const i=[...this._committedVertices];(0,h.pC)(this._stagedVertex)&&i.push(this._coordinateHelper.toArray(this._stagedVertex)),this.emit("redo",new b(this.view,t,e.vertices[0].index,i))}}))])}_removeViewHandles(){this._viewHandles.removeAll()}_removeUndoRedoHandles(){this._undoRedoHandles.removeAll()}_addDrawTool(e){this._drawTool=new G({view:e,elevationInfo:this.elevationInfo,hasZ:this.hasZ,geometryType:"polygon",mode:this.mode}),this.view.toolViewManager.tools.push(this._drawTool),this.view.activeTool=this._drawTool,this._drawTool.on("vertex-add",(e=>{1===e.vertices.length&&this.emit("vertex-add",new b(this.view,null,e.vertices[0].vertexIndex,this._drawTool.getVertexCoords()))})),this._drawTool.on("cursor-update",(e=>{1===e.vertices.length&&this.emit("cursor-update",new P(this.view,null,e.vertices[0].vertexIndex,this._drawTool.getVertexCoords()))})),this._drawTool.on("complete",(e=>{this.emit("draw-complete",new V(null,this._drawTool.getVertexCoords())),this._removeDrawTool()}))}_removeDrawTool(){(0,h.pC)(this._drawTool)&&(this.view.tools.remove(this._drawTool),this._drawTool.destroy(),this._drawTool=null)}_addVertex(e,t){if(this._popCursorVertex(),this.isDuplicateVertex(this._committedVertices,e))return;const i=this._coordinateHelper.fromArray(e);this._editGeometry.appendVertex(i);const s=t||new Event("placeholder");this._nativeEventHistory.undoStack.push(s)}_updateCursor(e,t=!1){if(this._popCursorVertex(),!this._cursorScreenPoint)return;let i=null,s=null;const r=this.getCoordsAndPointFromScreenPoint(this._cursorScreenPoint);(0,h.pC)(r)&&(i=r.mapPoint,t||(s=this._pushCursorVertex(r.vertex)));const n=new P(this.view,e,s,this.vertices,i);this.emit("cursor-update",n)}_completeDrawing(e){if(this._activePointerId=null,this._popCursorVertex(),this.vertices.length<3)return;const t=new V(e,this.vertices);this.emit("draw-complete",t),t.defaultPrevented||this._removeViewHandles()}_undoVertexAdd(e,t){this._editGeometry.undo(),this.emit("undo",new S(this.view,e,t,this.vertices))}_redoVertexAdd(e,t){this._editGeometry.redo(),this.emit("redo",new b(this.view,e,t,this.vertices))}_undoVertexRemove(e,t){this._editGeometry.undo(),this.emit("undo",new b(this.view,e,t,this.vertices))}_redoVertexRemove(e,t){this._editGeometry.redo(),this.emit("redo",new S(this.view,e,t,this.vertices))}_undoVertexUpdate(e,t){this._editGeometry.undo(),this.emit("undo",new T(this.view,e,t,this.vertices))}_redoVertexUpdate(e,t){this._editGeometry.redo(),this.emit("redo",new T(this.view,e,t,this.vertices))}_pushCursorVertex(e){return this._stagedVertex=this._coordinateHelper.fromArray(e),this.notifyChange("vertices"),this._cursorVertexAdded=!0,this.vertices.length}_popCursorVertex(){this._cursorVertexAdded&&(this._stagedVertex=null,this.notifyChange("vertices"),this._cursorVertexAdded=!1)}_shouldHandlePointerEvent(e){return function(e){return"mouse"!==e.pointerType||0===e.button}(e)&&((0,h.Wi)(this._activePointerId)||this._activePointerId===e.pointerId)}_vertexAddHandler(e){const t=(0,h.pC)(this._stagedVertex)?this._stagedVertex:this.getCoordsFromScreenPoint(this._cursorScreenPoint);(0,h.pC)(t)&&this._addVertex(t,e.native)}_drawCompleteHandler(e){this._completeDrawing(e.native)}};(0,s._)([(0,n.Cb)()],j.prototype,"_clickEnabled",null),(0,s._)([(0,n.Cb)()],j.prototype,"_dragEnabled",null),(0,s._)([(0,n.Cb)({type:z.A})],j.prototype,"mode",void 0),j=(0,s._)([(0,o.j)("esri.views.draw.PolygonDrawAction")],j);let U=class extends C{constructor(){super(...arguments),this._cursorScreenPoint=null,this._panEnabled=!1,this._cursorVertexAdded=!1,this._popVertexOnPointerMove=!1,this._addVertexOnPointerUp=!1,this._activePointerId=null,this._viewHandles=new d.Z,this._undoRedoHandles=new d.Z,this.mode=z.n}initialize(){"2d"===this.view.type?(this._addViewHandles(),this._addUndoRedoHandles()):this._addDrawTool(this.view)}destroy(){"2d"===this.view.type?(this._removeViewHandles(),this._viewHandles.destroy(),this._removeUndoRedoHandles(),this._undoRedoHandles.destroy()):this._removeDrawTool(),this.emit("destroy")}get _clickEnabled(){return"click"===this.mode||"hybrid"===this.mode}get _dragEnabled(){return"freehand"===this.mode||"hybrid"===this.mode}undo(){super.undo(),this.notifyChange("vertices")}redo(){super.redo(),this.notifyChange("vertices")}addVertex(e,t){this.vertices.splice(t,0,e);const i={vertex:e,vertexIndex:t,undo:()=>this._undoVertexAdd(null,t),redo:()=>this._redoVertexAdd(null,e,t)};this.history.push(i),this._set("redoHistory",[]);const s=new b(this.view,null,t,this.vertices);this.emit("vertex-add",s),s.defaultPrevented&&(this._popVertexOnPointerMove=!0)}removeVertex(e){const t=this.vertices.splice(e,1)[0],i={vertex:t,vertexIndex:e,undo:()=>this._undoVertexRemove(null,t,e),redo:()=>this._redoVertexRemove(null,e)};this.history.push(i),this._set("redoHistory",[]),this.emit("vertex-remove",new S(this.view,null,e,this.vertices))}updateVertex(e,t){this.vertices[t]=e;const i={vertex:e,vertexIndex:t,undo:()=>this._undoVertexUpdate(null,e,t),redo:()=>this._redoVertexUpdate(null,e,t)};this.history.push(i),this._set("redoHistory",[]),this.emit("vertex-update",new T(this.view,null,t,this.vertices))}complete(){"2d"===this.view.type?this._completeDrawing():this._drawTool.completeCreateOperation()}_addViewHandles(){this._removeViewHandles(),this._viewHandles.add([this.view.on("click",(e=>{e.stopPropagation()}),c.f.TOOL),this.view.on("pointer-down",(e=>{this._shouldHandlePointerEvent(e)&&!this._panEnabled&&(this._activePointerId=e.pointerId,this._addVertexOnPointerUp=!0,this._cursorScreenPoint=(0,l.vT)(e),"touch"===e.pointerType&&this._updateCursor(e.native))}),c.f.TOOL),this.view.on("pointer-move",(e=>{this._popVertexOnPointerMove&&(this.undo(),this._popVertexOnPointerMove=!1),this._cursorScreenPoint=(0,l.vT)(e),"touch"!==e.pointerType&&this._updateCursor(e.native)}),c.f.TOOL),this.view.on("pointer-drag",(e=>{this._shouldHandlePointerEvent(e)&&(this._cursorScreenPoint=(0,l.vT)(e),this._dragEnabled&&!this._panEnabled?this._vertexAddHandler(e):this._addVertexOnPointerUp=!1)}),c.f.TOOL),this.view.on("pointer-up",(e=>{if(this._shouldHandlePointerEvent(e))if(this._activePointerId=null,this._addVertexOnPointerUp){if(!this._clickEnabled)return 1===this.vertices.length&&this.vertices.pop(),void this._drawCompleteHandler(e);this._vertexAddHandler(e)}else{const t="touch"===e.pointerType;this._updateCursor(e.native,t)}}),c.f.TOOL),this.view.on("drag",(e=>{this._dragEnabled&&(0,h.pC)(this._activePointerId)&&!this._panEnabled&&e.stopPropagation()}),c.f.TOOL),this.view.on("drag",["Shift"],(e=>{e.stopPropagation()}),c.f.TOOL),this.view.on("double-click",(e=>{e.stopPropagation(),this._drawCompleteHandler(e)}),c.f.TOOL),this.view.on("double-click",["Control"],(e=>{e.stopPropagation(),this._drawCompleteHandler(e)}),c.f.TOOL),this.view.on("key-down",(e=>{const{key:t,repeat:i}=e;t===M&&!i&&this._cursorScreenPoint?(e.stopPropagation(),this._vertexAddHandler(e)):t===H&&!i&&this._cursorScreenPoint&&this.vertices.length>1?(e.stopPropagation(),this._vertexAddHandler(e),this._drawCompleteHandler(e)):t!==I||this.interactiveUndoDisabled||i?t!==E||this.interactiveUndoDisabled||i?t!==O||i||(e.stopPropagation(),this._panEnabled=!0):(e.stopPropagation(),this.redo()):(e.stopPropagation(),this.undo())}),c.f.TOOL),this.view.on("key-up",(e=>{e.key===O&&(e.stopPropagation(),this._panEnabled=!1)}),c.f.TOOL)])}_addUndoRedoHandles(){this._removeUndoRedoHandles(),this._undoRedoHandles.add([this._editGeometry.on("vertex-remove",(e=>{if(this.notifyChange("vertices"),"undo"===e.operation){const t=this._nativeEventHistory.undoStack.pop();this._nativeEventHistory.redoStack.push(t);const i=[...this._committedVertices];(0,h.pC)(this._stagedVertex)&&i.push(this._coordinateHelper.toArray(this._stagedVertex)),this.emit("undo",new S(this.view,t,e.vertices[0].index,i))}})),this._editGeometry.on("vertex-add",(e=>{if(this.notifyChange("vertices"),"apply"===e.operation){const e=this._nativeEventHistory.undoStack[this._nativeEventHistory.undoStack.length],t=this._committedVertices.length-1,i=new b(this.view,e,t,this.vertices);this.emit("vertex-add",i),i.defaultPrevented&&(this._popVertexOnPointerMove=!0)}if("redo"===e.operation){const t=this._nativeEventHistory.redoStack.pop();this._nativeEventHistory.undoStack.push(t);const i=[...this._committedVertices];(0,h.pC)(this._stagedVertex)&&i.push(this._coordinateHelper.toArray(this._stagedVertex)),this.emit("redo",new b(this.view,t,e.vertices[0].index,i))}}))])}_removeViewHandles(){this._viewHandles.removeAll()}_removeUndoRedoHandles(){this._undoRedoHandles.removeAll()}_addDrawTool(e){this._drawTool=new G({view:e,elevationInfo:this.elevationInfo,hasZ:this.hasZ,geometryType:"polyline",mode:this.mode}),this.view.toolViewManager.tools.push(this._drawTool),this.view.activeTool=this._drawTool,this._drawTool.on("vertex-add",(e=>{1===e.vertices.length&&this.emit("vertex-add",new b(this.view,null,e.vertices[0].vertexIndex,this._drawTool.getVertexCoords()))})),this._drawTool.on("cursor-update",(e=>{1===e.vertices.length&&this.emit("cursor-update",new P(this.view,null,e.vertices[0].vertexIndex,this._drawTool.getVertexCoords()))})),this._drawTool.on("complete",(e=>{this.emit("draw-complete",new V(null,this._drawTool.getVertexCoords())),this._removeDrawTool()}))}_removeDrawTool(){(0,h.pC)(this._drawTool)&&(this.view.tools.remove(this._drawTool),this._drawTool=(0,h.SC)(this._drawTool))}_addVertex(e,t){if(this._popCursorVertex(),this.isDuplicateVertex(this._committedVertices,e))return;const i=this._coordinateHelper.fromArray(e);this._editGeometry.appendVertex(i);const s=t||new Event("placeholder");this._nativeEventHistory.undoStack.push(s)}_updateCursor(e,t=!1){if(this._popCursorVertex(),!this._cursorScreenPoint)return;let i=null,s=null;const r=this.getCoordsAndPointFromScreenPoint(this._cursorScreenPoint);(0,h.pC)(r)&&(i=r.mapPoint,t||(s=this._pushCursorVertex(r.vertex)));const n=new P(this.view,e,s,this.vertices,i);this.emit("cursor-update",n)}_completeDrawing(e){if(this._activePointerId=null,this._popCursorVertex(),this.vertices.length<2)return;const t=new V(e,this.vertices);this.emit("draw-complete",t),t.defaultPrevented||this._removeViewHandles()}_undoVertexAdd(e,t){this.vertices.splice(t,1),this.emit("undo",new S(this.view,e,t,this.vertices))}_redoVertexAdd(e,t,i){this.vertices.splice(i,0,t),this.emit("redo",new b(this.view,e,i,this.vertices))}_undoVertexRemove(e,t,i){this.vertices.splice(i,0,t),this.emit("undo",new b(this.view,e,i,this.vertices))}_redoVertexRemove(e,t){this.vertices.splice(t,1),this.emit("redo",new S(this.view,e,t,this.vertices))}_undoVertexUpdate(e,t,i){this.vertices[i]=t,this.emit("undo",new T(this.view,e,i,this.vertices))}_redoVertexUpdate(e,t,i){this.vertices[i]=t,this.emit("redo",new T(this.view,e,i,this.vertices))}_pushCursorVertex(e){return this._stagedVertex=this._coordinateHelper.fromArray(e),this.notifyChange("vertices"),this._cursorVertexAdded=!0,this.vertices.length}_popCursorVertex(){this._cursorVertexAdded&&(this._stagedVertex=null,this.notifyChange("vertices"),this._cursorVertexAdded=!1)}_shouldHandlePointerEvent(e){return function(e){return"mouse"!==e.pointerType||0===e.button}(e)&&((0,h.Wi)(this._activePointerId)||this._activePointerId===e.pointerId)}_vertexAddHandler(e){const t=(0,h.pC)(this._stagedVertex)?this._stagedVertex:this.getCoordsFromScreenPoint(this._cursorScreenPoint);(0,h.pC)(t)&&this._addVertex(t,e.native)}_drawCompleteHandler(e){this._completeDrawing(e.native)}};(0,s._)([(0,n.Cb)()],U.prototype,"_clickEnabled",null),(0,s._)([(0,n.Cb)()],U.prototype,"_dragEnabled",null),(0,s._)([(0,n.Cb)({type:z.A})],U.prototype,"mode",void 0),U=(0,s._)([(0,o.j)("esri.views.draw.PolylineDrawAction")],U);var W=i(14425);let N=class extends C{constructor(){super(...arguments),this._isDragging=!1,this._panEnabled=!1,this._cursorScreenPoint=null,this._viewHandles=new d.Z,this._cursorVertexAdded=!1,this._activePointerId=null,this.viewAlignedCoordinateSystem=null,this.mode="freehand"}initialize(){"2d"===this.view.type?this._addViewHandles():this._addDrawTool(this.view)}destroy(){"2d"===this.view.type?(this._removeViewHandles(),this._viewHandles.destroy()):this._removeDrawTool(),this.emit("destroy")}complete(){"2d"===this.view.type?this._completeDrawing():this._drawTool.completeCreateOperation()}getGeometryZValue(){return this.vertices.length>0&&this.vertices[0].length>2?this.vertices[0][2]:this._get("defaultZ")}_addViewHandles(){this._removeViewHandles(),"click"===this.mode?this._viewHandles.add(this._getClickModeViewHandles()):this._viewHandles.add(this._getDragModeViewHandles())}_getDragModeViewHandles(){return[this.view.on("immediate-click",(e=>{if(e.stopPropagation(),e.mapPoint&&!this._panEnabled){const t=this.getCoordsFromScreenPoint((0,l.vT)(e));(0,h.pC)(t)&&(this._vertexAddHandler(e),this._drawCompleteHandler(e))}}),c.f.TOOL),this.view.on("pointer-down",(e=>{this._shouldHandlePointerEvent(e)&&!this._panEnabled&&(this._resetGeometry(),this._cursorScreenPoint=(0,l.vT)(e),this._activePointerId=e.pointerId,this._vertexAddHandler(e),this._isDragging=!1,"touch"===e.pointerType&&this._cursorUpdateHandler(e))}),c.f.TOOL),this.view.on("pointer-move",(e=>{this._cursorScreenPoint=(0,l.vT)(e),(0,h.Wi)(this._activePointerId)&&"touch"!==e.pointerType&&0===this.vertices.length&&this._cursorUpdateHandler(e)}),c.f.TOOL),this.view.on("pointer-drag",(e=>{this._shouldHandlePointerEvent(e)&&(this._isDragging=!0,this._cursorScreenPoint=(0,l.vT)(e),this._cursorUpdateHandler(e))}),c.f.TOOL),this.view.on("pointer-up",(e=>{this._shouldHandlePointerEvent(e)&&(this._activePointerId=null,this._popCursorVertex(),this._isDragging&&!this._panEnabled&&(this._vertexAddHandler(e),this._drawCompleteHandler(e)),this._isDragging=!1)}),c.f.TOOL),this.view.on("key-down",(e=>{e.key===H&&this._cursorScreenPoint?this._drawCompleteHandler(e):e.key===O&&(this._panEnabled=!0)}),c.f.TOOL),this.view.on("key-up",(e=>{e.key===O&&(this._panEnabled=!1)}),c.f.TOOL),this.view.on("drag",(e=>{(0,h.pC)(this._activePointerId)&&e.stopPropagation()}),c.f.TOOL),this.view.on("drag",["Shift"],(e=>{e.stopPropagation()}),c.f.TOOL)]}_getClickModeViewHandles(){return[this.view.on("immediate-click",(e=>{e.stopPropagation()}),c.f.TOOL),this.view.on("pointer-down",(e=>{this._cursorScreenPoint=(0,l.vT)(e),this._activePointerId=e.pointerId,this._isDragging=!1,"touch"===e.pointerType&&this._cursorUpdateHandler(e)}),c.f.TOOL),this.view.on("pointer-move",(e=>{this._cursorScreenPoint=(0,l.vT)(e),(0,h.Wi)(this._activePointerId)&&"touch"!==e.pointerType&&this._cursorUpdateHandler(e)}),c.f.TOOL),this.view.on("pointer-drag",(e=>{this._shouldHandlePointerEvent(e)&&(this._isDragging=!0)}),c.f.TOOL),this.view.on("pointer-up",(e=>{this._shouldHandlePointerEvent(e)&&(this._activePointerId=null,this._isDragging||this._vertexAddHandler(e),2!==this.vertices.length||this._isDragging||this._drawCompleteHandler(e),this._isDragging=!1)}),c.f.TOOL),this.view.on("key-down",(e=>{e.key===M&&this._cursorScreenPoint&&(this._vertexAddHandler(e),2===this.vertices.length&&this._drawCompleteHandler(e)),e.key===H&&this._cursorScreenPoint&&2===this.vertices.length&&this._drawCompleteHandler(e)}),c.f.TOOL)]}_removeViewHandles(){this._viewHandles.removeAll()}_addDrawTool(e){this._drawTool=new G({view:e,elevationInfo:this.elevationInfo,hasZ:this.hasZ,geometryType:"segment",mode:this.mode}),this.view.toolViewManager.tools.push(this._drawTool),this.view.activeTool=this._drawTool,this._drawTool.on("vertex-add",(e=>{1===e.vertices.length&&this.emit("vertex-add",new b(this.view,null,e.vertices[0].vertexIndex,this._drawTool.getVertexCoords()))})),this._drawTool.on("cursor-update",(e=>{1===e.vertices.length&&this.emit("cursor-update",new P(this.view,null,e.vertices[0].vertexIndex,this._drawTool.getVertexCoords()))})),this._drawTool.on("complete",(e=>{this.emit("draw-complete",new V(null,this._drawTool.getVertexCoords())),this._removeDrawTool()}))}_removeDrawTool(){(0,h.pC)(this._drawTool)&&(this.view.tools.remove(this._drawTool),this._drawTool.destroy(),this._drawTool=null)}_addVertex(e,t){if(this._popCursorVertex(),this.isDuplicateVertex(this._committedVertices,e))return;const i=this._coordinateHelper.fromArray(e);this._editGeometry.appendVertex(i),this.notifyChange("vertices"),1===this._committedVertices.length&&(this.viewAlignedCoordinateSystem=(0,W.Gn)(this.view,this._committedVertices[0]));const s=this._committedVertices.length-1,r=new b(this.view,t,s,this.vertices);this.emit("vertex-add",r)}_updateCursor(e,t){let i=null;(0,h.pC)(e)&&(i=this._pushCursorVertex(e));const s=new P(this.view,t,i,this.vertices);this.emit("cursor-update",s)}_completeDrawing(e){if(this._activePointerId=null,this._popCursorVertex(),this._isDragging=!1,this._cursorScreenPoint=null,this.vertices.length<1)return;const t=new V(e,this.vertices);this.emit("draw-complete",t),t.defaultPrevented||this._removeViewHandles()}_resetGeometry(){this._editGeometry=new m.hE(new g.XE(this._coordinateHelper),"polygon"),this._activeComponent=new g.wA(this._editGeometry.editGeometry),this._editGeometry.editGeometry.components.push(this._activeComponent)}_pushCursorVertex(e){return this._popCursorVertex(),this.vertices.push(e),this._cursorVertexAdded=!0,this.vertices.length-1}_popCursorVertex(){this._cursorVertexAdded&&(this.vertices.pop(),this._cursorVertexAdded=!1)}_shouldHandlePointerEvent(e){return function(e){return"mouse"!==e.pointerType||0===e.button}(e)&&((0,h.Wi)(this._activePointerId)||this._activePointerId===e.pointerId)}_vertexAddHandler(e){const t=this.getCoordsFromScreenPoint(this._cursorScreenPoint);(0,h.pC)(t)&&this._addVertex(t,e.native)}_cursorUpdateHandler(e){const t=this.getCoordsFromScreenPoint(this._cursorScreenPoint);this._updateCursor(t,e.native)}_drawCompleteHandler(e){this._completeDrawing(e.native)}};(0,s._)([(0,n.Cb)({type:["freehand","click"]})],N.prototype,"mode",void 0),N=(0,s._)([(0,o.j)("esri/views/2d/engine/markup/SegmentDrawAction")],N);let q=class extends a.default{constructor(){super(...arguments),this.activeAction=null,this.type="draw",this.view=null}destroy(){this.activeAction&&(this.activeAction.destroy(),this.activeAction=null)}create(e,t){this.reset();const i={view:this.view,enableWithinFeatureSnapping:!1,...t};switch(e){case"point":i.editGeometryType="point",this.activeAction=new F(i);break;case"polyline":i.editGeometryType="polyline",this.activeAction=new U(i);break;case"multipoint":i.editGeometryType="polygon",this.activeAction=new k(i);break;case"polygon":i.editGeometryType="polygon",this.activeAction=new j(i);break;case"rectangle":case"circle":case"ellipse":case"triangle":i.editGeometryType="polygon",this.activeAction=new N(i)}return this.activeAction}complete(){this.activeAction&&this.activeAction.complete(),this.activeAction=null}reset(){this.activeAction&&this.activeAction.destroy(),this.activeAction=null}};(0,s._)([(0,n.Cb)()],q.prototype,"activeAction",void 0),(0,s._)([(0,n.Cb)({readOnly:!0})],q.prototype,"type",void 0),(0,s._)([(0,n.Cb)()],q.prototype,"view",void 0),q=(0,s._)([(0,o.j)("esri.views.draw.Draw")],q);const B=q},636:(e,t,i)=>{"use strict";i.d(t,{n:()=>r,A:()=>s});const s=["freehand","hybrid","click"],r="click"},14425:(e,t,i)=>{"use strict";i.d(t,{Gn:()=>m,Q8:()=>p});var s=i(59472),r=i(61106),n=(i(36348),i(77625)),o=i(17387),a=i(32232),h=i(2847),d=i(42738),c=i(75384);function l(e,t,i=null){return(0,s.pC)(i)?[e,t,i]:[e,t]}function p(e,t,i=null){return(0,s.pC)(i)?{x:e,y:t,z:i}:{x:e,y:t}}class u{constructor(e){this.spatialReference=e}mapToLocalMultiple(e){return(0,s.lV)(e.map((e=>this.mapToLocal(e))))}get doUnnormalization(){return!1}}class v extends u{constructor(e,t,i=null){super(t),this.defaultZ=i,this.transform=(0,c.c)(),this.transformInv=(0,c.c)(),this.transform=(0,c.a)(e),(0,d.a)(this.transformInv,this.transform)}makeMapPoint(e,t){return l(e,t,this.defaultZ)}mapToLocal(e){return p(this.transform[0]*e[0]+this.transform[2]*e[1]+this.transform[4],this.transform[1]*e[0]+this.transform[3]*e[1]+this.transform[5])}localToMap(e){return l(this.transformInv[0]*e.x+this.transformInv[2]*e.y+this.transformInv[4],this.transformInv[1]*e.x+this.transformInv[3]*e.y+this.transformInv[5],this.defaultZ)}}class g extends u{constructor(e,t){super(e.spatialReference),this.view=e,this.defaultZ=null,this.pWS=(0,n.c)(),this.tangentFrameUpWS=(0,n.c)(),this.tangentFrameRightWS=(0,n.c)(),this.tangentFrameForwardWS=(0,n.c)(),this.localFrameRightWS=(0,n.c)(),this.localFrameUpWS=(0,n.c)(),this.worldToLocalTransform=(0,a.c)(),this.localToWorldTransform=(0,a.c)(),this.scale=1,this.scale=e.resolution,this.referenceMapPoint=t,this.defaultZ=t.hasZ?t.z:null;const i=e.state.camera.viewRight;this.view.renderCoordsHelper.toRenderCoords(this.referenceMapPoint,this.pWS),this.view.renderCoordsHelper.worldBasisAtPosition(this.pWS,0,this.tangentFrameRightWS),this.view.renderCoordsHelper.worldBasisAtPosition(this.pWS,1,this.tangentFrameUpWS),this.view.renderCoordsHelper.worldBasisAtPosition(this.pWS,2,this.tangentFrameForwardWS);const s=(0,n.c)();(0,o.a)(s,this.tangentFrameForwardWS,(0,o.d)(i,this.tangentFrameForwardWS)),(0,o.f)(this.localFrameRightWS,i,s),(0,o.n)(this.localFrameRightWS,this.localFrameRightWS),(0,o.c)(this.localFrameUpWS,this.tangentFrameForwardWS,this.localFrameRightWS),(0,h.r)(this.worldToLocalTransform,this.localFrameRightWS,this.tangentFrameRightWS),(0,h.i)(this.localToWorldTransform,this.worldToLocalTransform)}get doUnnormalization(){return"global"===this.view.viewingMode}makeMapPoint(e,t){return l(e,t,this.defaultZ)}mapToLocal(e){const t=(0,n.c)();this.view.renderCoordsHelper.toRenderCoords(new r.Z({x:e[0],y:e[1],spatialReference:this.spatialReference}),t),(0,o.q)(t,t,this.worldToLocalTransform);const i=this.view.renderCoordsHelper.fromRenderCoords(t,this.view.spatialReference);return(0,s.pC)(i)?p(i.x/this.scale,i.y/this.scale):null}localToMap(e){const t=(0,n.c)();this.view.renderCoordsHelper.toRenderCoords(new r.Z({x:e.x*this.scale,y:e.y*this.scale,spatialReference:this.spatialReference}),t),(0,o.q)(t,t,this.localToWorldTransform);const i=this.view.renderCoordsHelper.fromRenderCoords(t,this.view.spatialReference);return(0,s.pC)(i)?l(i.x,i.y,this.defaultZ):null}}function m(e,t){if("2d"===e.type)return new v(e.state.transform,e.spatialReference,t.length>2?t[2]:null);if("3d"===e.type){const i=t.length>2?new r.Z({x:t[0],y:t[1],z:t[2],spatialReference:e.spatialReference}):new r.Z({x:t[0],y:t[1],spatialReference:e.spatialReference});return new g(e,i)}return null}},94535:(e,t,i)=>{"use strict";i.d(t,{M:()=>o,e:()=>a});var s=i(2992),r=i(46539),n=i(16853);const o={maximumClickDelay:300,movementUntilMouseDrag:1.5,movementUntilPenDrag:6,movementUntilTouchDrag:6,holdDelay:500};class a extends r.a{constructor(e=o.maximumClickDelay,t=o.movementUntilMouseDrag,i=o.movementUntilPenDrag,r=o.movementUntilTouchDrag,n=o.holdDelay,a=s.Z){super(!1),this.maximumClickDelay=e,this.movementUntilMouseDrag=t,this.movementUntilPenDrag=i,this.movementUntilTouchDrag=r,this.holdDelay=n,this._clock=a,this._pointerState=new Map,this._pointerDrag=this.registerOutgoing("pointer-drag"),this._immediateClick=this.registerOutgoing("immediate-click"),this._pointerHold=this.registerOutgoing("hold"),this.registerIncoming("pointer-down",this._handlePointerDown.bind(this)),this.registerIncoming("pointer-up",(e=>{this._handlePointerLoss(e,"pointer-up")})),this.registerIncoming("pointer-capture-lost",(e=>{this._handlePointerLoss(e,"pointer-capture-lost")})),this.registerIncoming("pointer-cancel",(e=>{this._handlePointerLoss(e,"pointer-cancel")})),this._moveHandle=this.registerIncoming("pointer-move",this._handlePointerMove.bind(this)),this._moveHandle.pause()}onUninstall(){this._pointerState.forEach((e=>{null!=e.holdTimeout&&(e.holdTimeout.remove(),e.holdTimeout=null)})),super.onUninstall()}_handlePointerDown(e){const t=e.data,i=t.native.pointerId;let s=null;0===this._pointerState.size&&(s=this._clock.setTimeout((()=>{const t=this._pointerState.get(i);if(t){if(!t.isDragging){const i=t.previousEvent;this._pointerHold.emit(i,void 0,e.modifiers),t.holdEmitted=!0}t.holdTimeout=null}}),this.holdDelay));const r={startEvent:t,previousEvent:t,startTimestamp:e.timestamp,isDragging:!1,downButton:t.native.button,holdTimeout:s,modifiers:new Set};this._pointerState.set(i,r),this.startCapturingPointer(t.native),this._moveHandle.resume(),this._pointerState.size>1&&this.startDragging(e)}_createPointerDragData(e,t,i){return{action:e,startEvent:t.startEvent,previousEvent:t.previousEvent,currentEvent:i}}_handlePointerMove(e){const t=e.data,i=t.native.pointerId,s=this._pointerState.get(i);s&&(s.isDragging?this._pointerDrag.emit(this._createPointerDragData("update",s,t),void 0,s.modifiers):(0,n.WI)(t,s.startEvent)>this._getDragThreshold(t.native.pointerType)&&this.startDragging(e),s.previousEvent=t)}_getDragThreshold(e){switch(e){case"touch":return this.movementUntilTouchDrag;case"pen":return this.movementUntilPenDrag;case"mouse":default:return this.movementUntilMouseDrag}}startDragging(e){const t=e.data,i=t.native.pointerId;this._pointerState.forEach((s=>{null!=s.holdTimeout&&(s.holdTimeout.remove(),s.holdTimeout=null),s.isDragging||(s.modifiers=e.modifiers,s.isDragging=!0,i===s.startEvent.native.pointerId?this._pointerDrag.emit(this._createPointerDragData("start",s,t)):this._pointerDrag.emit(this._createPointerDragData("start",s,s.previousEvent),e.timestamp))}))}_handlePointerLoss(e,t){const i=e.data,s=i.native.pointerId,r=this._pointerState.get(s);r&&(null!=r.holdTimeout&&(r.holdTimeout.remove(),r.holdTimeout=null),r.isDragging?this._pointerDrag.emit(this._createPointerDragData("end",r,"pointer-up"===t?i:r.previousEvent),void 0,r.modifiers):"pointer-up"===t&&r.downButton===i.native.button&&e.timestamp-r.startTimestamp<=this.maximumClickDelay&&!r.holdEmitted&&this._immediateClick.emit(i),this._pointerState.delete(s),this.stopCapturingPointer(i.native),0===this._pointerState.size&&this._moveHandle.pause())}}},16853:(e,t,i)=>{"use strict";i.d(t,{WI:()=>n,y_:()=>o,nk:()=>r});var s=i(96071);function r(e,t){return Math.abs(t.x-e.x)+Math.abs(t.y-e.y)}function n(e,t){const i=t.x-e.x,s=t.y-e.y;return Math.sqrt(i*i+s*s)}function o(e,t){if(t?(t.radius=0,t.center.x=0,t.center.y=0):t={radius:0,center:(0,s.vW)()},0===e.length)return t;if(1===e.length)return t.center.x=e[0].x,t.center.y=e[0].y,t;if(2===e.length){const[i,s]=e,[r,n]=[s.x-i.x,s.y-i.y];return t.radius=Math.sqrt(r*r+n*n)/2,t.center.x=(i.x+s.x)/2,t.center.y=(i.y+s.y)/2,t}let i=0,r=0;for(let t=0;t<e.length;t++)i+=e[t].x,r+=e[t].y;i/=e.length,r/=e.length;const n=e.map((e=>e.x-i)),o=e.map((e=>e.y-r));let a=0,h=0,d=0,c=0,l=0,p=0,u=0;for(let e=0;e<n.length;e++){const t=n[e],i=o[e],s=t*t,r=i*i;a+=s,h+=r,d+=t*i,c+=s*t,l+=r*i,p+=t*r,u+=i*s}const v=.5*(c+p),g=.5*(l+u),m=a*h-d*d,f=(v*h-g*d)/m,_=(a*g-d*v)/m,y=(0,s.vW)(f+i,_+r);return{radius:Math.sqrt(f*f+_*_+(a+h)/e.length),center:y}}},42039:(e,t,i)=>{"use strict";i.d(t,{Y6:()=>g});var s=i(27780),r=i(61106),n=(i(36348),i(77625)),o=i(17387),a=i(55735),h=i(38256),d=i(8344),c=i(34353),l=i(14286);class p{constructor(e,t){this.spatialReference=e,this.viewingMode=t,this._unnormalizationInfo=f(e,t)}tag(e){return e}createNew(){return this.tag((0,a.c)())}fromPoint(e){return this.tag((0,a.f)(e.x,e.y))}fromArray(e){return this.tag((0,a.f)(e[0],e[1]))}toArray(e){return[e[0],e[1]]}clone(e){return this.tag((0,a.d)(e))}toPoint(e,t){return t.x=e[0],t.y=e[1],t.hasZ=!1,t.hasM=!1,t.spatialReference=this.spatialReference,t}createPoint(e){return new r.Z({x:e[0],y:e[1],z:void 0,m:void 0,spatialReference:this.spatialReference})}createPointFromArray(e){return new r.Z({x:e[0],y:e[1],z:void 0,m:void 0,spatialReference:this.spatialReference})}createDehydratedPoint(e){return{x:e[0],y:e[1],z:void 0,m:void 0,hasZ:!1,hasM:!1,spatialReference:this.spatialReference,type:"point"}}lerp(e,t,i,s){return(0,l.m)(s,e,t,i)}addDelta(e,t,i){e[0]+=t,e[1]+=i}scale(e,t,i,s){const r=d.qW.get(),n=(0,l.e)(r,e,t),o=(0,l.a)(r,i,(0,l.h)(i,n));(0,l.p)(e,e,o,s-1)}rotate(e,t,i){(0,l.r)(e,e,t,i)}pointToArray(e){return[e.x,e.y]}getZ(e,t){return t}hasZ(){return!1}unnormalize(e){m(e,this._unnormalizationInfo)}fromXYZ(e){return this.tag((0,a.f)(e[0],e[1]))}toXYZ(e,t=0){return(0,n.f)(e[0],e[1],t)}}class u{constructor(e,t,i){this.valueType=e,this.spatialReference=t,this._unnormalizationInfo=f(t,i)}tag(e){return e}createNew(){return this.tag((0,n.c)())}fromPoint(e){return this.tag((0,n.f)(e.x,e.y,0===this.valueType?e.z:e.m))}fromArray(e){return this.tag((0,n.f)(e[0],e[1],e[2]||0))}toArray(e){return[e[0],e[1],e[2]]}clone(e){return this.tag((0,n.d)(e))}toPoint(e,t){return t.x=e[0],t.y=e[1],0===this.valueType?(t.z=e[2],t.hasZ=!0,t.hasM=!1):(t.m=e[2],t.hasZ=!1,t.hasM=!0),t.spatialReference=this.spatialReference,t}createPoint(e){return new r.Z({x:e[0],y:e[1],z:0===this.valueType?e[2]:void 0,m:1===this.valueType?e[2]:void 0,spatialReference:this.spatialReference})}createPointFromArray(e){return new r.Z({x:e[0],y:e[1],z:0===this.valueType?e[2]:void 0,m:1===this.valueType?e[2]:void 0,spatialReference:this.spatialReference})}createDehydratedPoint(e){const t=0===this.valueType,i=1===this.valueType;return{x:e[0],y:e[1],z:t?e[2]:void 0,m:i?e[2]:void 0,hasZ:t,hasM:i,spatialReference:this.spatialReference,type:"point"}}lerp(e,t,i,s){return(0,o.e)(s,e,t,i)}addDelta(e,t,i,s){e[0]+=t,e[1]+=i,0===this.valueType&&(e[2]+=s)}scale(e,t,i,s){const r=d.qW.get(),n=(0,l.e)(r,e,t),o=(0,l.a)(r,i,(0,l.h)(i,n));(0,l.p)(e,e,o,s-1)}rotate(e,t,i){(0,l.r)(e,e,t,i)}pointToArray(e){return 0===this.valueType?[e.x,e.y,e.z]:[e.x,e.y,e.m]}getZ(e,t){return 0===this.valueType?e[2]:t}hasZ(){return 0===this.valueType}unnormalize(e){m(e,this._unnormalizationInfo)}fromXYZ(e,t=0,i=0){return this.tag((0,n.f)(e[0],e[1],0===this.valueType?e.length>2?e[2]:t:i))}toXYZ(e,t=0){return this.tag((0,n.f)(e[0],e[1],0===this.valueType?e[2]:t))}}class v{constructor(e,t){this.spatialReference=e,this._unnormalizationInfo=f(e,t)}tag(e){return e}createNew(){return this.tag((0,h.c)())}fromPoint(e){return this.tag((0,h.f)(e.x,e.y,e.z,e.m))}fromArray(e){return this.tag((0,h.f)(e[0],e[1],e[2]||0,e[3]||0))}toArray(e){return[e[0],e[1],e[2],e[3]]}clone(e){return this.tag((0,h.b)(e))}toPoint(e,t){return t.x=e[0],t.y=e[1],t.z=e[2],t.m=e[3],t.hasZ=!0,t.hasM=!0,t.spatialReference=this.spatialReference,t}createPoint(e){return new r.Z({x:e[0],y:e[1],z:e[2],m:e[3],spatialReference:this.spatialReference})}createPointFromArray(e){return new r.Z({x:e[0],y:e[1],z:e[2],m:e[3],spatialReference:this.spatialReference})}createDehydratedPoint(e){return{x:e[0],y:e[1],z:e[2],m:e[3],hasZ:!0,hasM:!0,spatialReference:this.spatialReference,type:"point"}}lerp(e,t,i,s){return(0,c.l)(s,e,t,i)}addDelta(e,t,i,s){e[0]+=t,e[1]+=i,e[2]+=s}scale(e,t,i,s){const r=d.qW.get(),n=(0,l.e)(r,e,t),o=(0,l.a)(r,i,(0,l.h)(i,n));(0,l.p)(e,e,o,s-1)}rotate(e,t,i){(0,l.r)(e,e,t,i)}pointToArray(e){return[e.x,e.y,e.z,e.m]}getZ(e){return e[2]}hasZ(){return!0}unnormalize(e){m(e,this._unnormalizationInfo)}fromXYZ(e,t=0,i=0){return this.tag((0,h.f)(e[0],e[1],e.length>2?e[2]:t,i))}toXYZ(e){return(0,n.f)(e[0],e[1],e[2])}}function g(e,t,i,s){return e&&t?new v(i,s):t?new u(1,i,s):e?new u(0,i,s):new p(i,s)}function m(e,t){if(!t.supported)return;let i=1/0,s=-1/0;const r=t.upperBoundX-t.lowerBoundX;e.forEach((e=>{let n=e.pos[0];for(;n<t.lowerBoundX;)n+=r;for(;n>t.upperBoundX;)n-=r;i=Math.min(i,n),s=Math.max(s,n),e.pos[0]=n}));const n=s-i;r-n<n&&e.forEach((e=>{e.pos[0]<0&&(e.pos[0]+=r)}))}function f(e,t){const i=(0,s.C5)(e);return"global"===t&&i?{supported:!0,lowerBoundX:i.valid[0],upperBoundX:i.valid[1]}:{supported:!1,lowerBoundX:null,upperBoundX:null}}},97450:(e,t,i)=>{"use strict";i.d(t,{wA:()=>c,kS:()=>d,XE:()=>l,Xz:()=>h});var s=i(59472),r=i(53817),n=i(93833),o=(i(36348),i(35470)),a=i(42039);class h{constructor(e){this.left=null,this.right=null,this.type="vertex",this.index=null,this.component=e}get pos(){return this._pos}set pos(e){this._pos=e,this.component.unnormalizeVertexPositions()}}class d{constructor(e,t,i){this.type="edge",this.component=e,this.left=t,this.right=i,t.right=this,i.left=this}}class c{constructor(e){this.vertices=[],this.edges=[],this.data=e}unnormalizeVertexPositions(){this.vertices.length<=1||this.data.coordinateHelper.unnormalize(this.vertices)}updateVertexIndex(e,t){if(0===this.vertices.length)return;const i=this.vertices[0];let s=null,r=e,n=t;do{s=r,s.index=n++,r=s.right?s.right.right:null}while(null!=r&&r!==i);s.left&&s!==this.vertices[this.vertices.length-1]&&this.swapVertices(this.vertices.indexOf(s),this.vertices.length-1)}getFirstVertex(){return 0===this.vertices.length?null:this.vertices[0]}getLastVertex(){return 0===this.vertices.length?null:this.vertices[this.vertices.length-1]}swapVertices(e,t){const i=this.vertices[e];this.vertices[e]=this.vertices[t],this.vertices[t]=i}iterateVertices(e){if(0===this.vertices.length)return;const t=this.vertices[0];let i=t;do{e(i,i.index),i=(0,s.pC)(i.right)?i.right.right:null}while(i!==t&&null!=i)}}class l extends o.Z{constructor(e){super(),this.coordinateHelper=e,this.undoStack=[],this.redoStack=[],this.components=[]}apply(e,t=1){0!==t&&!(0,s.Wi)(this.lastOperation)&&this.lastOperation.accumulate(e)||(e.apply(),this.undoStack.push(e),this.redoStack=[])}undo(){if(this.undoStack.length>0){const e=this.undoStack.pop();e.undo(),this.redoStack.push(e)}}get canUndo(){return this.undoStack.length>0}get lastOperation(){return this.undoStack.length>0?this.undoStack[this.undoStack.length-1]:null}redo(){if(this.redoStack.length>0){const e=this.redoStack.pop();e.apply(),this.undoStack.push(e)}}get canRedo(){return this.redoStack.length>0}toPoint(){return 0===this.components.length||0===this.components[0].vertices.length?null:this.coordinateHelper.createPoint(this.components[0].vertices[0].pos)}toPolyline(){const e=[],t=this.coordinateHelper.toArray;return this.components.forEach(((i,s)=>{const r=[];let n=i.vertices.find((e=>null==e.left));const o=n;do{r.push(t(n.pos)),n=n.right?n.right.right:null}while(n&&n!==o);e.push(r)})),new n.Z({paths:e,spatialReference:this.coordinateHelper.spatialReference})}toPolygon(){const e=[],t=this.coordinateHelper.toArray;return this.components.forEach(((i,r)=>{const n=[],o=i.vertices[0];let a=o;const h=a;do{n.push(t(a.pos)),a=(0,s.pC)(a.right)?a.right.right:null}while(a&&a!==h);n.push(t(o.pos)),e.push(n)})),new r.Z({rings:e,spatialReference:this.coordinateHelper.spatialReference})}static fromGeometry(e,t){const i=(0,a.Y6)(e.hasZ,e.hasM,e.spatialReference,t),s=new l(i);switch(e.type){case"polygon":{const t=e.rings;for(let e=0;e<t.length;++e){const r=t[e],n=new c(s),o=r.length-1;for(let e=0;e<o;++e){const t=i.fromArray(r[e]),s=new h(n);n.vertices.push(s),s.pos=t,s.index=e}const a=n.vertices.length-1;for(let e=0;e<a;++e){const t=n.vertices[e],i=n.vertices[e+1],s=new d(n,t,i);n.edges.push(s)}const l=new d(n,n.vertices[n.vertices.length-1],n.vertices[0]);n.edges.push(l),s.components.push(n)}}break;case"polyline":for(const t of e.paths){const e=new c(s),r=t.length;for(let s=0;s<r;++s){const r=i.fromArray(t[s]),n=new h(e);e.vertices.push(n),n.pos=r,n.index=s}const n=e.vertices.length-1;for(let t=0;t<n;++t){const i=e.vertices[t],s=e.vertices[t+1],r=new d(e,i,s);e.edges.push(r)}s.components.push(e)}}return s}}},46896:(e,t,i)=>{"use strict";i.d(t,{hE:()=>f});var s=i(35470),r=i(97450),n=i(66497);class o{constructor(e,t,i){this.editGeometry=e,this.vertices=t,this.operation=i,this.undone=!1}apply(){this.vertices.forEach((e=>this.operation.apply(e))),this.editGeometry.components.forEach((e=>e.unnormalizeVertexPositions()));const e={updatedVertices:this.vertices,operation:this.undone?"redo":"apply"};this.editGeometry.emit("change",e)}undo(){this.vertices.forEach((e=>{this.operation.undo(e)}));const e={updatedVertices:this.vertices,operation:"undo"};this.editGeometry.emit("change",e),this.undone=!0}canAccumulate(e){if(this.undone)return!1;if(e.vertices.length!==this.vertices.length)return!1;for(let t=0;t<e.vertices.length;++t)if(e.vertices[t]!==this.vertices[t])return!1;return this.operation.canAccumulate(e.operation)}accumulate(e){if(e instanceof o&&this.canAccumulate(e)){this.vertices.forEach((t=>this.operation.accumulate(t,e.operation))),this.operation.accumulateParams(e.operation),this.editGeometry.components.forEach((e=>e.unnormalizeVertexPositions()));const t={updatedVertices:this.vertices,operation:"apply"};return this.editGeometry.emit("change",t),!0}return!1}}class a{constructor(e){this.helper=e}}var h=i(59472);class d{constructor(e,t,i=0){this.editGeometry=e,this.removedVertices=null,this._minNumberOfVertices=0,this.vertices=t,this._minNumberOfVertices=i}apply(){let e="redo";null==this.removedVertices?(this.removedVertices=[],this.vertices.forEach((e=>{const t=this._removeVertex(e);(0,h.pC)(t)&&this.removedVertices.push(t)})),e="apply"):this.removedVertices.forEach((e=>{this._redoRemoveVertex(e)}));const t={removedVertices:this.vertices,operation:e};this.editGeometry.emit("change",t)}undo(){this.removedVertices.forEach((e=>{this._undoRemoveVertex(e)}));const e={addedVertices:this.vertices,operation:"undo"};this.editGeometry.emit("change",e)}accumulate(e){return!1}_removeVertex(e){const t=e.component;if(t.vertices.length<=this._minNumberOfVertices)return null;const i={removedVertex:e,createdEdge:null},s=e.left,n=e.right;return t.vertices.splice(t.vertices.indexOf(e),1),s&&(t.edges.splice(t.edges.indexOf(s),1),s.left.right=null),n&&(t.edges.splice(t.edges.indexOf(n),1),n.right.left=null),0===e.index&&n&&this.vertices.length>0&&t.swapVertices(t.vertices.indexOf(n.right),0),s&&n&&(i.createdEdge=new r.kS(t,s.left,n.right),t.edges.push(i.createdEdge)),n&&t.updateVertexIndex(n.right,n.right.index-1),i}_redoRemoveVertex(e){console.warn("redo remove vertex not implemented yet")}_undoRemoveVertex(e){const t=e.removedVertex,i=e.removedVertex.component,s=t.left,r=t.right;e.createdEdge&&i.edges.splice(i.edges.indexOf(e.createdEdge),1),i.vertices.push(t),s&&(i.edges.push(s),s.left.right=s),r&&(i.edges.push(r),r.right.left=r),i.updateVertexIndex(t,t.index)}}class c{constructor(e,t,i){this.editGeometry=e,this.edge=t,this.t=i,this.createdVertex=null,this.left=null,this.right=null}apply(){let e="redo";const t=this.edge,i=t.component,s=t.component.data,n=t.left,o=t.right;i.edges.splice(i.edges.indexOf(t),1),(0,h.Wi)(this.createdVertex)&&(e="apply",this.createdVertex=new r.Xz(t.component)),i.vertices.push(this.createdVertex),this.createdVertex.pos=s.coordinateHelper.lerp(t.left.pos,t.right.pos,this.t,s.coordinateHelper.createNew()),(0,h.Wi)(this.left)&&(this.left=new r.kS(i,n,this.createdVertex)),this.left.left.left?i.edges.push(this.left):i.edges.unshift(this.left),n.right=this.left,(0,h.Wi)(this.right)&&(this.right=new r.kS(i,this.createdVertex,o)),i.edges.push(this.right),o.left=this.right,i.updateVertexIndex(this.createdVertex,n.index+1);const a={addedVertices:[this.createdVertex],operation:e};this.editGeometry.emit("change",a)}undo(){if((0,h.Wi)(this.createdVertex)||(0,h.Wi)(this.left)||(0,h.Wi)(this.right))return null;const e=this.edge,t=e.component,i=this.createdVertex.left,s=this.createdVertex.right,r=i.left,n=s.right;t.vertices.splice(t.vertices.indexOf(this.createdVertex),1),t.edges.splice(t.edges.indexOf(this.left),1),t.edges.splice(t.edges.indexOf(this.right),1),this.edge.left.left?t.edges.push(this.edge):t.edges.unshift(this.edge),r.right=e,n.left=e,t.updateVertexIndex(r,r.index);const o={removedVertices:[this.createdVertex],operation:"undo"};this.editGeometry.emit("change",o)}accumulate(e){return!1}}class l extends a{constructor(e,t,i,s){super(e),this.dx=t,this.dy=i,this.dz=s}move(e,t,i,s){this.helper.addDelta(e.pos,t,i,s)}apply(e){this.move(e,this.dx,this.dy,this.dz)}undo(e){this.move(e,-this.dx,-this.dy,-this.dz)}canAccumulate(e){return e instanceof l}accumulate(e,t){this.move(e,t.dx,t.dy,t.dz)}accumulateParams(e){this.dx+=e.dx,this.dy+=e.dy,this.dz+=e.dz}}var p=i(19677);class u extends a{constructor(e,t,i,s=0){super(e),this.origin=t,this.angle=i,this.accumulationType=s}rotate(e,t){this.helper.rotate(e.pos,this.origin,t)}apply(e){this.rotate(e,this.angle)}undo(e){this.rotate(e,-this.angle)}canAccumulate(e){return e instanceof u&&(0,p.fS)(this.origin,e.origin)}accumulate(e,t){const i=1===t.accumulationType;this.rotate(e,i?t.angle-this.angle:t.angle)}accumulateParams(e){const t=1===e.accumulationType;this.angle=t?e.angle:this.angle+e.angle}}var v=i(55735),g=i(14286);class m extends a{constructor(e,t,i,s,r,n=0){super(e),this.origin=t,this.axis1=i,this.factor1=s,this.factor2=r,this.accumulationType=n,this.axis2=(0,g.s)((0,v.c)(),i[1],-i[0])}scale(e,t,i){this.helper.scale(e.pos,this.origin,this.axis1,t),this.helper.scale(e.pos,this.origin,this.axis2,i)}apply(e){this.scale(e,this.factor1,this.factor2)}undo(e){this.scale(e,1/this.factor1,1/this.factor2)}canAccumulate(e){return e instanceof m&&(0,p.fS)(this.origin,e.origin)&&(0,p.fS)(this.axis1,e.axis1)}accumulate(e,t){1===t.accumulationType?this.scale(e,t.factor1/this.factor1,t.factor2/this.factor2):this.scale(e,t.factor1,t.factor2)}accumulateParams(e){const t=1===e.accumulationType;this.factor1=t?e.factor1:this.factor1*e.factor1,this.factor2=t?e.factor2:this.factor2*e.factor2}}class f extends s.Z{constructor(e,t){super(),this.editGeometry=e,this.type=t,this._geometry=null,this._dirty=!0,this.editGeometry.on("change",(e=>{e.addedVertices&&this.emit("vertex-add",{type:"vertex-add",vertices:e.addedVertices,operation:e.operation}),e.removedVertices&&this.emit("vertex-remove",{type:"vertex-remove",vertices:e.removedVertices,operation:e.operation}),e.updatedVertices&&this.emit("vertex-update",{type:"vertex-update",vertices:e.updatedVertices,operation:e.operation}),this._dirty=!0}))}splitEdge(e,t){const i=new c(this.editGeometry,e,t);return this.editGeometry.apply(i),i}updateVertices(e,t,i=1){const s=new o(this.editGeometry,e,t);return this.editGeometry.apply(s,i),s}moveVertices(e,t,i,s,r=1){return this.updateVertices(e,new l(this.editGeometry.coordinateHelper,t,i,s),r)}scaleVertices(e,t,i,s,r,n=1,o=0){return this.updateVertices(e,new m(this.editGeometry.coordinateHelper,t,i,s,r,o),n)}rotateVertices(e,t,i,s=1,r=0){return this.updateVertices(e,new u(this.editGeometry.coordinateHelper,t,i,r),s)}removeVertices(e){let t=0;switch(this.type){case"point":t=1;break;case"polyline":t=2;break;case"polygon":t=3}const i=new d(this.editGeometry,e,t);return this.editGeometry.apply(i),i}appendVertex(e){if(0===this.editGeometry.components.length)return null;const t=new n.g(this.editGeometry,this.editGeometry.components[0],e);return this.editGeometry.apply(t),t}canRemoveVertex(){let e=0;switch(this.type){case"point":e=1;break;case"polyline":e=2;break;case"polygon":e=3}return this.editGeometry.components[0].vertices.length>e}undo(){this.editGeometry.undo()}get canUndo(){return this.editGeometry.canUndo}redo(){this.editGeometry.redo()}get canRedo(){return this.editGeometry.canRedo}get geometry(){if(this._dirty){switch(this.type){case"point":this._geometry=this.editGeometry.toPoint();break;case"polyline":this._geometry=this.editGeometry.toPolyline();break;case"polygon":this._geometry=this.editGeometry.toPolygon()}this._dirty=!1}return this._geometry}}},66497:(e,t,i)=>{"use strict";i.d(t,{g:()=>n});var s=i(59472),r=i(97450);class n{constructor(e,t,i){this.editGeometry=e,this.component=t,this.pos=i,this.addedVertex=null,this.originalEdge=null,this.left=null,this.right=null}apply(){let e="redo";if((0,s.Wi)(this.addedVertex)&&(e="apply",this.addedVertex=new r.Xz(this.component)),0===this.component.vertices.length)this.component.vertices.push(this.addedVertex),this.addedVertex.pos=this.pos,this.addedVertex.index=0;else{const e=(0,s.Wg)(this.component.getLastVertex());let t=null;e.right&&(this.originalEdge=e.right,t=this.originalEdge.right,this.component.edges.splice(this.component.edges.indexOf(this.originalEdge),1)),this.component.vertices.push(this.addedVertex),this.addedVertex.pos=this.pos,(0,s.Wi)(this.left)&&(this.left=new r.kS(this.component,e,this.addedVertex)),this.component.edges.push(this.left),e.right=this.left,(0,s.pC)(this.originalEdge)&&(0,s.pC)(t)&&((0,s.Wi)(this.right)&&(this.right=new r.kS(this.component,this.addedVertex,t)),this.component.edges.push(this.right),t.left=this.right),this.component.updateVertexIndex(this.addedVertex,e.index+1)}const t={addedVertices:[this.addedVertex],operation:e};this.editGeometry.emit("change",t)}undo(){if((0,s.Wi)(this.addedVertex))return null;this.component.vertices.splice(this.component.vertices.indexOf(this.addedVertex),1),(0,s.pC)(this.left)&&(this.component.edges.splice(this.component.edges.indexOf(this.left),1),this.left.left.right=null),(0,s.pC)(this.right)&&(this.component.edges.splice(this.component.edges.indexOf(this.right),1),this.right.right.left=null),(0,s.pC)(this.originalEdge)&&(this.component.edges.push(this.originalEdge),this.originalEdge.left.right=this.originalEdge,this.originalEdge.right.left=this.originalEdge),(0,s.pC)(this.left)?this.component.updateVertexIndex(this.left.left,this.left.left.index):this.component.updateVertexIndex(this.addedVertex,0);const e={removedVertices:[this.addedVertex],operation:"undo"};this.editGeometry.emit("change",e)}accumulate(e){return!1}}},74239:(e,t,i)=>{"use strict";i.d(t,{c:()=>c});var s=i(56140),r=i(79881),n=i(87566),o=i(58385),a=i(78745);let h=class extends o.wq{constructor(){super(...arguments),this.enabled=!0}};(0,s._)([(0,r.Cb)({type:Boolean})],h.prototype,"enabled",void 0),h=(0,s._)([(0,n.j)("esri.views.interactive.snapping.Settings.DefaultSnappingAlgorithm")],h);let d=class extends o.wq{constructor(e){super(e),this.lineSnapper=new h,this.parallelLineSnapper=new h,this.rightAngleSnapper=new h,this.rightAngleTriangleSnapper=new h,this.shortLineThreshold=15,this.proximityThreshold=5,this.pointThreshold=1e-6,this.intersectionParallelLineThreshold=1e-6,this.parallelLineThreshold=1e-6,this.touchSensitivityMultiplier=1.5,this.pointOnLineThreshold=1e-6,this.orange=new a.default([255,127,0]),this.lineHintWidthReference=3,this.lineHintWidthTarget=3,this.lineHintFadedExtensions=.3,this.parallelLineHintWidth=2,this.parallelLineHintLength=24,this.parallelLineHintOffset=1.5,this.rightAngleHintSize=24,this.rightAngleHintOutlineSize=1.5}};(0,s._)([(0,r.Cb)({type:h,constructOnly:!0,nonNullable:!0,json:{write:!0}})],d.prototype,"lineSnapper",void 0),(0,s._)([(0,r.Cb)({type:h,constructOnly:!0,nonNullable:!0,json:{write:!0}})],d.prototype,"parallelLineSnapper",void 0),(0,s._)([(0,r.Cb)({type:h,constructOnly:!0,nonNullable:!0,json:{write:!0}})],d.prototype,"rightAngleSnapper",void 0),(0,s._)([(0,r.Cb)({type:h,constructOnly:!0,nonNullable:!0,json:{write:!0}})],d.prototype,"rightAngleTriangleSnapper",void 0),(0,s._)([(0,r.Cb)({type:Number,nonNullable:!0,range:{min:-1,max:50,step:1},json:{write:!0}})],d.prototype,"shortLineThreshold",void 0),(0,s._)([(0,r.Cb)({type:Number,nonNullable:!0,range:{min:-1,max:50,step:1},json:{write:!0}})],d.prototype,"proximityThreshold",void 0),(0,s._)([(0,r.Cb)({type:Number,nonNullable:!0,range:{min:0,max:1e-5},json:{write:!0}})],d.prototype,"pointThreshold",void 0),(0,s._)([(0,r.Cb)({type:Number,nonNullable:!0,range:{min:0,max:1e-5},json:{write:!0}})],d.prototype,"intersectionParallelLineThreshold",void 0),(0,s._)([(0,r.Cb)({type:Number,nonNullable:!0,range:{min:0,max:1e-5},json:{write:!0}})],d.prototype,"parallelLineThreshold",void 0),(0,s._)([(0,r.Cb)({type:Number,nonNullable:!0,range:{min:0,max:10},json:{write:!0}})],d.prototype,"touchSensitivityMultiplier",void 0),(0,s._)([(0,r.Cb)({type:Number,nonNullable:!0,range:{min:0,max:1e-5},json:{write:!0}})],d.prototype,"pointOnLineThreshold",void 0),(0,s._)([(0,r.Cb)({type:a.default,nonNullable:!0})],d.prototype,"orange",void 0),(0,s._)([(0,r.Cb)({type:Number,nonNullable:!0,range:{min:0,max:10},json:{write:!0}})],d.prototype,"lineHintWidthReference",void 0),(0,s._)([(0,r.Cb)({type:Number,nonNullable:!0,range:{min:0,max:10},json:{write:!0}})],d.prototype,"lineHintWidthTarget",void 0),(0,s._)([(0,r.Cb)({type:Number,nonNullable:!0,range:{min:0,max:1},json:{write:!0}})],d.prototype,"lineHintFadedExtensions",void 0),(0,s._)([(0,r.Cb)({type:Number,nonNullable:!0,range:{min:0,max:10},json:{write:!0}})],d.prototype,"parallelLineHintWidth",void 0),(0,s._)([(0,r.Cb)({type:Number,nonNullable:!0,range:{min:0,max:50},json:{write:!0}})],d.prototype,"parallelLineHintLength",void 0),(0,s._)([(0,r.Cb)({type:Number,nonNullable:!0,range:{min:0,max:5},json:{write:!0}})],d.prototype,"parallelLineHintOffset",void 0),(0,s._)([(0,r.Cb)({type:Number,nonNullable:!0,range:{min:0,max:46},json:{write:!0}})],d.prototype,"rightAngleHintSize",void 0),(0,s._)([(0,r.Cb)({type:Number,nonNullable:!0,range:{min:0,max:6},json:{write:!0}})],d.prototype,"rightAngleHintOutlineSize",void 0),d=(0,s._)([(0,n.j)("esri.views.interactive.snapping.Settings.Defaults")],d);const c=new d},49659:(e,t,i)=>{"use strict";i.d(t,{N:()=>s});class s{constructor(e){this.vertexHandle=null,this.excludeFeature=null,this.geometry=e.geometry,this.elevationInfo=e.elevationInfo,this.pointer=e.pointer,this.vertexHandle=e.vertexHandle,this.excludeFeature=e.excludeFeature}get coordinateHelper(){return this.geometry.editGeometry.coordinateHelper}}},80532:(e,t,i)=>{"use strict";i.d(t,{N:()=>Ee});var s=i(56140),r=(i(95830),i(59472)),n=(i(36544),i(68055),i(79881)),o=i(87566),a=(i(10923),i(57002),i(86035),i(39105)),h=i(9419),d=i(73032),c=i(61106),l=i(35470),p=i(14286),u=i(77204),v=i(9434),g=i(7344),m=i(82677),f=i(45671),_=i(77293);class y{constructor(e,t,i){this.coordinateHelper=e,this.targetPoint=t,this.constraint=i}}class w extends y{constructor({coordinateHelper:e,targetPoint:t,objectId:i,constraint:s}){super(e,t,s),this.objectId=i}}var x=i(5632),C=i(6635),b=i(59691),T=i(77195);class S extends T.q{constructor(e){super("FeatureServiceSnappingSourceWorker","fetchCandidates",e,{strategy:"dedicated"}),this.events=new l.Z,this.updatingTracking=new f.t,this.handles=new b.Z,this.handles.add(this.updatingTracking.watch("updating",(()=>this.events.emit("updating-changed")))),this.handles.add((0,x.ed)(this.updatingTracking))}destroy(){super.destroy(),this.handles.destroy()}get updating(){return this.updatingTracking.updating}async initialize(e,t){const i=this.serviceInfoFromLayer(e.layer);if((0,r.Wi)(i))return;const s={configuration:this.convertConfiguration(e.configuration),serviceInfo:i,spatialReference:e.spatialReference.toJSON()};await this.updatingTracking.addPromise(this.invokeMethod("initialize",s,t)),this.updatingTracking.addPromise(this.invokeMethod("whenLoaded",{},null))}async configure(e,t){const i=this.convertConfiguration(e);await this.updatingTracking.addPromise(this.invokeMethod("configure",i,t)),this.updatingTracking.addPromise(this.invokeMethod("whenLoaded",{},null))}async fetchCandidates(e,t){const i={distance:e.distance,point:e.coordinateHelper.toPoint(e.point,new c.Z).toJSON(),types:e.types,filter:(0,r.pC)(e.filter)?e.filter.createQuery().toJSON():null};return this.invoke(i,t)}getTransferList(){return[]}convertConfiguration(e){return{filter:(0,r.pC)(e.filter)?e.filter.toJSON():null,customParameters:e.customParameters}}serviceInfoFromLayer(e){var t;return"multipatch"===e.geometryType||"mesh"===e.geometryType?null:{url:e.parsedUrl.path,fields:e.fields.map((e=>e.toJSON())),geometryType:C.Mk.toJSON(e.geometryType),capabilities:e.capabilities,hasM:e.hasM,hasZ:e.hasZ,objectIdField:e.objectIdField,spatialReference:e.spatialReference.toJSON(),timeInfo:null==(t=e.timeInfo)?void 0:t.toJSON()}}}var P=i(55735),V=i(74239),H=i(33655);function E(e,t){return e[0]*t[1]-e[1]*t[0]}function I(e,t,i){const s=(t[0]-e[0])*(i[1]-e[1])-(t[1]-e[1])*(i[0]-e[0]);return Math.abs(s)/(0,p.d)(t,i)}function M(e,t,i,s,r=i){return(0,p.e)(Z,s,i),(0,p.e)(G,t,r),function(e,t,i){const s=(0,p.h)(i,t)/(0,p.q)(i);(0,p.a)(e,i,s)}(F,G,Z),(0,p.i)(e,r,F)}function O(e,t,i,s){(0,p.e)(Z,t,i);const r=s/(0,p.l)(Z);return(0,p.p)(e,i,Z,r)}function k(e,t){return M(G,t,e.start,e.end),(0,H.W8)(G[0],t[0])&&(0,H.W8)(G[1],t[1])?[(0,P.b)(t)]:[]}function D(e,t,i){return O(G,i,e,t),(0,H.W8)(G[0],i[0])&&(0,H.W8)(G[1],i[1])?[(0,P.b)(i)]:[]}function R(e,t,i){const s=[],r=(0,p.e)(Z,e.end,e.start),n=(0,p.e)(L,e.start,t),o=(0,p.q)(r),a=2*(0,p.h)(r,n),h=a*a-4*o*((0,p.q)(n)-i*i);if(0===h){const t=-a/(2*o);(1===e.type||t>=0)&&s.push((0,p.p)(F,e.start,r,t))}else if(h>0){const t=Math.sqrt(h),i=(-a+t)/(2*o);(1===e.type||i>=0)&&s.push((0,p.p)(F,e.start,r,i));const n=(-a-t)/(2*o);(1===e.type||n>=0)&&s.push((0,p.p)(G,e.start,r,n))}return s}const A=1e-6,Z=(0,P.c)(),L=(0,P.c)(),G=(0,P.c)(),F=(0,P.c)();class z{constructor(e){this.coordinateHelper=e}}class j extends z{constructor(e,t){super(e),this.point=t}objectEqual(e){return e instanceof j&&(0,g.Xv)(this.point,e.point)}check(e){return(0,p.j)(e,this.point)<V.c.pointThreshold}closestTo(){return this.coordinateHelper.clone(this.point)}intersect(e){const t=[];return e instanceof U?t.push(...k({start:e.start,end:e.end,type:e instanceof N?1:0},this.point)):e instanceof B&&t.push(...D(e.center,e.radius,this.point)),t.map((t=>new q(this.coordinateHelper,t,this,e)))}}class U extends z{constructor(e,t,i){super(e),this.start=t,this.end=i}objectEqual(e){return e instanceof U&&(0,g.Xv)(this.start,e.start)&&(0,g.Xv)(this.end,e.end)}intersect(e){const t=[];return e instanceof j?t.push(...k({start:this.start,end:this.end,type:this instanceof N?1:0},e.point)):e instanceof U?t.push(...function(e,t){const i=e.start,s=e.end,r=t.start,n=t.end,o=(0,p.e)(Z,s,i),a=(0,p.e)(L,n,r),h=E(o,a);if(Math.abs(h)<=A)return[];const d=(0,p.e)(G,i,r),c=E(a,d)/h,l=E(o,d)/h;if(c>=0){if(l>=0||1===t.type)return[(0,p.p)(F,i,o,c)]}else if(1===e.type&&(l>=0||1===t.type))return[(0,p.p)(F,i,o,c)];return[]}({start:this.start,end:this.end,type:this instanceof N?1:0},{start:e.start,end:e.end,type:e instanceof N?1:0})):e instanceof B&&t.push(...R({start:this.start,end:this.end,type:this instanceof N?1:0},e.center,e.radius)),t.map((t=>new q(this.coordinateHelper,t,this,e)))}}class W extends U{constructor(e,t,i){super(e,t,i),this.dir=(0,P.c)(),this.p=(0,P.c)()}objectEqual(e){return e instanceof W&&super.objectEqual(e)}check(e){return(0,p.e)(this.dir,this.end,this.start),(0,p.e)(this.p,e,this.start),(0,p.h)(this.dir,this.p)>=0&&I(e,this.start,this.end)<V.c.pointOnLineThreshold}closestTo(e){const t=this.coordinateHelper.clone(e);return function(e,t,i,s){(0,p.e)(Z,s,i),(0,p.e)(G,t,i);const r=(0,p.h)(Z,G)/(0,p.q)(Z);r>0?(0,p.p)(e,i,Z,r):(0,p.c)(e,i)}(t,e,this.start,this.end),t}}class N extends U{constructor(e,t,i){super(e,t,i)}objectEqual(e){return e instanceof N&&super.objectEqual(e)}check(e){return I(e,this.start,this.end)<V.c.pointOnLineThreshold}closestTo(e){const t=this.coordinateHelper.clone(e);return M(t,e,this.start,this.end),t}}class q extends z{constructor(e,t,i,s){super(e),this.intersection=t,this.first=i,this.second=s}objectEqual(e){return e instanceof q&&this.first.objectEqual(e.first)&&this.second.objectEqual(e.second)}check(){return!1}closestTo(e){const t=this.coordinateHelper.clone(e);return(0,p.c)(t,this.intersection),t}intersect(){return[]}}class B extends z{constructor(e,t,i){super(e),this.center=t,this.radius=i}objectEqual(e){return e instanceof B&&this.center[0]===e.center[0]&&this.center[1]===e.center[1]&&this.radius===e.radius}check(){return!1}closestTo(e){const t=this.coordinateHelper.clone(e);return O(t,e,this.center,this.radius),t}intersect(e){const t=[];return e instanceof U?t.push(...R({start:e.start,end:e.end,type:e instanceof N?1:0},this.center,this.radius)):e instanceof j&&t.push(...D(this.center,this.radius,e.point)),t.map((t=>new q(this.coordinateHelper,t,this,e)))}}var X=i(29895);class Y extends w{constructor(e){super({...e,constraint:new N(e.coordinateHelper,e.edgeStart,e.edgeEnd)})}get hints(){return[new X.w(1,this.constraint.start,this.constraint.end)]}}var J=i(2826);class Q extends w{constructor(e){super({...e,constraint:new j(e.coordinateHelper,e.targetPoint)})}get hints(){return[new J.n(this.targetPoint)]}}function $(e,t){switch(e.type){case"edge":return new Y({coordinateHelper:t,edgeStart:t.fromPoint(e.start),edgeEnd:t.fromPoint(e.end),targetPoint:t.fromPoint(e.target),objectId:e.objectId});case"vertex":return new Q({coordinateHelper:t,targetPoint:t.fromPoint(e.target),objectId:e.objectId})}}let K=class extends((0,u.p)(m.default)){constructor(e){super(e)}get updating(){return this.workerHandle.updating}get configuration(){return{filter:this.layer.createQuery(),customParameters:this.layer.customParameters}}initialize(){this.workerHandle=new S((0,r.pC)(this.view)&&"3d"===this.view.type?this.view.resourceController.scheduler:null),this.handles.add((0,x.ed)(this.workerHandle)),this.handles.add(this.workerHandle.events.on("updating-changed",(()=>this.notifyChange("updating")))),this.workerHandle.initialize({layer:this.layer,spatialReference:this.spatialReference,configuration:this.configuration},null),this.handles.add((0,h.U5)((()=>this.configuration),(e=>this.workerHandle.configure(e,null))))}async fetchCandidates(e,t){const{candidates:i}=await this.workerHandle.fetchCandidates({...e,filter:null},t);return{candidates:i.map((t=>$(t,e.coordinateHelper)))}}};(0,s._)([(0,n.Cb)({constructOnly:!0})],K.prototype,"spatialReference",void 0),(0,s._)([(0,n.Cb)({constructOnly:!0})],K.prototype,"layer",void 0),(0,s._)([(0,n.Cb)({constructOnly:!0})],K.prototype,"view",void 0),(0,s._)([(0,n.Cb)({readOnly:!0})],K.prototype,"updating",null),(0,s._)([(0,n.Cb)({readOnly:!0})],K.prototype,"configuration",null),K=(0,s._)([(0,o.j)("esri.views.interactive.snapping.featureSources.FeatureServiceSnappingSource")],K);var ee=i(19677),te=i(53817),ie=i(17333),se=i(44195),re=i(31036),ne=i(82244),oe=i(77142),ae=i(21895);let he=class extends((0,u.p)(m.default)){constructor(e){super(e),this.sources={multipoint:null,point:null,polygon:null,polyline:null},this.loadedWkids=new Set,this.loadedWkts=new Set,this.pendingAdds=[]}get updating(){return this.updatingHandles.updating}destroy(){const e=this.pendingAdds;this.pendingAdds.length=0;for(const t of e)t.task.abort();this.mapSources((e=>this.destroySource(e)))}initialize(){this.handles.add([this.layer.on("graphic-update",(e=>this.onGraphicUpdate(e))),this.updatingHandles.addOnCollectionChange(this.layer.graphics,(e=>this.onGraphicsChanged(e)))]),this.addMany(this.layer.graphics.toArray())}async fetchCandidates(e,t){const i=(await(0,a.eachAlwaysValues)(this.mapSources((i=>i.queryEngine.executeQueryForSnapping({point:e.coordinateHelper.toPoint(e.point,new c.Z).toJSON(),distance:e.distance,types:e.types,query:(0,r.pC)(e.filter)?e.filter.createQuery().toJSON():{where:"1=1"}},t).then((({candidates:e})=>e)))))).flat().map((t=>$(t,e.coordinateHelper)));return(0,g.lQ)(e.point,i),{candidates:i}}onGraphicUpdate(e){switch(e.property){case"geometry":case"visible":this.remove(e.graphic),this.addMany([e.graphic])}}onGraphicsChanged(e){for(const t of e.removed)this.remove(t);this.addMany(e.added)}addMany(e){const t=[],i=new Map;for(const s of e)(0,r.Wi)(s.geometry)||(this.needsInitializeProjection(s.geometry.spatialReference)?(t.push(s.geometry.spatialReference),i.set(s.uid,s)):this.add(s));this.createPendingAdd(t,i)}createPendingAdd(e,t){if(!e.length)return;const i=(0,a.createTask)((async i=>{await(0,ie.iQ)(e.map((e=>({source:e,dest:this.spatialReference}))),{signal:i}),this.markLoadedSpatialReferences(e);for(const[,e]of t)this.add(e)}));this.updatingHandles.addPromise(i.promise);const s={task:i,graphics:t},r=()=>(0,ee.e$)(this.pendingAdds,s);i.promise.then(r,r),this.pendingAdds.push(s)}markLoadedSpatialReferences(e){for(const t of e)null!=t.wkid&&this.loadedWkids.add(t.wkid),null!=t.wkt&&this.loadedWkts.add(t.wkt)}add(e){if((0,r.Wi)(e.geometry)||!e.visible)return;let t=e.geometry;if("mesh"===t.type)return;"extent"===t.type&&(t=te.Z.fromExtent(t));const i=this.ensureSource(t.type);if((0,r.Wi)(i))return;const s=this.createOptimizedFeature(e.uid,t);(0,r.pC)(s)&&i.featureStore.add(s)}needsInitializeProjection(e){return!(null!=e.wkid&&this.loadedWkids.has(e.wkid)||null!=e.wkt&&this.loadedWkts.has(e.wkt)||(0,ie.Up)(e,this.spatialReference))}createOptimizedFeature(e,t){const i=(0,ie.iV)((0,ne.U)(t),this.spatialReference);return i?new se.Z((0,re.GH)(i,!1,!1),{[de]:e},null,e):null}ensureSource(e){const t=this.sources[e];if((0,r.pC)(t))return t;const i=this.createSource(e);return this.sources[e]=i,i}createSource(e){const t=C.Mk.toJSON(e),i=new oe.Z({geometryType:t,hasZ:!1,hasM:!1});return{featureStore:i,queryEngine:new ae.Z({featureStore:i,fields:[{name:de,type:"esriFieldTypeOID",alias:de}],geometryType:t,hasM:!1,hasZ:!1,objectIdField:de,spatialReference:this.spatialReference,scheduler:(0,r.pC)(this.view)&&"3d"===this.view.type?this.view.resourceController.scheduler:null}),type:e}}remove(e){this.mapSources((t=>this.removeFromSource(t,e)));for(const t of this.pendingAdds)t.graphics.delete(e.uid),0===t.graphics.size&&t.task.abort()}removeFromSource(e,t){const i=t.uid;e.featureStore.has(i)&&(e.featureStore.removeById(t.uid),0===e.featureStore.numFeatures&&this.destroySource(e))}destroySource(e){e.queryEngine.destroy(),this.sources[e.type]=null}mapSources(e){const{point:t,polygon:i,polyline:s,multipoint:n}=this.sources,o=[];return(0,r.pC)(t)&&o.push(e(t)),(0,r.pC)(i)&&o.push(e(i)),(0,r.pC)(s)&&o.push(e(s)),(0,r.pC)(n)&&o.push(e(n)),o}};(0,s._)([(0,n.Cb)({constructOnly:!0})],he.prototype,"spatialReference",void 0),(0,s._)([(0,n.Cb)({constructOnly:!0})],he.prototype,"layer",void 0),(0,s._)([(0,n.Cb)({constructOnly:!0})],he.prototype,"view",void 0),(0,s._)([(0,n.Cb)({readOnly:!0})],he.prototype,"updating",null),he=(0,s._)([(0,o.j)("esri.views.interactive.snapping.featureSources.GraphicsSnappingSource")],he);const de="OBJECTID";let ce=class extends m.default{constructor(e){super(e),this.options=new v.g,this.updatingTracking=new f.t}get updating(){return(0,_.o)(this.snappingSources,(e=>e.updating))||this.updatingTracking.updating}get snappingSources(){var e;const t=this._get("snappingSources")||new Map,i=new Map;if(null!=(e=this.options)&&e.featureSources)for(const e of this.options.featureSources.items){const s=e.layer.uid,n=t.get(s);if(n){t.delete(s),i.set(s,n);continue}if(!e.layer.loaded){this.updatingTracking.addPromise(e.layer.load());continue}const o=this.createFeatureSnappingSource(e);(0,r.pC)(o)&&i.set(s,o)}for(const[,e]of t)e.destroy();return i}getCandidates(){return[]}destroy(){this.updatingTracking.destroy(),this._set("options",null);for(const[,e]of this.snappingSources)e.destroy()}async fetchCandidates(e,t,i){if(!this.options.effectiveFeatureEnabled)return[];const s=[],r={distance:this.computeScreeenSizeDistanceParameters(e,t),point:e,coordinateHelper:t.coordinateHelper,types:this.types,filter:null};for(const[,e]of this.snappingSources)s.push(e.fetchCandidates(r,i).then((({candidates:i})=>i.filter((i=>!this.candidateIsExcluded(e,i,t.excludeFeature))))));const n=(await(0,a.eachAlwaysValues)(s)).flat();return(0,a.throwIfAborted)(i),(0,g.lQ)(e,n),n}computeScreeenSizeDistanceParameters(e,{coordinateHelper:t,elevationInfo:i,pointer:s}){const n=this.options.proximityThreshold*("touch"===s?this.options.touchSensitivityMultiplier:1);if((0,r.Wi)(this.view))return{x:n,y:n};const o=t.clone(e);o[0]+=1,o[1]+=1;const a=(0,g.a7)(e,t,i,this.view),h=(0,g.a7)(o,t,i,this.view);return{x:n/Math.abs(h.x-a.x),y:n/Math.abs(h.y-a.y)}}get types(){let e=0;return this.options.featureEdgeEnabled&&(e|=1),this.options.featureVertexEnabled&&(e|=2),e}candidateIsExcluded(e,t,i){if((0,r.Wi)(i))return!1;const s=this.getCandidateObjectId(t);return!(0,r.Wi)(s)&&i.sourceLayer===e.layer&&!(!i.attributes||!("objectIdField"in e.layer))&&i.attributes[e.layer.objectIdField]===s}getCandidateObjectId(e){return e instanceof w?e.objectId:null}createFeatureSnappingSource(e){const t=e.layer;switch(t.type){case"feature":return this.createFeatureSnappingSourceFeatureLayer(e);case"graphics":return new he({spatialReference:this.spatialReference,view:this.view,layer:t})}return null}createFeatureSnappingSourceFeatureLayer({layer:e}){return"memory"!==e.source.type?new K({spatialReference:this.spatialReference,view:this.view,layer:e}):null}};(0,s._)([(0,n.Cb)({constructOnly:!0})],ce.prototype,"spatialReference",void 0),(0,s._)([(0,n.Cb)({constructOnly:!0})],ce.prototype,"view",void 0),(0,s._)([(0,n.Cb)({constructOnly:!0})],ce.prototype,"options",void 0),(0,s._)([(0,n.Cb)({readOnly:!0})],ce.prototype,"updating",null),(0,s._)([(0,n.Cb)({readOnly:!0})],ce.prototype,"snappingSources",null),ce=(0,s._)([(0,o.j)("esri.views.interactive.snapping.FeatureSnappingEngine")],ce);var le=i(28293);class pe{constructor(e,t){this.view=e,this.options=t,this.squaredShortLineThreshold=V.c.shortLineThreshold*V.c.shortLineThreshold;const i=t.proximityThreshold*t.touchSensitivityMultiplier;this._squaredTouchProximityThreshold=i*i,this._squaredMouseProximityTreshold=t.proximityThreshold*t.proximityThreshold}snap(e,t){return(0,r.pC)(t.vertexHandle)?"vertex"!==t.vertexHandle.type?[]:this.snapExistingVertex(e,t):this.snapNewVertex(e,t)}edgeExceedsShortLineThreshold(e,t){return this.exceedsShortLineThreshold(e.left.pos,e.right.pos,t)}exceedsShortLineThreshold(e,t,{elevationInfo:i,geometry:s}){const r=s.editGeometry.coordinateHelper;return 0===this.squaredShortLineThreshold||(0,g.tp)((0,g.a7)(t,r,i,this.view),(0,g.a7)(e,r,i,this.view))>this.squaredShortLineThreshold}squaredProximityTreshold(e){return"touch"===e?this._squaredTouchProximityThreshold:this._squaredMouseProximityTreshold}}class ue extends y{constructor({coordinateHelper:e,lineStart:t,lineEnd:i,targetPoint:s}){super(e,s,new N(e,t,i)),this.referenceLineHint=new X.w(2,t,i)}get hints(){return[this.referenceLineHint,new X.w(0,this.lineEndClosestToTarget(),this.targetPoint)]}lineEndClosestToTarget(){const e=this.constraint.start,t=this.constraint.end;return(0,H.Xx)((0,p.h)((0,p.e)(ge,t,e),(0,p.e)(ve,this.targetPoint,e)))>0?t:e}}const ve=(0,P.c)(),ge=(0,P.c)();class me extends pe{snapNewVertex(e,t){const i=t.geometry.editGeometry.components[0],s=i.edges.length,r=[];if(s<1)return r;const n=t.coordinateHelper,o=(0,g.a7)(e,n,t.elevationInfo,this.view),a=i.edges[s-1];let h=a;do{this.edgeExceedsShortLineThreshold(h,t)&&this._processCandidateProposal(h.left.pos,h.right.pos,e,o,t,r),h=h.left.left}while(h&&h!==a);return r}snapExistingVertex(e,t){const i=[],s=(0,r.Wg)(t.vertexHandle),n=s.component;if(n.edges.length<2)return i;const o=t.coordinateHelper,a=(0,g.a7)(e,o,t.elevationInfo,this.view),h=s.left,d=s.right;h&&d&&this.edgeExceedsShortLineThreshold(h,t)&&this.edgeExceedsShortLineThreshold(d,t)&&this._processCandidateProposal(h.left.pos,d.right.pos,e,a,t,i);const c=n.edges[0];let l=c;do{l!==s.left&&l!==s.right&&this.edgeExceedsShortLineThreshold(l,t)&&this._processCandidateProposal(l.left.pos,l.right.pos,e,a,t,i),l=l.right.right}while(l&&l!==c);return i}_processCandidateProposal(e,t,i,s,r,n){const o=M((0,P.c)(),i,e,t),a=r.coordinateHelper,h=a.fromXYZ(o,a.getZ(i,0));(0,g.tp)(s,(0,g.a7)(h,a,r.elevationInfo,this.view))<this.squaredProximityTreshold(r.pointer)&&n.push(new ue({coordinateHelper:r.coordinateHelper,lineStart:e,lineEnd:t,targetPoint:h}))}}var fe=i(31046);class _e extends y{constructor({coordinateHelper:e,referenceLine:t,lineStart:i,targetPoint:s}){const r=e.clone(i);(0,p.e)(r,(0,p.i)(r,r,t.right.pos),t.left.pos),super(e,s,new N(e,i,r)),this._referenceLines=[{edge:t,fadeLeft:!0,fadeRight:!0}]}get hints(){return[new X.w(0,this.constraint.start,this.targetPoint),new fe.L(this.constraint.start,this.targetPoint),...this._referenceLines.map((e=>new X.w(1,e.edge.left.pos,e.edge.right.pos,e.fadeLeft,e.fadeRight)))]}addReferenceLine(e){const t={edge:e,fadeLeft:!0,fadeRight:!0};this._referenceLines.forEach((i=>{e.right.right===i.edge&&(i.fadeLeft=!1,t.fadeRight=!1),e.left.left===i.edge&&(i.fadeRight=!1,t.fadeLeft=!1)})),this._referenceLines.push(t)}}class ye extends pe{constructor(){super(...arguments),this._tmpProjection=(0,P.c)()}snapNewVertex(e,t){const i=t.geometry.editGeometry.components[0],s=i.edges.length,r=i.vertices.length,n=[];if(s<2)return n;const o=(0,g.a7)(e,t.coordinateHelper,t.elevationInfo,this.view),a=i.vertices[r-1],h=i.vertices[0],d=i.edges[s-1];let c=d;do{this.edgeExceedsShortLineThreshold(c,t)&&(this._checkEdgeForParalleLines(c,a.pos,e,o,t,n),this._checkEdgeForParalleLines(c,h.pos,e,o,t,n)),c=c.left.left}while(c&&c!==d);return n}snapExistingVertex(e,t){const i=[],s=(0,r.Wg)(t.vertexHandle),n=s.component;if(n.edges.length<3)return i;const o=(0,g.a7)(e,t.coordinateHelper,t.elevationInfo,this.view),a=s.left,h=s.right,d=n.vertices[0],c=n.vertices.length,l=n.vertices[c-1],p=n.edges[0];let u=p;do{u!==a&&u!==h&&this.edgeExceedsShortLineThreshold(u,t)&&(a&&this._checkEdgeForParalleLines(u,a.left.pos,e,o,t,i),h&&this._checkEdgeForParalleLines(u,h.right.pos,e,o,t,i),s===d?this._checkEdgeForParalleLines(u,l.pos,e,o,t,i):s===l&&this._checkEdgeForParalleLines(u,d.pos,e,o,t,i)),u=u.right.right}while(u&&u!==p);return i}_checkEdgeForParalleLines(e,t,i,s,r,n){const o=e.left.pos,a=e.right.pos;if(M(this._tmpProjection,t,o,a),(0,p.j)(this._tmpProjection,t)<V.c.parallelLineThreshold)return;M(this._tmpProjection,i,o,a,t);const h=r.coordinateHelper,d=h.fromXYZ(this._tmpProjection,h.getZ(i,0));if((0,g.tp)(s,(0,g.a7)(d,h,r.elevationInfo,this.view))<this.squaredProximityTreshold(r.pointer)){if(this.parallelToPreviousCandidate(e,n))return;n.push(new _e({coordinateHelper:h,referenceLine:e,lineStart:t,targetPoint:d}))}}parallelToPreviousCandidate(e,t){const i=e.left.pos,s=e.right.pos;for(const r of t)if(M(this._tmpProjection,s,r.constraint.start,r.constraint.end,i),(0,p.j)(this._tmpProjection,s)<V.c.parallelLineThreshold)return r.addReferenceLine(e),!0;return!1}}var we=i(54352);class xe extends y{constructor({coordinateHelper:e,targetPoint:t,constraint:i,previousVertex:s,centerVertex:r}){super(e,t,i),this.previousVertex=s,this.centerVertex=r,this.referenceLine=new X.w(1,s,i.start)}get hints(){return[new X.w(0,this.constraint.start,this.targetPoint),this.referenceLine,new we.y(this.previousVertex,this.centerVertex,this.targetPoint)]}}class Ce extends pe{constructor(){super(...arguments),this._tmp=(0,P.c)()}snapNewVertex(e,t){const i=t.geometry.editGeometry.components[0],s=i.vertices.length,r=[];if(s<2)return r;const n=(0,g.a7)(e,t.coordinateHelper,t.elevationInfo,this.view),o=i.vertices[s-1];this._checkForSnappingCandidate(r,o.left,o.pos,e,o.left.left.pos,o.pos,t,e,n);const a=i.vertices[0];return this._checkForSnappingCandidate(r,a.right,a.pos,e,a.right.right.pos,a.pos,t,e,n),r}snapExistingVertex(e,t){const i=[],s=(0,r.Wg)(t.vertexHandle),n=s.component,o=n.vertices.length;if(o<3)return i;const a=(0,g.a7)(e,t.coordinateHelper,t.elevationInfo,this.view),h=s.left,d=s.right,c=n.vertices[0],l=n.vertices[o-1];if(!h)return this._checkForSnappingCandidate(i,c.right.right.right,c.right.right.pos,e,c.right.right.right.right.pos,c.right.right.pos,t,e,a),i;if(!d)return this._checkForSnappingCandidate(i,l.left.left.left,l.left.left.pos,e,l.left.left.left.left.pos,l.left.left.pos,t,e,a),i;if(h&&h.left.left){const s=h.left.left;this._checkForSnappingCandidate(i,s,h.left.pos,e,s.left.pos,h.left.pos,t,e,a)}if(d&&d.right.right){const s=d.right.right;this._checkForSnappingCandidate(i,s,d.right.pos,e,s.right.pos,d.right.pos,t,e,a)}return i}_checkForSnappingCandidate(e,t,i,s,r,n,o,a,h){if(!this.edgeExceedsShortLineThreshold(t,o))return;(0,p.e)(this._tmp,t.right.pos,t.left.pos);const d=(0,P.f)(this._tmp[1],-this._tmp[0]),c=(0,p.h)(d,(0,p.e)(this._tmp,s,i))/(0,p.q)(d),l=o.coordinateHelper,u=l.fromXYZ((0,p.p)((0,P.c)(),n,d,c),l.getZ(a,0));(0,g.tp)(h,(0,g.a7)(u,l,o.elevationInfo,this.view))<this.squaredProximityTreshold(o.pointer)&&e.push(new xe({coordinateHelper:l,targetPoint:u,constraint:new W(l,n,(0,p.p)(l.createNew(),n,d,(0,H.Xx)(c))),previousVertex:r,centerVertex:n}))}}class be extends y{constructor({coordinateHelper:e,targetPoint:t,point1:i,point2:s}){super(e,t,new B(e,(0,p.m)(Te,i,s,.5),.5*(0,p.d)(i,s))),this.p1=i,this.p2=s}get hints(){return[new X.w(1,this.targetPoint,this.p1),new X.w(1,this.targetPoint,this.p2),new we.y(this.p1,this.targetPoint,this.p2)]}}const Te=(0,P.c)();class Se extends pe{snapNewVertex(e,t){const i=t.geometry.editGeometry.components[0],s=[],r=i.vertices.length;if("polygon"!==t.geometry.type||r<2)return s;const n=i.vertices[0],o=i.vertices[r-1];return this._processCandidateProposal(n.pos,o.pos,e,t,s),s}snapExistingVertex(e,t){const i=[],s=(0,r.Wg)(t.vertexHandle),n=s.component;return n.edges.length<2?i:"polyline"!==t.geometry.type||0!==s.index&&s.index!==n.vertices.length-1?(this._processCandidateProposal(s.left.left.pos,s.right.right.pos,e,t,i),i):i}_processCandidateProposal(e,t,i,s,r){if(!this.exceedsShortLineThreshold(e,t,s))return;const n=(0,p.m)((0,P.c)(),e,t,.5),o=.5*(0,p.d)(e,t),a=O((0,P.c)(),i,n,o),h=s.coordinateHelper,d=h.fromXYZ(a,h.getZ(i,0)),c=(0,g.a7)(i,h,s.elevationInfo,this.view);(0,g.tp)(c,(0,g.a7)(d,h,s.elevationInfo,this.view))<this.squaredProximityTreshold(s.pointer)&&r.push(new be({coordinateHelper:h,targetPoint:d,point1:e,point2:t}))}}let Pe=class extends m.default{constructor(e){super(e),this.updating=!1,this.options=new v.g,this._snappers=new le.Z}initialize(){this._snappers.push(new ye(this.view,this.options),new me(this.view,this.options),new Ce(this.view,this.options),new Se(this.view,this.options))}async fetchCandidates(e,t,i){const s=this.getCandidates(e,t);return(0,a.throwIfAborted)(i),s}getCandidates(e,t){if(!this.options.effectiveSelfEnabled)return[];const i=[];for(const s of this._snappers.items)i.push(...s.snap(e,t));return(0,g.lQ)(e,i),i}};(0,s._)([(0,n.Cb)({readOnly:!0})],Pe.prototype,"updating",void 0),(0,s._)([(0,n.Cb)({constructOnly:!0})],Pe.prototype,"view",void 0),(0,s._)([(0,n.Cb)({constructOnly:!0})],Pe.prototype,"options",void 0),Pe=(0,s._)([(0,o.j)("esri.views.interactive.snapping.SelfSnappingEngine")],Pe);var Ve=i(16332);class He extends y{constructor(e,t,i,s){super(e,t,new q(e,t,i.constraint,s.constraint)),this.first=i,this.second=s}get hints(){return this.first.targetPoint=this.targetPoint,this.second.targetPoint=this.targetPoint,[...this.first.hints,...this.second.hints,new Ve.w(this.targetPoint)]}}let Ee=class extends(l.Z.EventedMixin(u.r)){constructor(e){var t,i;super(e),this.options=new v.g,this.visualizer=null,this._currentSnappingCandidate=null;const s=e.options||this.options;this.selfEngine=new Pe({view:e.view,options:s}),this.featureEngine=new ce({view:e.view,spatialReference:null!=(t=null==(i=e.view)?void 0:i.spatialReference)?t:d.Z.WGS84,options:s}),this.handles.add((0,h.U5)((()=>{const{effectiveFeatureEnabled:e,featureEdgeEnabled:t,featureVertexEnabled:i,effectiveSelfEnabled:s,touchSensitivityMultiplier:r,proximityThreshold:n}=this.options;return{effectiveFeatureEnabled:e,effectiveSelfEnabled:s,featureEdgeEnabled:t,featureVertexEnabled:i,touchSensitivityMultiplier:r,proximityThreshold:n}}),(()=>{this.doneSnapping(),this.emit("changed")})))}destroy(){for(const e of this.engines)e.destroy();this.engines.length=0}get updating(){return this.engines.some((e=>e.updating))}get engines(){return[this.selfEngine,this.featureEngine]}get squaredMouseProximityTreshold(){return this.options.proximityThreshold*this.options.proximityThreshold}get squaredTouchProximityThreshold(){const{proximityThreshold:e,touchSensitivityMultiplier:t}=this.options,i=e*t;return i*i}async snap(e,t,i){const s=t.coordinateHelper.fromPoint(e),n=await this.fetchCandidates(s,t,i);return{get valid(){return!(0,a.isAborted)(i)},apply:()=>{const{snappedPoint:e,hints:i}=this.processCandidates(s,n,t);return this.removeVisualization(),(0,r.pC)(this.visualizer)&&this.handles.add(this.visualizer.draw(i,{coordinateHelper:t.coordinateHelper,elevationInfo:t.elevationInfo,view:this.view}),Ie),e}}}update(e,t){this.removeVisualization();let i=e,s=[];if((0,r.pC)(this._currentSnappingCandidate)){const r=t.coordinateHelper,n=r.fromPoint(e),o=this._currentSnappingCandidate.constraint.closestTo(n);(0,g.tp)((0,g.a7)(n,r,t.elevationInfo,this.view),(0,g.a7)(o,r,t.elevationInfo,this.view))<this.squaredPointProximityThreshold(t.pointer)?(this._currentSnappingCandidate.targetPoint=o,i=r.createDehydratedPoint(o),s=this._currentSnappingCandidate.hints):this._currentSnappingCandidate=null}return(0,r.pC)(this.visualizer)&&this.handles.add(this.visualizer.draw(s,{coordinateHelper:t.coordinateHelper,elevationInfo:t.elevationInfo,view:this.view}),Ie),i}doneSnapping(){this.removeVisualization(),this._currentSnappingCandidate=null}removeVisualization(){this.handles.remove(Ie)}async fetchCandidates(e,t,i){return(await Promise.all(this.engines.map((s=>s.fetchCandidates(e,t,i))))).flat()}processCandidates(e,t,i){if(t.length<1)return this.doneSnapping(),{snappedPoint:i.coordinateHelper.toPoint(e,new c.Z),hints:[]};if((0,g.lQ)(e,t),(0,r.pC)(this._currentSnappingCandidate)){const s=this.findOldConstraintInNewCandidates(this._currentSnappingCandidate,t);if(s>=0){if(!(t[s]instanceof He))return this.intersectWithOtherCandidates(s,t,e,i);if((0,p.j)(e,this._currentSnappingCandidate.targetPoint)<this.squaredPointProximityThreshold(i.pointer))return this.updateSnappingCandidate(this._currentSnappingCandidate,t,i)}}return this.intersectWithOtherCandidates(0,t,e,i)}findOldConstraintInNewCandidates(e,t){return e instanceof He?this.findOldCandidateIndex(t,e.first)>=0&&this.findOldCandidateIndex(t,e.second)>=0?0:-1:this.findOldCandidateIndex(t,e)}intersectWithOtherCandidates(e,t,i,s){const r=t[e],n=[],o=s.coordinateHelper;for(let a=0;a<t.length;++a){if(a===e)continue;const h=t[a];for(const e of r.constraint.intersect(h.constraint)){const t=o.fromXYZ(e.intersection,r.targetPoint[2]);n.push([new He(o,t,r,h),(0,g.tp)((0,g.a7)(i,s.coordinateHelper,s.elevationInfo,this.view),(0,g.a7)(t,s.coordinateHelper,s.elevationInfo,this.view))])}}return n.length>0&&(n.sort(((e,t)=>e[1]-t[1])),n[0][1]<this.squaredPointProximityThreshold(s.pointer))?this.updateSnappingCandidate(n[0][0],t,s):this.updateSnappingCandidate(r,t,s)}updateSnappingCandidate(e,t,i){this.doneSnapping(),this._currentSnappingCandidate=e;const s=this._currentSnappingCandidate.targetPoint,r=[];r.push(...e.hints);for(const i of t){if(e instanceof He){if(i.constraint.objectEqual(e.first.constraint)||i.constraint.objectEqual(e.second.constraint))continue}else if(i.constraint.objectEqual(e.constraint))continue;i.constraint.check(s)&&(i.targetPoint=s,r.push(...i.hints))}return{snappedPoint:i.coordinateHelper.createDehydratedPoint(s),hints:r}}squaredPointProximityThreshold(e){return"touch"===e?this.squaredTouchProximityThreshold:this.squaredMouseProximityTreshold}findOldCandidateIndex(e,t){let i=-1;for(let s=0;s<e.length;++s)if(t.constraint.objectEqual(e[s].constraint)){i=s;break}return i}get test(){return{visualizationsActive:this.handles.has(Ie)}}};(0,s._)([(0,n.Cb)({constructOnly:!0})],Ee.prototype,"view",void 0),(0,s._)([(0,n.Cb)()],Ee.prototype,"options",void 0),(0,s._)([(0,n.Cb)()],Ee.prototype,"visualizer",void 0),(0,s._)([(0,n.Cb)({readOnly:!0})],Ee.prototype,"updating",null),(0,s._)([(0,n.Cb)()],Ee.prototype,"selfEngine",void 0),(0,s._)([(0,n.Cb)()],Ee.prototype,"featureEngine",void 0),(0,s._)([(0,n.Cb)({readOnly:!0})],Ee.prototype,"engines",null),(0,s._)([(0,n.Cb)()],Ee.prototype,"squaredMouseProximityTreshold",null),(0,s._)([(0,n.Cb)()],Ee.prototype,"squaredTouchProximityThreshold",null),Ee=(0,s._)([(0,o.j)("esri.views.interactive.snapping.SnappingManager")],Ee);const Ie="visualization-handle"},9434:(e,t,i)=>{"use strict";i.d(t,{g:()=>d});var s=i(56140),r=(i(95830),i(36544),i(68055),i(79881)),n=i(87566),o=(i(10923),i(57002),i(86035),i(82677)),a=i(28293),h=i(74239);let d=class extends o.default{constructor(e){super(e),this.selfEnabled=!1,this.enabledToggled=!1,this.featureEnabled=!1,this.proximityThreshold=h.c.proximityThreshold,this.touchSensitivityMultiplier=h.c.touchSensitivityMultiplier,this.featureEdgeEnabled=!0,this.featureVertexEnabled=!0,this.featureSources=new a.Z}get effectiveSelfEnabled(){return this.enabledToggled?!this.selfEnabled:this.selfEnabled}get effectiveFeatureEnabled(){return(this.enabledToggled?!this.featureEnabled:this.featureEnabled)&&(this.featureEdgeEnabled||this.featureVertexEnabled)}};(0,s._)([(0,r.Cb)()],d.prototype,"selfEnabled",void 0),(0,s._)([(0,r.Cb)()],d.prototype,"enabledToggled",void 0),(0,s._)([(0,r.Cb)()],d.prototype,"featureEnabled",void 0),(0,s._)([(0,r.Cb)()],d.prototype,"proximityThreshold",void 0),(0,s._)([(0,r.Cb)()],d.prototype,"touchSensitivityMultiplier",void 0),(0,s._)([(0,r.Cb)()],d.prototype,"featureEdgeEnabled",void 0),(0,s._)([(0,r.Cb)()],d.prototype,"featureVertexEnabled",void 0),(0,s._)([(0,r.Cb)({type:a.Z})],d.prototype,"featureSources",void 0),(0,s._)([(0,r.Cb)({readOnly:!0})],d.prototype,"effectiveSelfEnabled",null),(0,s._)([(0,r.Cb)({readOnly:!0})],d.prototype,"effectiveFeatureEnabled",null),d=(0,s._)([(0,n.j)("esri.views.interactive.snapping.SnappingOptions")],d)},16332:(e,t,i)=>{"use strict";i.d(t,{w:()=>n});var s=i(7344),r=i(13407);class n extends r.r{constructor(e){super(),this.intersectionPoint=e}equals(e){return e instanceof n&&(0,s.Xv)(this.intersectionPoint,e.intersectionPoint)}}},29895:(e,t,i)=>{"use strict";i.d(t,{w:()=>o});i(95830);var s=i(36544),r=i(7344),n=i(13407);s.Z.getLogger("esri.views.interactive.snapping.hints.LineSnappingHint");class o extends n.r{constructor(e,t,i,s=!0,r=!0){super(),this.type=e,this.lineStart=t,this.lineEnd=i,this.fadeLeft=s,this.fadeRight=r}equals(e){return e instanceof o&&this.type===e.type&&(0,r.Xv)(this.lineStart,e.lineStart)&&(0,r.Xv)(this.lineEnd,e.lineEnd)&&this.fadeLeft===e.fadeLeft&&this.fadeRight===e.fadeRight}}},31046:(e,t,i)=>{"use strict";i.d(t,{L:()=>o});i(95830);var s=i(36544),r=i(7344),n=i(13407);s.Z.getLogger("esri.views.interactive.snapping.hints.ParallelSnappingHint");class o extends n.r{constructor(e,t){super(),this.lineStart=e,this.lineEnd=t}equals(e){return e instanceof o&&(0,r.Xv)(this.lineStart,e.lineStart)&&(0,r.Xv)(this.lineEnd,e.lineEnd)}}},2826:(e,t,i)=>{"use strict";i.d(t,{n:()=>n});var s=i(7344),r=i(13407);class n extends r.r{constructor(e){super(),this.point=e}equals(e){return e instanceof n&&(0,s.Xv)(this.point,e.point)}}},54352:(e,t,i)=>{"use strict";i.d(t,{y:()=>o});i(95830);var s=i(36544),r=i(7344),n=i(13407);s.Z.getLogger("esri.views.interactive.snapping.hints.RightAngleSnappingHint");class o extends n.r{constructor(e,t,i){super(),this.previousVertex=e,this.centerVertex=t,this.nextVertex=i}equals(e){return e instanceof o&&(0,r.Xv)(this.previousVertex,e.previousVertex)&&(0,r.Xv)(this.centerVertex,e.centerVertex)&&(0,r.Xv)(this.nextVertex,e.nextVertex)}}},13407:(e,t,i)=>{"use strict";i.d(t,{r:()=>s});class s{}},7344:(e,t,i)=>{"use strict";i.d(t,{$r:()=>l,a7:()=>c,Xv:()=>d,lQ:()=>p,tp:()=>h});var s=i(61106),r=i(96071),n=i(77625),o=i(14286),a=i(46970);function h(e,t){const i=e.x-t.x,s=e.y-t.y;return i*i+s*s}function d(e,t){const i=e.length===t.length&&e[0]===t[0]&&e[1]===t[1];switch(e.length){case 2:return i;case 3:return i&&e[2]===t[2];case 4:return i&&e[3]===t[3]}return!1}function c(e,t,i,s){return"2d"===s.type?s.toScreen(t.toPoint(e,g)):(l(e,t,i,s,u),s.state.camera.projectToScreen(u,v),(0,r.vW)(v[0],v[1]))}function l(e,t,i,s,r=(0,n.c)()){const o=t.toXYZ(e);return o[2]=(0,a.zx)(s,o,t.spatialReference,i)||0,s.renderCoordsHelper.toRenderCoords(o,t.spatialReference,r),r}function p(e,t){t.sort(((t,i)=>(0,o.j)(t.targetPoint,e)-(0,o.j)(i.targetPoint,e)))}const u=(0,n.c)(),v=(0,r.s1)(),g=new s.Z}}]);
//# sourceMappingURL=5834.js.map