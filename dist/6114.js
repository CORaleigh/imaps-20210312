(self.webpackChunkimaps=self.webpackChunkimaps||[]).push([[6114],{87790:(e,t,r)=>{"use strict";r.r(t),r.d(t,{default:()=>I});var s=r(56140),i=(r(95830),r(59472)),a=r(36544),o=(r(68055),r(79881)),n=r(30590),l=r(87566),c=r(32656),u=r(10923),h=(r(57002),r(86035),r(39105)),p=r(54721),d=r(56700),f=r(43072),y=r(19048),m=r(18152),b=r(78910),g=r(48899),v=r(33716),_=r(54856),w=r(92673);const x=a.Z.getLogger("esri.views.3d.support.WorkerHandle");class S extends class{constructor(e,t,r,s={}){this._methodName=t,this._promise=(0,w.bA)(e,{...s,scheduler:r}).then((e=>{void 0===this._thread?(this._thread=e,this._promise=null,s.hasInitialize&&this.broadcast({},"initialize")):e.close()})),this._promise.catch((t=>x.error(`Failed to initialize ${e} worker: ${t}`)))}destroy(){this._thread&&(this._thread.close(),this._thread=null),this._promise=null}invoke(e,t){if(this._thread){const r=this.getTransferList(e);return this._thread.invoke(this._methodName,e,{transferList:r,signal:t})}return this._promise?this._promise.then((()=>((0,h.throwIfAborted)(t),this.invoke(e,t)))):(0,h.reject)(null)}broadcast(e,t){return this._thread?(0,h.all)(this._thread.broadcast(t,e)).then((()=>{})):this._promise?this._promise.then((()=>this.broadcast(e,t))):(0,h.reject)()}get promise(){return this._promise}}{constructor(e){super("LercWorker","_decode",e,{strategy:"dedicated"}),this.scheduler=e}decode(e,t,r){return e&&0!==e.byteLength?this.invoke({buffer:e,options:t},r):(0,h.resolve)(null)}getTransferList(e){return[e.buffer]}}const A=new Map;const C=a.Z.getLogger("esri.layers.ElevationLayer");let O=class extends((0,_.Z)((0,g.Y)((0,b.q)((0,v.I)((0,f.R)(d.Z)))))){constructor(...e){super(...e),this.copyright=null,this.heightModelInfo=null,this.path=null,this.opacity=1,this.operationalLayerType="ArcGISTiledElevationServiceLayer",this.sourceJSON=null,this.type="elevation",this.url=null,this.version=null,this._lercDecoder=function(e){let t=A.get(e);return t||(t={instance:new S(e),ref:0},A.set(e,t)),++t.ref,t.instance}()}normalizeCtorArgs(e,t){return"string"==typeof e?{url:e,...t}:e}destroy(){(function(e){if(null==e)return;const t=e.scheduler,r=A.get(t);r&&--r.ref<=0&&(r.instance.destroy(),A.delete(t))})(this._lercDecoder),this._lercDecoder=null}set minScale(e){this.constructed&&C.warn(`${this.declaredClass}.minScale support has been removed (since 4.5)`)}get minScale(){}set maxScale(e){this.constructed&&C.warn(`${this.declaredClass}.maxScale support has been removed (since 4.5)`)}get maxScale(){}readVersion(e,t){let r=t.currentVersion;return r||(r=9.3),r}load(e){const t=(0,i.pC)(e)?e.signal:null;return this.addResolvingPromise(this.loadFromPortal({supportedTypes:["Image Service"],supportsData:!1,validateItem:e=>{for(let t=0;t<e.typeKeywords.length;t++)if("elevation 3d layer"===e.typeKeywords[t].toLowerCase())return!0;throw new c.Z("portal:invalid-layer-item-type","Invalid layer item type '${type}', expected '${expectedType}' ",{type:"Image Service",expectedType:"Image Service Elevation 3D Layer"})}},e).then((()=>this._fetchImageService(t)),(()=>this._fetchImageService(t)))),(0,h.resolve)(this)}fetchTile(e,t,r,s){const a=(0,i.pC)((s=s||{signal:null}).signal)?s.signal:s.signal=(0,h.createAbortController)().signal,o={responseType:"array-buffer",signal:a},n={noDataValue:s.noDataValue,returnFileInfo:!0};return this.load().then((()=>this._fetchTileAvailability(e,t,r,s))).then((()=>(0,p.default)(this.getTileUrl(e,t,r),o))).then((e=>this._lercDecoder.decode(e.data,n,a))).then((e=>({values:e.pixelData,width:e.width,height:e.height,maxZError:e.fileInfo.maxZError,noDataValue:e.noDataValue,minValue:e.minValue,maxValue:e.maxValue})))}getTileUrl(e,t,r){const s=!this.tilemapCache&&this.supportsBlankTile,i=(0,u.B7)({...this.parsedUrl.query,blankTile:!s&&null});return`${this.parsedUrl.path}/tile/${e}/${t}/${r}${i?"?"+i:""}`}async queryElevation(e,t){const{ElevationQuery:s}=await Promise.all([r.e(8157),r.e(7333),r.e(5836)]).then(r.bind(r,93549));return(0,h.throwIfAborted)(t),(new s).query(this,e,t)}async createElevationSampler(e,t){const{ElevationQuery:s}=await Promise.all([r.e(8157),r.e(7333),r.e(5836)]).then(r.bind(r,93549));return(0,h.throwIfAborted)(t),(new s).createSampler(this,e,t)}_fetchTileAvailability(e,t,r,s){return this.tilemapCache?this.tilemapCache.fetchAvailability(e,t,r,s):(0,h.resolve)("unknown")}async _fetchImageService(e){if(this.sourceJSON)return this.sourceJSON;const t={query:{f:"json",...this.parsedUrl.query},responseType:"json",signal:e},r=await(0,p.default)(this.parsedUrl.path,t);r.ssl&&(this.url=this.url.replace(/^http:/i,"https:")),this.sourceJSON=r.data,this.read(r.data,{origin:"service",url:this.parsedUrl})}};(0,s._)([(0,o.Cb)({json:{read:{source:"copyrightText"}}})],O.prototype,"copyright",void 0),(0,s._)([(0,o.Cb)({readOnly:!0,type:y.Z})],O.prototype,"heightModelInfo",void 0),(0,s._)([(0,o.Cb)({type:String,json:{origins:{"web-scene":{read:!0,write:!0}},read:!1}})],O.prototype,"path",void 0),(0,s._)([(0,o.Cb)({type:["show","hide"]})],O.prototype,"listMode",void 0),(0,s._)([(0,o.Cb)({json:{read:!1,write:!1,origins:{service:{read:!1,write:!1},"portal-item":{read:!1,write:!1},"web-document":{read:!1,write:!1}}}})],O.prototype,"minScale",null),(0,s._)([(0,o.Cb)({json:{read:!1,write:!1,origins:{service:{read:!1,write:!1},"portal-item":{read:!1,write:!1},"web-document":{read:!1,write:!1}}}})],O.prototype,"maxScale",null),(0,s._)([(0,o.Cb)({json:{read:!1,write:!1,origins:{"web-document":{read:!1,write:!1}}}})],O.prototype,"opacity",void 0),(0,s._)([(0,o.Cb)({type:["ArcGISTiledElevationServiceLayer"]})],O.prototype,"operationalLayerType",void 0),(0,s._)([(0,o.Cb)()],O.prototype,"sourceJSON",void 0),(0,s._)([(0,o.Cb)({json:{read:!1},value:"elevation",readOnly:!0})],O.prototype,"type",void 0),(0,s._)([(0,o.Cb)(m.HQ)],O.prototype,"url",void 0),(0,s._)([(0,o.Cb)()],O.prototype,"version",void 0),(0,s._)([(0,n.r)("version",["currentVersion"])],O.prototype,"readVersion",null),O=(0,s._)([(0,l.j)("esri.layers.ElevationLayer")],O);const I=O},66416:(e,t,r)=>{"use strict";r.r(t),r.d(t,{default:()=>k});var s=r(56140),i=(r(95830),r(59472)),a=(r(36544),r(79881)),o=r(60263),n=r(30590),l=r(87566),c=r(60538),u=r(32656),h=r(10923),p=(r(57002),r(86035),r(39105)),d=r(73032),f=(r(36348),r(54721)),y=r(56700),m=r(43072),b=r(97849),g=r(18152),v=r(78910),_=r(48899),w=r(57407),x=r(63795),S=r(33716),A=r(2194),C=r(10113),O=r(77204),I=r(54856),T=r(5698),R=r(41452),M=r(49708);const B=["Canvas/World_Dark_Gray_Base","Canvas/World_Dark_Gray_Reference","Canvas/World_Light_Gray_Base","Canvas/World_Light_Gray_Reference","Elevation/World_Hillshade","Elevation/World_Hillshade_Dark","Ocean/World_Ocean_Base","Ocean/World_Ocean_Reference","Ocean_Basemap","Reference/World_Boundaries_and_Places","Reference/World_Boundaries_and_Places_Alternate","Reference/World_Transportation","World_Imagery","World_Street_Map","World_Topo_Map"];let L=class extends((0,w.h)((0,M.x)((0,C.M)((0,A.Q)((0,v.q)((0,S.I)((0,I.Z)((0,T.O)((0,_.Y)((0,m.R)((0,O.p)((0,x.N)(y.Z))))))))))))){constructor(...e){super(...e),this.listMode="show",this.isReference=null,this.operationalLayerType="ArcGISTiledMapServiceLayer",this.resampling=!0,this.sourceJSON=null,this.spatialReference=null,this.path=null,this.sublayers=null,this.type="tile",this.url=null}normalizeCtorArgs(e,t){return"string"==typeof e?{url:e,...t}:e}load(e){const t=(0,i.pC)(e)?e.signal:null;return this.addResolvingPromise(this.loadFromPortal({supportedTypes:["Map Service"]},e).then((()=>this._fetchService(t)),(()=>this._fetchService(t)))),(0,p.resolve)(this)}get attributionDataUrl(){var e;const t=null==(e=this.parsedUrl)?void 0:e.path.toLowerCase();return t&&this._getDefaultAttribution(this._getMapName(t))}readSpatialReference(e,t){return(e=e||t.tileInfo&&t.tileInfo.spatialReference)&&d.Z.fromJSON(e)}writeSublayers(e,t,r,s){if(!this.loaded||!e)return;const i=e.slice().reverse().flatten((({sublayers:e})=>e&&e.toArray().reverse())).toArray(),a=[],o={writeSublayerStructure:!1,...s};i.forEach((e=>{const t=e.write({},o);a.push(t)})),a.some((e=>Object.keys(e).length>1))&&(t.layers=a)}get tileServers(){return this._getDefaultTileServers(this.parsedUrl.path)}castTileServers(e){return Array.isArray(e)?e.map((e=>(0,h.mN)(e).path)):null}fetchTile(e,t,r,s={}){const{signal:i,timestamp:a}=s,o=this.getTileUrl(e,t,r),n={responseType:"image",signal:i};return null!=a&&(n.query={_ts:s.timestamp}),(0,f.default)(o,n).then((e=>e.data))}getTileUrl(e,t,r){const s=!this.tilemapCache&&this.supportsBlankTile,i=(0,h.B7)({...this.parsedUrl.query,blankTile:!s&&null,...this.customParameters}),a=this.tileServers;return`${a&&a.length?a[t%a.length]:this.parsedUrl.path}/tile/${e}/${t}/${r}${i?"?"+i:""}`}_fetchService(e){return(0,p.create)(((t,r)=>{if(this.sourceJSON){if(null!=this.sourceJSON.bandCount&&null!=this.sourceJSON.pixelSizeX)throw new u.Z("tile-layer:unsupported-url","use ImageryTileLayer to open a tiled image service");return void t({data:this.sourceJSON})}if(!this.parsedUrl)throw new u.Z("tile-layer:undefined-url","layer's url is not defined");const s=(0,b.Qc)(this.parsedUrl.path);if((0,i.pC)(s)&&"ImageServer"===s.serverType)throw new u.Z("tile-layer:unsupported-url","use ImageryTileLayer to open a tiled image service");(0,f.default)(this.parsedUrl.path,{query:{f:"json",...this.parsedUrl.query,...this.customParameters},responseType:"json",signal:e}).then(t,r)})).then((t=>{if(t.ssl&&(this.url=this.url.replace(/^http:/i,"https:")),this.sourceJSON=t.data,this.read(t.data,{origin:"service",url:this.parsedUrl}),10.1===this.version&&!(0,b.M8)(this.url))return this._fetchServerVersion(this.url,e).then((e=>{this.read({currentVersion:e})})).catch((()=>{}))}))}_fetchServerVersion(e,t){if(!(0,b.B5)(e))return(0,p.reject)();const r=e.replace(/(.*\/rest)\/.*/i,"$1")+"/info";return(0,f.default)(r,{query:{f:"json",...this.customParameters},responseType:"json",signal:t}).then((e=>{if(e.data&&e.data.currentVersion)return e.data.currentVersion;throw new u.Z("tile-layer:version-not-available")}))}_getMapName(e){const t=e.match(/^(?:https?:)?\/\/(server\.arcgisonline\.com|services\.arcgisonline\.com|ibasemaps-api\.arcgis\.com)\/arcgis\/rest\/services\/([^\/]+(\/[^\/]+)*)\/mapserver/i);return t&&t[2]}_getDefaultAttribution(e){if(!e)return;let t;e=e.toLowerCase();for(let r=0,s=B.length;r<s;r++)if(t=B[r],t.toLowerCase().indexOf(e)>-1)return(0,h.hF)("//static.arcgis.com/attribution/"+t)}_getDefaultTileServers(e){const t=-1!==e.search(/^(?:https?:)?\/\/server\.arcgisonline\.com/i),r=-1!==e.search(/^(?:https?:)?\/\/services\.arcgisonline\.com/i);return t||r?[e,e.replace(t?/server\.arcgisonline/i:/services\.arcgisonline/i,t?"services.arcgisonline":"server.arcgisonline")]:[]}};(0,s._)([(0,a.Cb)({readOnly:!0,dependsOn:["parsedUrl"]})],L.prototype,"attributionDataUrl",null),(0,s._)([(0,a.Cb)({type:["show","hide","hide-children"]})],L.prototype,"listMode",void 0),(0,s._)([(0,a.Cb)({type:Boolean,json:{read:!1,write:{enabled:!0,overridePolicy:()=>({enabled:!1})}}})],L.prototype,"isReference",void 0),(0,s._)([(0,a.Cb)({readOnly:!0,type:["ArcGISTiledMapServiceLayer"]})],L.prototype,"operationalLayerType",void 0),(0,s._)([(0,a.Cb)({type:Boolean})],L.prototype,"resampling",void 0),(0,s._)([(0,a.Cb)()],L.prototype,"sourceJSON",void 0),(0,s._)([(0,a.Cb)({type:d.Z})],L.prototype,"spatialReference",void 0),(0,s._)([(0,n.r)("spatialReference",["spatialReference","tileInfo"])],L.prototype,"readSpatialReference",null),(0,s._)([(0,a.Cb)({type:String,json:{origins:{"web-scene":{read:!0,write:!0}},read:!1}})],L.prototype,"path",void 0),(0,s._)([(0,a.Cb)({readOnly:!0})],L.prototype,"sublayers",void 0),(0,s._)([(0,c.c)("sublayers",{layers:{type:[R.Z]}})],L.prototype,"writeSublayers",null),(0,s._)([(0,a.Cb)({json:{read:!1,write:!1}})],L.prototype,"popupEnabled",void 0),(0,s._)([(0,a.Cb)({dependsOn:["parsedUrl"]})],L.prototype,"tileServers",null),(0,s._)([(0,o.p)("tileServers")],L.prototype,"castTileServers",null),(0,s._)([(0,a.Cb)({readOnly:!0,json:{read:!1}})],L.prototype,"type",void 0),(0,s._)([(0,a.Cb)(g.HQ)],L.prototype,"url",void 0),L=(0,s._)([(0,l.j)("esri.layers.TileLayer")],L);const k=L},57680:(e,t,r)=>{"use strict";r.r(t),r.d(t,{default:()=>G});var s=r(56140),i=r(7584),a=(r(95830),r(82550)),o=r(36544),n=(r(68055),r(79881)),l=r(30590),c=r(87566),u=r(60538),h=r(32656),p=r(10923),d=(r(57002),r(86035),r(39105)),f=r(73032),y=r(52937),m=r(54721),b=r(56700),g=r(43072),v=r(78910),_=r(48899),w=r(57407),x=r(33716),S=r(10113),A=r(40920),C=r(78136),O=r(54856);const I=o.Z.getLogger("esri.layers.support.SpriteSource"),T=class{constructor(e,t,r,s){this.baseURL=e,this.devicePixelRatio=t,this.maxTextureSize=r,this._spriteImageFormat=s,this._isRetina=!1,this._spritesData={},this.image=null,this.width=null,this.height=null,this.loadStatus="not-loaded"}get spriteNames(){const e=[];for(const t in this._spritesData)e.push(t);return e.sort(),e}getSpriteInfo(e){return this._spritesData[e]}async load(e){if(this.baseURL){this.loadStatus="loading";try{await this._loadSprites(e),this.loadStatus="loaded"}catch{this.loadStatus="failed"}}else this.loadStatus="failed"}_loadSprites(e){this._isRetina=this.devicePixelRatio>1.15;const t=(0,p.mN)(this.baseURL),r=t.query?"?"+(0,p.B7)(t.query):"",s=this._isRetina?"@2x":"",i=`${t.path}${s}.${this._spriteImageFormat}${r}`,a=`${t.path}${s}.json${r}`;return(0,d.all)([(0,m.default)(a,e),(0,m.default)(i,{responseType:"image",...e})]).then((([e,r])=>{const s=Object.keys(e.data);if(!s||0===s.length||1===s.length&&"_ssl"===s[0]||!r||!r.data)return this._spritesData=this.image=null,this.width=this.height=0,(0,d.resolve)(null);this._spritesData=e.data;const i=r.data,a=Math.max(this.maxTextureSize,4096);if(i.width>a||i.height>a){const e=`Sprite resource for style ${t.path} is bigger than the maximum allowed of ${a} pixels}`;throw I.error(e),new h.Z("SpriteSource",e)}this.width=i.width,this.height=i.height;const o=document.createElement("canvas"),n=o.getContext("2d");o.width=i.width,o.height=i.height,n.drawImage(i,0,0,i.width,i.height);const l=n.getImageData(0,0,i.width,i.height),c=new Uint8Array(l.data);let u;for(let e=0;e<c.length;e+=4)u=c[e+3]/255,c[e]=c[e]*u,c[e+1]=c[e+1]*u,c[e+2]=c[e+2]*u;this.image=c}))}};var R=r(34926),M=r(63710),B=r(95723);const L=R.Z.defaults&&R.Z.defaults.io.corsEnabledServers;function k(e){if(!e)return;const t=(0,p.P$)(e);L&&-1===L.indexOf(t)&&L.push(t)}function D(...e){let t;for(let r=0;r<e.length;++r)if((0,p.oC)(e[r])){if(t){const s=t.split("://")[0];t=s+":"+e[r].trim()}}else t=(0,p.YP)(e[r])?e[r]:(0,p.v_)(t,e[r]);return(0,p.Qj)(t)}async function U(e,t,r,s,i){let a,o,n;if((0,d.throwIfAborted)(i),"string"==typeof r){const e=(0,p.Fv)(r);k(e);const t=(0,p.mN)(e);n=await(0,m.default)(t.path,{query:{f:"json"},responseType:"json",...i}),a=e,o=e}else n={data:r},a=r.jsonUrl||null,o=s;const l=n.data;return n.ssl&&(a&&(a=a.replace(/^http:/i,"https:")),o&&(o=o.replace(/^http:/i,"https:"))),V(l)?(e.styleUrl=a||null,async function(e,t,r,s){const i=r?(0,p.Yd)(r):p.AX;e.styleBase=i,e.style=t,e.styleUrl&&k(e.styleUrl),t["sprite-format"]&&"webp"===t["sprite-format"].toLowerCase()&&(e.spriteFormat="webp");const a=[];if(t.sources&&t.sources.esri){const r=t.sources.esri;r.url?await U(e,"esri",D(i,r.url),void 0,s):a.push(U(e,"esri",r,i,s))}for(const r of Object.keys(t.sources))"esri"!==r&&"vector"===t.sources[r].type&&(t.sources[r].url?a.push(U(e,r,D(i,t.sources[r].url),void 0,s)):a.push(U(e,r,t.sources[r],i,s)));await(0,d.all)(a)}(e,l,o,i)):V(l)?(0,d.reject)("You must specify the URL or the JSON for a service or for a style."):e.sourceUrl?P(e,l,o,!1,t,i):(e.sourceUrl=a||null,P(e,l,o,!0,t,i))}function V(e){return!!e.sources}async function P(e,t,r,s,i,o){const n=r?(0,p.Qj)(r)+"/":p.AX,l=function(e,t){if(e.hasOwnProperty("tileInfo"))return e;const r={xmin:-20037507.067161843,ymin:-20037507.067161843,xmax:20037507.067161843,ymax:20037507.067161843,spatialReference:{wkid:102100}};let s=78271.51696400007,i=295828763.7957775;const a=[],o=e.hasOwnProperty("minzoom")?parseFloat(e.minzoom):0,n=e.hasOwnProperty("maxzoom")?parseFloat(e.maxzoom):22;for(let e=0;e<=n;e++)e>=o&&a.push({level:e,scale:i,resolution:s}),s/=2,i/=2;for(const r of e.tiles)k(D(t,r));return{capabilities:"TilesOnly",initialExtent:r,fullExtent:r,minScale:0,maxScale:0,tiles:e.tiles,tileInfo:{rows:512,cols:512,dpi:96,format:"pbf",origin:{x:-20037508.342787,y:20037508.342787},lods:a,spatialReference:{wkid:102100}}}}(t,n),c=new class{constructor(e,t,r){this.tileMapURL="",this.tilemapCache=null,this.parsedUrl=null,this.tileInfo=null,this.capabilities=null,this.tileIndex=null,this.fullExtent=null,this.name=e,this.sourceUrl=t,t&&(this.parsedUrl=(0,p.mN)(this.sourceUrl));const s=this.parsedUrl.path,i=this.parsedUrl.query?"?"+(0,p.B7)(this.parsedUrl.query):"",o=(0,a.d9)(r),n=o.tiles;t&&n.forEach(((e,t)=>{(0,p.YP)(e)||(n[t]=(0,p.v_)(s,e)+i)})),this.tileServers=n,r.tileMap&&(this.tileMapURL=(0,p.v_)(t,r.tileMap));const l=r.capabilities&&r.capabilities.split(",").map((e=>e.toLowerCase().trim())),c=!!r.exportTilesAllowed,u=!!l&&-1!==l.indexOf("tilemap"),h=c&&r.hasOwnProperty("maxExportTilesCount")?r.maxExportTilesCount:0;this.capabilities={operations:{supportsExportTiles:c,supportsTileMap:u},exportTiles:c?{maxExportTilesCount:+h}:null},this.tileInfo=(0,M.d)(o.tileInfo,o,null,{ignoreMinMaxLOD:!0}),u&&(this.type="vector-tile",this.tilemapCache=new C.y({layer:this}),this.tilemapCache&&(this.tileIndex=new B.Z(this.tilemapCache))),this.fullExtent=y.Z.fromJSON(r.fullExtent)}getRefKey(e,t){return this.tileIndex?this.tileIndex.dataKey(e,t):(0,d.resolve)(e)}getSourceTileUrl(e,t,r){let s=this.tileServers[t%this.tileServers.length];return s=s.replace(/\{z\}/gi,e.toString()).replace(/\{y\}/gi,t.toString()).replace(/\{x\}/gi,r.toString()),s}isCompatibleWith(e){const t=this.tileInfo,r=e.tileInfo;if(!t.spatialReference.equals(r.spatialReference))return!1;if(!t.origin.equals(r.origin))return!1;if(Math.round(t.dpi)!==Math.round(r.dpi))return!1;const s=t.lods,i=r.lods,a=Math.min(s.length,i.length);for(let e=0;e<a;e++){const t=s[e],r=i[e];if(t.level!==r.level||Math.round(t.scale)!==Math.round(r.scale))return!1}return!0}}(i,n,l);if(!s&&e.primarySourceName in e.sourceNameToSource){const t=e.sourceNameToSource[e.primarySourceName];if(!t.isCompatibleWith(c))return(0,d.resolve)();null!=c.fullExtent&&(null!=t.fullExtent?t.fullExtent.union(c.fullExtent):t.fullExtent=c.fullExtent.clone()),t.tileInfo.lods.length<c.tileInfo.lods.length&&(t.tileInfo=c.tileInfo)}if(s?(e.sourceBase=n,e.source=t,e.validatedSource=l,e.primarySourceName=i,e.sourceUrl&&k(e.sourceUrl)):k(n),e.sourceNameToSource[i]=c,!e.style)return null==t.defaultStyles?(0,d.reject)():"string"==typeof t.defaultStyles?U(e,"",D(n,t.defaultStyles,"root.json"),void 0,o):U(e,"",t.defaultStyles,D(n,"root.json"),o)}var z=r(58482),j=r(18897);const E=class{constructor(e,t){this.lockedSchemaPixelSize=e,this.isGCS=t}getLevelRowColumn(e){return this.isGCS?[e[0],e[1]>>1,e[2]>>1]:256===this.lockedSchemaPixelSize&&e[0]>0?[e[0]-1,e[1]>>1,e[2]>>1]:e}adjustLevel(e){return this.isGCS?e:256===this.lockedSchemaPixelSize?e>0?e-1:0:e}getShift(e,t){let r=0,s=0;return(256===this.lockedSchemaPixelSize||this.isGCS)&&(e[2]%2&&(r=t),e[1]%2&&(s=t)),[r,s]}getScale(e){if(this.isGCS){if(512===this.lockedSchemaPixelSize)return 4}else if(256===this.lockedSchemaPixelSize&&0===e)return 1;return 2}static create256x256CompatibleTileInfo(e){if(!e)return null;if(256===e.size[0]&&256===e.size[1])return e;const t=e.spatialReference.isGeographic,r=[],s=e.lods.length;for(let i=0;i<s;i++){const s=e.lods[i],a=t?s.resolution:2*s.resolution;r.push(new j.Z({level:s.level,scale:s.scale,resolution:a}))}return new A.Z({size:[256,256],dpi:e.dpi,format:e.format,compressionQuality:e.compressionQuality,origin:e.origin,spatialReference:e.spatialReference,lods:r})}static create512x512CompatibleTileInfo(e){if(!e)return null;if(256===e.size[0]||256===e.size[1])return null;const t=[],r=e.lods.length;for(let s=0;s<r;s++){const r=e.lods[s],i=.5*r.resolution;t.push(new j.Z({level:r.level,scale:r.scale,resolution:i}))}return new A.Z({size:[512,512],dpi:e.dpi,format:e.format,compressionQuality:e.compressionQuality,origin:e.origin,spatialReference:e.spatialReference,lods:t})}};function Z(e,t){if(e===t)return!0;if(!e&&null!=t)return!1;if(null!=e&&!t)return!1;if(!e.spatialReference.equals(t.spatialReference)||e.dpi!==t.dpi)return!1;const r=e.origin,s=t.origin;if(Math.abs(r.x-s.x)>=1e-6||Math.abs(r.y-s.y)>=1e-6)return!1;let i,a;e.lods[0].scale>t.lods[0].scale?(i=e,a=t):(a=e,i=t);for(let e=i.lods[0].scale;e>=a.lods[a.lods.length-1].scale-1e-6;e/=2)if(Math.abs(e-a.lods[0].scale)<1e-6)return!0;return!1}function F(e,t){if(e===t)return e;if(!e&&null!=t)return t;if(null!=e&&!t)return e;const r=e.size[0],s=e.format,i=e.dpi,a={x:e.origin.x,y:e.origin.y},o=e.spatialReference.toJSON(),n=e.lods[0].scale>t.lods[0].scale?e.lods[0]:t.lods[0],l=e.lods[e.lods.length-1].scale<=t.lods[t.lods.length-1].scale?e.lods[e.lods.length-1]:t.lods[t.lods.length-1],c=n.scale,u=n.resolution,h=l.scale,p=[];let d=c,f=u,y=0;for(;d>h;)p.push({level:y,resolution:f,scale:d}),y++,d/=2,f/=2;return new A.Z({size:[r,r],dpi:i,format:s||"pbf",origin:a,lods:p,spatialReference:o})}var N=r(6017),W=r(43129);let q=class extends((0,w.h)((0,S.M)((0,O.Z)((0,_.Y)((0,v.q)((0,x.I)((0,g.R)(b.Z)))))))){constructor(...e){super(...e),this._spriteSourceMap=new Map,this.currentStyleInfo=null,this.style=null,this.isReference=null,this.operationalLayerType="VectorTileLayer",this.type="vector-tile",this.url=null}normalizeCtorArgs(e,t){return"string"==typeof e?{url:e,...t}:e}destroy(){this._spriteSourceMap.clear()}async prefetchResources(e){await this.loadSpriteSource(i.Z.devicePixelRatio||1,e)}load(e){const t=this.loadFromPortal({supportedTypes:["Vector Tile Service"],supportsData:!1},e).then((async()=>{if(!this.portalItem||!this.portalItem.id)return;const t=`${this.portalItem.itemUrl}/resources/styles/root.json`;(await(0,m.default)(t,{...e,query:{f:"json"}})).data&&this.read({url:t},(0,z.m)(this.portalItem))})).then((()=>this._loadStyle(e)),(()=>this._loadStyle(e)));return this.addResolvingPromise(t),(0,d.resolve)(this)}get attributionDataUrl(){const e=this.currentStyleInfo,t=e&&e.serviceUrl&&(0,p.mN)(e.serviceUrl);return t?this._getDefaultAttribution(t.path):null}get capabilities(){const e=this._getPrimarySource();return e?e.capabilities:{operations:{supportsExportTiles:!1,supportsTileMap:!1},exportTiles:null}}get fullExtent(){const e=this._getPrimarySource();return e?e.fullExtent:null}get parsedUrl(){return this.serviceUrl?(0,p.mN)(this.serviceUrl):null}get serviceUrl(){return this.currentStyleInfo&&this.currentStyleInfo.serviceUrl||null}get spatialReference(){return this.tileInfo&&this.tileInfo.spatialReference||null}get styleUrl(){return this.currentStyleInfo&&this.currentStyleInfo.styleUrl||null}writeStyleUrl(e,t){e&&(0,p.oC)(e)&&(e=`https:${e}`),t.styleUrl=e}get tileIndexType(){const e=this._getPrimarySource();return e?e.type:""}get tileIndexUrl(){const e=this._getPrimarySource();return e?e.tileMapURL:""}get tileInfo(){var e;const t=[];for(const e in this.sourceNameToSource)t.push(this.sourceNameToSource[e]);let r=(null==(e=this._getPrimarySource())?void 0:e.tileInfo)||new A.Z;if(t.length>1)for(let e=0;e<t.length;e++)Z(r,t[e].tileInfo)&&(r=F(r,t[e].tileInfo));return r}get tilemapCache(){const e=this._getPrimarySource();return e&&e.capabilities.operations.supportsTileMap?e.tilemapCache:null}get tileServers(){const e=this._getPrimarySource();return e?e.tileServers:[]}readVersion(e,t){return t.version?parseFloat(t.version):parseFloat(t.currentVersion)}get compatibleTileInfo256(){return E.create256x256CompatibleTileInfo(this.tileInfo)}get compatibleTileInfo512(){return E.create512x512CompatibleTileInfo(this.tileInfo)}async loadSpriteSource(e=1,t){if(!this._spriteSourceMap.has(e)){const r=(0,W.Z)(),s=new T(this.styleRepository.sprite,e,r.maxTextureSize,this.currentStyleInfo.spriteFormat);await s.load(t),this._spriteSourceMap.set(e,s)}return(0,d.resolve)(this._spriteSourceMap.get(e))}async loadStyle(e,t){const r=e||this.style||this.url;if(this._loadingPromise&&"string"==typeof r&&this.url===r&&!(0,d.isAborted)(this._abortController))return this._loadingPromise;const s=this._abortController;s&&s.abort();const i=(0,d.createAbortController)();return this._loadingPromise=(0,d.create)(((e,s)=>{const a={signal:i.signal};this._spriteSourceMap.clear(),this._getSourceAndStyle(r,a).then(e,s),(0,d.onAbort)(t,(()=>{i.abort()}))})),this._abortController=i,this._loadingPromise}getStyleLayerId(e){return this.styleRepository.getStyleLayerId(e)}getStyleLayerIndex(e){return this.styleRepository.getStyleLayerIndex(e)}getPaintProperties(e){return(0,a.d9)(this.styleRepository.getPaintProperties(e))}setPaintProperties(e,t){const r=this.styleRepository.isPainterDataDriven(e);this.styleRepository.setPaintProperties(e,t);const s=this.styleRepository.isPainterDataDriven(e);this.emit("paint-change",{layerName:e,paint:t,isDataDriven:r||s})}getStyleLayer(e){return(0,a.d9)(this.styleRepository.getStyleLayer(e))}setStyleLayer(e,t){this.styleRepository.setStyleLayer(e,t),this.emit("style-layer-change",{layer:e,index:t})}deleteStyleLayer(e){this.styleRepository.deleteStyleLayer(e),this.emit("delete-style-layer",{layerName:e})}getLayoutProperties(e){return(0,a.d9)(this.styleRepository.getLayoutProperties(e))}setLayoutProperties(e,t){this.styleRepository.setLayoutProperties(e,t),this.emit("layout-change",{layer:e,layout:t})}setStyleLayerVisibility(e,t){this.styleRepository.setStyleLayerVisibility(e,t),this.emit("style-layer-visibility-change",{layer:e,visibility:t})}getStyleLayerVisibility(e){return this.styleRepository.getStyleLayerVisibility(e)}getTileUrl(e,t,r){let s=this.tileServers[t%this.tileServers.length];return s=s.replace(/\{z\}/gi,e.toString()).replace(/\{y\}/gi,t.toString()).replace(/\{x\}/gi,r.toString()),s}write(e,t){return t&&t.origin&&!this.styleUrl?(t.messages&&t.messages.push(new h.Z("vectortilelayer:unsupported",`VectorTileLayer (${this.title}, ${this.id}) with style defined by JSON only are not supported`,{layer:this})),null):super.write(e,t)}async _getSourceAndStyle(e,t){if(!e)throw new Error("invalid style!");const r=await async function(e,t){const r={source:null,sourceBase:null,sourceUrl:null,validatedSource:null,style:null,styleBase:null,styleUrl:null,sourceNameToSource:{},primarySourceName:"",spriteFormat:"png"},[s,i]="string"==typeof e?[e,null]:[null,e.jsonUrl],a=s?(0,p.mN)(s):null;await U(r,"esri",e,i,t);const o={layerDefinition:r.validatedSource,url:s,parsedUrl:a,serviceUrl:r.sourceUrl,style:r.style,styleUrl:r.styleUrl,spriteUrl:r.style.sprite&&D(r.styleBase,r.style.sprite),spriteFormat:r.spriteFormat,glyphsUrl:r.style.glyphs&&D(r.styleBase,r.style.glyphs),sourceNameToSource:r.sourceNameToSource,primarySourceName:r.primarySourceName};return k(o.spriteUrl),k(o.glyphsUrl),o}(e,t);"webp"===r.spriteFormat&&(await function(e){const t={lossy:"UklGRiIAAABXRUJQVlA4IBYAAAAwAQCdASoBAAEADsD+JaQAA3AAAAAA",lossless:"UklGRhoAAABXRUJQVlA4TA0AAAAvAAAAEAcQERGIiP4HAA==",alpha:"UklGRkoAAABXRUJQVlA4WAoAAAAQAAAAAAAAAAAAQUxQSAwAAAARBxAR/Q9ERP8DAABWUDggGAAAABQBAJ0BKgEAAQAAAP4AAA3AAP7mtQAAAA==",animation:"UklGRlIAAABXRUJQVlA4WAoAAAASAAAAAAAAAAAAQU5JTQYAAAD/////AABBTk1GJgAAAAAAAAAAAAAAAAAAAGQAAABWUDhMDQAAAC8AAAAQBxAREYiI/gcA"};return new Promise((r=>{const s=new Image;s.onload=()=>{s.onload=s.onerror=null,r(s.width>0&&s.height>0)},s.onerror=()=>{s.onload=s.onerror=null,r(!1)},s.src="data:image/webp;base64,"+t[e]}))}("lossy")||(r.spriteFormat="png")),this._set("currentStyleInfo",{...r}),"string"==typeof e?(this.url=e,this.style=null):(this.url=null,this.style=e),this._set("sourceNameToSource",r.sourceNameToSource),this._set("primarySourceName",r.primarySourceName),this._set("styleRepository",new N.Z(r.style,r)),this.read(r.layerDefinition,{origin:"service"}),this.emit("load-style",{})}_getDefaultAttribution(e){const t=e.match(/^https?:\/\/(?:basemaps|basemapsbeta|basemapsdev)(?:-api)?\.arcgis\.com(\/[^\/]+)?\/arcgis\/rest\/services\/([^\/]+(\/[^\/]+)*)\/vectortileserver/i),r=["OpenStreetMap_v2","OpenStreetMap_Daylight_v2","OpenStreetMap_Export_v2","OpenStreetMap_FTS_v2","OpenStreetMap_GCS_v2","World_Basemap","World_Basemap_v2","World_Basemap_Export_v2","World_Basemap_GCS_v2","World_Basemap_WGS84","World_Contours_v2"];if(!t)return;const s=t[2]&&t[2].toLowerCase();if(!s)return;const i=t[1]||"";for(const e of r)if(e.toLowerCase().indexOf(s)>-1)return(0,p.Fv)(`//static.arcgis.com/attribution/Vector${i}/${e}`)}_getPrimarySource(){return this.sourceNameToSource&&this.primarySourceName in this.sourceNameToSource?this.sourceNameToSource[this.primarySourceName]:null}async _loadStyle(e){return this._loadingPromise?this._loadingPromise:this.loadStyle(null,e)}};(0,s._)([(0,n.Cb)({readOnly:!0,dependsOn:["currentStyleInfo"]})],q.prototype,"attributionDataUrl",null),(0,s._)([(0,n.Cb)({type:["show","hide"]})],q.prototype,"listMode",void 0),(0,s._)([(0,n.Cb)({readOnly:!0,dependsOn:["sourceNameToSource","primarySourceName"],autoTracked:!1,json:{read:!1}})],q.prototype,"capabilities",null),(0,s._)([(0,n.Cb)({readOnly:!0})],q.prototype,"currentStyleInfo",void 0),(0,s._)([(0,n.Cb)({json:{read:!1},readOnly:!0,type:y.Z,dependsOn:["sourceNameToSource","primarySourceName"]})],q.prototype,"fullExtent",null),(0,s._)([(0,n.Cb)()],q.prototype,"style",void 0),(0,s._)([(0,n.Cb)({type:Boolean,json:{read:!1,write:{enabled:!0,overridePolicy:()=>({enabled:!1})}}})],q.prototype,"isReference",void 0),(0,s._)([(0,n.Cb)({type:["VectorTileLayer"]})],q.prototype,"operationalLayerType",void 0),(0,s._)([(0,n.Cb)({readOnly:!0,dependsOn:["serviceUrl"]})],q.prototype,"parsedUrl",null),(0,s._)([(0,n.Cb)({readOnly:!0,dependsOn:["currentStyleInfo"]})],q.prototype,"serviceUrl",null),(0,s._)([(0,n.Cb)({type:f.Z,dependsOn:["tileInfo"],readOnly:!0})],q.prototype,"spatialReference",null),(0,s._)([(0,n.Cb)({readOnly:!0})],q.prototype,"styleRepository",void 0),(0,s._)([(0,n.Cb)({readOnly:!0})],q.prototype,"sourceNameToSource",void 0),(0,s._)([(0,n.Cb)({readOnly:!0})],q.prototype,"primarySourceName",void 0),(0,s._)([(0,n.Cb)({type:String,readOnly:!0,dependsOn:["currentStyleInfo"],json:{write:{ignoreOrigin:!0},origins:{"web-document":{write:{ignoreOrigin:!0,isRequired:!0}}}}})],q.prototype,"styleUrl",null),(0,s._)([(0,u.c)(["portal-item","web-document"],"styleUrl")],q.prototype,"writeStyleUrl",null),(0,s._)([(0,n.Cb)({json:{read:!1},readOnly:!0,dependsOn:["sourceNameToSource","primarySourceName"]})],q.prototype,"tileIndexType",null),(0,s._)([(0,n.Cb)({json:{read:!1},readOnly:!0,dependsOn:["sourceNameToSource","primarySourceName"]})],q.prototype,"tileIndexUrl",null),(0,s._)([(0,n.Cb)({json:{read:!1,origins:{service:{read:!1}}},readOnly:!0,type:A.Z,dependsOn:["sourceNameToSource","primarySourceName"]})],q.prototype,"tileInfo",null),(0,s._)([(0,n.Cb)({json:{read:!1},readOnly:!0,type:C.y,dependsOn:["sourceNameToSource","primarySourceName"]})],q.prototype,"tilemapCache",null),(0,s._)([(0,n.Cb)({json:{read:!1},readOnly:!0,dependsOn:["sourceNameToSource","primarySourceName"]})],q.prototype,"tileServers",null),(0,s._)([(0,n.Cb)({json:{read:!1},readOnly:!0,value:"vector-tile"})],q.prototype,"type",void 0),(0,s._)([(0,n.Cb)({json:{origins:{"web-document":{read:{source:"styleUrl"}},"portal-item":{read:{source:"url"}}},write:!1,read:!1}})],q.prototype,"url",void 0),(0,s._)([(0,n.Cb)({readOnly:!0})],q.prototype,"version",void 0),(0,s._)([(0,l.r)("version",["version","currentVersion"])],q.prototype,"readVersion",null),(0,s._)([(0,n.Cb)({readOnly:!0,dependsOn:["tileInfo"]})],q.prototype,"compatibleTileInfo256",null),(0,s._)([(0,n.Cb)({readOnly:!0,dependsOn:["tileInfo"]})],q.prototype,"compatibleTileInfo512",null),q=(0,s._)([(0,c.j)("esri.layers.VectorTileLayer")],q);const G=q},54856:(e,t,r)=>{"use strict";r.d(t,{Z:()=>u});var s=r(56140),i=(r(95830),r(36544),r(68055),r(79881)),a=r(30590),o=r(87566),n=(r(10923),r(57002),r(86035),r(73032)),l=(r(36348),r(63710)),c=r(78136);const u=e=>{let t=class extends e{constructor(){super(...arguments),this.copyright=null,this.minScale=0,this.maxScale=0,this.spatialReference=null,this.tileInfo=null,this.tilemapCache=null}readMinScale(e,t){return null!=t.minLOD&&null!=t.maxLOD?e:0}readMaxScale(e,t){return null!=t.minLOD&&null!=t.maxLOD?e:0}get supportsBlankTile(){return this.version>=10.2}readTilemapCache(e,t){return t.capabilities&&t.capabilities.indexOf("Tilemap")>-1?new c.y({layer:this}):null}};return(0,s._)([(0,i.Cb)({json:{read:{source:"copyrightText"}}})],t.prototype,"copyright",void 0),(0,s._)([(0,i.Cb)()],t.prototype,"minScale",void 0),(0,s._)([(0,a.r)("service","minScale")],t.prototype,"readMinScale",null),(0,s._)([(0,i.Cb)()],t.prototype,"maxScale",void 0),(0,s._)([(0,a.r)("service","maxScale")],t.prototype,"readMaxScale",null),(0,s._)([(0,i.Cb)({type:n.Z})],t.prototype,"spatialReference",void 0),(0,s._)([(0,i.Cb)({readOnly:!0,dependsOn:["version"]})],t.prototype,"supportsBlankTile",null),(0,s._)([(0,i.Cb)(l.h)],t.prototype,"tileInfo",void 0),(0,s._)([(0,i.Cb)()],t.prototype,"tilemapCache",void 0),(0,s._)([(0,a.r)("service","tilemapCache",["capabilities"])],t.prototype,"readTilemapCache",null),(0,s._)([(0,i.Cb)()],t.prototype,"version",void 0),t=(0,s._)([(0,o.j)("esri.layers.mixins.ArcGISCachedService")],t),t}},5698:(e,t,r)=>{"use strict";r.d(t,{O:()=>d});var s=r(56140),i=(r(95830),r(36544),r(68055),r(79881)),a=r(30590),o=r(87566),n=r(10923),l=(r(57002),r(86035),r(39105)),c=r(73032),u=r(52937),h=r(54721),p=r(18152);const d=e=>{let t=class extends e{constructor(){super(...arguments),this.capabilities=void 0,this.copyright=null,this.fullExtent=null,this.legendEnabled=!0,this.spatialReference=null,this.version=null}readCapabilities(e,t){const r=t.capabilities&&t.capabilities.split(",").map((e=>e.toLowerCase().trim()));if(!r)return{operations:{supportsQuery:!1,supportsExportMap:!1,supportsExportTiles:!1,supportsTileMap:!1},exportMap:null,exportTiles:null};const s=this.type,i=-1!==r.indexOf("query"),a=-1!==r.indexOf("map"),o=!!t.exportTilesAllowed,n=-1!==r.indexOf("tilemap"),l="tile"!==s&&!!t.supportsDynamicLayers,c="tile"!==s&&(!t.tileInfo||l),u="tile"!==s&&(!t.tileInfo||l);return{operations:{supportsQuery:i,supportsExportMap:a,supportsExportTiles:o,supportsTileMap:n},exportMap:a?{supportsSublayersChanges:"tile"!==s,supportsDynamicLayers:l,supportsSublayerVisibility:c,supportsSublayerDefinitionExpression:u}:null,exportTiles:o?{maxExportTilesCount:+t.maxExportTilesCount}:null}}readVersion(e,t){let r=t.currentVersion;return r||(r=t.hasOwnProperty("capabilities")||t.hasOwnProperty("tables")?10:t.hasOwnProperty("supportedImageFormatTypes")?9.31:9.3),r}async fetchSublayerInfo(e,t){return await this.fetchAllLayersAndTables(t),this._allLayersAndTablesMap.get(e)}async fetchAllLayersAndTables(e){await this.load(e),this._allLayersAndTablesPromise||(this._allLayersAndTablesPromise=(0,h.default)((0,n.mN)(this.url).path+"/layers",{responseType:"json",query:{f:"json",...this.customParameters}}).then((e=>{this._allLayersAndTablesMap=new Map;for(const t of e.data.layers)this._allLayersAndTablesMap.set(t.id,t);return{result:e.data}}),(e=>({error:e}))));const t=await this._allLayersAndTablesPromise;if((0,l.throwIfAborted)(e),"result"in t)return t.result;throw t.error}};return(0,s._)([(0,i.Cb)({readOnly:!0})],t.prototype,"capabilities",void 0),(0,s._)([(0,a.r)("service","capabilities",["capabilities","exportTilesAllowed","maxExportTilesCount","supportsDynamicLayers","tileInfo"])],t.prototype,"readCapabilities",null),(0,s._)([(0,i.Cb)({json:{read:{source:"copyrightText"}}})],t.prototype,"copyright",void 0),(0,s._)([(0,i.Cb)({type:u.Z})],t.prototype,"fullExtent",void 0),(0,s._)([(0,i.Cb)({json:{origins:{service:{read:!1},"portal-item":{read:!1}}}})],t.prototype,"id",void 0),(0,s._)([(0,i.Cb)({type:Boolean,json:{origins:{service:{read:{enabled:!1}}},read:{source:"showLegend"},write:{target:"showLegend"}}})],t.prototype,"legendEnabled",void 0),(0,s._)([(0,i.Cb)(p.C_)],t.prototype,"popupEnabled",void 0),(0,s._)([(0,i.Cb)({type:c.Z})],t.prototype,"spatialReference",void 0),(0,s._)([(0,i.Cb)()],t.prototype,"version",void 0),(0,s._)([(0,a.r)("version",["currentVersion","capabilities","tables","supportedImageFormatTypes"])],t.prototype,"readVersion",null),t=(0,s._)([(0,o.j)("esri.layers.mixins.ArcGISMapService")],t),t}},49708:(e,t,r)=>{"use strict";r.d(t,{x:()=>b});var s=r(56140),i=(r(95830),r(36544)),a=(r(68055),r(65575)),o=r(79881),n=r(87566),l=r(32656),c=(r(10923),r(57002),r(9678)),u=(r(86035),r(83477)),h=r(78452),p=r(41452),d=r(24681);const f=i.Z.getLogger("esri.layers.TileLayer"),y=u.Z.ofType(p.Z);function m(e,t){e&&e.forEach((e=>{t(e),e.sublayers&&e.sublayers.length&&m(e.sublayers,t)}))}const b=e=>{let t=class extends e{constructor(...e){super(...e),this.allSublayers=new h.Z({root:this,rootCollectionNames:["sublayers"],getChildrenFunction:e=>e.sublayers}),this.sublayersSourceJSON={2:{},3:{},4:{},5:{}},this.watch("sublayers",((e,t)=>this._handleSublayersChange(e,t)),!0)}readSublayers(e,t){if(!t||!e)return;const{sublayersSourceJSON:r}=this,s=(0,c.M9)(t.origin);if(s<2)return;if(r[s]={context:t,visibleLayers:e.visibleLayers||r[s].visibleLayers,layers:e.layers||r[s].layers},s>2)return;this._set("serviceSublayers",this.createSublayersForOrigin("service").sublayers);const{sublayers:i,origin:o}=this.createSublayersForOrigin("web-document"),n=(0,a.vw)(this);n.setDefaultOrigin(o),this._set("sublayers",new y(i)),n.setDefaultOrigin("user")}findSublayerById(e){return this.allSublayers.find((t=>t.id===e))}createServiceSublayers(){return this.createSublayersForOrigin("service").sublayers}createSublayersForOrigin(e){const t=(0,c.M9)("web-document"===e?"web-map":e);let r=2,s=this.sublayersSourceJSON[2].layers,i=this.sublayersSourceJSON[2].context,a=null;const o=[3,4,5].filter((e=>e<=t));for(const e of o){const t=this.sublayersSourceJSON[e];(0,d.ac)(t.layers)&&(r=e,s=t.layers,i=t.context,t.visibleLayers&&(a={visibleLayers:t.visibleLayers,context:t.context}))}const n=[3,4,5].filter((e=>e>r&&e<=t));let l=null;for(const e of n){const{layers:t,visibleLayers:r,context:s}=this.sublayersSourceJSON[e];t&&(l={layers:t,context:s}),r&&(a={visibleLayers:r,context:s})}const u=function(e,t){const r=[],s={};return e?(e.forEach((e=>{const i=new p.Z;if(i.read(e,t),s[i.id]=i,null!=e.parentLayerId&&-1!==e.parentLayerId){const t=s[e.parentLayerId];t.sublayers||(t.sublayers=[]),t.sublayers.unshift(i)}else r.unshift(i)})),r):r}(s,i),h=new Map,f=new Set;if(l)for(const e of l.layers)h.set(e.id,e);if(a)for(const e of a.visibleLayers)f.add(e);return m(u,(e=>{l&&e.read(h.get(e.id),l.context),a&&e.read({defaultVisibility:f.has(e.id)},a.context)})),{origin:(0,c.x3)(r),sublayers:new y({items:u})}}read(e,t){super.read(e,t),this.readSublayers(e,t)}_handleSublayersChange(e,t){t&&(t.forEach((e=>{e.parent=null,e.layer=null})),this.handles.remove("sublayers-owner")),e&&(e.forEach((e=>{e.parent=this,e.layer=this})),this.handles.add([e.on("after-add",(({item:e})=>{e.parent=this,e.layer=this})),e.on("after-remove",(({item:e})=>{e.parent=null,e.layer=null}))],"sublayers-owner"),"tile"===this.type&&this.handles.add(e.on("before-changes",(e=>{f.error(new l.Z("tilelayer:sublayers-non-modifiable","Sublayer can't be added, moved, or removed from the layer's sublayers",{layer:this})),e.preventDefault()})),"sublayers-owner"))}};return(0,s._)([(0,o.Cb)({readOnly:!0})],t.prototype,"allSublayers",void 0),(0,s._)([(0,o.Cb)({readOnly:!0,type:u.Z.ofType(p.Z)})],t.prototype,"serviceSublayers",void 0),(0,s._)([(0,o.Cb)({value:null,type:y,json:{read:!1,write:{allowNull:!0,ignoreOrigin:!0}}})],t.prototype,"sublayers",void 0),(0,s._)([(0,o.Cb)({readOnly:!0})],t.prototype,"sublayersSourceJSON",void 0),t=(0,s._)([(0,n.j)("esri.layers.mixins.SublayersOwner")],t),t}},63710:(e,t,r)=>{"use strict";r.d(t,{d:()=>a,h:()=>i});var s=r(40920);const i={type:s.Z,json:{origins:{service:{read:{source:["tileInfo","minScale","maxScale","minLOD","maxLOD"],reader:a}}}}};function a(e,t,r,i){if(!e)return null;const{minScale:a,maxScale:o,minLOD:n,maxLOD:l}=t;if(null!=n&&null!=l)return i&&i.ignoreMinMaxLOD?s.Z.fromJSON(e):s.Z.fromJSON({...e,lods:e.lods.filter((({level:e})=>null!=e&&e>=n&&e<=l))});if(0!==a&&0!==o){const t=e=>Math.round(1e4*e)/1e4,r=a?t(a):1/0,i=o?t(o):-1/0;return s.Z.fromJSON({...e,lods:e.lods.filter((e=>{const s=t(e.scale);return s<=r&&s>=i}))})}return s.Z.fromJSON(e)}},24681:(e,t,r)=>{"use strict";function s(e,t,r){return t.flatten((({sublayers:e})=>e)).length!==e.length||(!!e.some((e=>e.originIdOf("minScale")>r||e.originIdOf("maxScale")>r||e.originIdOf("renderer")>r||e.originIdOf("labelingInfo")>r||e.originIdOf("opacity")>r||e.originIdOf("labelsVisible")>r||e.originIdOf("source")>r))||!a(e,t))}function i(e,t,r){return!!e.some((e=>{const t=e.source;return!(!t||"map-layer"===t.type&&t.mapLayerId===e.id&&(!t.gdbVersion||t.gdbVersion===r.gdbVersion))||e.originIdOf("renderer")>2||e.originIdOf("labelingInfo")>2||e.originIdOf("opacity")>2||e.originIdOf("labelsVisible")>2}))||!a(e,t)}function a(e,t){if(!e||!e.length)return!0;const r=t.slice().reverse().flatten((({sublayers:e})=>e&&e.toArray().reverse())).map((e=>e.id)).toArray();if(e.length>r.length)return!1;let s=0;const i=r.length;for(const{id:t}of e){for(;s<i&&r[s]!==t;)s++;if(s>=i)return!1}return!0}function o(e){return!!e&&e.some((e=>null!=e.minScale||e.layerDefinition&&null!=e.layerDefinition.minScale))}r.d(t,{FN:()=>i,ac:()=>o,QV:()=>s})},58482:(e,t,r)=>{"use strict";r.d(t,{m:()=>a});var s=r(10923),i=r(32797);function a(e){return{origin:"portal-item",url:(0,s.mN)(e.itemUrl),portal:e.portal||i.Z.getDefault(),portalItem:e,readResourcePaths:[]}}},56291:(e,t,r)=>{"use strict";r.d(t,{s:()=>n});var s=r(95830),i=r(39105),a=r(35470);const o=1/(0,s.Z)("mapview-transitions-duration");class n extends a.Z{constructor(){super(...arguments),this._fadeOutResolver=null,this._fadeInResolver=null,this._clips=null,this.computedVisible=!0,this.computedOpacity=1,this.fadeTransitionEnabled=!1,this.inFadeTransition=!1,this._isReady=!1,this._opacity=1,this._stage=null,this._visible=!0}get clips(){return this._clips}set clips(e){this._clips=e,this.requestRender()}get isReady(){return this._isReady}get opacity(){return this._opacity}set opacity(e){this._opacity!==e&&(this._opacity=Math.min(1,Math.max(e,0)),this.requestRender())}get stage(){return this._stage}set stage(e){if(this._stage===e)return;const t=this._stage;this._stage=e,e?this._stage.untrashDisplayObject(this)||(this.onAttach(),this.emit("attach")):t.trashDisplayObject(this)}get visible(){return this._visible}set visible(e){this._visible!==e&&(this._visible=e,this.requestRender())}fadeIn(){return this._fadeInResolver||(this._fadeOutResolver&&(this._fadeOutResolver(),this._fadeOutResolver=null),this.computedOpacity=0,this.fadeTransitionEnabled=!0,this._fadeInResolver=(0,i.createResolver)(),this.requestRender()),this._fadeInResolver.promise}fadeOut(){return this._fadeOutResolver||(this._fadeInResolver&&(this._fadeInResolver(),this._fadeInResolver=null),this.fadeTransitionEnabled=!0,this._fadeOutResolver=(0,i.createResolver)(),this.requestRender()),this._fadeOutResolver.promise}beforeRender(e){this.updateTransitionProperties(e.deltaTime,e.state.scale)}afterRender(e){this._fadeInResolver&&this.computedOpacity===this.opacity?(this._fadeInResolver(),this._fadeInResolver=null):this._fadeOutResolver&&0===this.computedOpacity&&(this._fadeOutResolver(),this._fadeOutResolver=null)}setTransform(e){}processRender(e){this.stage&&this.computedVisible&&this.doRender(e)}requestRender(){this.stage&&this.stage.requestRender()}processDetach(){this.onDetach(),this.emit("detach")}updateTransitionProperties(e,t){if(this.fadeTransitionEnabled){const t=this._fadeOutResolver||!this.visible?0:this.opacity,r=this.computedOpacity;if(r===t)this.computedVisible=this.visible;else{const s=e*o;this.computedOpacity=r>t?Math.max(t,r-s):Math.min(t,r+s),this.computedVisible=this.computedOpacity>0;const i=t===this.computedOpacity;this.inFadeTransition=!i,i||this.requestRender()}}else this.computedOpacity=this.opacity,this.computedVisible=this.visible}onAttach(){}onDetach(){}doRender(e){}ready(){this._isReady||(this._isReady=!0,this.emit("isReady"),this.requestRender())}}},57498:(e,t,r)=>{"use strict";r.d(t,{i:()=>m});var s=r(98501),i=r(55955),a=r(41658),o=(r(95830),r(59472)),n=(r(33655),r(5627),r(69595)),l=r(74038),c=(r(84570),r(89930),r(17441));class u{constructor(e){this.layerUIDs=[],this.isDestroyed=!1,this.data=e,this.memoryUsed=e.byteLength;let t=1;const r=new Uint32Array(e);this.layerUIDs=[];const s=r[t++];for(let e=0;e<s;e++)this.layerUIDs[e]=r[t++];this.bufferDataOffset=t}get isPreparedForRendering(){return(0,o.Wi)(this.data)}get offset(){return this.bufferDataOffset}destroy(){this.isDestroyed||(this.doDestroy(),this.isDestroyed=!0)}prepareForRendering(e,t){(0,o.Wi)(this.data)||(this.doPrepareForRendering(e,t,this.data,this.bufferDataOffset),this.data=null)}}class h extends u{constructor(e){super(e),this.type=2,this.lineIndexStart=0,this.lineIndexCount=0;let t=this.bufferDataOffset;const r=new Uint32Array(e);this.lineIndexStart=r[t++],this.lineIndexCount=r[t++],this.isLineDataDriven=!!r[t++],this.bufferDataOffset=t}hasData(){return this.lineIndexCount>0}triangleCount(){return this.lineIndexCount/3}doDestroy(){(0,o.pC)(this.lineVertexArrayObject)&&this.lineVertexArrayObject.dispose(),(0,o.pC)(this.lineVertexBuffer)&&this.lineVertexBuffer.dispose(),(0,o.pC)(this.lineIndexBuffer)&&this.lineIndexBuffer.dispose(),this.lineVertexArrayObject=null,this.lineVertexBuffer=null,this.lineIndexBuffer=null,this.memoryUsed=0}doPrepareForRendering(e,t,r,s){const i=new Uint32Array(r),a=new Int32Array(i.buffer),o=i[s++];this.lineVertexBuffer=n.Z.createVertex(e,35044,new Int32Array(a.buffer,4*s,o)),s+=o;const c=i[s++];this.lineIndexBuffer=n.Z.createIndex(e,35044,new Uint32Array(i.buffer,4*s,c)),s+=c,this.lineVertexArrayObject=new l.Z(e,t.getProgramAttributes(3),this.isLineDataDriven?h.lineVertexAttributesDD:h.lineVertexAttributes,{geometry:this.lineVertexBuffer},this.lineIndexBuffer)}}h.lineVertexAttributes={geometry:[{name:"a_pos",count:2,type:5122,offset:0,stride:12,normalized:!1,divisor:0},{name:"a_offsetAndNormal",count:4,type:5120,offset:4,stride:12,normalized:!1,divisor:0},{name:"a_accumulatedDistance",count:2,type:5123,offset:8,stride:12,normalized:!1,divisor:0}]},h.lineVertexAttributesDD={geometry:[{name:"a_pos",count:2,type:5122,offset:0,stride:20,normalized:!1,divisor:0},{name:"a_offsetAndNormal",count:4,type:5120,offset:4,stride:20,normalized:!1,divisor:0},{name:"a_accumulatedDistance",count:2,type:5122,offset:8,stride:20,normalized:!1,divisor:0},{name:"a_color",count:4,type:5121,offset:12,stride:20,normalized:!0,divisor:0},{name:"a_width",count:1,type:5126,offset:16,stride:20,normalized:!1,divisor:0}]};class p extends u{constructor(e){super(e),this.type=1,this.fillIndexStart=0,this.fillIndexCount=0,this.outlineIndexStart=0,this.outlineIndexCount=0;let t=this.bufferDataOffset;const r=new Uint32Array(e);this.fillIndexStart=r[t++],this.fillIndexCount=r[t++],this.outlineIndexStart=r[t++],this.outlineIndexCount=r[t++],this.isFillDataDriven=!!r[t++],this.isOutlineDataDriven=!!r[t++],this.bufferDataOffset=t}hasData(){return this.fillIndexCount>0||this.outlineIndexCount>0}triangleCount(){return(this.fillIndexCount+this.outlineIndexCount)/3}doDestroy(){(0,o.pC)(this.fillVertexArrayObject)&&this.fillVertexArrayObject.dispose(),(0,o.pC)(this.fillVertexBuffer)&&this.fillVertexBuffer.dispose(),(0,o.pC)(this.fillIndexBuffer)&&this.fillIndexBuffer.dispose(),this.fillVertexArrayObject=null,this.fillVertexBuffer=null,this.fillIndexBuffer=null,(0,o.pC)(this.outlineVertexArrayObject)&&this.outlineVertexArrayObject.dispose(),(0,o.pC)(this.outlineVertexBuffer)&&this.outlineVertexBuffer.dispose(),(0,o.pC)(this.outlineIndexBuffer)&&this.outlineIndexBuffer.dispose(),this.outlineVertexArrayObject=null,this.outlineVertexBuffer=null,this.outlineIndexBuffer=null,this.memoryUsed=0}doPrepareForRendering(e,t,r,s){const i=new Uint32Array(r),a=new Int32Array(i.buffer),o=i[s++];this.fillVertexBuffer=n.Z.createVertex(e,35044,new Int32Array(a.buffer,4*s,o)),s+=o;const c=i[s++];this.fillIndexBuffer=n.Z.createIndex(e,35044,new Uint32Array(i.buffer,4*s,c)),s+=c;const u=i[s++];this.outlineVertexBuffer=n.Z.createVertex(e,35044,new Int32Array(a.buffer,4*s,u)),s+=u;const h=i[s++];this.outlineIndexBuffer=n.Z.createIndex(e,35044,new Uint32Array(i.buffer,4*s,h)),s+=h,this.fillVertexArrayObject=new l.Z(e,t.getProgramAttributes(1),this.isFillDataDriven?p.fillVertexAttributesDD:p.fillVertexAttributes,{geometry:this.fillVertexBuffer},this.fillIndexBuffer),this.outlineVertexArrayObject=new l.Z(e,t.getProgramAttributes(2),this.isOutlineDataDriven?p.outlineVertexAttributesDD:p.outlineVertexAttributes,{geometry:this.outlineVertexBuffer},this.outlineIndexBuffer)}}p.fillVertexAttributes={geometry:[{name:"a_pos",count:2,type:5122,offset:0,stride:4,normalized:!1,divisor:0}]},p.fillVertexAttributesDD={geometry:[{name:"a_pos",count:2,type:5122,offset:0,stride:8,normalized:!1,divisor:0},{name:"a_color",count:4,type:5121,offset:4,stride:8,normalized:!0,divisor:0}]},p.outlineVertexAttributes={geometry:[{name:"a_pos",count:2,type:5122,offset:0,stride:8,normalized:!1,divisor:0},{name:"a_offset",count:2,type:5120,offset:4,stride:8,normalized:!1,divisor:0},{name:"a_xnormal",count:2,type:5120,offset:6,stride:8,normalized:!1,divisor:0}]},p.outlineVertexAttributesDD={geometry:[{name:"a_pos",count:2,type:5122,offset:0,stride:12,normalized:!1,divisor:0},{name:"a_offset",count:2,type:5120,offset:4,stride:12,normalized:!1,divisor:0},{name:"a_xnormal",count:2,type:5120,offset:6,stride:12,normalized:!1,divisor:0},{name:"a_color",count:4,type:5121,offset:8,stride:12,normalized:!0,divisor:0}]};class d extends u{constructor(e,t){super(e),this.type=3,this.iconPerPageElementsMap=new Map,this.glyphPerPageElementsMap=new Map,this.symbolInstances=[],this.isIconSDF=!1,this.opacityChanged=!1,this.lastOpacityUpdate=0,this.symbols=[];let r=this.bufferDataOffset;const s=new Uint32Array(e),i=new Int32Array(e),a=new Float32Array(e);this.isIconSDF=!!s[r++],this.isIconDataDriven=!!s[r++],this.isTextDataDriven=!!s[r++];const o=s[r++];for(let e=0;e<o;e++){const e=s[r++],t=s[r++],i=s[r++];this.iconPerPageElementsMap.set(e,[t,i])}const n=s[r++];for(let e=0;e<n;e++){const e=s[r++],t=s[r++],i=s[r++];this.glyphPerPageElementsMap.set(e,[t,i])}const l=s[r++],u=s[r++];this.iconOpacity=new Int32Array(l),this.textOpacity=new Int32Array(u),r=(0,c.wB)(s,i,a,r,this.symbols,t),this.bufferDataOffset=r}hasData(){return this.iconPerPageElementsMap.size>0||this.glyphPerPageElementsMap.size>0}triangleCount(){let e=0;return this.iconPerPageElementsMap.forEach((t=>{e+=t[1]})),this.glyphPerPageElementsMap.forEach((t=>{e+=t[1]})),e/3}doDestroy(){(0,o.pC)(this.iconVertexArrayObject)&&this.iconVertexArrayObject.dispose(),(0,o.pC)(this.iconVertexBuffer)&&this.iconVertexBuffer.dispose(),(0,o.pC)(this.iconOpacityBuffer)&&this.iconOpacityBuffer.dispose(),(0,o.pC)(this.iconIndexBuffer)&&this.iconIndexBuffer.dispose(),this.iconVertexArrayObject=null,this.iconVertexBuffer=null,this.iconOpacityBuffer=null,this.iconIndexBuffer=null,(0,o.pC)(this.textVertexArrayObject)&&this.textVertexArrayObject.dispose(),(0,o.pC)(this.textVertexBuffer)&&this.textVertexBuffer.dispose(),(0,o.pC)(this.textOpacityBuffer)&&this.textOpacityBuffer.dispose(),(0,o.pC)(this.textIndexBuffer)&&this.textIndexBuffer.dispose(),this.textVertexArrayObject=null,this.textVertexBuffer=null,this.textOpacityBuffer=null,this.textIndexBuffer=null,this.memoryUsed=0}updateOpacityInfo(){if(!this.opacityChanged)return;this.opacityChanged=!1;const e=(0,o.Wg)(this.iconOpacity),t=(0,o.Wg)(this.iconOpacityBuffer);e.length>0&&e.byteLength===t.size&&t.setSubData(e);const r=(0,o.Wg)(this.textOpacity),s=(0,o.Wg)(this.textOpacityBuffer);r.length>0&&r.byteLength===s.size&&s.setSubData(r)}doPrepareForRendering(e,t,r,s){const i=new Uint32Array(r),a=new Int32Array(i.buffer),c=i[s++];this.iconVertexBuffer=n.Z.createVertex(e,35044,new Int32Array(a.buffer,4*s,c)),s+=c;const u=i[s++];this.iconIndexBuffer=n.Z.createIndex(e,35044,new Uint32Array(i.buffer,4*s,u)),s+=u;const h=i[s++];this.textVertexBuffer=n.Z.createVertex(e,35044,new Int32Array(a.buffer,4*s,h)),s+=h;const p=i[s++];this.textIndexBuffer=n.Z.createIndex(e,35044,new Uint32Array(i.buffer,4*s,p)),s+=p,this.iconOpacityBuffer=n.Z.createVertex(e,35044,(0,o.Wg)(this.iconOpacity).buffer),this.textOpacityBuffer=n.Z.createVertex(e,35044,(0,o.Wg)(this.textOpacity).buffer),this.iconVertexArrayObject=new l.Z(e,t.getProgramAttributes(4),this.isIconDataDriven?d.vertexAttributesDD:d.vertexAttributes,{geometry:this.iconVertexBuffer,opacity:this.iconOpacityBuffer},this.iconIndexBuffer),this.textVertexArrayObject=new l.Z(e,t.getProgramAttributes(6),this.isTextDataDriven?d.vertexAttributesDD:d.vertexAttributes,{geometry:this.textVertexBuffer,opacity:this.textOpacityBuffer},this.textIndexBuffer)}}d.vertexAttributes={geometry:[{name:"a_pos",count:2,type:5122,offset:0,stride:16,normalized:!1,divisor:0},{name:"a_vertexOffset",count:2,type:5122,offset:4,stride:16,normalized:!1,divisor:0},{name:"a_texAngleRange",count:4,type:5121,offset:8,stride:16,normalized:!1,divisor:0},{name:"a_levelInfo",count:4,type:5121,offset:12,stride:16,normalized:!1,divisor:0}],opacity:[{name:"a_opacityInfo",count:1,type:5121,offset:0,stride:1,normalized:!1,divisor:0}]},d.vertexAttributesDD={geometry:[{name:"a_pos",count:2,type:5122,offset:0,stride:24,normalized:!1,divisor:0},{name:"a_vertexOffset",count:2,type:5122,offset:4,stride:24,normalized:!1,divisor:0},{name:"a_texAngleRange",count:4,type:5121,offset:8,stride:24,normalized:!1,divisor:0},{name:"a_levelInfo",count:4,type:5121,offset:12,stride:24,normalized:!1,divisor:0},{name:"a_color",count:4,type:5121,offset:16,stride:24,normalized:!0,divisor:0},{name:"a_size",count:1,type:5126,offset:20,stride:24,normalized:!1,divisor:0}],opacity:[{name:"a_opacityInfo",count:1,type:5121,offset:0,stride:1,normalized:!1,divisor:0}]};class f extends u{constructor(e){super(e),this.type=4,this.circleIndexStart=0,this.circleIndexCount=0;let t=this.bufferDataOffset;const r=new Uint32Array(e);this.circleIndexStart=r[t++],this.circleIndexCount=r[t++],this.bufferDataOffset=t}hasData(){return this.circleIndexCount>0}triangleCount(){return this.circleIndexCount/3}doDestroy(){(0,o.pC)(this.circleVertexArrayObject)&&this.circleVertexArrayObject.dispose(),(0,o.pC)(this.circleVertexBuffer)&&this.circleVertexBuffer.dispose(),(0,o.pC)(this.circleIndexBuffer)&&this.circleIndexBuffer.dispose(),this.circleVertexArrayObject=null,this.circleVertexBuffer=null,this.circleIndexBuffer=null,this.memoryUsed=0}doPrepareForRendering(e,t,r,s){const i=new Uint32Array(r),a=new Int32Array(i.buffer),o=i[s++];this.circleVertexBuffer=n.Z.createVertex(e,35044,new Int32Array(a.buffer,4*s,o)),s+=o;const c=i[s++];this.circleIndexBuffer=n.Z.createIndex(e,35044,new Uint32Array(i.buffer,4*s,c)),s+=c,this.circleVertexArrayObject=new l.Z(e,t.getProgramAttributes(5),f.circleVertexAttributes,{geometry:this.circleVertexBuffer},this.circleIndexBuffer)}}f.circleVertexAttributes={geometry:[{name:"a_pos",count:2,type:5122,offset:0,stride:16,normalized:!1,divisor:0},{name:"a_color",count:4,type:5121,offset:4,stride:16,normalized:!0,divisor:0},{name:"a_stroke_color",count:4,type:5121,offset:8,stride:16,normalized:!0,divisor:0},{name:"a_data",count:4,type:5121,offset:12,stride:16,normalized:!1,divisor:0}]};var y=r(9793);class m extends y.I{constructor(e,t,r,s){super(e,r,s,[4096,4096]),this._referenced=0,this._hasSymbolBuckets=!1,this._memoryUsedByLayerData=0,this.layerData=new Map,this.layerCount=0,this.status="loading",this.allSymbolsFadingOut=!1,this.lastOpacityUpdate=0,this.symbols=new Map,this.isCoverage=!1,this.neededForCoverage=!1,this.decluttered=!1,this.invalidating=!1,this.parentTile=null,this.childrenTiles=new Set,this._processed=!1,this._referenced=1,this.styleRepository=t,this.id=e.id,this.transforms.tileUnitsToPixels=(0,i.c)()}get hasSymbolBuckets(){return this._hasSymbolBuckets}get isFading(){return this._hasSymbolBuckets&&performance.now()-this.lastOpacityUpdate<a.nN}get isHoldingForFade(){return this._hasSymbolBuckets&&(!this.allSymbolsFadingOut||performance.now()-this.lastOpacityUpdate<a.nN)}get wasRequested(){return"errored"===this.status||"loaded"===this.status||"reloading"===this.status}setData(e){this.changeDataImpl(e),this.requestRender(),this.ready(),this.invalidating=!1,this._processed=!0}deleteLayerData(e){let t=!1;for(const r of e)if(this.layerData.has(r)){const e=this.layerData.get(r);this._memoryUsedByLayerData-=e.memoryUsed,3===e.type&&this.symbols.has(r)&&(this.symbols.delete(r),t=!0),e.destroy(),this.layerData.delete(r),this.layerCount--}t&&this.emit("symbols-changed"),this.requestRender()}processed(){return this._processed}hasData(){return this.layerCount>0}dispose(){m._destroyRenderBuckets(this.layerData),this.layerData=null,this.layerCount=0,this._memoryUsedByLayerData=0,this.destroy()}release(){return 0==--this._referenced&&(this.dispose(),this.stage=null,!0)}reference(){++this._referenced}get referenced(){return this._referenced}getMemoryUsage(){return this._memoryUsedByLayerData/(this._referenced||1)}changeDataImpl(e){let t=!1;if(e){const r=this._createRenderBuckets(e);for(const[e,s]of r){if(this.layerData.has(e)){const t=this.layerData.get(e);this._memoryUsedByLayerData-=s.memoryUsed,t.destroy(),this.layerData.delete(e),this.layerCount--}3===s.type&&(this.symbols.set(e,s.symbols),t=!0),this._memoryUsedByLayerData+=s.memoryUsed,this.layerData.set(e,s),this.layerCount++}}this._hasSymbolBuckets=!1;for(const[e,t]of this.layerData)3===t.type&&(this._hasSymbolBuckets=!0);t&&this.emit("symbols-changed")}attachWithContext(e){this.stage={context:e,trashDisplayObject(e){e.processDetach()},untrashDisplayObject:()=>!1}}setTransform(e,t){super.setTransform(e,t);const r=t/(e.resolution*e.pixelRatio),i=this.size[0]/this.coordRange[0]*r,a=this.size[1]/this.coordRange[1]*r,o=[0,0];e.toScreen(o,this.coords);const n=this.transforms.tileUnitsToPixels;(0,s.i)(n),(0,s.a)(n,n,o),(0,s.r)(n,n,Math.PI*e.rotation/180),(0,s.c)(n,n,[i,a,1])}static _destroyRenderBuckets(e){const t=new Set;e.forEach((e=>{t.has(e)||(e.destroy(),t.add(e))})),e.clear()}_createRenderBuckets(e){const t=new Map,r=new Map;for(const s of e){const e=this._deserializeBucket(s,r);for(const r of e.layerUIDs)t.set(r,e)}return t}_deserializeBucket(e,t){let r=t.get(e);if(r)return r;switch(new Uint32Array(e)[0]){case 1:r=new p(e);break;case 2:r=new h(e);break;case 3:r=new d(e,this);break;case 4:r=new f(e)}return t.set(e,r),r}}},41658:(e,t,r)=>{"use strict";r.d(t,{PF:()=>i,Ts:()=>a,Bf:()=>s,nN:()=>o});const s=!0,i=32,a=1.5,o=200},16086:(e,t,r)=>{"use strict";r.d(t,{a:()=>s,J:()=>i});class s{constructor(e){this.xTile=0,this.yTile=0,this.hash=0,this.priority=1,this.colliders=[],this.textVertexRanges=[],this.iconVertexRanges=[],this.tile=e}}class i{constructor(){this.tileSymbols=[],this.parts=[{startTime:0,startOpacity:0,targetOpacity:0,show:!1},{startTime:0,startOpacity:0,targetOpacity:0,show:!1}],this.show=!1}}},17441:(e,t,r)=>{"use strict";r.d(t,{HX:()=>a,wB:()=>o,co:()=>i,C$:()=>n});var s=r(16086);function i(e,t,r,s,i,a){const o=r-i;if(o>=0)return(t>>o)+(s-(a<<o))*(e>>o);const n=-o;return t-(a-(s<<n))*(e>>n)<<n}class a{constructor(e,t,r){this._rows=Math.ceil(t/r),this._columns=Math.ceil(e/r),this._cellSize=r,this.cells=new Array(this._rows);for(let e=0;e<this._rows;e++){this.cells[e]=new Array(this._columns);for(let t=0;t<this._columns;t++)this.cells[e][t]=[]}}getCell(e,t){const r=Math.min(Math.max(Math.floor(t/this._cellSize),0),this._rows-1),s=Math.min(Math.max(Math.floor(e/this._cellSize),0),this._columns-1);return this.cells[r]&&this.cells[r][s]||null}getCellSpan(e,t,r,s){return[Math.min(Math.max(Math.floor(e/this._cellSize),0),this.columns-1),Math.min(Math.max(Math.floor(t/this._cellSize),0),this.rows-1),Math.min(Math.max(Math.floor(r/this._cellSize),0),this.columns-1),Math.min(Math.max(Math.floor(s/this._cellSize),0),this.rows-1)]}get cellSize(){return this._cellSize}get columns(){return this._columns}get rows(){return this._rows}}function o(e,t,r,i,a,o){const n=t[i++];for(let l=0;l<n;l++){const n=new s.a(o);n.xTile=t[i++],n.yTile=t[i++],n.hash=t[i++],n.priority=t[i++];const l=t[i++];for(let e=0;e<l;e++){const e=t[i++],s=t[i++],a=t[i++],o=t[i++],l=!!t[i++],c=t[i++],u=r[i++],h=r[i++],p=t[i++],d=t[i++];n.colliders.push({xTile:e,yTile:s,dxPixels:a,dyPixels:o,hard:l,partIndex:c,width:p,height:d,minLod:u,maxLod:h})}const c=e[i++];for(let t=0;t<c;t++)n.textVertexRanges.push([e[i++],e[i++]]);const u=e[i++];for(let t=0;t<u;t++)n.iconVertexRanges.push([e[i++],e[i++]]);a.push(n)}return i}function n(e,t,r){for(const[s,i]of e.symbols)l(e,t,r,i,s)}function l(e,t,r,s,i){const a=e.layerData.get(i);if(3===a.type){for(const t of s){const s=t.unique;let i;if(t.selectedForRendering){const t=s.parts[0],a=t.startOpacity,o=t.targetOpacity;e.allSymbolsFadingOut=e.allSymbolsFadingOut&&0===o;const n=r?Math.floor(127*a)|o<<7:o?255:0;i=n<<24|n<<16|n<<8|n}else i=0;for(const[e,r]of t.iconVertexRanges)for(let t=e;t<e+r;t+=4)a.iconOpacity[t/4]=i;if(t.selectedForRendering){const t=s.parts[1],a=t.startOpacity,o=t.targetOpacity;e.allSymbolsFadingOut=e.allSymbolsFadingOut&&0===o;const n=r?Math.floor(127*a)|o<<7:o?255:0;i=n<<24|n<<16|n<<8|n}else i=0;for(const[e,r]of t.textVertexRanges)for(let t=e;t<e+r;t+=4)a.textOpacity[t/4]=i}a.lastOpacityUpdate=t,a.opacityChanged=!0}}},9793:(e,t,r)=>{"use strict";r.d(t,{I:()=>n});r(95830);var s=r(98501),i=r(5201),a=r(55955),o=r(56291);class n extends o.s{constructor(e,t,r,s=r){super(),this.triangleCountReportedInDebug=0,this.transforms={dvs:(0,a.c)(),tileMat3:(0,a.c)()},this.triangleCount=0,this.key=new i.Z(e),this.bounds=t,this.size=r,this.coordRange=s}destroy(){this.texture&&(this.texture.dispose(),this.texture=null)}get coords(){return this._coords}get bounds(){return this._bounds}set bounds(e){this._coords=[e[0],e[3]],this._bounds=e}setTransform(e,t){const r=t/(e.resolution*e.pixelRatio),i=this.transforms.tileMat3,[a,o]=e.toScreenNoRotation([0,0],this.coords),n=this.size[0]/this.coordRange[0]*r,l=this.size[1]/this.coordRange[1]*r;(0,s.s)(i,n,0,0,0,l,0,a,o,1),(0,s.m)(this.transforms.dvs,e.displayViewMat3,i)}}},71286:(e,t,r)=>{"use strict";r.d(t,{xl:()=>O,aK:()=>I,eF:()=>f,V8:()=>o,wz:()=>u,o4:()=>c,$0:()=>n,iV:()=>B,Zd:()=>M,Qg:()=>p,YP:()=>h,uG:()=>R,Jc:()=>k,xm:()=>l,m4:()=>T,AI:()=>s,ru:()=>i,fL:()=>P,iJ:()=>g,nM:()=>v,Ij:()=>_,f2:()=>w,Ic:()=>b,Al:()=>m,QU:()=>x,Jw:()=>S,kF:()=>A,yP:()=>C,D3:()=>y,Iw:()=>d,OM:()=>L,I_:()=>a,a:()=>V,CU:()=>U,V4:()=>D});const s=1e-30,i=4294967295,a=512,o=128,n=8,l=29,c=1,u=16,h=50,p=10,d=8,f={metrics:{width:15,height:17,left:0,top:-7,advance:14}},y=0,m=0,b=0,g=1,v=2,_=3,w=4,x=5,S=6,A=5,C=6,O=1,I=2,T=2,R=1,M=2,B=4,L=2.5,k=6,D=5,U=6,V=1.15,P=2},32415:(e,t,r)=>{"use strict";r.d(t,{iC:()=>o,s9:()=>i,Br:()=>a,zS:()=>c,Ue:()=>l,Tc:()=>n,Fm:()=>h,xW:()=>u,v:()=>p,RA:()=>f,N9:()=>d});r(95830),r(5627);var s=r(8634);r(84570),r(89930);function i(e,t,r="nearest",i=!1){var a;const o=!(i&&"u8"===t.pixelType),n=o?5126:5121,l=null==t.pixels||0===t.pixels.length?null:o?t.getAsRGBAFloat():t.getAsRGBA(),c=null==(a=e.capabilities.textureFloat)?void 0:a.textureFloatLinear,u={width:t.width,height:t.height,target:3553,pixelFormat:6408,internalFormat:6408,samplingMode:!c||"bilinear"!==r&&"cubic"!==r?9728:9729,dataType:n,wrapMode:33071,flipped:!1};return new s.Z(e,u,l)}function a(e,t){const r=4*t.size[0],i=t.size[1],a={width:r,height:i,target:3553,pixelFormat:6408,internalFormat:6408,dataType:5126,samplingMode:9728,wrapMode:33071,flipped:!1},o=new Float32Array(r*i*4);let n=0;for(let e=0;e<t.coefficients.length;e++)o[n++]=t.coefficients[e],e%3==2&&(o[n++]=1);return new s.Z(e,a,o)}function o(e,t){const r={width:t.length/4,height:1,target:3553,pixelFormat:6408,internalFormat:6408,dataType:5121,samplingMode:9728,wrapMode:33071,flipped:!1};return new s.Z(e,r,t)}function n(e,t,r,s=1,i=!0,a=!1){return{u_flipY:i,u_isFloatTexture:a,u_applyTransform:!!e,u_opacity:s,u_transformSpacing:e?e.spacing:null,u_transformGridSize:e?e.size:null,u_targetImageSize:t,u_srcImageSize:r}}function l(e,t){return{u_colormapOffset:t||0,u_colormapMaxIndex:e?e.length/4-1:null}}function c(e,t){return{u_scale:e,u_offset:t}}function u(e){return{u_bandCount:e.bandCount,u_minOutput:e.outMin,u_maxOutput:e.outMax,u_minCutOff:e.minCutOff,u_maxCutOff:e.maxCutOff,u_factor:e.factor,u_useGamma:e.useGamma,u_gamma:e.gamma,u_gammaCorrection:e.gammaCorrection}}function h(e){return{u_hillshadeType:e.hillshadeType,u_sinZcosAs:e.sinZcosAs,u_sinZsinAs:e.sinZsinAs,u_cosZs:e.cosZs,u_weights:e.weights,u_factor:e.factor,u_minValue:e.minValue,u_maxValue:e.maxValue}}function p(e,t){const r=e.gl,s=t.glName,i=r.getProgramParameter(s,r.ACTIVE_UNIFORMS),a=new Map;let o;for(let e=0;e<i;e++)o=r.getActiveUniform(s,e),o&&a.set(o.name,{location:r.getUniformLocation(s,o.name),info:o});return a}function d(e,t,r){Object.keys(r).forEach((s=>{const i=t.get(s)||t.get(s+"[0]");i&&function(e,t,r,s){if(null===s||null==r)return!1;const{info:i}=s;switch(i.type){case 5126:i.size>1?e.setUniform1fv(t,r):e.setUniform1f(t,r);break;case 35664:e.setUniform2fv(t,r);break;case 35665:e.setUniform3fv(t,r);break;case 35666:e.setUniform4fv(t,r);break;case 35675:e.setUniformMatrix3fv(t,r);break;case 35676:e.setUniformMatrix4fv(t,r);break;case 5124:i.size>1?e.setUniform1iv(t,r):e.setUniform1i(t,r);break;case 35670:e.setUniform1i(t,r?1:0);break;case 35667:case 35671:e.setUniform2iv(t,r);break;case 35668:case 35672:e.setUniform3iv(t,r);break;case 35669:case 35673:e.setUniform4iv(t,r);break;default:;}}(e,s,r[s],i)}))}function f(e,t,r,s){r.length===s.length&&(s.some((e=>null==e))||r.some((e=>null==e))||r.forEach(((r,i)=>{t.setUniform1i(r,i),e.bindTexture(s[i],i)})))}},99899:(e,t,r)=>{"use strict";r.r(t),r.d(t,{default:()=>Ce});var s=r(56140),i=(r(95830),r(36544)),a=(r(68055),r(79881)),o=r(51894),n=r(87566),l=(r(10923),r(57002),r(86035),r(12973)),c=r(59691),u=r(80621),h=(r(40450),r(24258)),p=r(9200),d=r(90846),f=r(19401),y=r(90806),m=r(60263),b=r(39105),g=r(83477),v=r(809),_=r(80882),w=r(94588),x=r(32656);var S=r(27780),A=r(73032),C=r(52937),O=(r(36348),r(33655)),I=r(93533),T=r(50897),R=r(17333),M=r(40920);const B=R.IU.x2lon,L=R.IU.y2lat;class k{constructor(e){const t=k.checkUnsupported(e);if(t)throw t;this.spatialReference=e.spatialReference,this._isWebMercator=this.spatialReference.isWebMercator,this._isGCS=(0,R.jF)(this.spatialReference)||(0,S.BZ)(this.spatialReference)||(0,S.V2)(this.spatialReference),this.origin=[e.origin.x,e.origin.y],this.pixelSize=e.size[0],this.dpi=e.dpi;const r=e.lods.reduce((function(e,t,r){return t.level<e.min&&(e.min=t.level,e.minIndex=r),e.max=Math.max(e.max,t.level),e}),{min:1/0,minIndex:0,max:-1/0}),s=e.lods[r.minIndex],i=Math.pow(2,s.level);let a=s.resolution*i,o=s.scale*i;this.levels=new Array(r.max+1);for(let t=0;t<this.levels.length;t++)this.levels[t]={resolution:a,scale:o,tileSize:[a*e.size[0],a*e.size[1]]},a/=2,o/=2}clone(){return new k(this.toTileInfo())}toTileInfo(){return new M.Z({dpi:this.dpi,origin:{x:this.origin[0],y:this.origin[1],spatialReference:this.spatialReference},size:[this.pixelSize,this.pixelSize],spatialReference:this.spatialReference,lods:this.levels.map(((e,t)=>({level:t,scale:e.scale,resolution:e.resolution})))})}getExtent(e,t,r,s){const i=this.levels[e],a=i.tileSize[0],o=i.tileSize[1];s[0]=this.origin[0]+r*a,s[2]=s[0]+a,s[3]=this.origin[1]-t*o,s[1]=s[3]-o}convertExtentToRadians(e,t){this._isWebMercator?(t[0]=B(e[0]),t[1]=L(e[1]),t[2]=B(e[2]),t[3]=L(e[3])):this._isGCS&&(t[0]=(0,O.Vl)(e[0]),t[1]=(0,O.Vl)(e[1]),t[2]=(0,O.Vl)(e[2]),t[3]=(0,O.Vl)(e[3]))}getExtentGeometry(e,t,r,s=new C.Z){return this.getExtent(e,t,r,D),s.spatialReference=this.spatialReference,s.xmin=D[0],s.ymin=D[1],s.xmax=D[2],s.ymax=D[3],s.zmin=void 0,s.zmax=void 0,s}ensureMaxLod(e){if(null==e)return!1;let t=!1;for(;this.levels.length<=e;){const e=this.levels[this.levels.length-1],r=e.resolution/2;this.levels.push({resolution:r,scale:e.scale/2,tileSize:[r*this.pixelSize,r*this.pixelSize]}),t=!0}return t}capMaxLod(e){this.levels.length>e+1&&(this.levels.length=e+1)}getMaxLod(){return this.levels.length-1}scaleAtLevel(e){return this.levels[0].scale/Math.pow(2,e)}levelAtScale(e){const t=this.levels[0].scale;return e>=t?0:Math.log(t/e)*Math.LOG2E}resolutionAtLevel(e){return this.levels[0].resolution/Math.pow(2,e)}compatibleWith(e){if(!(e instanceof k)){if(k.checkUnsupported(e))return!1;e=new k(e)}if(!e.spatialReference.equals(this.spatialReference))return!1;if(e.pixelSize!==this.pixelSize)return!1;const t=Math.min(this.levels.length,e.levels.length)-1,r=this.levels[t].resolution;let s=.5*r;return!(!(0,O.W8)(e.origin[0],this.origin[0],s)||!(0,O.W8)(e.origin[1],this.origin[1],s))&&(s=.5*r/Math.pow(2,t)/this.pixelSize*12,(0,O.W8)(r,e.levels[t].resolution,s))}rootTilesInExtent(e,t,r){const s=this.levels[0].tileSize;if(0===s[0]||0===s[1])return[];k.computeRowColExtent(e,s,this.origin,D);let i=D[1],a=D[3],o=D[0],n=D[2];const l=n-o,c=a-i;if(l*c>r){const e=Math.floor(Math.sqrt(r));c>e&&(i=i+Math.floor(.5*c)-Math.floor(.5*e),a=i+e),l>e&&(o=o+Math.floor(.5*l)-Math.floor(.5*e),n=o+e)}const u=[];for(let e=i;e<a;e++)for(let t=o;t<n;t++)u.push([0,e,t]);return t&&(t[0]=this.origin[0]+o*s[0],t[1]=this.origin[1]-a*s[1],t[2]=this.origin[0]+n*s[0],t[3]=this.origin[1]-i*s[1]),u}static computeRowColExtent(e,t,r,s){const i=.001*(e[2]-e[0]+(e[3]-e[1]));s[0]=Math.max(0,Math.floor((e[0]+i-r[0])/t[0])),s[2]=Math.max(0,Math.ceil((e[2]-i-r[0])/t[0])),s[1]=Math.max(0,Math.floor((r[1]-e[3]+i)/t[1])),s[3]=Math.max(0,Math.ceil((r[1]-e[1]-i)/t[1]))}static isPowerOfTwo(e){const t=e.lods,r=t[0].resolution*Math.pow(2,t[0].level);return!t.some((function(e){return!(0,O.Y8)(e.resolution,r/Math.pow(2,e.level))}))}static hasGapInLevels(e){const t=e.lods.map((function(e){return e.level}));t.sort((function(e,t){return e-t}));for(let e=1;e<t.length;e++)if(t[e]!==t[0]+e)return!0;return!1}static tileSizeSupported(e){const t=e.size[1];return t===e.size[0]&&0==(t&t-1)&&t>=128&&t<=512}static checkUnsupported(e){return e?e.lods.length<1?new x.Z("tilingscheme:generic","Tiling scheme must have at least one level"):k.isPowerOfTwo(e)?k.hasGapInLevels(e)?new x.Z("tilingscheme:gaps","Tiling scheme levels must not have gaps between min and max level"):k.tileSizeSupported(e)?null:new x.Z("tilingscheme:tile-size","Tiles must be square and size must be one of [128, 256, 512]"):new x.Z("tilingscheme:power-of-two","Tiling scheme must be power of two"):new x.Z("tilingscheme:tile-info-missing","Tiling scheme must have tiling information")}static fromExtent(e,t){const r=e[2]-e[0],s=e[3]-e[1],i=(0,I.c9)(t),a=1.2*Math.max(r,s),o=256,n=new k(new M.Z({size:[o,o],origin:{x:e[0]-.5*(a-r),y:e[3]+.5*(a-s)},lods:[{level:0,resolution:a/o,scale:1/(o/96*.0254/(a*i))}],spatialReference:t}));return n.ensureMaxLod(20),n}static makeWebMercatorAuxiliarySphere(e){const t=new k(k.WebMercatorAuxiliarySphereTileInfo);return t.ensureMaxLod(e),t}static makeGCSWithTileSize(e,t=256,r=16){const s=256/t,i=new k(new M.Z({size:[t,t],origin:{x:-180,y:90,spatialReference:e},spatialReference:e,lods:[{level:0,resolution:.703125*s,scale:295497598.570834*s}]}));return i.ensureMaxLod(r),i}get test(){return{isWebMercator:this._isWebMercator,isGCS:this._isGCS}}}k.WebMercatorAuxiliarySphereTileInfo=new M.Z({size:[256,256],origin:{x:-20037508.342787,y:20037508.342787,spatialReference:A.Z.WebMercator},spatialReference:A.Z.WebMercator,lods:[{level:0,resolution:156543.03392800014,scale:591657527.591555}]}),k.WebMercatorAuxiliarySphere=k.makeWebMercatorAuxiliarySphere(19);const D=(0,T.Ue)(),U=k;r(87790),r(66416),r(57680);var V=r(82550),P=r(59472),z=r(19677),j=r(82677),E=r(54721),Z=r(35430),F=r(56469);class N{constructor(e){this.typeWorkerQuota=e,this.tasks=new Array,this.numWorkers=0,this.statistics=new W}}class W{constructor(){this.requests=0,this.size=0,this.duration=0,this.speed=0}}class q{constructor(e,t,r,s){this._workerFunc=e,this._callbackFunc=t,this._maxTotalNumWorkers=r,this._totalNumWorkers=0,this._clients=s.map((e=>new N(e)))}hasQuota(e){const t=this._clients[e];return!!t&&t.typeWorkerQuota>t.numWorkers+t.tasks.length}push(e){const t=this._clients[e.client];t&&(this._totalNumWorkers<this._maxTotalNumWorkers?(t.numWorkers++,this._totalNumWorkers++,this._workerFunc(e,((e,t)=>this._taskCallback(e,t)))):t.tasks.push(e))}getStatsForType(e){const t=this._clients[e];return t?{quota:t.typeWorkerQuota,workers:t.numWorkers,queueSize:t.tasks.length,requestStats:t.statistics}:null}cancel(e){this._taskFinished(e),e._cancelled=!0}destroy(){this._clients.length=0}_taskFinished(e){const t=this._clients[e.client];this._totalNumWorkers--,t.numWorkers--,t.statistics.requests++,t.statistics.size+=e.size||0,t.statistics.duration+=e.duration||0,t.statistics.speed=t.statistics.duration>0?t.statistics.size/t.statistics.duration:0,(0,F.hu)(t.numWorkers>=0),this._next()}_next(){for(const e of this._clients)if(e&&e.numWorkers<e.typeWorkerQuota&&this._processQueue(e))return;for(const e of this._clients)if(e&&this._processQueue(e))return}_processQueue(e){for(;e.tasks.length>0;)if(this._workerFunc(e.tasks.shift(),((e,t)=>this._taskCallback(e,t))))return e.numWorkers++,this._totalNumWorkers++,!0;return!1}_taskCallback(e,t){e._cancelled||(this._callbackFunc(e,t),this._taskFinished(e))}get test(){const e=this;return{set workerFunc(t){e._workerFunc=t}}}}let G=class extends j.default{constructor(){super(...arguments),this.tasks=new Map,this.onLoadQueue=new Array,this.doneQueue=new Array,this.updating=!1}setup(e,t,r){this.loadQueue=new q(((e,t)=>this.startLoading(e,t)),((e,t)=>this.doneLoadingCallback(e,t)),e,t),r&&(this.taskHandle=r.registerTask(Z.iQ.STREAM_DATA_LOADER,(e=>this.update(e)),(()=>this.doneQueue.length>0||this.onLoadQueue.length>0)))}destroy(){this.taskHandle&&(this.taskHandle.remove(),this.taskHandle=null),this.tasks.forEach((e=>{e.abortController&&e.abortController.abort()})),this.loadQueue.destroy(),this.loadQueue=null,this.onLoadQueue=null,this.doneQueue=null,this.tasks=null}hasDownloadSlots(e){return this.loadQueue.hasQuota(e)}request(e,t,r,s={}){const i=(0,b.createResolver)();i.__signal=(0,P.pC)(s)?s.signal:null;const a=this.createOrUpdateTask(e,t,r,s,i);return(0,b.onAbort)(s,(()=>this.cancelRequest(a,i))),i.promise}createTask(e,t,r,s,i,a){const o=new class extends class{constructor(e){this.client=e,this._cancelled=!1,this.size=0,this.duration=0}}{constructor(e,t,r,s,i){super(s),this.url=e,this.options=t,this.docType=r,this.key=i,this.result=null,this.status=1,this.request=null,this.abortController=null,this.resolvers=new Array,this.startTime=0}}(e,t,r,s,i);return this.updateTask(o,a),this.tasks.set(i,o),1===this.tasks.size&&this._set("updating",!0),this.loadQueue.push(o),o}cancelRequest(e,t){(0,z.e$)(e.resolvers,t),t.reject((0,b.createAbortError)()),0===e.resolvers.length&&(2===e.status&&(e.status=4,this.loadQueue.cancel(e),e.abortController.abort(),e.request=null,e.abortController=null),e.status=4,this.tasks.delete(e.key),0===this.tasks.size&&this._set("updating",!1))}taskKey(e,t,r){return`${e}:${t}:${r}`}updateTask(e,t){e.resolvers.push(t)}createOrUpdateTask(e,t,r,s,i){const a=(0,P.pC)(s)&&s.uid||e,o=this.taskKey(a,t,r),n=this.tasks.get(o);return n?(this.updateTask(n,i),n):this.createTask(e,s,t,r,o,i)}doneLoadingCallback(e,t){this.loadQueue&&((0,F.hu)(2===e.status),e.status=3,this.taskHandle?this.doneQueue.push({task:e,err:t}):this.doneLoading(e,t))}update(e){for(;!e.done&&this.onLoadQueue.length>0;){const t=this.onLoadQueue.shift();(0,b.throwIfAborted)(t.task.abortController),t.task.abortController=null,t.callback(t.task),e.madeProgress()}for(;!e.done&&this.doneQueue.length>0;){const t=this.doneQueue.shift();3!==t.task.status&&(t.err=t.err||(0,b.createAbortError)()),this.doneLoading(t.task,t.err),e.madeProgress()}}doneLoading(e,t){let r=e.result instanceof HTMLImageElement?0:e.resolvers.length;for(const s of e.resolvers)if(t)(0,b.isAbortError)(t)?s.reject(t):s.reject(new x.Z("stream-data-loader:request-error",`Failed to request resource at '${e.url}'. ${t}`,{url:e.url,error:t}));else{--r;const t=r<=0?e.result:(0,V.d9)(e.result);s.resolve(t)}this.tasks.delete(e.key),0===this.tasks.size&&this._set("updating",!1)}startLoading(e,t){if(4===e.status)return!1;let r,s;switch(e.startTime=performance.now(),e.status=2,e.docType){case"binary":s="array-buffer",r=0;break;case"image":s="image";break;case"image+type":s="array-buffer";break;default:s="json"}e.abortController=(0,b.createAbortController)();const i=e.abortController.signal;e.request=(0,E.default)(e.url,{...e.options,responseType:s,timeout:r,signal:i});let a=()=>{};const o=r=>{e.duration=performance.now()-e.startTime,e.size=r instanceof ArrayBuffer?r.byteLength:e.size||0,e.result=r,this.taskHandle?this.onLoadQueue.push({callback:t,task:e}):(e.abortController=null,t(e))},n=r=>{2===e.status&&t(e,r),a()};return"image+type"!==e.docType?(e.request.then((e=>o(e.data)),n),!0):(e.request.then((t=>{const l=t.data,c=function(e){if(e.byteLength<2)return"unknown";const t=new Uint8Array(e,0,e.byteLength);return 137===t[0]&&80===t[1]?"image/png":71===t[0]&&73===t[1]?"image/gif":66===t[0]&&77===t[1]?"image/bmp":255===t[0]&&216===t[1]?"image/jpeg":"unknown"}(l);if(s="image",e.size=l.byteLength,"unknown"===c)return e.request=(0,E.default)(e.url,{responseType:s,timeout:r,signal:i}),void e.request.then((e=>o(e.data)),n);const u=new Blob([l],{type:c}),h=window.URL.createObjectURL(u);a=()=>window.URL.revokeObjectURL(h),e.request=(0,E.default)(h,{responseType:s,timeout:r,signal:i}),e.request.then((e=>o(new Q(e.data,c,a))),n)}),n),!0)}get test(){return{loadQueue:this.loadQueue}}};(0,s._)([(0,a.Cb)({readOnly:!0})],G.prototype,"updating",void 0),G=(0,s._)([(0,n.j)("esri.views.3d.support.StreamDataLoader")],G);class Q{constructor(e,t,r){this.image=e,this.type=t,this.release=r}get isOpaque(){return"image/jpeg"===this.type}}r(57498),r(32415);var $=r(77625),J=r(17387);(0,O.oK)(O._3/10);const H=(0,T.Ue)();U.WebMercatorAuxiliarySphere.getExtent(0,0,0,H);(0,T.Ue)([-180,-90,180,90]);const Y=(0,$.c)(),K=(0,$.c)(),X=(0,$.c)(),ee=(0,$.c)();function te(e,t,r,s){(0,J.g)(Y,r),Y[s]=t[s];const i=(0,J.f)(Y,Y,t),a=(0,J.f)(K,e,t),o=(0,J.d)(a,i),n=(0,J.d)(i,i);let l;l=o<=0?t:n<=o?r:(0,J.b)(Y,t,(0,J.a)(i,i,o/n));const c=(0,J.f)(Y,e,l);return Math.PI/2-Math.atan(c[2]/Math.sqrt(c[0]*c[0]+c[1]*c[1]))}const re={planar:Object.freeze({__proto__:null,isInsideExtent:function(e,t,r=0){const s=e.extent;if(0===r)return(0,T.BD)(s,t);const i=Math.min(s[2]-s[0],s[3]-s[1]);return(0,T.Zm)(s,t,r*i)},tiltOnEdge:te,tiltToExtentEdge:function(e,t){const r=e.elevationBounds,s=e.extent,i=.5*(r.min+r.max);X[0]=s[0],X[1]=s[1],X[2]=i,ee[0]=s[2],ee[1]=s[3],ee[2]=i;let a=1/0,o=1/0;return t[0]<X[0]?a=te(t,X,ee,0):t[0]>ee[0]&&(a=te(t,ee,X,0)),t[1]<X[1]?o=te(t,X,ee,1):t[1]>ee[1]&&(o=te(t,ee,X,1)),Math.min(a,o)},checkIfTileInfoSupportedForViewSR:function(e,t,r){if(e.spatialReference.isGeographic)return new x.Z("tilingscheme:local-gcs-not-supported","Geographic coordinate systems are not supported in local scenes");const s=U.checkUnsupported(e);return s||(function(e,t){const r=e.lods,s=r[0].resolution*Math.pow(2,r[0].level),i=[s*e.size[0],s*e.size[1]],a=[e.origin.x,e.origin.y],o=(0,T.oJ)(t),n=(0,T.Ue)();U.computeRowColExtent(o,i,a,n);const l=(n[2]-n[0])*(n[3]-n[1]);if(l>64){const t=r[0].scale*Math.pow(2,r[0].level);let i=Math.max((o[3]-o[1])/e.size[1],(o[2]-o[0])/e.size[0])*t/s;const a=Math.floor(Math.log(i)/Math.log(10));return i=Math.ceil(i/Math.pow(10,a))*Math.pow(10,a),new x.Z("tilingscheme:too-many-root-tiles","Scale of level 0 of the tiling scheme (1:"+Math.floor(t).toLocaleString()+") is too large for the layer's extent. Suggested scale: 1:"+i.toLocaleString()+".",{level0Scale:t,suggestedLevel0Scale:i,requiredNumRootTiles:l,allowedNumRootTiles:64})}return null}(e,r)||(t&&!e.spatialReference.equals(t)?new x.Z("tilingscheme:spatial-reference-mismatch","The tiling scheme does not match the spatial reference of the local scene"):null))}}),spherical:Object.freeze({__proto__:null,isInsideExtent:function(){return!0},tiltToExtentEdge:function(){return 0},checkIfTileInfoSupportedForViewSR:function(e,t){const r=e.lods.length-1,s=e.spatialReference,i=(0,R.jF)(s)||(0,S.BZ)(s)||(0,S.V2)(s);if(s.isWebMercator){if(!U.makeWebMercatorAuxiliarySphere(r).compatibleWith(e))return new x.Z("tilingscheme:incompatible-global-web-mercator","The tiling scheme is not compatible with the ArcGIS Online Web Mercator tiling scheme")}else{if(!i)return new x.Z("tilingscheme:global-unsupported-spatial-reference","The tiling scheme spatial reference is not supported in global scenes");if(!U.makeGCSWithTileSize(e.spatialReference,e.size[0],r).compatibleWith(e))return e.spatialReference.isWGS84?new x.Z("tilingscheme:incompatible-global-wgs84","The tiling scheme is not compatible with the ArcGIS Online WGS84 tiling scheme"):new x.Z("tilingscheme:incompatible-global","The tiling scheme is not compatible with the ArcGIS Online tiling scheme")}if(t&&!e.spatialReference.equals(t))return new x.Z("tilingscheme:spatial-reference-mismatch","The tiling scheme does not match the spatial reference of the global scene")}})};Math.PI,Math.PI;function se(e,t,r,s){let i;return i=2===s||"planar"===s?"planar":"spherical",re[i].checkIfTileInfoSupportedForViewSR(e,r,t)}async function ie(e,t={}){await async function(e,t){const{basemap:r,view:s}=e;if(await r.load(t),0===r.baseLayers.length)return;const i=function(e){const t=["ArcGISTiledImageServiceLayer","ArcGISTiledMapServiceLayer","OpenStreetMap","VectorTileLayer","WebTiledLayer"];return e.toArray().filter((e=>-1===t.indexOf(e.operationalLayerType))).map((e=>new x.Z("basemap-compatibility:unsupported-basemap-layer-type","Unsupported basemap layer type ${operationalLayerType}",{layer:e,operationalLayerType:e.operationalLayerType||"unknown"})))}(r.baseLayers.concat(r.referenceLayers));if(i.length)throw i[0];const a=(0,w.sM)(r.baseLayers.getItemAt(0))();try{await a.load(t)}catch(e){const t="basemap-compatibility:unknown-error",r="Unknown basemap compatibility error",{name:s=t,message:i=r,details:a}=e;throw new x.Z(s,i,a)}!function(e,t){const r=e.tileInfo;if(!r)return;const s=t.viewingMode;if(!s)return;if(!function(e,t){return null!=e&&("2d"===t||("local"===t?!e.isGeographic:e.isWebMercator||e.isWGS84||4490===e.wkid||104971===e.wkid||104905===e.wkid||104903===e.wkid))}(r.spatialReference,s))throw new x.Z(`basemapgalleryitem:spatial-reference-unsupported-${s}`,`Basemap spatial reference is unsupported in ${s} mode`);if("global"===s){let t=se(r,e.fullExtent,null,1);if(t&&e.compatibleTileInfo256&&!se(e.compatibleTileInfo256,e.fullExtent,null,1)&&(t=null),t){const e=r.spatialReference.isWebMercator?"web-mercator":"wgs84";throw new x.Z(`basemapgalleryitem:tiling-scheme-unsupported-${e}-global`,"Basemap tiling scheme is unsupported in global mode",{error:t})}}else if(U.checkUnsupported(r))throw new x.Z("basemapgalleryitem:tiling-scheme-unsupported-local","Basemap tiling scheme is unsupported in local mode");const i=t.get("basemapTerrain.tilingScheme");if(i&&!i.compatibleWith(r)&&(!e.compatibleTileInfo256||!i.compatibleWith(e.compatibleTileInfo256)))throw new x.Z("basemapgalleryitem:tiling-scheme-incompatible","Basemap tiling scheme is incompatible with the view")}(a,s)}(e,t),(0,b.throwIfAborted)(t)}async function ae(e,t={}){const{basemap:r,view:s}=e;if(await r.load(t),(0,b.throwIfAborted)(t),0===r.baseLayers.length)return;const i=r.baseLayers.getItemAt(0);if(!function(e){return e&&"base-tile"===e.type||"tile"===e.type||"elevation"===e.type||"imagery-tile"===e.type||"base-elevation"===e.type||"open-street-map"===e.type||"wcs"===e.type||"web-tile"===e.type||"wmts"===e.type||"vector-tile"===e.type}(i))return;if(r.spatialReference){if(s.spatialReference.equals(r.spatialReference))return;oe()}await i.load(t),(0,b.throwIfAborted)(t);const a=(i.get("supportedSpatialReferences")||[i.get("tileInfo.spatialReference")]).filter(Boolean);0!==a.length&&a.every((e=>!s.spatialReference.equals(e)))&&oe()}function oe(){throw new x.Z("basemap-compatibility:incompatible-spatial-reference","Basemap spatial reference is not compatible with the view")}let ne=class extends j.default{constructor(e){super(e),this._handles=new c.Z,this.compatibilityFunction=null,this.error=null,this.state="loading",this.view=null}initialize(){this._handles.add((0,u.init)(this,["basemap.loadStatus","compatibilityFunction","view.basemapTerrain?.tilingScheme","view.ready","view.spatialReference"],(()=>this.refresh())))}destroy(){this._cancelCompatibilityCheck(),this._handles.destroy(),this._handles=null,this.basemap=null,this.compatibilityFunction=null,this.view=null}set basemap(e){const t=this._get("basemap");t&&t.cancelLoad(),e&&e.load().catch((()=>{})),this._set("basemap",e)}refresh(){this._cancelCompatibilityCheck(),this._set("state","loading");const e=this.get("basemap.loadStatus");if("loaded"!==e&&"failed"!==e)return;if(!this.compatibilityFunction)return void("loaded"===e?(this._set("state","ready"),this._set("error",null)):(this._set("state","error"),this._set("error",this.basemap.loadError)));const t=new AbortController,{signal:r}=t;this.compatibilityFunction(this,{signal:r}).then((()=>{this._set("state","ready"),this._set("error",null)})).catch((e=>{(0,b.isAbortError)(e)||(this._set("state","error"),this._set("error",e))})),this._lastCompatibilityCheckController=t}_cancelCompatibilityCheck(){this._lastCompatibilityCheckController&&(this._lastCompatibilityCheckController.abort(),this._lastCompatibilityCheckController=null)}};(0,s._)([(0,a.Cb)()],ne.prototype,"basemap",null),(0,s._)([(0,a.Cb)()],ne.prototype,"compatibilityFunction",void 0),(0,s._)([(0,a.Cb)({readOnly:!0})],ne.prototype,"error",void 0),(0,s._)([(0,a.Cb)({readOnly:!0})],ne.prototype,"state",void 0),(0,s._)([(0,a.Cb)()],ne.prototype,"view",void 0),ne=(0,s._)([(0,n.j)("esri.widgets.BasemapGallery.support.BasemapGalleryItem")],ne);const le=ne;var ce=r(22696);const ue=g.Z.ofType(ce.default);let he=class extends j.default{constructor(e){super(e),this.basemaps=new ue}get state(){return"ready"}refresh(){}};(0,s._)([(0,a.Cb)({type:ue})],he.prototype,"basemaps",void 0),(0,s._)([(0,a.Cb)({readOnly:!0})],he.prototype,"state",null),he=(0,s._)([(0,n.j)("esri.widgets.BasemapGallery.support.LocalBasemapsSource")],he);const pe=he;var de=r(75044),fe=r(32797);const ye=g.Z.ofType(ce.default),me="esri.widgets.BasemapGallery.support.PortalBasemapsSource",be=i.Z.getLogger(me);let ge=class extends(v.Z.LoadableMixin((0,de.v)(pe))){constructor(e){super(e),this._handles=new c.Z,this.basemaps=new ye,this.filterFunction=null,this.portal=fe.Z.getDefault(),this.query=null,this.updateBasemapsCallback=null}initialize(){this._handles.add([(0,u.init)(this,["filterFunction","loadStatus","portal.basemapGalleryGroupQuery","portal.user","query","updateBasemapsCallback"],(()=>this.refresh()))])}destroy(){this._handles.destroy(),this._handles=null,this.filterFunction=null,this.portal=null}get state(){return"not-loaded"===this.loadStatus?"not-loaded":"loading"===this.loadStatus||this._lastPortalBasemapFetchController?"loading":"ready"}load(e){return this.addResolvingPromise(this.portal.load(e)),this.notifyChange("state"),(0,b.resolve)(this)}async refresh(){if("ready"!==this.state)return;this._lastPortalBasemapFetchController&&(this._lastPortalBasemapFetchController.abort(),this._lastPortalBasemapFetchController=null);const e=this.portal,t=new AbortController;this._lastPortalBasemapFetchController=t,this.notifyChange("state");try{const r=await e.fetchBasemaps(this._toQueryString(this.query),t);this._updateBasemaps(r)}catch(e){if((0,b.isAbortError)(e))throw e;be.warn(new x.Z("basemap-source:fetch-basemaps-error","Could not fetch basemaps from portal.",{error:e})),this._updateBasemaps()}this._lastPortalBasemapFetchController=null,this.notifyChange("state")}_toQueryString(e){return e&&"string"!=typeof e?Object.keys(e).map((t=>`${t}:${e[t]}`)).join(" AND "):e}_updateBasemaps(e=[]){let t=this.filterFunction?e.filter(this.filterFunction):e;t=this.updateBasemapsCallback?this.updateBasemapsCallback(t):t,this.basemaps.removeAll(),this.basemaps.addMany(t)}};(0,s._)([(0,a.Cb)({readOnly:!0,type:ye})],ge.prototype,"basemaps",void 0),(0,s._)([(0,a.Cb)()],ge.prototype,"filterFunction",void 0),(0,s._)([(0,a.Cb)({type:fe.Z})],ge.prototype,"portal",void 0),(0,s._)([(0,a.Cb)()],ge.prototype,"query",void 0),(0,s._)([(0,a.Cb)({dependsOn:["loadStatus"],readOnly:!0})],ge.prototype,"state",null),(0,s._)([(0,a.Cb)()],ge.prototype,"updateBasemapsCallback",void 0),ge=(0,s._)([(0,n.j)(me)],ge);const ve=ge,_e=g.Z.ofType(le);let we=class extends v.Z{constructor(e){super(e),this._handles=new c.Z,this.activeBasemap=null,this.items=new _e,this.source=new ve,this.view=null}initialize(){const e=()=>this._recreateItems();this._handles.add([(0,u.watch)(this,["compatibilityFunction","state"],(()=>this._updateItems())),(0,u.on)(this,"source.basemaps","change",e,e)])}destroy(){this._handles.destroy(),this._handles=null}get compatibilityFunction(){return void 0===this._get("compatibilityFunction")?"3d"===this.get("view.type")?ie:ae:this._get("compatibilityFunction")}set compatibilityFunction(e){this._set("compatibilityFunction",e)}castSource(e){return Array.isArray(e)||g.Z.isCollection(e)?new pe({basemaps:e}):function(e){return e&&"esri.portal.Portal"===e.declaredClass}(e)?new ve({portal:e}):function(e){return e&&!(e instanceof ve)&&(!!e.portal||!!e.query)}(e)?new ve(e):function(e){return e&&"basemaps"in e&&"state"in e&&"refresh"in e}(e)?e:null}get state(){return this.get("view.ready")&&this.source?"ready":"disabled"}basemapEquals(e,t){return(0,_.Bj)(e,t)}refresh(){this._recreateItems()}load(e){return this.addResolvingPromise(v.Z.isLoadable(this.source)?this.source.load(e):(0,b.resolve)()),(0,b.resolve)(this)}_recreateItems(){const e=this.get("source.basemaps"),{view:t,compatibilityFunction:r}=this;this.items.removeAll().forEach((e=>e.destroy())),this.items.addMany(e.map((e=>new le({basemap:e,compatibilityFunction:r,view:t}))))}_updateItems(){this.items.forEach((e=>{e.compatibilityFunction=this.compatibilityFunction,e.view=this.view}))}};(0,s._)([(0,a.Cb)({aliasOf:"view.map.basemap"})],we.prototype,"activeBasemap",void 0),(0,s._)([(0,a.Cb)({dependsOn:["view.type"]})],we.prototype,"compatibilityFunction",null),(0,s._)([(0,a.Cb)({readOnly:!0,type:_e})],we.prototype,"items",void 0),(0,s._)([(0,a.Cb)()],we.prototype,"source",void 0),(0,s._)([(0,m.p)("source")],we.prototype,"castSource",null),(0,s._)([(0,a.Cb)({readOnly:!0,dependsOn:["view.ready"]})],we.prototype,"state",null),(0,s._)([(0,a.Cb)()],we.prototype,"view",void 0),we=(0,s._)([(0,n.j)("esri.widgets.BasemapGallery.BasemapGalleryViewModel")],we);const xe=we,Se=(0,l.V)("esri/themes/base/images/basemap-toggle-64.svg");let Ae=class extends y.default{constructor(e,t){super(e,t),this._handles=new c.Z,this.activeBasemap=null,this.disabled=!1,this.iconClass="esri-icon-basemap",this.label=void 0,this.messages=null,this.source=null,this.view=null,this.viewModel=new xe}initialize(){const e=this._handles;this.own([(0,u.on)(this,"viewModel.items","change",(t=>{const r="basemap-gallery-item-changes",{added:s,moved:i}=t;e.remove(r),e.add([...s,...i].map((e=>e.watch("state",(()=>this.scheduleRender())))),r),this.scheduleRender()})),e,(0,u.whenOnce)(this,"source",(()=>this.viewModel.load()))])}render(){const e="loading"===this.get("source.state"),t=this.disabled||"disabled"===this.get("viewModel.state"),r=this.get("viewModel.items").toArray().map(this._renderBasemapGalleryItem,this),s={"esri-basemap-gallery--source-loading":e,"esri-disabled":t},i=e?(0,f.j)("div",{class:"esri-basemap-gallery__loader",key:"esri-basemap-gallery__loader"}):null,a=e?null:r.length>0?(0,f.j)("ul",{class:"esri-basemap-gallery__item-container",key:"esri-basemap-gallery__item-container",role:"menu"},r):(0,f.j)("div",{class:"esri-widget__content--empty",key:"esri-basemap-gallery__empty-message"},(0,f.j)("h2",{class:"esri-widget__heading"},this.messages.noBasemaps));return(0,f.j)("div",{class:this.classes("esri-basemap-gallery esri-widget esri-widget--panel-height-only",s)},i,a)}_handleClick(e){const t=e.currentTarget["data-item"];"ready"===t.state&&(this.activeBasemap=t.basemap)}_renderBasemapGalleryItem(e){const t=e.get("basemap.thumbnailUrl")||Se,r=e.get("basemap.title"),s=e.get("basemap.portalItem.snippet"),i=e.get("error.message")||s||r,{viewModel:a}=this,o=this.disabled||"ready"!==a.state||"ready"!==e.state?-1:0,n=a.basemapEquals(e.basemap,this.activeBasemap),l={"esri-basemap-gallery__item--selected":n,"esri-basemap-gallery__item--loading":"loading"===e.state,"esri-basemap-gallery__item--error":"error"===e.state};return(0,f.j)("li",{"aria-selected":n,bind:this,class:this.classes("esri-basemap-gallery__item",l),"data-item":e,onkeydown:this._handleClick,onclick:this._handleClick,role:"menuitem",tabIndex:o,title:i},(0,f.j)("img",{alt:"",class:"esri-basemap-gallery__item-thumbnail",src:t}),(0,f.j)("div",{class:"esri-basemap-gallery__item-title"},r))}};(0,s._)([(0,o.B)("viewModel.activeBasemap"),(0,d.G)()],Ae.prototype,"activeBasemap",void 0),(0,s._)([(0,a.Cb)(),(0,d.G)()],Ae.prototype,"disabled",void 0),(0,s._)([(0,a.Cb)()],Ae.prototype,"iconClass",void 0),(0,s._)([(0,a.Cb)({aliasOf:{source:"messages.widgetLabel",overridable:!0}})],Ae.prototype,"label",void 0),(0,s._)([(0,a.Cb)(),(0,d.G)(),(0,p.H)("esri/widgets/BasemapGallery/t9n/BasemapGallery")],Ae.prototype,"messages",void 0),(0,s._)([(0,o.B)("viewModel.source"),(0,d.G)("source.state")],Ae.prototype,"source",void 0),(0,s._)([(0,o.B)("viewModel.view"),(0,d.G)()],Ae.prototype,"view",void 0),(0,s._)([(0,a.Cb)(),(0,d.G)(["viewModel.state"])],Ae.prototype,"viewModel",void 0),(0,s._)([(0,h.h)()],Ae.prototype,"_handleClick",null),Ae=(0,s._)([(0,n.j)("esri.widgets.BasemapGallery")],Ae);const Ce=Ae},97900:function(e,t,r){"use strict";function s(e,t){for(var r=0;r<t.length;r++){var s=t[r];s.enumerable=s.enumerable||!1,s.configurable=!0,"value"in s&&(s.writable=!0),Object.defineProperty(e,s.key,s)}}function i(e,t){return(i=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function a(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,s=n(e);if(t){var i=n(this).constructor;r=Reflect.construct(s,arguments,i)}else r=s.apply(this,arguments);return o(this,r)}}function o(e,t){return!t||"object"!==l(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function n(e){return(n=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function l(e){return(l="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}var c=this&&this.__decorate||function(e,t,r,s){var i,a=arguments.length,o=a<3?t:null===s?s=Object.getOwnPropertyDescriptor(t,r):s;if("object"===("undefined"==typeof Reflect?"undefined":l(Reflect))&&"function"==typeof Reflect.decorate)o=Reflect.decorate(e,t,r,s);else for(var n=e.length-1;n>=0;n--)(i=e[n])&&(o=(a<3?i(o):a>3?i(t,r,o):i(t,r))||o);return a>3&&o&&Object.defineProperty(t,r,o),o},u=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});var h=r(83781),p=r(73502),d=u(r(90806)),f=u(r(81826));r(40548);var y="esri-widget basemaps-base",m=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&i(e,t)}(l,e);var t,r,o,n=a(l);function l(e){var t;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,l),(t=n.call(this,e)).viewModel=new f.default,t._createMaps=function(){t.basemaps&&(t.basemaps.container="maps")},t._createImages=function(){t.images&&(t.images.container="images")},t.handleSwitchChange=function(e){""!=e.target.getAttribute("switched")?(t.view.map.addMany(t.viewModel.activeBasemap.baseLayers.toArray(),0),t.view.map.basemap.referenceLayers.forEach((function(e){e.visible=!1})),t.view.map.layers.filter((function(e){return t.viewModel.activeBasemap.baseLayers.includes(e)})).forEach((function(e){e.opacity=.5,e.visible=!0}))):(t.view.map.basemap.referenceLayers.forEach((function(e){e.visible=!0})),t.viewModel.activeBasemap.baseLayers.forEach((function(e){t.view.map.remove(t.view.map.findLayerById(e.id))})))},t.handleSliderChange=function(e){t.view.map.layers.filter((function(e){var r;return null===(r=t.viewModel.activeBasemap)||void 0===r?void 0:r.baseLayers.includes(e)})).toArray().forEach((function(t){t.opacity=parseFloat(e.target.getAttribute("value"))}))},t._sliderCreated=function(e){var r;null===(r=document.querySelector("#blendSlider"))||void 0===r||r.addEventListener("calciteSliderUpdate",t.handleSliderChange.bind({basemap:t.basemaps,view:t.view},{passive:!0}))},t._blendCreated=function(e){var r,s;null===(r=document.querySelector("#blendSwitch"))||void 0===r||r.addEventListener("calciteSwitchChange",t.handleSwitchChange.bind({basemap:t.basemaps,view:t.view},{passive:!0})),null===(s=document.querySelector("#blend"))||void 0===s||s.removeAttribute("switched")},t}return t=l,(r=[{key:"render",value:function(){var e=this;return document.querySelectorAll("#basemapDiv calcite-radio-group-item").forEach((function(t){null==t||t.addEventListener("calciteRadioGroupItemChange",(function(t){var r,s;(null===(r=t.target)||void 0===r?void 0:r.checked)&&e.viewModel.toggleContent(null===(s=t.target)||void 0===s?void 0:s.value)}),{passive:!0})})),p.tsx("div",{class:y},p.tsx("calcite-tabs",{layout:"center",position:"below","calcite-hydrated":""},p.tsx("calcite-tab-nav",{slot:"tab-nav",role:"tablist",layout:"center",position:"below","calcite-hydrated":""},p.tsx("calcite-tab-title",{active:!0,"aria-expanded":"true",dir:"ltr",hastext:"",id:"listTabTitle",role:"tab",tabindex:"0",layout:"center",position:"below","calcite-hydrated":""},"Base Maps"),p.tsx("calcite-tab-title",{"aria-expanded":"false",dir:"ltr",hastext:"",id:"detailsTabTitle",role:"tab",tabindex:"0",layout:"center",position:"below","calcite-hydrated":""},"Imagery")),p.tsx("calcite-tab",{"aria-expanded":"true",id:"listTab",role:"tabpanel","calcite-hydrated":""},p.tsx("div",{afterCreate:this._createMaps,id:"maps"})),p.tsx("calcite-tab",{"aria-expanded":"false",id:"detailsTab",role:"tabpanel","calcite-hydrated":""},p.tsx("label",{id:"blend"},p.tsx("calcite-switch",{afterCreate:this._blendCreated,id:"blendSwitch"})," Blend"),p.tsx("calcite-slider",{afterCreate:this._sliderCreated,id:"blendSlider",value:"0.5",max:"1",min:"0",step:"0.1"}),p.tsx("div",{afterCreate:this._createImages,id:"images"}))))}}])&&s(t.prototype,r),o&&s(t,o),l}(d.default);c([h.aliasOf("viewModel.view")],m.prototype,"view",void 0),c([h.aliasOf("viewModel.basemaps")],m.prototype,"basemaps",void 0),c([h.aliasOf("viewModel.images")],m.prototype,"images",void 0),c([h.property({type:f.default}),p.renderable()],m.prototype,"viewModel",void 0),m=c([h.subclass("app.widgets.BaseMaps")],m),t.default=m},81826:function(e,t,r){"use strict";function s(e,t){for(var r=0;r<t.length;r++){var s=t[r];s.enumerable=s.enumerable||!1,s.configurable=!0,"value"in s&&(s.writable=!0),Object.defineProperty(e,s.key,s)}}function i(e,t){return(i=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function a(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,s=l(e);if(t){var i=l(this).constructor;r=Reflect.construct(s,arguments,i)}else r=s.apply(this,arguments);return o(this,r)}}function o(e,t){return!t||"object"!==c(t)&&"function"!=typeof t?n(e):t}function n(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function l(e){return(l=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function c(e){return(c="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}var u=this&&this.__decorate||function(e,t,r,s){var i,a=arguments.length,o=a<3?t:null===s?s=Object.getOwnPropertyDescriptor(t,r):s;if("object"===("undefined"==typeof Reflect?"undefined":c(Reflect))&&"function"==typeof Reflect.decorate)o=Reflect.decorate(e,t,r,s);else for(var n=e.length-1;n>=0;n--)(i=e[n])&&(o=(a<3?i(o):a>3?i(t,r,o):i(t,r))||o);return a>3&&o&&Object.defineProperty(t,r,o),o},h=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});var p=h(r(82677)),d=h(r(78745)),f=r(83781),y=h(r(99899)),m=r(80621),b=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&i(e,t)}(c,e);var t,r,o,l=a(c);function c(e){var t;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,c),(t=l.call(this,e)).changePropertyLines=function(e){var r,s=t.view.map.allLayers.find((function(e){return"feature"===e.type&&"Property"===e.title}));if(s.loaded){var i=null===(r=null==s?void 0:s.renderer)||void 0===r?void 0:r.clone();e.title.toLowerCase().includes("dark")||e.title.toLowerCase().includes("night")||e.title.toLowerCase().includes("dark")||e.title.toLowerCase().startsWith("20")||e.title.toLowerCase().startsWith("19")?i.symbol.outline.color=new d.default([255,255,255,.5]):i.symbol.outline.color=new d.default([0,0,0,.5]),s.renderer=i}},t.toggleContent=function(e){var t,r,s,i,a,o,n,l,c,u,h;"maps"===e?(null===(t=document.querySelector("#maps"))||void 0===t||t.classList.remove("esri-hidden"),null===(r=document.querySelector("#images"))||void 0===r||r.classList.add("esri-hidden"),null===(s=document.querySelector("#mapsItem"))||void 0===s||s.setAttribute("checked",""),null===(i=document.querySelector("#imagesItem"))||void 0===i||i.removeAttribute("checked"),null===(a=document.querySelector("#blend"))||void 0===a||a.classList.add("esri-hidden"),null===(o=document.querySelector("#blendSlider"))||void 0===o||o.classList.add("esri-hidden")):(null===(n=document.querySelector("#images"))||void 0===n||n.classList.remove("esri-hidden"),null===(l=document.querySelector("#maps"))||void 0===l||l.classList.add("esri-hidden"),null===(c=document.querySelector("#imagesItem"))||void 0===c||c.setAttribute("checked",""),null===(u=document.querySelector("#mapsItem"))||void 0===u||u.removeAttribute("checked"),null===(h=document.querySelector("#blend"))||void 0===h||h.classList.remove("esri-hidden"))},m.whenDefinedOnce(n(t),"view",t.init.bind(n(t))),t}return t=c,(r=[{key:"init",value:function(e){var t=this;this.basemaps=new y.default({view:this.view}),this.view.when((function(){t.changePropertyLines(t.view.map.basemap)})),this.view.map.watch("basemap",(function(e){var r,s,i;t.changePropertyLines(e),(null===(r=document.querySelector("#images"))||void 0===r?void 0:r.classList.contains("esri-hidden"))&&(t.activeBasemap.baseLayers.forEach((function(e){t.view.map.remove(t.view.map.findLayerById(e.id))})),t.activeBasemap=t.view.map.basemap,null===(s=document.querySelector("#blendSwitch"))||void 0===s||s.removeAttribute("switched")),t.images.viewModel.items.find((function(e){return e.basemap.title===t.view.map.basemap.title}))&&(null===(i=document.querySelector("#blendSwitch"))||void 0===i?void 0:i.hasAttribute("switched"))?t.view.map.addMany(t.activeBasemap.baseLayers.toArray()):t.activeBasemap.baseLayers.forEach((function(e){t.view.map.remove(t.view.map.findLayerById(e.id))}))})),this.activeBasemap=this.view.map.basemap,this.images=new y.default({view:this.view,source:{query:{id:"492386759d264d49948bf7f83957ddb9"}}}),window.addEventListener("pagehide",(function(){t.activeBasemap.baseLayers.forEach((function(e){t.view.map.remove(t.view.map.findLayerById(e.id))}));var r=e.map.toJSON();r.initialState.viewpoint.targetGeometry=e.extent,window.localStorage.setItem("imaps",JSON.stringify(r))}),{passive:!0})}}])&&s(t.prototype,r),o&&s(t,o),c}(p.default);u([f.property()],b.prototype,"view",void 0),b=u([f.subclass("app.widgets.BaseMaps.BaseMapsViewModel")],b),t.default=b},96648:(e,t,r)=>{"use strict";r.d(t,{Z:()=>n});var s=r(94015),i=r.n(s),a=r(23645),o=r.n(a)()(i());o.push([e.id,".basemaps-base{padding:0}#basemapDiv{height:100%}.basemaps-base calcite-tab{height:100%;position:absolute;top:54px;left:0;right:0;height:calc(100% - 99px)}.basemaps-base calcite-tabs{height:100%}.esri-basemap-gallery{height:100%}","",{version:3,sources:["webpack://./src/widgets/BaseMaps/styles/BaseMaps.scss"],names:[],mappings:"AAAA,eACE,SAAA,CAEF,YACE,WAAA,CAIF,2BACE,WAAA,CACA,iBAAA,CACA,QAAA,CACA,MAAA,CACA,OAAA,CACA,wBAAA,CAIF,4BACE,WAAA,CAGF,sBACE,WAAA",sourcesContent:[".basemaps-base {\n  padding: 0;\n}\n#basemapDiv {\n  height: 100%;\n}\n\n\n.basemaps-base calcite-tab {\n  height: 100%;\n  position: absolute;\n  top: 54px;\n  left: 0;\n  right: 0;\n  height: calc(100% - 99px);\n}\n\n\n.basemaps-base calcite-tabs {\n  height: 100%\n}\n\n.esri-basemap-gallery {\n  height: 100%;\n}"],sourceRoot:""}]);const n=o},40548:(e,t,r)=>{"use strict";r.r(t),r.d(t,{default:()=>n});var s=r(93379),i=r.n(s),a=r(96648),o={insert:"head",singleton:!1};i()(a.Z,o);const n=a.Z.locals||{}}}]);
//# sourceMappingURL=6114.js.map