(self.webpackChunkimaps=self.webpackChunkimaps||[]).push([[6205],{55534:(t,e,n)=>{"use strict";n(95830);var i=n(36544),r=n(33655),s=n(77625),o=n(17387),a=n(17154),c=n(67128),u=n(91531),l=n(12811),f=n(8344),d=n(69987),h=n(35280),g=n(95224),m=n(31641);const b=i.Z.getLogger("esri.views.3d.support.geometryUtils.boundedPlane");function p(t=L){return{plane:(0,g.c)(t.plane),origin:(0,s.b)(t.origin),basis1:(0,s.b)(t.basis1),basis2:(0,s.b)(t.basis2)}}function v(t,e=p()){return _(t.origin,t.basis1,t.basis2,e)}function _(t,e,n,i=p()){return(0,o.g)(i.origin,t),(0,o.g)(i.basis1,e),(0,o.g)(i.basis2,n),M(i),function(t,e){Math.abs((0,o.d)(t.basis1,t.basis2)/((0,o.l)(t.basis1)*(0,o.l)(t.basis2)))>1e-6&&b.warn(e,"Provided basis vectors are not perpendicular"),Math.abs((0,o.d)(t.basis1,V(t)))>1e-6&&b.warn(e,"Basis vectors and plane normal are not perpendicular"),Math.abs(-(0,o.d)(V(t),t.origin)-t.plane[3])>1e-6&&b.warn(e,"Plane offset is not consistent with plane origin")}(i,"fromValues()"),i}function M(t){(0,g.f)(t.basis2,t.basis1,t.origin,t.plane)}function y(t,e,n){t!==n&&v(t,n);const i=(0,o.a)(f.WM.get(),V(t),e);return(0,o.b)(n.origin,n.origin,i),n.plane[3]-=e,n}function x(t,e=p()){const n=(t[2]-t[0])/2,i=(t[3]-t[1])/2;return(0,o.s)(e.origin,t[0]+n,t[1]+i,0),(0,o.s)(e.basis1,n,0,0),(0,o.s)(e.basis2,0,i,0),(0,g.a)(0,0,1,0,e.plane),e}function S(t,e,n){return!!(0,g.i)(t.plane,e,n)&&B(t,n)}function P(t,e,n){const i=F.get();C(t,e,i,F.get());let s=Number.POSITIVE_INFINITY;for(const c of E){const u=z(t,c,W.get()),l=f.WM.get();if((0,g.b)(i,u,l)){const t=(0,a.tB)(f.WM.get(),e.origin,l),i=Math.abs((0,r.ZF)((0,o.d)(e.direction,t)));i<s&&(s=i,(0,o.g)(n,l))}}return s===Number.POSITIVE_INFINITY?A(t,e,n):n}function A(t,e,n){if(S(t,e,n))return n;const i=F.get(),r=F.get();C(t,e,i,r);let s=Number.POSITIVE_INFINITY;for(const a of E){const c=z(t,a,W.get()),u=f.WM.get();if((0,g.d)(i,c,u)){const t=(0,m.d)(e,u);if(!(0,g.e)(r,u))continue;t<s&&(s=t,(0,o.g)(n,u))}}return w(t,e.origin)<s&&O(t,e.origin,n),n}function O(t,e,n){const i=(0,g.p)(t.plane,e,f.WM.get()),r=(0,h.p)(R(t,t.basis1),i,-1,1,f.WM.get()),s=(0,h.p)(R(t,t.basis2),i,-1,1,f.WM.get());return(0,o.f)(n,(0,o.b)(f.WM.get(),r,s),t.origin),n}function I(t,e,n){const{origin:i,basis1:r,basis2:s}=t,a=(0,o.f)(f.WM.get(),e,i),c=(0,d.p)(r,a),u=(0,d.p)(s,a),l=(0,d.p)(V(t),a);return(0,o.s)(n,c,u,l)}function w(t,e){const n=I(t,e,f.WM.get()),{basis1:i,basis2:r}=t,s=(0,o.l)(i),a=(0,o.l)(r),c=Math.max(Math.abs(n[0])-s,0),u=Math.max(Math.abs(n[1])-a,0),l=n[2];return c*c+u*u+l*l}function T(t,e){const n=-t.plane[3];return(0,d.p)(V(t),e)-n}function V(t){return(0,g.n)(t.plane)}function B(t,e){const n=(0,o.f)(f.WM.get(),e,t.origin),i=(0,o.o)(t.basis1),r=(0,o.o)(t.basis2),s=(0,o.d)(t.basis1,n),a=(0,o.d)(t.basis2,n);return-s-i<0&&s-i<0&&-a-r<0&&a-r<0}function R(t,e){const n=W.get();return(0,o.g)(n.origin,t.origin),(0,o.g)(n.vector,e),n}function z(t,e,n){const{basis1:i,basis2:r,origin:s}=t,a=(0,o.a)(f.WM.get(),i,e.origin[0]),c=(0,o.a)(f.WM.get(),r,e.origin[1]);(0,o.b)(n.origin,a,c),(0,o.b)(n.origin,n.origin,s);const u=(0,o.a)(f.WM.get(),i,e.direction[0]),l=(0,o.a)(f.WM.get(),r,e.direction[1]);return(0,o.a)(n.vector,(0,o.b)(u,u,l),2),n}function C(t,e,n,i){const r=V(t);(0,g.f)(r,e.direction,e.origin,n),(0,g.f)((0,g.n)(n),r,e.origin,i)}const L={plane:(0,g.c)(),origin:(0,s.f)(0,0,0),basis1:(0,s.f)(1,0,0),basis2:(0,s.f)(0,1,0)},F=new u.x(g.c),W=new u.x(h.c),N=(0,s.c)(),U=new u.x((()=>({origin:null,basis1:null,basis2:null,plane:null}))),E=[{origin:[-1,-1],direction:[1,0]},{origin:[1,-1],direction:[0,1]},{origin:[1,1],direction:[-1,0]},{origin:[-1,1],direction:[0,-1]}],j=(0,l.a)(),D=(0,l.a)();Object.freeze({__proto__:null,BoundedPlaneClass:class{constructor(){this.plane=(0,g.c)(),this.origin=(0,s.c)(),this.basis1=(0,s.c)(),this.basis2=(0,s.c)()}},create:p,wrap:function(t,e,n){const i=U.get();return i.origin=t,i.basis1=e,i.basis2=n,i.plane=(0,g.w)(0,0,0,0),M(i),i},copy:v,fromValues:_,updateUnboundedPlane:M,elevate:y,setExtent:function(t,e,n){return x(e,n),y(n,T(t,t.origin),n),n},fromAABoundingRect:x,intersectRay:S,intersectRayClosestSilhouette:function(t,e,n){if(S(t,e,n))return n;const i=P(t,e,f.WM.get());return(0,o.b)(n,e.origin,(0,o.a)(f.WM.get(),e.direction,(0,o.k)(e.origin,i)/(0,o.l)(e.direction))),n},closestPointOnSilhouette:P,closestPoint:A,projectPoint:O,projectPointLocal:I,distance2:w,distance:function(t,e){return Math.sqrt(w(t,e))},distanceToSilhouette:function(t,e){let n=Number.NEGATIVE_INFINITY;for(const i of E){const r=z(t,i,W.get()),s=(0,h.d)(r,e);s>n&&(n=s)}return Math.sqrt(n)},extrusionContainsPoint:function(t,e){return(0,g.e)(t.plane,e)&&B(t,e)},axisAt:function(t,e,n,i){return function(t,e,n){switch(e){case 0:(0,o.g)(n,t.basis1),(0,o.n)(n,n);break;case 1:(0,o.g)(n,t.basis2),(0,o.n)(n,n);break;case 2:(0,o.g)(n,V(t))}return n}(t,n,i)},altitudeAt:T,setAltitudeAt:function(t,e,n,i){const r=T(t,e),s=(0,o.a)(N,V(t),n-r);return(0,o.b)(i,e,s),i},equals:function(t,e){return(0,o.m)(t.basis1,e.basis1)&&(0,o.m)(t.basis2,e.basis2)&&(0,o.m)(t.origin,e.origin)},transform:function(t,e,n){return t!==n&&v(t,n),(0,c.a)(j,e),(0,c.b)(j,j),(0,o.i)(n.basis1,t.basis1,j),(0,o.i)(n.basis2,t.basis2,j),(0,o.i)((0,g.n)(n.plane),(0,g.n)(t.plane),j),(0,o.i)(n.origin,t.origin,e),(0,g.s)(n.plane,n.origin,n.plane),n},rotate:function(t,e,n,i){return t!==i&&v(t,i),(0,c.r)(D,(0,c.i)(D),e,n),(0,o.i)(i.basis1,t.basis1,D),(0,o.i)(i.basis2,t.basis2,D),M(i),i},normal:V,UP:L})},46304:(t,e,n)=>{"use strict";n.d(e,{a:()=>l,b:()=>a,c:()=>m,d:()=>d,f:()=>u,g:()=>f});var i=n(17387),r=n(91531),s=n(8344),o=n(31641);function a(t){return t?{ray:(0,o.c)(t.ray),c0:t.c0,c1:t.c1}:{ray:(0,o.c)(),c0:0,c1:Number.MAX_VALUE}}function c(t,e,n,i=a()){return(0,o.b)(t,i.ray),i.c0=e,i.c1=n,i}function u(t,e=a()){return(0,o.b)(t,e.ray),e.c0=0,e.c1=Number.MAX_VALUE,e}function l(t,e,n=a()){const r=(0,i.l)(t.vector);return(0,o.e)(t.origin,e,n.ray),n.c0=0,n.c1=r,n}function f(t,e){return h(t,t.c0,e)}function d(t,e){return h(t,t.c1,e)}function h(t,e,n){return(0,i.b)(n,t.ray.origin,(0,i.a)(n,t.ray.direction,e))}const g=new r.x((()=>({c0:0,c1:0,ray:null})));var m=Object.freeze({__proto__:null,create:a,wrap:function(t,e,n){const i=g.get();return i.ray=t,i.c0=e,i.c1=n,i},copy:function(t,e=a()){return c(t.ray,t.c0,t.c1,e)},fromValues:c,fromRay:u,fromLineSegment:function(t,e=a()){return l(t,(0,i.n)(s.WM.get(),t.vector),e)},fromLineSegmentAndDirection:l,getStart:f,getEnd:d,getAt:h})},35280:(t,e,n)=>{"use strict";n.d(e,{c:()=>c,d:()=>f,f:()=>l,l:()=>b,p:()=>d});var i=n(33655),r=n(77625),s=n(17387),o=n(91531),a=n(8344);function c(t){return t?{origin:(0,r.b)(t.origin),vector:(0,r.b)(t.vector)}:{origin:(0,r.c)(),vector:(0,r.c)()}}function u(t,e){const n=m.get();return n.origin=t,n.vector=e,n}function l(t,e,n=c()){return(0,s.g)(n.origin,t),(0,s.g)(n.vector,e),n}function f(t,e){const n=(0,s.f)(a.WM.get(),e,t.origin),r=(0,s.d)(t.vector,n),o=(0,s.d)(t.vector,t.vector),c=(0,i.uZ)(r/o,0,1),u=(0,s.f)(a.WM.get(),(0,s.a)(a.WM.get(),t.vector,c),n);return(0,s.d)(u,u)}function d(t,e,n,r,o){const{vector:c,origin:u}=t,l=(0,s.f)(a.WM.get(),e,u),f=(0,s.l)(c),d=(0,s.d)(c,l)/f;return(0,s.a)(o,c,(0,i.uZ)(d,n,r)),(0,s.b)(o,o,t.origin)}function h(t,e,n,r){const o=1e-6,c=t.origin,u=(0,s.b)(a.WM.get(),c,t.vector),l=e.origin,f=(0,s.b)(a.WM.get(),l,e.vector),d=a.WM.get(),h=a.WM.get();if(d[0]=c[0]-l[0],d[1]=c[1]-l[1],d[2]=c[2]-l[2],h[0]=f[0]-l[0],h[1]=f[1]-l[1],h[2]=f[2]-l[2],Math.abs(h[0])<o&&Math.abs(h[1])<o&&Math.abs(h[2])<o)return!1;const g=a.WM.get();if(g[0]=u[0]-c[0],g[1]=u[1]-c[1],g[2]=u[2]-c[2],Math.abs(g[0])<o&&Math.abs(g[1])<o&&Math.abs(g[2])<o)return!1;const m=d[0]*h[0]+d[1]*h[1]+d[2]*h[2],b=h[0]*g[0]+h[1]*g[1]+h[2]*g[2],p=d[0]*g[0]+d[1]*g[1]+d[2]*g[2],v=h[0]*h[0]+h[1]*h[1]+h[2]*h[2],_=(g[0]*g[0]+g[1]*g[1]+g[2]*g[2])*v-b*b;if(Math.abs(_)<o)return!1;let M=(m*b-p*v)/_,y=(m+b*M)/v;n&&(M=(0,i.uZ)(M,0,1),y=(0,i.uZ)(y,0,1));const x=a.WM.get(),S=a.WM.get();return x[0]=c[0]+M*g[0],x[1]=c[1]+M*g[1],x[2]=c[2]+M*g[2],S[0]=l[0]+y*h[0],S[1]=l[1]+y*h[1],S[2]=l[2]+y*h[2],r.tA=M,r.tB=y,r.pA=x,r.pB=S,r.distance2=(0,s.h)(x,S),!0}const g={tA:0,tB:0,pA:(0,r.c)(),pB:(0,r.c)(),distance2:0},m=new o.x((()=>({origin:null,vector:null})));var b=Object.freeze({__proto__:null,create:c,wrap:u,copy:function(t,e=c()){return l(t.origin,t.vector,e)},fromValues:l,fromPoints:function(t,e,n=c()){return(0,s.g)(n.origin,t),(0,s.f)(n.vector,e,t),n},distance2:f,distance:function(t,e){return Math.sqrt(f(t,e))},projectPoint:function(t,e,n){return d(t,e,0,1,n)},pointAt:function(t,e,n){return(0,s.b)(n,t.origin,(0,s.a)(n,t.vector,e))},projectPointClamp:d,closestRayDistance2:function(t,e){if(h(t,u(e.origin,e.direction),!1,g)){const{tA:e,pB:n,distance2:i}=g;if(e>=0&&e<=1)return i;if(e<0)return(0,s.h)(t.origin,n);if(e>1)return(0,s.h)((0,s.b)(a.WM.get(),t.origin,t.vector),n)}return null},closestLineSegmentPoint:function(t,e,n){return!!h(t,e,!0,g)&&((0,s.g)(n,g.pA),!0)},closestLineSegmentDistance2:function(t,e){return h(t,e,!0,g)?g.distance2:null}})},98501:(t,e,n)=>{"use strict";n.d(e,{a:()=>c,b:()=>d,c:()=>l,f:()=>r,i:()=>o,j:()=>f,m:()=>a,n:()=>h,r:()=>u,s:()=>s});var i=n(60418);function r(t,e){return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[4],t[4]=e[5],t[5]=e[6],t[6]=e[8],t[7]=e[9],t[8]=e[10],t}function s(t,e,n,i,r,s,o,a,c,u){return t[0]=e,t[1]=n,t[2]=i,t[3]=r,t[4]=s,t[5]=o,t[6]=a,t[7]=c,t[8]=u,t}function o(t){return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=1,t[5]=0,t[6]=0,t[7]=0,t[8]=1,t}function a(t,e,n){const i=e[0],r=e[1],s=e[2],o=e[3],a=e[4],c=e[5],u=e[6],l=e[7],f=e[8],d=n[0],h=n[1],g=n[2],m=n[3],b=n[4],p=n[5],v=n[6],_=n[7],M=n[8];return t[0]=d*i+h*o+g*u,t[1]=d*r+h*a+g*l,t[2]=d*s+h*c+g*f,t[3]=m*i+b*o+p*u,t[4]=m*r+b*a+p*l,t[5]=m*s+b*c+p*f,t[6]=v*i+_*o+M*u,t[7]=v*r+_*a+M*l,t[8]=v*s+_*c+M*f,t}function c(t,e,n){const i=e[0],r=e[1],s=e[2],o=e[3],a=e[4],c=e[5],u=e[6],l=e[7],f=e[8],d=n[0],h=n[1];return t[0]=i,t[1]=r,t[2]=s,t[3]=o,t[4]=a,t[5]=c,t[6]=d*i+h*o+u,t[7]=d*r+h*a+l,t[8]=d*s+h*c+f,t}function u(t,e,n){const i=e[0],r=e[1],s=e[2],o=e[3],a=e[4],c=e[5],u=e[6],l=e[7],f=e[8],d=Math.sin(n),h=Math.cos(n);return t[0]=h*i+d*o,t[1]=h*r+d*a,t[2]=h*s+d*c,t[3]=h*o-d*i,t[4]=h*a-d*r,t[5]=h*c-d*s,t[6]=u,t[7]=l,t[8]=f,t}function l(t,e,n){const i=n[0],r=n[1],s=n[2];return t[0]=i*e[0],t[1]=i*e[1],t[2]=i*e[2],t[3]=r*e[3],t[4]=r*e[4],t[5]=r*e[5],t[6]=s*e[6],t[7]=s*e[7],t[8]=s*e[8],t}function f(t,e,n){const i=n[0],r=n[1];return t[0]=i*e[0],t[1]=i*e[1],t[2]=i*e[2],t[3]=r*e[3],t[4]=r*e[4],t[5]=r*e[5],t}function d(t,e){const n=e[0],i=e[1],r=e[2],s=e[4],o=e[5],a=e[6],c=e[8],u=e[9],l=e[10],f=l*o-a*u,d=-l*s+a*c,h=u*s-o*c,g=n*f+i*d+r*h;if(!g)return null;const m=1/g;return t[0]=f*m,t[1]=(-l*i+r*u)*m,t[2]=(a*i-r*o)*m,t[3]=d*m,t[4]=(l*n-r*c)*m,t[5]=(-a*n+r*s)*m,t[6]=h*m,t[7]=(-u*n+i*c)*m,t[8]=(o*n-i*s)*m,t}function h(t,e){const n=e[0],i=e[1],r=e[2],s=e[3],o=e[4],a=e[5],c=e[6],u=e[7],l=e[8],f=e[9],d=e[10],h=e[11],g=e[12],m=e[13],b=e[14],p=e[15],v=n*a-i*o,_=n*c-r*o,M=n*u-s*o,y=i*c-r*a,x=i*u-s*a,S=r*u-s*c,P=l*m-f*g,A=l*b-d*g,O=l*p-h*g,I=f*b-d*m,w=f*p-h*m,T=d*p-h*b;let V=v*T-_*w+M*I+y*O-x*A+S*P;return V?(V=1/V,t[0]=(a*T-c*w+u*I)*V,t[1]=(c*O-o*T-u*A)*V,t[2]=(o*w-a*O+u*P)*V,t[3]=(r*w-i*T-s*I)*V,t[4]=(n*T-r*O+s*A)*V,t[5]=(i*O-n*w-s*P)*V,t[6]=(m*S-b*x+p*y)*V,t[7]=(b*M-g*S-p*_)*V,t[8]=(g*x-m*M+p*v)*V,t):null}function g(t,e,n){return t[0]=e[0]-n[0],t[1]=e[1]-n[1],t[2]=e[2]-n[2],t[3]=e[3]-n[3],t[4]=e[4]-n[4],t[5]=e[5]-n[5],t[6]=e[6]-n[6],t[7]=e[7]-n[7],t[8]=e[8]-n[8],t}let m=a,b=g;Object.freeze({__proto__:null,fromMat4:r,copy:function(t,e){return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[4]=e[4],t[5]=e[5],t[6]=e[6],t[7]=e[7],t[8]=e[8],t},set:s,identity:o,transpose:function(t,e){if(t===e){const n=e[1],i=e[2],r=e[5];t[1]=e[3],t[2]=e[6],t[3]=n,t[5]=e[7],t[6]=i,t[7]=r}else t[0]=e[0],t[1]=e[3],t[2]=e[6],t[3]=e[1],t[4]=e[4],t[5]=e[7],t[6]=e[2],t[7]=e[5],t[8]=e[8];return t},invert:function(t,e){const n=e[0],i=e[1],r=e[2],s=e[3],o=e[4],a=e[5],c=e[6],u=e[7],l=e[8],f=l*o-a*u,d=-l*s+a*c,h=u*s-o*c;let g=n*f+i*d+r*h;return g?(g=1/g,t[0]=f*g,t[1]=(-l*i+r*u)*g,t[2]=(a*i-r*o)*g,t[3]=d*g,t[4]=(l*n-r*c)*g,t[5]=(-a*n+r*s)*g,t[6]=h*g,t[7]=(-u*n+i*c)*g,t[8]=(o*n-i*s)*g,t):null},adjoint:function(t,e){const n=e[0],i=e[1],r=e[2],s=e[3],o=e[4],a=e[5],c=e[6],u=e[7],l=e[8];return t[0]=o*l-a*u,t[1]=r*u-i*l,t[2]=i*a-r*o,t[3]=a*c-s*l,t[4]=n*l-r*c,t[5]=r*s-n*a,t[6]=s*u-o*c,t[7]=i*c-n*u,t[8]=n*o-i*s,t},determinant:function(t){const e=t[0],n=t[1],i=t[2],r=t[3],s=t[4],o=t[5],a=t[6],c=t[7],u=t[8];return e*(u*s-o*c)+n*(-u*r+o*a)+i*(c*r-s*a)},multiply:a,translate:c,rotate:u,scale:l,scaleByVec2:f,fromTranslation:function(t,e){return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=1,t[5]=0,t[6]=e[0],t[7]=e[1],t[8]=1,t},fromRotation:function(t,e){const n=Math.sin(e),i=Math.cos(e);return t[0]=i,t[1]=n,t[2]=0,t[3]=-n,t[4]=i,t[5]=0,t[6]=0,t[7]=0,t[8]=1,t},fromScaling:function(t,e){return t[0]=e[0],t[1]=0,t[2]=0,t[3]=0,t[4]=e[1],t[5]=0,t[6]=0,t[7]=0,t[8]=1,t},fromMat2d:function(t,e){return t[0]=e[0],t[1]=e[1],t[2]=0,t[3]=e[2],t[4]=e[3],t[5]=0,t[6]=e[4],t[7]=e[5],t[8]=1,t},fromQuat:function(t,e){const n=e[0],i=e[1],r=e[2],s=e[3],o=n+n,a=i+i,c=r+r,u=n*o,l=i*o,f=i*a,d=r*o,h=r*a,g=r*c,m=s*o,b=s*a,p=s*c;return t[0]=1-f-g,t[3]=l-p,t[6]=d+b,t[1]=l+p,t[4]=1-u-g,t[7]=h-m,t[2]=d-b,t[5]=h+m,t[8]=1-u-f,t},normalFromMat4Legacy:d,normalFromMat4:h,projection:function(t,e,n){return t[0]=2/e,t[1]=0,t[2]=0,t[3]=0,t[4]=-2/n,t[5]=0,t[6]=-1,t[7]=1,t[8]=1,t},str:function(t){return"mat3("+t[0]+", "+t[1]+", "+t[2]+", "+t[3]+", "+t[4]+", "+t[5]+", "+t[6]+", "+t[7]+", "+t[8]+")"},frob:function(t){return Math.sqrt(Math.pow(t[0],2)+Math.pow(t[1],2)+Math.pow(t[2],2)+Math.pow(t[3],2)+Math.pow(t[4],2)+Math.pow(t[5],2)+Math.pow(t[6],2)+Math.pow(t[7],2)+Math.pow(t[8],2))},add:function(t,e,n){return t[0]=e[0]+n[0],t[1]=e[1]+n[1],t[2]=e[2]+n[2],t[3]=e[3]+n[3],t[4]=e[4]+n[4],t[5]=e[5]+n[5],t[6]=e[6]+n[6],t[7]=e[7]+n[7],t[8]=e[8]+n[8],t},subtract:g,multiplyScalar:function(t,e,n){return t[0]=e[0]*n,t[1]=e[1]*n,t[2]=e[2]*n,t[3]=e[3]*n,t[4]=e[4]*n,t[5]=e[5]*n,t[6]=e[6]*n,t[7]=e[7]*n,t[8]=e[8]*n,t},multiplyScalarAndAdd:function(t,e,n,i){return t[0]=e[0]+n[0]*i,t[1]=e[1]+n[1]*i,t[2]=e[2]+n[2]*i,t[3]=e[3]+n[3]*i,t[4]=e[4]+n[4]*i,t[5]=e[5]+n[5]*i,t[6]=e[6]+n[6]*i,t[7]=e[7]+n[7]*i,t[8]=e[8]+n[8]*i,t},exactEquals:function(t,e){return t[0]===e[0]&&t[1]===e[1]&&t[2]===e[2]&&t[3]===e[3]&&t[4]===e[4]&&t[5]===e[5]&&t[6]===e[6]&&t[7]===e[7]&&t[8]===e[8]},equals:function(t,e){const n=t[0],r=t[1],s=t[2],o=t[3],a=t[4],c=t[5],u=t[6],l=t[7],f=t[8],d=e[0],h=e[1],g=e[2],m=e[3],b=e[4],p=e[5],v=e[6],_=e[7],M=e[8];return Math.abs(n-d)<=i.E*Math.max(1,Math.abs(n),Math.abs(d))&&Math.abs(r-h)<=i.E*Math.max(1,Math.abs(r),Math.abs(h))&&Math.abs(s-g)<=i.E*Math.max(1,Math.abs(s),Math.abs(g))&&Math.abs(o-m)<=i.E*Math.max(1,Math.abs(o),Math.abs(m))&&Math.abs(a-b)<=i.E*Math.max(1,Math.abs(a),Math.abs(b))&&Math.abs(c-p)<=i.E*Math.max(1,Math.abs(c),Math.abs(p))&&Math.abs(u-v)<=i.E*Math.max(1,Math.abs(u),Math.abs(v))&&Math.abs(l-_)<=i.E*Math.max(1,Math.abs(l),Math.abs(_))&&Math.abs(f-M)<=i.E*Math.max(1,Math.abs(f),Math.abs(M))},mul:m,sub:b})},30663:(t,e,n)=>{"use strict";function i(){return[1,0,0,0,1,0,0,0,1]}function r(t,e){return new Float64Array(t,e,9)}n.d(e,{a:()=>i,c:()=>r});Object.freeze({__proto__:null,create:i,clone:function(t){return[t[0],t[1],t[2],t[3],t[4],t[5],t[6],t[7],t[8]]},fromValues:function(t,e,n,i,r,s,o,a,c){return[t,e,n,i,r,s,o,a,c]},createView:r})},6897:(t,e,n)=>{"use strict";function i(){const t=new Float32Array(16);return t[0]=1,t[5]=1,t[10]=1,t[15]=1,t}n.d(e,{c:()=>i});const r=i();Object.freeze({__proto__:null,create:i,clone:function(t){const e=new Float32Array(16);return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e[4]=t[4],e[5]=t[5],e[6]=t[6],e[7]=t[7],e[8]=t[8],e[9]=t[9],e[10]=t[10],e[11]=t[11],e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15],e},fromValues:function(t,e,n,i,r,s,o,a,c,u,l,f,d,h,g,m){const b=new Float32Array(16);return b[0]=t,b[1]=e,b[2]=n,b[3]=i,b[4]=r,b[5]=s,b[6]=o,b[7]=a,b[8]=c,b[9]=u,b[10]=l,b[11]=f,b[12]=d,b[13]=h,b[14]=g,b[15]=m,b},createView:function(t,e){return new Float32Array(t,e,16)},IDENTITY:r})},12811:(t,e,n)=>{"use strict";function i(){return[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1]}function r(t){return[t[0],t[1],t[2],t[3],t[4],t[5],t[6],t[7],t[8],t[9],t[10],t[11],t[12],t[13],t[14],t[15]]}function s(t,e){return new Float64Array(t,e,16)}n.d(e,{I:()=>o,a:()=>i,b:()=>r,c:()=>s});const o=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1];Object.freeze({__proto__:null,create:i,clone:r,fromValues:function(t,e,n,i,r,s,o,a,c,u,l,f,d,h,g,m){return[t,e,n,i,r,s,o,a,c,u,l,f,d,h,g,m]},createView:s,IDENTITY:o})},95224:(t,e,n)=>{"use strict";n.d(e,{a:()=>f,b:()=>P,c:()=>c,d:()=>A,e:()=>I,f:()=>x,g:()=>W,h:()=>l,i:()=>S,j:()=>h,k:()=>O,l:()=>V,m:()=>z,n:()=>L,o:()=>w,p:()=>B,q:()=>T,s:()=>y,w:()=>u});var i=n(59472),r=n(33655),s=n(77625),o=n(17387),a=n(8344);function c(t=F){return[t[0],t[1],t[2],t[3]]}function u(t,e,n,i){return f(t,e,n,i,a.o6.get())}function l(t,e=c()){return f(t[0],t[1],t[2],t[3],e)}function f(t,e,n,i,r=c()){return r[0]=t,r[1]=e,r[2]=n,r[3]=i,r}function d(t,e,n=c()){(0,o.g)(n,e);const i=(0,o.d)(e,e);return Math.abs(i-1)>1e-5&&i>1e-12&&(0,o.a)(n,n,1/Math.sqrt(i)),y(n,t,n),n}function h(t,e,n,i=c()){return x((0,o.f)(a.WM.get(),t,e),(0,o.f)(a.WM.get(),n,e),t,i)}function g(t,e,n,i,r){if(t.count<3)return!1;t.getVec(n,b);let s=i,a=!1;for(;s<t.count-1&&!a;)t.getVec(s,p),s++,a=!(0,o.m)(b,p);if(!a)return!1;for(s=Math.max(s,r),a=!1;s<t.count&&!a;)t.getVec(s,v),s++,(0,o.f)(_,b,p),(0,o.n)(_,_),(0,o.f)(M,p,v),(0,o.n)(M,M),a=!(0,o.m)(b,v)&&!(0,o.m)(p,v)&&Math.abs((0,o.d)(_,M))<m;return a?(h(b,p,v,e),!0):(0!==n||1!==i||2!==r)&&g(t,e,0,1,2)}const m=.99619469809,b=(0,s.c)(),p=(0,s.c)(),v=(0,s.c)(),_=(0,s.c)(),M=(0,s.c)();function y(t,e,n){return t!==n&&l(t,n),n[3]=-(0,o.d)(n,e),n}function x(t,e,n,i=c()){return d(n,(0,o.c)(a.WM.get(),e,t),i)}function S(t,e,n){return!!(0,i.pC)(e)&&C(t,e.origin,e.direction,!0,!1,n)}function P(t,e,n){return C(t,e.origin,e.vector,!1,!1,n)}function A(t,e,n){return C(t,e.origin,e.vector,!1,!0,n)}function O(t,e){const{center:n,radius:i}=e;return z(t,n)-i>=0}function I(t,e){return z(t,e)>=0}function w(t,e){const n=e[0],i=e[1],r=e[2],s=e[3],o=e[4],a=e[5];return t[0]*(t[0]>0?n:s)+t[1]*(t[1]>0?i:o)+t[2]*(t[2]>0?r:a)+t[3]>=0}function T(t,e){const n=(0,o.d)(t,e.ray.direction),i=-z(t,e.ray.origin);if(i<0&&n>=0)return!1;if(n>-1e-6&&n<1e-6)return i>0;if((i<0||n<0)&&!(i<0&&n<0))return!0;const r=i/n;return n>0?r<e.c1&&(e.c1=r):r>e.c0&&(e.c0=r),e.c0<=e.c1}function V(t,e){const n=(0,o.d)(t,e.ray.direction),i=-z(t,e.ray.origin);if(n>-1e-6&&n<1e-6)return i>0;const r=i/n;return n>0?r<e.c1&&(e.c1=r):r>e.c0&&(e.c0=r),e.c0<=e.c1}function B(t,e,n){const i=(0,o.a)(a.WM.get(),t,-t[3]),r=R(t,(0,o.f)(a.WM.get(),e,i),a.WM.get());return(0,o.b)(n,r,i),n}function R(t,e,n){const i=(0,o.a)(a.WM.get(),t,(0,o.d)(t,e));return(0,o.f)(n,e,i),n}function z(t,e){return(0,o.d)(t,e)+t[3]}function C(t,e,n,i,s,a){const c=(0,o.d)(t,n);if(0===c)return!1;let u=-((0,o.d)(t,e)+t[3])/c;return s&&(u=i?Math.max(0,u):(0,r.uZ)(u,0,1)),!(u<0||!i&&u>1||((0,o.b)(a,e,(0,o.a)(a,n,u)),0))}function L(t){return t}const F=[0,0,1,0];var W=Object.freeze({__proto__:null,create:c,wrap:u,copy:l,fromValues:f,fromNormalAndOffset:function(t,e,n=c()){return(0,o.g)(n,t),n[3]=e,n},fromPositionAndNormal:d,fromPoints:h,fromManyPoints:function(t,e){return g(t,e,0,1,2)},fromManyPointsSampleAt:g,setOffsetFromPoint:y,negate:function(t,e){return e[0]=-t[0],e[1]=-t[1],e[2]=-t[2],e[3]=-t[3],e},fromVectorsAndPoint:x,intersectRay:S,intersectLineSegment:P,intersectLineSegmentClamp:A,isSphereFullyInside:O,isSphereFullyOutside:function(t,e){const{center:n,radius:i}=e;return z(t,n)+i<0},isPointInside:I,isPointOutside:function(t,e){return z(t,e)<0},isAABBFullyInside:w,clip:T,clipInfinite:V,projectPoint:B,projectVector:R,distance:function(t,e){return Math.abs(z(t,e))},signedDistance:z,normal:L,UP:F})},2847:(t,e,n)=>{"use strict";n.d(e,{c:()=>g,g:()=>l,i:()=>h,r:()=>V});var i=n(77625),r=n(60418),s=n(17387),o=n(30663),a=n(32232),c=n(34353);function u(t,e,n){n*=.5;const i=Math.sin(n);return t[0]=i*e[0],t[1]=i*e[1],t[2]=i*e[2],t[3]=Math.cos(n),t}function l(t,e){const n=2*Math.acos(e[3]),i=Math.sin(n/2);return i>r.E?(t[0]=e[0]/i,t[1]=e[1]/i,t[2]=e[2]/i):(t[0]=1,t[1]=0,t[2]=0),n}function f(t,e,n){const i=e[0],r=e[1],s=e[2],o=e[3],a=n[0],c=n[1],u=n[2],l=n[3];return t[0]=i*l+o*a+r*u-s*c,t[1]=r*l+o*c+s*a-i*u,t[2]=s*l+o*u+i*c-r*a,t[3]=o*l-i*a-r*c-s*u,t}function d(t,e,n,i){const s=e[0],o=e[1],a=e[2],c=e[3];let u,l,f,d,h,g=n[0],m=n[1],b=n[2],p=n[3];return l=s*g+o*m+a*b+c*p,l<0&&(l=-l,g=-g,m=-m,b=-b,p=-p),1-l>r.E?(u=Math.acos(l),f=Math.sin(u),d=Math.sin((1-i)*u)/f,h=Math.sin(i*u)/f):(d=1-i,h=i),t[0]=d*s+h*g,t[1]=d*o+h*m,t[2]=d*a+h*b,t[3]=d*c+h*p,t}function h(t,e){const n=e[0],i=e[1],r=e[2],s=e[3],o=n*n+i*i+r*r+s*s,a=o?1/o:0;return t[0]=-n*a,t[1]=-i*a,t[2]=-r*a,t[3]=s*a,t}function g(t,e){return t[0]=-e[0],t[1]=-e[1],t[2]=-e[2],t[3]=e[3],t}function m(t,e){const n=e[0]+e[4]+e[8];let i;if(n>0)i=Math.sqrt(n+1),t[3]=.5*i,i=.5/i,t[0]=(e[5]-e[7])*i,t[1]=(e[6]-e[2])*i,t[2]=(e[1]-e[3])*i;else{let n=0;e[4]>e[0]&&(n=1),e[8]>e[3*n+n]&&(n=2);const r=(n+1)%3,s=(n+2)%3;i=Math.sqrt(e[3*n+n]-e[3*r+r]-e[3*s+s]+1),t[n]=.5*i,i=.5/i,t[3]=(e[3*r+s]-e[3*s+r])*i,t[r]=(e[3*r+n]+e[3*n+r])*i,t[s]=(e[3*s+n]+e[3*n+s])*i}return t}const b=c.c,p=c.s,v=c.a,_=f,M=c.b,y=c.d,x=c.l,S=c.e,P=S,A=c.f,O=A,I=c.n,w=c.g,T=c.h;function V(t,e,n){const i=(0,s.d)(e,n);return i<-.999999?((0,s.c)(B,R,e),(0,s.j)(B)<1e-6&&(0,s.c)(B,z,e),(0,s.n)(B,B),u(t,B,Math.PI),t):i>.999999?(t[0]=0,t[1]=0,t[2]=0,t[3]=1,t):((0,s.c)(B,e,n),t[0]=B[0],t[1]=B[1],t[2]=B[2],t[3]=1+i,I(t,t))}const B=(0,i.c)(),R=(0,i.f)(1,0,0),z=(0,i.f)(0,1,0);const C=(0,a.a)(),L=(0,a.a)();const F=(0,o.a)();Object.freeze({__proto__:null,identity:function(t){return t[0]=0,t[1]=0,t[2]=0,t[3]=1,t},setAxisAngle:u,getAxisAngle:l,multiply:f,rotateX:function(t,e,n){n*=.5;const i=e[0],r=e[1],s=e[2],o=e[3],a=Math.sin(n),c=Math.cos(n);return t[0]=i*c+o*a,t[1]=r*c+s*a,t[2]=s*c-r*a,t[3]=o*c-i*a,t},rotateY:function(t,e,n){n*=.5;const i=e[0],r=e[1],s=e[2],o=e[3],a=Math.sin(n),c=Math.cos(n);return t[0]=i*c-s*a,t[1]=r*c+o*a,t[2]=s*c+i*a,t[3]=o*c-r*a,t},rotateZ:function(t,e,n){n*=.5;const i=e[0],r=e[1],s=e[2],o=e[3],a=Math.sin(n),c=Math.cos(n);return t[0]=i*c+r*a,t[1]=r*c-i*a,t[2]=s*c+o*a,t[3]=o*c-s*a,t},calculateW:function(t,e){const n=e[0],i=e[1],r=e[2];return t[0]=n,t[1]=i,t[2]=r,t[3]=Math.sqrt(Math.abs(1-n*n-i*i-r*r)),t},slerp:d,random:function(t){const e=(0,r.R)(),n=(0,r.R)(),i=(0,r.R)(),s=Math.sqrt(1-e),o=Math.sqrt(e);return t[0]=s*Math.sin(2*Math.PI*n),t[1]=s*Math.cos(2*Math.PI*n),t[2]=o*Math.sin(2*Math.PI*i),t[3]=o*Math.cos(2*Math.PI*i),t},invert:h,conjugate:g,fromMat3:m,fromEuler:function(t,e,n,i){const r=.5*Math.PI/180;e*=r,n*=r,i*=r;const s=Math.sin(e),o=Math.cos(e),a=Math.sin(n),c=Math.cos(n),u=Math.sin(i),l=Math.cos(i);return t[0]=s*c*l-o*a*u,t[1]=o*a*l+s*c*u,t[2]=o*c*u-s*a*l,t[3]=o*c*l+s*a*u,t},str:function(t){return"quat("+t[0]+", "+t[1]+", "+t[2]+", "+t[3]+")"},copy:b,set:p,add:v,mul:_,scale:M,dot:y,lerp:x,length:S,len:P,squaredLength:A,sqrLen:O,normalize:I,exactEquals:w,equals:T,rotationTo:V,sqlerp:function(t,e,n,i,r,s){return d(C,e,r,s),d(L,n,i,s),d(t,C,L,2*s*(1-s)),t},setAxes:function(t,e,n,i){const r=F;return r[0]=n[0],r[3]=n[1],r[6]=n[2],r[1]=i[0],r[4]=i[1],r[7]=i[2],r[2]=-e[0],r[5]=-e[1],r[8]=-e[2],I(t,m(t,r))}})},32232:(t,e,n)=>{"use strict";function i(){return[0,0,0,1]}function r(t,e){return new Float64Array(t,e,4)}n.d(e,{a:()=>i,c:()=>r});Object.freeze({__proto__:null,create:i,clone:function(t){return[t[0],t[1],t[2],t[3]]},fromValues:function(t,e,n,i){return[t,e,n,i]},createView:r,IDENTITY:[0,0,0,1]})},31641:(t,e,n)=>{"use strict";n.d(e,{b:()=>f,c:()=>l,d:()=>b,e:()=>d,g:()=>g,h:()=>p,r:()=>M});var i=n(59472),r=n(96071),s=n(77625),o=n(17387),a=n(91531),c=n(14286),u=n(8344);function l(t){return t?{origin:(0,s.b)(t.origin),direction:(0,s.b)(t.direction)}:{origin:(0,s.c)(),direction:(0,s.c)()}}function f(t,e=l()){return d(t.origin,t.direction,e)}function d(t,e,n=l()){return(0,o.g)(n.origin,t),(0,o.g)(n.direction,e),n}function h(t,e,n=l()){const s=(0,r.Wv)((0,c.c)(u.WM.get(),e));if(s[2]=0,!t.unprojectFromRenderScreen(s,n.origin))return null;const a=(0,r.Wv)((0,c.c)(u.WM.get(),e));a[2]=1;const f=t.unprojectFromRenderScreen(a,u.WM.get());return(0,i.Wi)(f)?null:((0,o.f)(n.direction,f,n.origin),n)}function g(t,e,n=l()){return m(t,t.screenToRender(e,(0,r.Wv)(u.WM.get())),n)}function m(t,e,n=l()){(0,o.g)(n.origin,t.eye);const r=(0,o.s)(u.WM.get(),e[0],e[1],1),s=t.unprojectFromRenderScreen(r,u.WM.get());return(0,i.Wi)(s)?null:((0,o.f)(n.direction,s,n.origin),n)}function b(t,e){const n=(0,o.c)(u.WM.get(),(0,o.n)(u.WM.get(),t.direction),(0,o.f)(u.WM.get(),e,t.origin));return(0,o.d)(n,n)}function p(t,e,n){const i=(0,o.d)(t.direction,(0,o.f)(n,e,t.origin));return(0,o.b)(n,t.origin,(0,o.a)(n,t.direction,i)),n}function v(){return{origin:null,direction:null}}const _=new a.x(v);var M=Object.freeze({__proto__:null,create:l,wrap:function(t,e){const n=_.get();return n.origin=t,n.direction=e,n},copy:f,fromPoints:function(t,e,n=l()){return(0,o.g)(n.origin,t),(0,o.f)(n.direction,e,t),n},fromValues:d,fromScreen:function(t,e,n=l()){return h(t,t.screenToRender(e,(0,r.Wv)(u.WM.get())),n)},fromRender:h,fromScreenAtEye:g,fromRenderAtEye:m,distance2:b,distance:function(t,e){return Math.sqrt(b(t,e))},closestPoint:p,createWrapper:v})},13633:(t,e,n)=>{"use strict";n.d(e,{c:()=>m,s:()=>T});n(95830);var i=n(59472),r=n(36544),s=n(33655),o=n(77625),a=n(17387),c=n(17154),u=n(67128),l=n(91531),f=n(8344),d=n(69987),h=n(31641);const g=r.Z.getLogger("esri.views.3d.support.geometryUtils.sphere");function m(t){return t?{radius:t.radius,center:(0,o.b)(t.center)}:{radius:1,center:(0,o.c)()}}function b(t,e=m()){return p(t.radius,t.center,e)}function p(t,e,n=m()){return(0,a.g)(n.center,e),n.radius=t,n}function v(t,e,n){if((0,i.Wi)(e))return!1;const r=(0,a.f)(f.WM.get(),e.origin,t.center),s=(0,a.d)(e.direction,e.direction),o=2*(0,a.d)(e.direction,r),c=o*o-4*s*((0,a.d)(r,r)-t.radius*t.radius);if(c<0)return!1;const u=Math.sqrt(c);let l=(-o-u)/(2*s);const d=(-o+u)/(2*s);return(l<0||d<l&&d>0)&&(l=d),!(l<0||(n&&(0,a.b)(n,e.origin,(0,a.a)(f.WM.get(),e.direction,l)),0))}function _(t,e,n){const i=f.WM.get(),r=f.MP.get();(0,a.c)(i,e.origin,e.direction),(0,a.c)(n,i,e.origin),(0,a.a)(n,n,1/(0,a.l)(n)*t.radius);const s=y(t,e.origin),o=(0,d.a)(e.origin,n);return(0,u.i)(r),(0,u.r)(r,r,o+s,i),(0,a.i)(n,n,r),n}function M(t,e,n){const i=(0,a.f)(f.WM.get(),e,t.center),r=(0,a.a)(f.WM.get(),i,t.radius/(0,a.l)(i));return(0,a.b)(n,r,t.center)}function y(t,e){const n=(0,a.f)(f.WM.get(),e,t.center),i=(0,a.l)(n),r=t.radius+Math.abs(t.radius-i);return(0,s.ZF)(t.radius/r)}const x=(0,o.c)();function S(t,e,n,i){const r=(0,a.f)(x,e,t.center);switch(n){case 0:{const t=(0,c.jE)(r,x)[2];return(0,a.s)(i,-Math.sin(t),Math.cos(t),0)}case 1:{const t=(0,c.jE)(r,x),e=t[1],n=t[2],s=Math.sin(e);return(0,a.s)(i,-s*Math.cos(n),-s*Math.sin(n),Math.cos(e))}case 2:return(0,a.n)(i,r);default:return}}function P(t,e){const n=(0,a.f)(w,e,t.center);return(0,a.l)(n)-t.radius}const A=new l.x((()=>({center:null,radius:0}))),O=(0,h.c)(),I=(0,o.c)(),w=(0,o.c)();Object.freeze(I);var T=Object.freeze({__proto__:null,create:m,wrap:function(t,e){const n=A.get();return n.radius=t,n.center=e||I,n},copy:b,fromValues:p,elevate:function(t,e,n){return t!==n&&(0,a.g)(n.center,t.center),n.radius=t.radius+e,n},setExtent:function(t,e,n){return g.error("sphere.setExtent is not yet supported"),t===n?n:b(t,n)},intersectRay:v,intersectScreen:function(t,e,n,i){return v(t,(0,h.g)(e,n,O),i)},intersectsRay:function(t,e){return v(t,e,null)},intersectRayClosestSilhouette:function(t,e,n){if(v(t,e,n))return n;const i=_(t,e,f.WM.get());return(0,a.b)(n,e.origin,(0,a.a)(f.WM.get(),e.direction,(0,a.k)(e.origin,i)/(0,a.l)(e.direction))),n},closestPointOnSilhouette:_,closestPoint:function(t,e,n){return v(t,e,n)?n:((0,h.h)(e,t.center,n),M(t,n,n))},projectPoint:M,distanceToSilhouette:function(t,e){const n=(0,a.f)(f.WM.get(),e,t.center),i=(0,a.o)(n),r=t.radius*t.radius;return Math.sqrt(Math.abs(i-r))},angleToSilhouette:y,axisAt:S,altitudeAt:P,setAltitudeAt:function(t,e,n,i){const r=P(t,e),s=S(t,e,2,w),o=(0,a.a)(w,s,n-r);return(0,a.b)(i,e,o),i}})},56938:(t,e,n)=>{"use strict";n.d(e,{a:()=>d});var i=n(77625),r=n(17387),s=n(91531),o=n(14286),a=n(8344),c=n(35280);function u(t){return t?{p0:(0,i.b)(t.p0),p1:(0,i.b)(t.p1),p2:(0,i.b)(t.p2)}:{p0:(0,i.c)(),p1:(0,i.c)(),p2:(0,i.c)()}}function l(t,e,n,i=u()){return(0,r.g)(i.p0,t),(0,r.g)(i.p1,e),(0,r.g)(i.p2,n),i}function f(t,e,n){const i=(0,o.i)(t,e),r=(0,o.i)(e,n),s=(0,o.i)(n,t),a=(i+r+s)/2,c=a*(a-i)*(a-r)*(a-s);return c<=0?0:Math.sqrt(c)}function d(t,e,n){return(0,r.f)(m,e,t),(0,r.f)(b,n,t),(0,r.l)((0,r.c)(m,m,b))/2}const h=new s.x(c.c),g=new s.x((()=>({p0:null,p1:null,p2:null}))),m=(0,i.c)(),b=(0,i.c)();Object.freeze({__proto__:null,create:u,wrap:function(t,e,n){const i=g.get();return i.p0=t,i.p1=e,i.p2=n,i},copy:function(t,e=u()){return l(t.p0,t.p1,t.p2,e)},fromValues:l,distance2:function(t,e){const n=t.p0,i=t.p1,s=t.p2,o=(0,r.f)(a.WM.get(),i,n),u=(0,r.f)(a.WM.get(),s,i),l=(0,r.f)(a.WM.get(),n,s),f=(0,r.f)(a.WM.get(),e,n),d=(0,r.f)(a.WM.get(),e,i),g=(0,r.f)(a.WM.get(),e,s),m=(0,r.c)(o,o,l),b=(0,r.d)((0,r.c)(a.WM.get(),o,m),f),p=(0,r.d)((0,r.c)(a.WM.get(),u,m),d),v=(0,r.d)((0,r.c)(a.WM.get(),l,m),g);if(b>0&&p>0&&v>0){const t=(0,r.d)(m,f);return t*t/(0,r.d)(m,m)}const _=(0,c.d)((0,c.f)(n,o,h.get()),e),M=(0,c.d)((0,c.f)(i,u,h.get()),e),y=(0,c.d)((0,c.f)(s,l,h.get()),e);return Math.min(_,M,y)},intersectRay:function(t,e,n){const i=1e-5,{direction:s,origin:o}=e,{p0:a,p1:c,p2:u}=t,l=c[0]-a[0],f=c[1]-a[1],d=c[2]-a[2],h=u[0]-a[0],g=u[1]-a[1],m=u[2]-a[2],b=s[1]*m-g*s[2],p=s[2]*h-m*s[0],v=s[0]*g-h*s[1],_=l*b+f*p+d*v;if(_>-i&&_<i)return!1;const M=1/_,y=o[0]-a[0],x=o[1]-a[1],S=o[2]-a[2],P=M*(y*b+x*p+S*v);if(P<0||P>1)return!1;const A=x*d-f*S,O=S*l-d*y,I=y*f-l*x,w=M*(s[0]*A+s[1]*O+s[2]*I);return!(w<0||P+w>1)&&(n&&((0,r.a)(n,s,M*(h*A+g*O+m*I)),(0,r.b)(n,o,n)),!0)},areaPoints2d:f,area2d:function(t){return f(t.p0,t.p1,t.p2)},areaPoints3d:d})},55735:(t,e,n)=>{"use strict";function i(){return[0,0]}function r(t,e){return[t,e]}function s(t){const e=[0,0],n=Math.min(2,t.length);for(let i=0;i<n;++i)e[i]=t[i];return e}function o(t,e){return new Float64Array(t,e,2)}function a(){return r(1,1)}function c(){return r(1,0)}function u(){return r(0,1)}n.d(e,{a:()=>i,c:()=>o,d:()=>s,f:()=>r});const l=a(),f=c(),d=u();Object.freeze({__proto__:null,create:i,clone:function(t){return[t[0],t[1]]},fromValues:r,fromArray:s,createView:o,zeros:function(){return[0,0]},ones:a,unitX:c,unitY:u,ZEROS:[0,0],ONES:l,UNIT_X:f,UNIT_Y:d})},69236:(t,e,n)=>{"use strict";function i(){return new Float32Array(3)}function r(t){const e=new Float32Array(3);return e[0]=t[0],e[1]=t[1],e[2]=t[2],e}function s(t,e,n){const i=new Float32Array(3);return i[0]=t,i[1]=e,i[2]=n,i}function o(){return i()}function a(){return s(1,1,1)}function c(){return s(1,0,0)}function u(){return s(0,1,0)}function l(){return s(0,0,1)}n.d(e,{a:()=>r,c:()=>i,f:()=>s});const f=o(),d=a(),h=c(),g=u(),m=l();Object.freeze({__proto__:null,create:i,clone:r,fromValues:s,createView:function(t,e){return new Float32Array(t,e,3)},zeros:o,ones:a,unitX:c,unitY:u,unitZ:l,ZEROS:f,ONES:d,UNIT_X:h,UNIT_Y:g,UNIT_Z:m})},38256:(t,e,n)=>{"use strict";function i(){return[0,0,0,0]}function r(t,e,n,i){return[t,e,n,i]}function s(t){const e=[0,0,0,0],n=Math.min(4,t.length);for(let i=0;i<n;++i)e[i]=t[i];return e}function o(t,e){return new Float64Array(t,e,4)}function a(){return r(1,1,1,1)}function c(){return r(1,0,0,0)}function u(){return r(0,1,0,0)}function l(){return r(0,0,1,0)}function f(){return r(0,0,0,1)}n.d(e,{O:()=>h,Z:()=>d,a:()=>i,b:()=>r,c:()=>o,f:()=>s});const d=[0,0,0,0],h=a(),g=c(),m=u(),b=l(),p=f();Object.freeze({__proto__:null,create:i,clone:function(t){return[t[0],t[1],t[2],t[3]]},fromValues:r,fromArray:s,createView:o,zeros:function(){return[0,0,0,0]},ones:a,unitX:c,unitY:u,unitZ:l,unitW:f,ZEROS:d,ONES:h,UNIT_X:g,UNIT_Y:m,UNIT_Z:b,UNIT_W:p})},69987:(t,e,n)=>{"use strict";n.d(e,{a:()=>a,p:()=>o,v:()=>l});var i=n(33655),r=n(77625),s=n(17387);function o(t,e){return(0,s.d)(t,e)/(0,s.l)(t)}function a(t,e){const n=(0,s.d)(t,e)/((0,s.l)(t)*(0,s.l)(e));return-(0,i.ZF)(n)}const c=(0,r.c)(),u=(0,r.c)();var l=Object.freeze({__proto__:null,projectPoint:function(t,e,n){const i=(0,s.d)(t,e)/(0,s.d)(t,t);return(0,s.a)(n,t,i)},projectPointSignedLength:o,angle:a,angleAroundAxis:function(t,e,n){(0,s.n)(c,t),(0,s.n)(u,e);const r=(0,s.d)(c,u),o=(0,i.ZF)(r),a=(0,s.c)(c,c,u);return(0,s.d)(a,n)<0?2*Math.PI-o:o}})},91531:(t,e,n)=>{"use strict";n.d(e,{x:()=>s});var i=n(59472),r=n(33469);class s{constructor(t){this.allocator=t,this.items=[],this.itemsPtr=0,this.tickHandle=r.Z.before((()=>this.reset())),this.grow()}destroy(){this.tickHandle&&(this.tickHandle.remove(),this.tickHandle=(0,i.Bd)(this.tickHandle)),this.items=(0,i.Bd)(this.items)}get(){return 0===this.itemsPtr&&(0,r.Z)((()=>{})),this.itemsPtr===this.items.length&&this.grow(),this.items[this.itemsPtr++]}reset(){const t=Math.min(3*Math.max(8,this.itemsPtr),this.itemsPtr+3*o);this.items.length=Math.min(t,this.items.length),this.itemsPtr=0}grow(){for(let t=0;t<Math.max(8,Math.min(this.items.length,o));t++)this.items.push(this.allocator())}}const o=1024},88:(t,e,n)=>{"use strict";n.d(e,{bW:()=>T,oy:()=>B,KD:()=>I,yC:()=>O,kx:()=>w,Dv:()=>V,xr:()=>R});var i=n(69987),r=n(17387),s=n(8344);function o(t=c){return[t[0],t[1],t[2],t[3]]}function a(t,e,n,i,r=o()){return r[0]=t,r[1]=e,r[2]=n,r[3]=i,r}const c=[0,0,1,0];Object.freeze({__proto__:null,create:o,wrap:function(t,e,n,i){return a(t,e,n,i,s.o6.get())},wrapAxisAngle:function(t,e){return a(t[0],t[1],t[2],e,s.o6.get())},copy:function(t,e=o()){return a(t[0],t[1],t[2],t[3],e)},fromValues:a,fromAxisAndAngle:function(t,e,n=o()){return(0,r.g)(n,t),n[3]=e,n},fromPoints:function(t,e,n=o()){return(0,r.c)(n,t,e),(0,r.n)(n,n),n[3]=(0,i.a)(t,e),n},axis:function(t){return t},UP:c});var u=n(35280),l=n(95224),f=n(31641),d=(n(55534),n(46304)),h=n(77625),g=n(67128),m=n(91531),b=n(38256),p=n(34353);function v(t){if(t){const{planes:e,points:n}=t;return{planes:[(0,l.c)(e[0]),(0,l.c)(e[1]),(0,l.c)(e[2]),(0,l.c)(e[3]),(0,l.c)(e[4]),(0,l.c)(e[5])],points:[(0,h.b)(n[0]),(0,h.b)(n[1]),(0,h.b)(n[2]),(0,h.b)(n[3]),(0,h.b)(n[4]),(0,h.b)(n[5]),(0,h.b)(n[6]),(0,h.b)(n[7])]}}return{planes:[(0,l.c)(),(0,l.c)(),(0,l.c)(),(0,l.c)(),(0,l.c)(),(0,l.c)()],points:[(0,h.c)(),(0,h.c)(),(0,h.c)(),(0,h.c)(),(0,h.c)(),(0,h.c)(),(0,h.c)(),(0,h.c)()]}}function _(t,e,n=v()){for(let e=0;e<6;e++)(0,l.h)(t[e],n.planes[e]);for(let t=0;t<8;t++)(0,r.g)(n.points[t],e[t]);return n}function M(t){const{planes:e,points:n}=t;(0,l.j)(n[4],n[0],n[3],e[0]),(0,l.j)(n[1],n[5],n[6],e[1]),(0,l.j)(n[4],n[5],n[1],e[2]),(0,l.j)(n[3],n[2],n[6],e[3]),(0,l.j)(n[0],n[1],n[2],e[4]),(0,l.j)(n[5],n[4],n[7],e[5])}function y(t,e){for(let n=0;n<6;n++)if(!(0,l.q)(t[n],e))return!1;return!0}const x=[(0,b.b)(-1,-1,-1,1),(0,b.b)(1,-1,-1,1),(0,b.b)(1,1,-1,1),(0,b.b)(-1,1,-1,1),(0,b.b)(-1,-1,1,1),(0,b.b)(1,-1,1,1),(0,b.b)(1,1,1,1),(0,b.b)(-1,1,1,1)],S=new m.x(d.b);var P=Object.freeze({__proto__:null,create:v,copy:function(t,e=v()){return _(t.planes,t.points,e)},fromValues:_,fromMatrix:function(t,e,n=v()){const{points:i}=n,o=(0,g.m)(s.MP.get(),e,t);(0,g.a)(o,o);for(let t=0;t<8;++t){const e=(0,p.t)(s.o6.get(),x[t],o);(0,r.s)(i[t],e[0]/e[3],e[1]/e[3],e[2]/e[3])}return M(n),n},recomputePlanes:M,intersectsSphere:function(t,e){for(let n=0;n<6;n++)if((0,l.k)(t[n],e))return!1;return!0},intersectsRay:function(t,e){return y(t,(0,d.f)(e,S.get()))},intersectClipRay:function(t,e){for(let n=0;n<6;n++){const i=t[n];if(!(0,l.l)(i,e))return!1}return!0},intersectsLineSegment:function(t,e,n){return y(t,(0,d.a)(e,n,S.get()))},intersectsPoint:function(t,e){for(let n=0;n<6;n++)if((0,l.m)(t[n],e)>0)return!1;return!0},intersectsAABB:function(t,e){for(let n=0;n<6;n++)if((0,l.o)(t[n],e))return!1;return!0},planePointIndices:{bottom:[5,1,0,4],near:[0,1,2,3],far:[5,4,7,6],right:[1,5,6,2],left:[4,0,3,7],top:[7,3,2,6]}}),A=n(13633);n(56938);const O=l.g,I=u.l,w=f.r,T=d.c,V=A.s,B=P,R=i.v},8344:(t,e,n)=>{"use strict";n.d(e,{MP:()=>b,qW:()=>h,WM:()=>g,o6:()=>m});var i=n(59472),r=n(33469),s=n(77625),o=n(30663),a=n(12811),c=n(32232),u=n(55735),l=n(38256);class f{constructor(t,e,n){this.itemByteSize=t,this.itemCreate=e,this.buffers=[],this.items=[],this.itemsPerBuffer=0,this.itemsPtr=0,this.itemsPerBuffer=Math.ceil(n/this.itemByteSize),this.tickHandle=r.Z.before((()=>this.reset()))}destroy(){this.tickHandle&&(this.tickHandle.remove(),this.tickHandle=(0,i.Bd)(this.tickHandle)),this.itemsPtr=0,this.items=(0,i.Bd)(this.items),this.buffers=(0,i.Bd)(this.buffers)}get(){0===this.itemsPtr&&(0,r.Z)((()=>{}));const t=Math.floor(this.itemsPtr/this.itemsPerBuffer);for(;this.buffers.length<=t;){const t=new ArrayBuffer(this.itemsPerBuffer*this.itemByteSize);for(let e=0;e<this.itemsPerBuffer;++e)this.items.push(this.itemCreate(t,e*this.itemByteSize));this.buffers.push(t)}return this.items[this.itemsPtr++]}reset(){const t=2*(Math.floor(this.itemsPtr/this.itemsPerBuffer)+1);for(;this.buffers.length>t;)this.buffers.pop(),this.items.length=this.buffers.length*this.itemsPerBuffer;this.itemsPtr=0}static createVec2f64(t=d){return new f(16,u.c,t)}static createVec3f64(t=d){return new f(24,s.a,t)}static createVec4f64(t=d){return new f(32,l.c,t)}static createMat3f64(t=d){return new f(72,o.c,t)}static createMat4f64(t=d){return new f(128,a.c,t)}static createQuatf64(t=d){return new f(32,c.c,t)}get test(){return{size:this.buffers.length*this.itemsPerBuffer*this.itemByteSize}}}const d=4096,h=f.createVec2f64(),g=f.createVec3f64(),m=f.createVec4f64(),b=(f.createMat3f64(),f.createMat4f64());f.createQuatf64()},61514:(t,e,n)=>{"use strict";n.d(e,{p:()=>c});var i,r=n(59472),s=n(77625),o=n(17387),a=n(85461);function c(t,e){if(e.slicePlaneEnabled){t.extensions.add("GL_OES_standard_derivatives"),e.sliceEnabledForVertexPrograms&&(t.vertex.uniforms.add("slicePlaneOrigin","vec3"),t.vertex.uniforms.add("slicePlaneBasis1","vec3"),t.vertex.uniforms.add("slicePlaneBasis2","vec3")),t.fragment.uniforms.add("slicePlaneOrigin","vec3"),t.fragment.uniforms.add("slicePlaneBasis1","vec3"),t.fragment.uniforms.add("slicePlaneBasis2","vec3");const n=a.H`
      struct SliceFactors {
        float front;
        float side0;
        float side1;
        float side2;
        float side3;
      };

      SliceFactors calculateSliceFactors(vec3 pos) {
        vec3 rel = pos - slicePlaneOrigin;

        vec3 slicePlaneNormal = -cross(slicePlaneBasis1, slicePlaneBasis2);
        float slicePlaneW = -dot(slicePlaneNormal, slicePlaneOrigin);

        float basis1Len2 = dot(slicePlaneBasis1, slicePlaneBasis1);
        float basis2Len2 = dot(slicePlaneBasis2, slicePlaneBasis2);

        float basis1Dot = dot(slicePlaneBasis1, rel);
        float basis2Dot = dot(slicePlaneBasis2, rel);

        return SliceFactors(
          dot(slicePlaneNormal, pos) + slicePlaneW,
          -basis1Dot - basis1Len2,
          basis1Dot - basis1Len2,
          -basis2Dot - basis2Len2,
          basis2Dot - basis2Len2
        );
      }

      bool sliceByFactors(SliceFactors factors) {
        return factors.front < 0.0
          && factors.side0 < 0.0
          && factors.side1 < 0.0
          && factors.side2 < 0.0
          && factors.side3 < 0.0;
      }

      bool sliceEnabled() {
        // a slicePlaneBasis1 vector of zero length is used to disable slicing in the shader during draped rendering.
        return dot(slicePlaneBasis1, slicePlaneBasis1) != 0.0;
      }

      bool sliceByPlane(vec3 pos) {
        return sliceEnabled() && sliceByFactors(calculateSliceFactors(pos));
      }

      #define rejectBySlice(_pos_) sliceByPlane(_pos_)
      #define discardBySlice(_pos_) { if (sliceByPlane(_pos_)) discard; }
    `,i=a.H`
      vec4 applySliceHighlight(vec4 color, vec3 pos) {
        SliceFactors factors = calculateSliceFactors(pos);

        if (sliceByFactors(factors)) {
          return color;
        }

        const float HIGHLIGHT_WIDTH = 1.0;
        const vec4 HIGHLIGHT_COLOR = vec4(0.0, 0.0, 0.0, 0.3);

        factors.front /= (2.0 * HIGHLIGHT_WIDTH) * fwidth(factors.front);
        factors.side0 /= (2.0 * HIGHLIGHT_WIDTH) * fwidth(factors.side0);
        factors.side1 /= (2.0 * HIGHLIGHT_WIDTH) * fwidth(factors.side1);
        factors.side2 /= (2.0 * HIGHLIGHT_WIDTH) * fwidth(factors.side2);
        factors.side3 /= (2.0 * HIGHLIGHT_WIDTH) * fwidth(factors.side3);

        float highlightFactor = (1.0 - step(0.5, factors.front))
          * (1.0 - step(0.5, factors.side0))
          * (1.0 - step(0.5, factors.side1))
          * (1.0 - step(0.5, factors.side2))
          * (1.0 - step(0.5, factors.side3));

        return mix(color, vec4(HIGHLIGHT_COLOR.rgb, color.a), highlightFactor * HIGHLIGHT_COLOR.a);
      }
    `,r=e.sliceHighlightDisabled?a.H`#define highlightSlice(_color_, _pos_) (_color_)`:a.H`
        ${i}
        #define highlightSlice(_color_, _pos_) (sliceEnabled() ? applySliceHighlight(_color_, _pos_) : (_color_))
      `;e.sliceEnabledForVertexPrograms&&t.vertex.code.add(n),t.fragment.code.add(n),t.fragment.code.add(r)}else{const n=a.H`
      #define rejectBySlice(_pos_) false
      #define discardBySlice(_pos_) {}
      #define highlightSlice(_color_, _pos_) (_color_)
    `;e.sliceEnabledForVertexPrograms&&t.vertex.code.add(n),t.fragment.code.add(n)}}(i=c||(c={})).bindUniformsWithOrigin=function(t,e,n){i.bindUniforms(t,e,n.slicePlane,n.origin)},i.bindUniforms=function(t,e,n,i){e.slicePlaneEnabled&&((0,r.pC)(n)?(i?((0,o.f)(u,n.origin,i),t.setUniform3fv("slicePlaneOrigin",u)):t.setUniform3fv("slicePlaneOrigin",n.origin),t.setUniform3fv("slicePlaneBasis1",n.basis1),t.setUniform3fv("slicePlaneBasis2",n.basis2)):(t.setUniform3fv("slicePlaneBasis1",s.Z),t.setUniform3fv("slicePlaneBasis2",s.Z),t.setUniform3fv("slicePlaneOrigin",s.Z)))};const u=(0,s.c)()},62213:(t,e,n)=>{"use strict";n.d(e,{w:()=>r});var i=n(85461);function r(t,e){e.linearDepth?t.vertex.code.add(i.H`
    vec4 transformPositionWithDepth(mat4 proj, mat4 view, vec3 pos, vec2 nearFar, out float depth) {
      vec4 eye = view * vec4(pos, 1.0);
      depth = (-eye.z - nearFar[0]) / (nearFar[1] - nearFar[0]) ;
      return proj * eye;
    }
    `):t.vertex.code.add(i.H`
    vec4 transformPosition(mat4 proj, mat4 view, vec3 pos) {
      // Make sure the order of operations is the same as in transformPositionWithDepth.
      return proj * (view * vec4(pos, 1.0));
    }
    `)}},11823:(t,e,n)=>{"use strict";n.d(e,{c:()=>r});var i=n(85461);function r(t,e){e.attributeColor?(t.attributes.add("color","vec4"),t.varyings.add("vColor","vec4"),t.vertex.code.add(i.H`
      void forwardVertexColor() { vColor = color; }
    `),t.vertex.code.add(i.H`
      void forwardNormalizedVertexColor() { vColor = color * 0.003921568627451; }
    `)):t.vertex.code.add(i.H`
      void forwardVertexColor() {}
      void forwardNormalizedVertexColor() {}
    `)}},83488:(t,e,n)=>{"use strict";n.d(e,{F:()=>s});var i=n(85461),r=n(61017);function s(t,e){t.fragment.include(r.n),3===e.output?(t.extensions.add("GL_OES_standard_derivatives"),t.fragment.code.add(i.H`
      float _calculateFragDepth(const in float depth) {
        // calc polygon offset
        const float SLOPE_SCALE = 2.0;
        const float BIAS = 2.0 * .000015259;    // 1 / (2^16 - 1)
        float m = max(abs(dFdx(depth)), abs(dFdy(depth)));
        float result = depth + SLOPE_SCALE * m + BIAS;
        return clamp(result, .0, .999999);
      }

      void outputDepth(float _linearDepth) {
        gl_FragColor = float2rgba(_calculateFragDepth(_linearDepth));
      }
    `)):1===e.output&&t.fragment.code.add(i.H`
      void outputDepth(float _linearDepth) {
        gl_FragColor = float2rgba(_linearDepth);
      }
    `)}},72023:(t,e,n)=>{"use strict";n.d(e,{b:()=>r});var i=n(85461);function r(t){t.fragment.uniforms.add("depthTex","sampler2D"),t.fragment.uniforms.add("highlightViewportPixelSz","vec4"),t.fragment.code.add(i.H`
    void outputHighlight() {
      vec4 fragCoord = gl_FragCoord;

      float sceneDepth = texture2D(depthTex, (fragCoord.xy - highlightViewportPixelSz.xy) * highlightViewportPixelSz.zw).r;
      if (fragCoord.z > sceneDepth + 5e-7) {
        gl_FragColor = vec4(1.0, 1.0, 0.0, 1.0);
      }
      else {
        gl_FragColor = vec4(1.0, 0.0, 1.0, 1.0);
      }
    }
  `)}!function(t){t.bindOutputHighlight=function(t,e,n){t.bindTexture(n.highlightDepthTexture,5),e.setUniform1i("depthTex",5),e.setUniform4f("highlightViewportPixelSz",0,0,n.inverseViewport[0],n.inverseViewport[1])}}(r||(r={}))},9295:(t,e,n)=>{"use strict";n.d(e,{e:()=>r});var i=n(85461);function r(t){t.vertex.code.add(i.H`
    const float PI = 3.141592653589793;
  `),t.fragment.code.add(i.H`
    const float PI = 3.141592653589793;
    const float LIGHT_NORMALIZATION = 1.0 / PI;
    const float INV_PI = 0.3183098861837907;
    const float HALF_PI = 1.570796326794897;
    `)}},8681:(t,e,n)=>{"use strict";n.d(e,{k:()=>r});var i=n(85461);function r(t,e){e.vvInstancingEnabled&&(e.vvSize||e.vvColor)&&t.attributes.add("instanceFeatureAttribute","vec4"),e.vvSize?(t.vertex.uniforms.add("vvSizeMinSize","vec3"),t.vertex.uniforms.add("vvSizeMaxSize","vec3"),t.vertex.uniforms.add("vvSizeOffset","vec3"),t.vertex.uniforms.add("vvSizeFactor","vec3"),t.vertex.uniforms.add("vvSymbolRotationMatrix","mat3"),t.vertex.uniforms.add("vvSymbolAnchor","vec3"),t.vertex.code.add(i.H`
      vec3 vvScale(vec4 _featureAttribute) {
        return clamp(vvSizeOffset + _featureAttribute.x * vvSizeFactor, vvSizeMinSize, vvSizeMaxSize);
      }

      vec4 vvTransformPosition(vec3 position, vec4 _featureAttribute) {
        return vec4(vvSymbolRotationMatrix * ( vvScale(_featureAttribute) * (position + vvSymbolAnchor)), 1.0);
      }
    `),t.vertex.code.add(i.H`
      const float eps = 1.192092896e-07;
      vec4 vvTransformNormal(vec3 _normal, vec4 _featureAttribute) {
        vec3 vvScale = clamp(vvSizeOffset + _featureAttribute.x * vvSizeFactor, vvSizeMinSize + eps, vvSizeMaxSize);
        return vec4(vvSymbolRotationMatrix * _normal / vvScale, 1.0);
      }

      ${e.vvInstancingEnabled?i.H`
      vec4 vvLocalNormal(vec3 _normal) {
        return vvTransformNormal(_normal, instanceFeatureAttribute);
      }

      vec4 localPosition() {
        return vvTransformPosition(position, instanceFeatureAttribute);
      }`:""}
    `)):t.vertex.code.add(i.H`
      vec4 localPosition() { return vec4(position, 1.0); }

      vec4 vvLocalNormal(vec3 _normal) { return vec4(_normal, 1.0); }
    `),e.vvColor?(t.vertex.defines.addInt("VV_COLOR_N",8),t.vertex.code.add(i.H`
      uniform float vvColorValues[VV_COLOR_N];
      uniform vec4 vvColorColors[VV_COLOR_N];

      vec4 vvGetColor(vec4 featureAttribute, float values[VV_COLOR_N], vec4 colors[VV_COLOR_N]) {
        float value = featureAttribute.y;
        if (value <= values[0]) {
          return colors[0];
        }

        for (int i = 1; i < VV_COLOR_N; ++i) {
          if (values[i] >= value) {
            float f = (value - values[i-1]) / (values[i] - values[i-1]);
            return mix(colors[i-1], colors[i], f);
          }
        }
        return colors[VV_COLOR_N - 1];
      }

      ${e.vvInstancingEnabled?i.H`
      vec4 vvColor() {
        return vvGetColor(instanceFeatureAttribute, vvColorValues, vvColorColors);
      }`:""}
    `)):t.vertex.code.add(i.H`
      vec4 vvColor() { return vec4(1.0); }
    `)}!function(t){function e(t,e){e.vvSizeEnabled&&(t.setUniform3fv("vvSizeMinSize",e.vvSizeMinSize),t.setUniform3fv("vvSizeMaxSize",e.vvSizeMaxSize),t.setUniform3fv("vvSizeOffset",e.vvSizeOffset),t.setUniform3fv("vvSizeFactor",e.vvSizeFactor)),e.vvColorEnabled&&(t.setUniform1fv("vvColorValues",e.vvColorValues),t.setUniform4fv("vvColorColors",e.vvColorColors))}t.bindUniforms=e,t.bindUniformsWithOpacity=function(t,n){e(t,n),n.vvOpacityEnabled&&(t.setUniform1fv("vvOpacityValues",n.vvOpacityValues),t.setUniform1fv("vvOpacityOpacities",n.vvOpacityOpacities))},t.bindUniformsForSymbols=function(t,n){e(t,n),n.vvSizeEnabled&&(t.setUniform3fv("vvSymbolAnchor",n.vvSymbolAnchor),t.setUniformMatrix3fv("vvSymbolRotationMatrix",n.vvSymbolRotationMatrix))}}(r||(r={}))},34658:(t,e,n)=>{"use strict";n.d(e,{sj:()=>o,F:()=>r,bf:()=>s});var i=n(85461);const r=.1,s=.001;function o(t,e){const n=t.fragment;switch(e.alphaDiscardMode){case 0:n.code.add(i.H`
        #define discardOrAdjustAlpha(color) { if (color.a < ${i.H.float(.001)}) { discard; } }
      `);break;case 1:n.code.add(i.H`
        void discardOrAdjustAlpha(inout vec4 color) {
          color.a = 1.0;
        }
      `);break;case 2:n.uniforms.add("textureAlphaCutoff","float"),n.code.add(i.H`
        #define discardOrAdjustAlpha(color) { if (color.a < textureAlphaCutoff) { discard; } else { color.a = 1.0; } }
      `);break;case 3:t.fragment.uniforms.add("textureAlphaCutoff","float"),t.fragment.code.add(i.H`
        #define discardOrAdjustAlpha(color) { if (color.a < textureAlphaCutoff) { discard; } }
      `)}}},63230:(t,e,n)=>{"use strict";n.d(e,{Y:()=>r});var i=n(85461);function r(t){t.code.add(i.H`
    vec4 premultiplyAlpha(vec4 v) {
      return vec4(v.rgb * v.a, v.a);
    }

    // Note: the min in the last line has been added to fix an instability in chrome.
    // See https://devtopia.esri.com/WebGIS/arcgis-js-api/issues/23911
    // With proper floating point handling, the value could never be >1.
    vec3 rgb2hsv(vec3 c) {
      vec4 K = vec4(0.0, -1.0 / 3.0, 2.0 / 3.0, -1.0);
      vec4 p = c.g < c.b ? vec4(c.bg, K.wz) : vec4(c.gb, K.xy);
      vec4 q = c.r < p.x ? vec4(p.xyw, c.r) : vec4(c.r, p.yzx);

      float d = q.x - min(q.w, q.y);
      float e = 1.0e-10;
      return vec3(abs(q.z + (q.w - q.y) / (6.0 * d + e)), min(d / (q.x + e), 1.0), q.x);
    }

    vec3 hsv2rgb(vec3 c) {
      vec4 K = vec4(1.0, 2.0 / 3.0, 1.0 / 3.0, 3.0);
      vec3 p = abs(fract(c.xxx + K.xyz) * 6.0 - K.www);
      return c.z * mix(K.xxx, clamp(p - K.xxx, 0.0, 1.0), c.y);
    }

    float rgb2v(vec3 c) {
      return max(c.x, max(c.y, c.z));
    }
  `)}},61017:(t,e,n)=>{"use strict";n.d(e,{n:()=>r});var i=n(85461);function r(t){t.code.add(i.H`
    // This is the maximum float value representable as 32bit fixed point,
    // it is rgba2float(vec4(1)) inlined.
    const float MAX_RGBA_FLOAT =
      255.0 / 256.0 +
      255.0 / 256.0 / 256.0 +
      255.0 / 256.0 / 256.0 / 256.0 +
      255.0 / 256.0 / 256.0 / 256.0 / 256.0;

    // Factors to convert to fixed point, i.e. factors (256^0, 256^1, 256^2, 256^3)
    const vec4 FIXED_POINT_FACTORS = vec4(1.0, 256.0, 256.0 * 256.0, 256.0 * 256.0 * 256.0);

    vec4 float2rgba(const float value) {
      // Make sure value is in the domain we can represent
      float valueInValidDomain = clamp(value, 0.0, MAX_RGBA_FLOAT);

      // Decompose value in 32bit fixed point parts represented as
      // uint8 rgba components. Decomposition uses the fractional part after multiplying
      // by a power of 256 (this removes the bits that are represented in the previous
      // component) and then converts the fractional part to 8bits.
      vec4 fixedPointU8 = floor(fract(valueInValidDomain * FIXED_POINT_FACTORS) * 256.0);

      // Convert uint8 values (from 0 to 255) to floating point representation for
      // the shader
      const float toU8AsFloat = 1.0 / 255.0;

      return fixedPointU8 * toU8AsFloat;
    }

    // Factors to convert rgba back to float
    const vec4 RGBA_2_FLOAT_FACTORS = vec4(
      255.0 / (256.0),
      255.0 / (256.0 * 256.0),
      255.0 / (256.0 * 256.0 * 256.0),
      255.0 / (256.0 * 256.0 * 256.0 * 256.0)
    );

    float rgba2float(vec4 rgba) {
      // Convert components from 0->1 back to 0->255 and then
      // add the components together with their corresponding
      // fixed point factors, i.e. (256^1, 256^2, 256^3, 256^4)
      return dot(rgba, RGBA_2_FLOAT_FACTORS);
    }
  `)}},89553:(t,e,n)=>{"use strict";n.d(e,{G:()=>i});var i,r=n(67128),s=n(6897);!function(t){function e(t,e,n){(0,r.t)(o,n,e),t.setUniform3fv("localOrigin",e),t.setUniformMatrix4fv("view",o)}t.bindCamPosition=function(t,e,n){t.setUniform3f("camPos",n[3]-e[0],n[7]-e[1],n[11]-e[2])},t.bindProjectionMatrix=function(t,e){t.setUniformMatrix4fv("proj",e)},t.bindNearFar=function(t,e){t.setUniform2fv("nearFar",e)},t.bindViewCustomOrigin=e,t.bindView=function(t,n){e(t,n.origin,n.camera.viewMatrix)},t.bindViewport=function(t,e){t.setUniform4fv("viewport",e.camera.fullViewport)}}(i||(i={}));const o=(0,s.c)()},51219:(t,e,n)=>{"use strict";n.d(e,{kG:()=>s});const i=n(36544).Z.getLogger("esri.views.3d.webgl-engine.core.shaderModules.shaderBuilder");class r{constructor(){this.includedModules=new Map}include(t,e){this.includedModules.has(t)?this.includedModules.get(t)!==e&&i.error("Trying to include shader module multiple times with different sets of options."):(this.includedModules.set(t,e),t(this.builder,e))}}class s extends r{constructor(){super(...arguments),this.vertex=new c,this.fragment=new c,this.attributes=new u,this.varyings=new l,this.extensions=new f,this.defines=new d}get builder(){return this}generateSource(t){const e=this.extensions.generateSource(t),n=this.attributes.generateSource(t),i=this.varyings.generateSource(),r="vertex"===t?this.vertex:this.fragment,s=r.uniforms.generateSource(),o=r.code.generateSource(),a="vertex"===t?g:h,c=this.defines.generateSource().concat(r.defines.generateSource());return`\n${e.join("\n")}\n\n${c.join("\n")}\n\n${a}\n\n${s.join("\n")}\n\n${n.join("\n")}\n\n${i.join("\n")}\n\n${o.join("\n")}`}}class o{constructor(){this._entries=new Array,this._set=new Set}add(t,e,n){const i=`${t}_${e}_${n}`;return this._set.has(i)||(this._entries.push([t,e,n]),this._set.add(i)),this}generateSource(){return this._entries.map((t=>{return`uniform ${t[1]} ${t[0]}${e=t[2],e?`[${e}]`:""};`;var e}))}}class a{constructor(){this._entries=new Array}add(t){this._entries.push(t)}generateSource(){return this._entries}}class c extends r{constructor(){super(...arguments),this.uniforms=new o,this.code=new a,this.defines=new d}get builder(){return this}}class u{constructor(){this._entries=new Array}add(t,e){this._entries.push([t,e])}generateSource(t){return"fragment"===t?[]:this._entries.map((t=>`attribute ${t[1]} ${t[0]};`))}}class l{constructor(){this._entries=new Array}add(t,e){this._entries.push([t,e])}generateSource(){return this._entries.map((t=>`varying ${t[1]} ${t[0]};`))}}class f{constructor(){this._entries=new Set}add(t){this._entries.add(t)}generateSource(t){const e="vertex"===t?f.ALLOWLIST_VERTEX:f.ALLOWLIST_FRAGMENT;return Array.from(this._entries).filter((t=>e.includes(t))).map((t=>`#extension ${t} : enable`))}}f.ALLOWLIST_FRAGMENT=["GL_EXT_shader_texture_lod","GL_OES_standard_derivatives"],f.ALLOWLIST_VERTEX=[];class d{constructor(){this._entries=new Map}addInt(t,e){const n=e%1==0?e.toFixed(0):e.toString();this._entries.set(t,n)}addFloat(t,e){const n=e%1==0?e.toFixed(1):e.toString();this._entries.set(t,n)}generateSource(){return Array.from(this._entries,(([t,e])=>`#define ${t} ${e}`))}}const h="#ifdef GL_FRAGMENT_PRECISION_HIGH\n  precision highp float;\n  precision highp sampler2D;\n#else\n  precision mediump float;\n  precision mediump sampler2D;\n#endif",g="precision highp float;\nprecision highp sampler2D;"},85461:(t,e,n)=>{"use strict";function i(t,...e){let n="";for(let i=0;i<e.length;i++)n+=t[i]+e[i];return n+=t[t.length-1],n}n.d(e,{H:()=>i}),function(t){t.int=function(t){return Math.round(t).toString()},t.float=function(t){return t.toPrecision(8)}}(i||(i={}))},23240:(t,e,n)=>{"use strict";n.d(e,{J:()=>i});class i{constructor(t,e){this._module=t,this._loadModule=e}get(){return this._module}async reload(){return this._module=await this._loadModule(),this._module}}},97853:(t,e,n)=>{"use strict";n.d(e,{A:()=>i});class i{constructor(t,e){e&&(this._config=e.snapshot()),this._program=this.initializeProgram(t),t.commonUniformStore&&(this._commonUniformStore=t.commonUniformStore,this._commonUniformStore.subscribeProgram(this._program)),this._pipeline=this.initializePipeline(t)}dispose(){this._program&&(this._commonUniformStore&&this._commonUniformStore.unsubscribeProgram(this._program),this._program.dispose(),this._program=null)}reload(t){this._program&&(this._commonUniformStore&&this._commonUniformStore.unsubscribeProgram(this._program),this._program.dispose()),this._program=this.initializeProgram(t),this._commonUniformStore&&this._commonUniformStore.subscribeProgram(this._program)}get program(){return this._program}get pipeline(){return this._pipeline}get key(){return this._config.key}get configuration(){return this._config}bindPass(t,e,n){}bindMaterial(t,e,n){}bindDraw(t,e,n){}bindPipelineState(t){t.setPipelineState(this.pipeline)}ensureAttributeLocations(t){this.program.assertCompatibleVertexAttributeLocations(t)}get primitiveType(){return 4}}},44801:(t,e,n)=>{"use strict";n.d(e,{m:()=>r,o:()=>s});var i=n(33655);class r{constructor(){this._key="",this._keyDirty=!1,this._parameterBits=this._parameterBits.map((()=>0))}get key(){return this._keyDirty&&(this._keyDirty=!1,this._key=String.fromCharCode.apply(String,this._parameterBits)),this._key}snapshot(){const t=this._parameterNames,e={key:this.key};for(const n of t)e[n]=this[n];return e}}function s(t={}){return(e,n)=>{var r,s;e._parameterNames=null!=(r=e._parameterNames)?r:[],e._parameterNames.push(n);const o=e._parameterNames.length-1,a=t.count||2,c=Math.ceil((0,i.k3)(a)),u=null!=(s=e._parameterBits)?s:[0];let l=0;for(;u[l]+c>16;)l++,l>=u.length&&u.push(0);e._parameterBits=u;const f=u[l],d=(1<<c)-1<<f;u[l]+=c,Object.defineProperty(e,n,{get(){return this[o]},set(t){if(this[o]!==t&&(this[o]=t,this._keyDirty=!0,this._parameterBits[l]=this._parameterBits[l]&~d|+t<<f&d,"number"!=typeof t&&"boolean"!=typeof t))throw"Configuration values must be booleans or numbers!"}})}}},91852:(t,e,n)=>{"use strict";n.d(e,{Xn:()=>r,TF:()=>i,gT:()=>s});const i=t=>class extends t{constructor(){super(...arguments),this._isDisposed=!1}dispose(){for(const e of null!=(t=this._managedDisposables)?t:[]){var t;const n=this[e];this[e]=null,n&&"function"==typeof n.dispose&&n.dispose()}this._isDisposed=!0}get isDisposed(){return this._isDisposed}};class r extends(i(class{})){}function s(){return(t,e)=>{var n,i;t.hasOwnProperty("_managedDisposables")||(t._managedDisposables=null!=(n=null==(i=t._managedDisposables)?void 0:i.slice())?n:[]),t._managedDisposables.unshift(e)}}},11379:(t,e,n)=>{"use strict";n.d(e,{i:()=>i});const i={position:0,normal:1,uv0:2,color:3,size:4,tangent:4,uvMapSpace:4,auxpos1:5,symbolColor:5,auxpos2:6,featureAttribute:6,instanceFeatureAttribute:6,instanceColor:7,bound1:5,bound2:6,bound3:7,model:8,modelNormal:12,modelOriginHi:11,modelOriginLo:15}},26701:(t,e,n)=>{"use strict";n.d(e,{Z:()=>r});var i=n(91852);const r=class extends i.Xn{constructor(t){super(),this.material=t.material,this.techniqueRep=t.techniqueRep,this.output=t.output}getTechnique(){return this.technique}getPipelineState(t,e){return this.getTechnique().pipeline}ensureResources(t){return 2}ensureParameters(t){}}},68500:(t,e,n)=>{"use strict";n.d(e,{Z:()=>h});var i=n(59472),r=n(27898),s=n(56469),o=n(15853),a=n(62698),c=n(77625),u=n(17387);class l{constructor(t,e,n,i){this.primitiveIndices=t,this._numIndexPerPrimitive=e,this.indices=n,this._position=i,this.center=(0,c.c)(),(0,s.hu)(t.length>=1),(0,s.hu)(n.length%this._numIndexPerPrimitive==0),(0,s.hu)(n.length>=t.length*this._numIndexPerPrimitive),(0,s.hu)(3===this._position.size||4===this._position.size);const{data:r,offsetIdx:o,strideIdx:a}=this._position;let f=0;const d=t.length;let h=o+a*n[this._numIndexPerPrimitive*t[f]];for(l.tmpIndices.clear(),l.tmpIndices.push(h),this.bbMin=(0,c.f)(r[h],r[h+1],r[h+2]),this.bbMax=(0,c.b)(this.bbMin);f<d;++f){const e=this._numIndexPerPrimitive*t[f];for(let t=0;t<this._numIndexPerPrimitive;++t){h=o+a*n[e+t],l.tmpIndices.push(h);let i=r[h];this.bbMin[0]=Math.min(i,this.bbMin[0]),this.bbMax[0]=Math.max(i,this.bbMax[0]),i=r[h+1],this.bbMin[1]=Math.min(i,this.bbMin[1]),this.bbMax[1]=Math.max(i,this.bbMax[1]),i=r[h+2],this.bbMin[2]=Math.min(i,this.bbMin[2]),this.bbMax[2]=Math.max(i,this.bbMax[2])}}(0,u.e)(this.center,this.bbMin,this.bbMax,.5),this.bsRadius=.5*Math.max(Math.max(this.bbMax[0]-this.bbMin[0],this.bbMax[1]-this.bbMin[1]),this.bbMax[2]-this.bbMin[2]);let g=this.bsRadius*this.bsRadius;for(f=0;f<l.tmpIndices.length;++f){h=l.tmpIndices.data[f];const t=r[h]-this.center[0],e=r[h+1]-this.center[1],n=r[h+2]-this.center[2],i=t*t+e*e+n*n;if(i<=g)continue;const s=Math.sqrt(i),o=.5*(s-this.bsRadius);this.bsRadius=this.bsRadius+o,g=this.bsRadius*this.bsRadius;const a=o/s;this.center[0]+=t*a,this.center[1]+=e*a,this.center[2]+=n*a}l.tmpIndices.clear()}getCenter(){return this.center}getBSRadius(){return this.bsRadius}getBBMin(){return this.bbMin}getBBMax(){return this.bbMax}getPrimitiveIndices(){return this.primitiveIndices}getIndices(){return this.indices}getPosition(){return this._position}getChildren(){if(this._children)return this._children;if((0,u.h)(this.bbMin,this.bbMax)>1){const t=(0,u.e)((0,c.c)(),this.bbMin,this.bbMax,.5),e=this.primitiveIndices.length,n=new Uint8Array(e),i=new Array(8);for(let t=0;t<8;++t)i[t]=0;const{data:r,offsetIdx:s,strideIdx:o}=this._position;for(let a=0;a<e;++a){let e=0;const c=this._numIndexPerPrimitive*this.primitiveIndices[a];let u=s+o*this.indices[c],l=r[u],f=r[u+1],d=r[u+2];for(let t=1;t<this._numIndexPerPrimitive;++t){u=s+o*this.indices[c+t];const e=r[u],n=r[u+1],i=r[u+2];e<l&&(l=e),n<f&&(f=n),i<d&&(d=i)}l<t[0]&&(e|=1),f<t[1]&&(e|=2),d<t[2]&&(e|=4),n[a]=e,++i[e]}let a=0;for(let t=0;t<8;++t)i[t]>0&&++a;if(a<2)return;const f=new Array(8);for(let t=0;t<8;++t)f[t]=i[t]>0?new Uint32Array(i[t]):void 0;for(let t=0;t<8;++t)i[t]=0;for(let t=0;t<e;++t){const e=n[t];f[e][i[e]++]=this.primitiveIndices[t]}this._children=new Array(8);for(let t=0;t<8;++t)void 0!==f[t]&&(this._children[t]=new l(f[t],this._numIndexPerPrimitive,this.indices,this._position))}return this._children}}!function(t){t.tmpIndices=new a.Z({deallocator:null})}(l||(l={}));const f=l;class d{constructor(t,e){this._boundingInfo=null,this._id=d.__idGen.gen(e),this._data=t}get id(){return this._id}get data(){return this._data}getIndices(t){return this.data.getIndices(t)}get indexCount(){return this.data.indexCount}getAttribute(t){return this.data.getAttribute(t)}get vertexCount(){return this.data.indexCount}get faceCount(){return this.data.indexCount/3}get boundingInfo(){return(0,i.Wi)(this._boundingInfo)&&(this._boundingInfo=this._calculateBoundingInfo()),this._boundingInfo}computeAttachmentOrigin(t){return"triangle"===this.data.primitiveType?this.computeAttachmentOriginTriangles(t):this.computeAttachmentOriginPoints(t)}computeAttachmentOriginTriangles(t){const e=this.getIndices(s.Xt.POSITION),n=this.getAttribute(s.Xt.POSITION);return(0,r.cM)(n,e,t)}computeAttachmentOriginPoints(t){const e=this.getIndices(s.Xt.POSITION),n=this.getAttribute(s.Xt.POSITION);return(0,r.NO)(n,e,t)}invalidateBoundingInfo(){this._boundingInfo=null}_calculateBoundingInfo(){let t=this.data.getIndices(s.Xt.POSITION);const e=this.data.getAttribute(s.Xt.POSITION),n="triangle"===this.data.primitiveType?3:1;if(0===t.length){t=new Uint32Array(n);for(let e=0;e<n;++e)t[e]=e}const i=t.length;(0,s.hu)(i%n==0,"Indexing error: "+i.toFixed(0)+" not divisible by "+n.toFixed(0));const o=(0,r.p)(i/n);return new f(o,n,t,e)}}d.__idGen=new o.A;const h=d},69534:(t,e,n)=>{"use strict";n.d(e,{b:()=>s});var i=n(27898),r=n(56469);class s{constructor(t,e=s.DefaultIndices,n="triangle"){this.initialize(t,e,n)}get id(){return this._id}get vertexAttributes(){return this._vertexAttributes}get indices(){return this._indices}get indexCount(){const t=(0,r.kV)(this._indices);return null==t?0:t.length}get primitiveType(){return this._primitiveType}getVertexAttr(){return this.vertexAttributes}initialize(t,e=s.DefaultIndices,n="triangle"){const o={};for(const e in t){const{data:n,size:i}=t[e];o[e]={data:n,size:i,offsetIdx:0,strideIdx:i}}if(e===s.DefaultIndices){const t=function(t){const e=(0,r.kV)(t);return null==e?0:e.data.length/e.size}(o),n=(0,i.p)(t);e={};for(const t in o)e[t]=n}this._id=(0,i.RL)(),this._vertexAttributes=o,this._indices=e,this._primitiveType=n}toRenderData(){return{id:this._id.toString(),indices:this._indices,vertexAttr:this._vertexAttributes}}getIndices(t){return this._indices[t]}getAttribute(t){return this._vertexAttributes[t]}estimateGpuMemoryUsage(){let t=0;if(this._indices[r.Xt.POSITION]){const e=3;t+=this._indices[r.Xt.POSITION].length*e*4}if(this._indices[r.Xt.NORMAL]){const e=3;t+=this._indices[r.Xt.NORMAL].length*e*4}if(this._indices[r.Xt.UV0]){const e=2;t+=this._indices[r.Xt.UV0].length*e*4}if(this._indices[r.Xt.COLOR]){const e=1;t+=this._indices[r.Xt.COLOR].length*e*4}return t}}s.DefaultIndices={}},15853:(t,e,n)=>{"use strict";n.d(e,{A:()=>i});class i{constructor(){this._count=0}gen(t){return null==t&&(t="a"),t+"_"+this._count++}}},10762:(t,e,n)=>{"use strict";n.d(e,{F5:()=>a,zh:()=>u,Pb:()=>c});var i=n(59472),r=n(11379),s=n(15853),o=n(30090);class a{constructor(t,e,n){this.supportsEdges=!1,this._visible=!0,this._renderPriority=0,this._insertOrder=0,this._vertexAttributeLocations=r.i,this.id=a._idGen.gen(t),this._params=(0,o.Uf)(e,n),this.validateParameterValues(this._params)}dispose(){}get params(){return this._params}update(){return!1}setParameterValues(t){(0,o.LO)(this._params,t)&&(this.validateParameterValues(this._params),this.parametersChanged())}validateParameterValues(){}get visible(){return this._visible}set visible(t){t!==this._visible&&(this._visible=t,this.parametersChanged())}isVisibleInPass(t){return!0}get renderOccluded(){return this.params.renderOccluded}get renderPriority(){return this._renderPriority}set renderPriority(t){t!==this._renderPriority&&(this._renderPriority=t,this.parametersChanged())}get insertOrder(){return this._insertOrder}set insertOrder(t){t!==this._insertOrder&&(this._insertOrder=t,this.parametersChanged())}get vertexAttributeLocations(){return this._vertexAttributeLocations}isVisible(){return this._visible}parametersChanged(){(0,i.pC)(this.materialRepository)&&this.materialRepository.materialChanged(this)}}function c(t,e){return t.isVisible()&&t.isVisibleInPass(e.pass)&&0!=(t.renderOccluded&e.renderOccludedMask)}a._idGen=new s.A;const u={renderOccluded:1}},88909:(t,e,n)=>{"use strict";n.d(e,{Z:()=>_});var i=n(59472),r=n(77625),s=n(17387),o=n(17154),a=n(67128),c=n(12811),u=n(56469),l=n(15853),f=n(38035);class d{acquire(t,e,n,i,r,s){this.id=d._idGen.gen(t&&t.id),this.geometry=t,this.material=e,this.transformation=n,this.instanceParameters=i,this.origin=r,this.shaderTransformation=s}getStaticTransformation(){return this.transformation}getShaderTransformation(){return this.shaderTransformation?this.shaderTransformation(this.transformation):this.transformation}computeAttachmentOrigin(t){return!!(this.material.computeAttachmentOrigin?this.material.computeAttachmentOrigin(this.geometry,t):this.geometry.computeAttachmentOrigin(t))&&((0,s.i)(t,t,this.getStaticTransformation()),!0)}}d._idGen=new l.A,d.pool=new f.Z(d);const h=d;var g=n(8830),m=n(49366);class b{constructor(t={}){this._objectTransformation=(0,c.a)(),this._bvObjectSpace=new v,this._bvWorldSpace=new v,this._bvDirty=!0,this._hasVolatileTransformation=!1,this._visible=!0,this.id=b._idGen.gen(t.idHint),this.castShadow=null==t.castShadow||t.castShadow,this.metadata=t.metadata,this.metadata&&this.metadata.isElevationSource&&(this.metadata.lastValidElevationBB=new p),this.objectTransformation=(0,c.a)(),this._initializeGeometryRecords(t.geometries,t.materials,t.transformations,t.origins)}get geometryRecords(){return this._geometryRecords}get geometries(){return this._geometries}get objectTransformation(){return this._objectTransformation}set objectTransformation(t){(0,a.c)(this._objectTransformation,t),this._invalidateBoundingVolume(),this._notifyDirty("objTransformation")}dispose(){for(const t of this._geometryRecords)h.pool.release(t);this._geometryRecords=null,this._geometries=null}_initializeGeometryRecords(t,e,n,i){if(!Array.isArray(t))return this._geometryRecords=[],void(this._geometries=[]);(0,u.hu)(e.length===t.length,"Object3D: materials don't match geometries"),(0,u.hu)(n.length===t.length,"Object3D: transformations don't match geometries"),this._geometryRecords=new Array(t.length),this._geometries=t.slice();for(let r=0;r<t.length;r++){const s={highlights:null,occludees:null,visible:!0};this._geometryRecords[r]=h.pool.acquire(t[r],e[r],(0,c.b)(n[r]),s,i&&i[r])}this._hasVolatileTransformation=!1}get parentLayer(){return this._parentLayer}set parentLayer(t){(0,u.hu)(null==this._parentLayer||null==t,"Object3D can only be added to a single Layer"),this._parentLayer=t}getNumGeometryRecords(){return this._geometryRecords.length}getGeometryRecord(t){return(0,u.hu)(t>=0&&t<this._geometryRecords.length,"Object3d.getGeometryDataByIndex: index out of range"),this._geometryRecords[t]}addGeometry(t,e,n,i,r,s){n=n||c.I,this._geometries.push(t);const o=h.pool.acquire(t,e,n,i||{highlights:null,occludees:null,visible:!0},r,s);return this._geometryRecords.push(o),this._hasVolatileTransformation=this._geometryRecords.some((t=>!!t.shaderTransformation)),this._notifyDirty("objGeometryAdded",o),this._invalidateBoundingVolume(),o}removeGeometry(t){const e=this._geometryRecords.splice(t,1)[0];return h.pool.release(e),this._hasVolatileTransformation=this._geometryRecords.some((t=>!!t.shaderTransformation)),this._geometries.splice(t,1),this._notifyDirty("objGeometryRemoved",e),this._invalidateBoundingVolume(),e}removeAllGeometries(){for(;this.getNumGeometryRecords()>0;)this.removeGeometry(0)}geometryVertexAttrsUpdated(t){this._notifyDirty("vertexAttrsUpdated",this._geometryRecords[t]),this._invalidateBoundingVolume()}get isVisible(){return this._visible}setVisible(t){this._visible=t;for(const t of this._geometryRecords)t.instanceParameters.visible=this._visible;this._notifyDirty("visibilityChanged")}maskOccludee(){const t=(0,g.K)(1);for(const e of this._geometryRecords)e.instanceParameters.occludees=(0,m.lr)(e.instanceParameters.occludees,t);return this._notifyDirty("occlusionChanged"),t}removeOcclude(t){for(const e of this._geometryRecords)e.instanceParameters.occludees=(0,m.U_)(e.instanceParameters.occludees,t);this._notifyDirty("occlusionChanged")}highlight(){const t=(0,g.K)(0);for(const e of this._geometryRecords)e.instanceParameters.highlights=(0,m.lr)(e.instanceParameters.highlights,t);return this._notifyDirty("highlightChanged"),t}removeHighlight(t){for(const e of this._geometryRecords)e.instanceParameters.highlights=(0,m.U_)(e.instanceParameters.highlights,t);this._notifyDirty("highlightChanged")}getCombinedStaticTransformation(t,e){return(0,a.m)((0,i.Pt)(e,(0,c.a)()),this.objectTransformation,t.getStaticTransformation())}getCombinedShaderTransformation(t,e){return e=e||(0,c.a)(),(0,a.m)(e,this.objectTransformation,t.getShaderTransformation()),e}hasVolativeTransformation(){return this._hasVolatileTransformation}getBBMin(t){return this._validateBoundingVolume(),t?this._bvObjectSpace.bbMin:this._bvWorldSpace.bbMin}getBBMax(t){return this._validateBoundingVolume(),t?this._bvObjectSpace.bbMax:this._bvWorldSpace.bbMax}getCenter(t){return this._validateBoundingVolume(),t?this._bvObjectSpace.center:this._bvWorldSpace.center}getBSRadius(t){return this._validateBoundingVolume(),t?this._bvObjectSpace.bsRadius:this._bvWorldSpace.bsRadius}_validateBoundingVolume(){if(!this._bvDirty&&!this._hasVolatileTransformation)return;this._bvObjectSpace.init(),this._bvWorldSpace.init();for(let t=0;t<this._geometryRecords.length;++t){const e=this._geometries[t],n=this._geometryRecords[t],i=e.boundingInfo;this._calculateTransformedBoundingVolume(i,this._bvObjectSpace,n.getShaderTransformation()),this._calculateTransformedBoundingVolume(i,this._bvWorldSpace,this.getCombinedShaderTransformation(n))}(0,s.e)(this._bvObjectSpace.center,this._bvObjectSpace.bbMin,this._bvObjectSpace.bbMax,.5),(0,s.e)(this._bvWorldSpace.center,this._bvWorldSpace.bbMin,this._bvWorldSpace.bbMax,.5);const t=(0,r.c)(),e=(0,r.c)(),n=(0,o.u1)(this.objectTransformation);for(let i=0;i<this._geometryRecords.length;++i){const r=this._geometries[i],a=this._geometryRecords[i].getShaderTransformation(),c=(0,o.u1)(a),u=r.boundingInfo;(0,s.i)(t,u.getCenter(),a);const l=(0,s.k)(t,this._bvObjectSpace.center),f=u.getBSRadius()*c;this._bvObjectSpace.bsRadius=Math.max(this._bvObjectSpace.bsRadius,l+f),(0,s.i)(e,t,this.objectTransformation);const d=(0,s.k)(e,this._bvWorldSpace.center),h=f*n;this._bvWorldSpace.bsRadius=Math.max(this._bvWorldSpace.bsRadius,d+h)}this._bvDirty=!1}_calculateTransformedBoundingVolume(t,e,n){const i=t.getBBMin(),o=t.getBBMax(),a=(0,r.b)(i),c=(0,r.b)(o);(0,s.i)(a,a,n),(0,s.i)(c,c,n);for(let t=0;t<3;++t)e.bbMin[t]=Math.min(e.bbMin[t],a[t],c[t]),e.bbMax[t]=Math.max(e.bbMax[t],a[t],c[t]);for(let t=0;t<3;++t){(0,s.g)(a,i),(0,s.g)(c,o),a[t]=o[t],c[t]=i[t],(0,s.i)(a,a,n),(0,s.i)(c,c,n);for(let t=0;t<3;++t)e.bbMin[t]=Math.min(e.bbMin[t],a[t],c[t]),e.bbMax[t]=Math.max(e.bbMax[t],a[t],c[t])}}_invalidateBoundingVolume(){this._bvDirty=!0,this._parentLayer&&this._parentLayer.notifyObjectBBChanged(this,{center:this._bvWorldSpace.center,radius:this._bvWorldSpace.bsRadius})}_notifyDirty(t,e,n,i){if(this._parentLayer){n=n||1;const r=i||this;this._parentLayer.notifyDirty(t,e,n,r)}}get test(){const t=this;return{hasGeometry:e=>t._geometries.indexOf(e)>-1,getGeometryIndex:e=>t._geometries.indexOf(e)}}}b._idGen=new l.A;class p{constructor(){this.bbMin=(0,r.f)(Number.MAX_VALUE,Number.MAX_VALUE,Number.MAX_VALUE),this.bbMax=(0,r.f)(-Number.MAX_VALUE,-Number.MAX_VALUE,-Number.MAX_VALUE)}isEmpty(){return this.bbMax[0]<this.bbMin[0]&&this.bbMax[1]<this.bbMin[1]&&this.bbMax[2]<this.bbMin[2]}}class v extends p{constructor(){super(),this.center=(0,r.c)(),this.bsRadius=0}init(){(0,s.s)(this.bbMin,Number.MAX_VALUE,Number.MAX_VALUE,Number.MAX_VALUE),(0,s.s)(this.bbMax,-Number.MAX_VALUE,-Number.MAX_VALUE,-Number.MAX_VALUE),(0,s.s)(this.center,0,0,0),this.bsRadius=0}getCenter(){return this.center}getBSRadius(){return this.bsRadius}}const _=b},8830:(t,e,n)=>{"use strict";n.d(e,{K:()=>r});const i=new(n(15853).A);function r(t){const e=0===t?"highlight":"occludee";return{id:i.gen(e),channel:t}}},66704:(t,e,n)=>{"use strict";n.d(e,{$L:()=>a,$x:()=>d,Vc:()=>c,E0:()=>l,ve:()=>u,wu:()=>r,je:()=>f});var i=n(36904);const r=(0,i.wK)(770,1,771,771),s=(0,i.if)(1,1),o=(0,i.if)(0,771);function a(t){return 2===t?null:1===t?o:s}function c(t){return 2===t?i.LZ:null}const u=5e5,l={factor:-1,units:-2};function f(t){return t?l:null}function d(t){return 3===t||2===t?513:515}},38391:(t,e,n)=>{"use strict";n.d(e,{zV:()=>r,JN:()=>i,RY:()=>a,eD:()=>c,ii:()=>u,YD:()=>l,P7:()=>o,s3:()=>s});const i={func:513},r={func:519},s={mask:255},o={mask:0},a={function:{func:519,ref:2,mask:2},operation:{fail:7680,zFail:7680,zPass:0}},c={function:{func:519,ref:2,mask:2},operation:{fail:7680,zFail:7680,zPass:7681}},u={function:{func:514,ref:2,mask:2},operation:{fail:7680,zFail:7680,zPass:7680}},l={function:{func:517,ref:2,mask:2},operation:{fail:7680,zFail:7680,zPass:7680}}},56469:(t,e,n)=>{"use strict";n.d(e,{Xt:()=>a,hu:()=>c,tM:()=>m,RQ:()=>b,Kj:()=>h,zF:()=>g,kV:()=>l,Xv:()=>x,kG:()=>d,I0:()=>p,yK:()=>u,u_:()=>f,vP:()=>v});var i=n(33655),r=(n(77625),n(67128),n(55735),n(38256)),s=n(14286);n(34353);(0,r.a)();class o{constructor(t){this.message=t}toString(){return`AssertException: ${this.message}`}}const a={POSITION:"position",NORMAL:"normal",UV0:"uv0",UVMAPSPACE:"uvMapSpace",MEANVERTEXPOSITION:"meanVertexPosition",AUXPOS1:"auxpos1",AUXPOS2:"auxpos2",BOUND1:"bound1",BOUND2:"bound2",BOUND3:"bound3",COLOR:"color",SYMBOLCOLOR:"symbolColor",SIZE:"size",TANGENT:"tangent"};function c(t,e){if(!t){e=e||"assert";const t=new Error(e);throw t.stack&&console.log(t.stack),new o(e)}}function u(t,e,n,i){let r,s=(n[0]-t[0])/e[0],o=(i[0]-t[0])/e[0];s>o&&(r=s,s=o,o=r);let a=(n[1]-t[1])/e[1],c=(i[1]-t[1])/e[1];if(a>c&&(r=a,a=c,c=r),s>c||a>o)return!1;a>s&&(s=a),c<o&&(o=c);let u=(n[2]-t[2])/e[2],l=(i[2]-t[2])/e[2];return u>l&&(r=u,u=l,l=r),!(s>l||u>o||(l<o&&(o=l),o<0))}function l(t){return t[function(t){for(const e in t)return e}(t)]}function f(t,e,n,i){t[12]=e,t[13]=n,t[14]=i}function d(t){return 1===t[0]&&0===t[1]&&0===t[2]&&0===t[3]&&0===t[4]&&1===t[5]&&0===t[6]&&0===t[7]&&0===t[8]&&0===t[9]&&1===t[10]&&0===t[11]&&1===t[15]}function h(t,e,n){return 2*Math.atan(Math.sqrt(e*e+n*n)*Math.tan(.5*t)/e)}function g(t,e,n){return 2*Math.atan(Math.sqrt(e*e+n*n)*Math.tan(.5*t)/n)}function m(t,e,n){return 2*Math.atan(e*Math.tan(.5*t)/Math.sqrt(e*e+n*n))}function b(t,e,n){return 2*Math.atan(n*Math.tan(.5*t)/Math.sqrt(e*e+n*n))}function p(t,e,n=0){const r=(0,i.uZ)(t,0,y);for(let t=0;t<4;t++)e[n+t]=Math.floor(256*((s=r*_[t])-Math.floor(s)));var s}function v(t,e=0){let n=0;for(let i=0;i<4;i++)n+=t[e+i]*M[i];return n}const _=[1,256,65536,16777216],M=[1/256,1/65536,1/16777216,1/4294967296],y=v(new Uint8ClampedArray([255,255,255,255]));function x(t,e,n,i,r){const o=t;0===t[11]?(i[0]=2/(e*o[0]),i[1]=2/(n*o[5]),i[2]=(1+o[12])/o[0],i[3]=(1+o[13])/o[5],(0,s.s)(r,0,1)):(i[0]=-2/(e*o[0]),i[1]=-2/(n*o[5]),i[2]=(1-o[8])/o[0],i[3]=(1-o[9])/o[5],(0,s.s)(r,1,0))}},71061:(t,e,n)=>{"use strict";function i(t,e,n){for(let i=0;i<n;++i)e[2*i]=t[i],e[2*i+1]=t[i]-e[2*i]}function r(t,e,n,r){for(let a=0;a<r;++a)s[0]=t[a],i(s,o,1),e[a]=o[0],n[a]=o[1]}n.d(e,{LF:()=>i,po:()=>r});const s=new Float64Array(1),o=new Float32Array(2)},27898:(t,e,n)=>{"use strict";n.d(e,{qZ:()=>d,NO:()=>f,cM:()=>l,p:()=>u,RL:()=>g});var i=n(77625),r=n(17387),s=n(56938);let o=1,a=null;const c=new Uint32Array([0]);function u(t){if(1===t)return c;if(t>o||null==a){for(;t>o;)o*=2;a=new Uint32Array(o);for(let t=0;t<o;t++)a[t]=t}return new Uint32Array(a.buffer,0,t)}function l(t,e,n){if(!t)return!1;const{strideIdx:i,offsetIdx:o,data:a}=t;(0,r.s)(n,0,0,0),(0,r.s)(v,0,0,0);let c=0,u=0;for(let t=0;t<e.length-2;t+=3){const l=e[t+0]*i+o,f=e[t+1]*i+o,d=e[t+2]*i+o;(0,r.s)(m,a[l+0],a[l+1],a[l+2]),(0,r.s)(b,a[f+0],a[f+1],a[f+2]),(0,r.s)(p,a[d+0],a[d+1],a[d+2]);const h=(0,s.a)(m,b,p);h?((0,r.b)(m,m,b),(0,r.b)(m,m,p),(0,r.a)(m,m,1/3*h),(0,r.b)(n,n,m),c+=h):((0,r.b)(v,v,m),(0,r.b)(v,v,b),(0,r.b)(v,v,p),u+=3)}return!(0===u&&0===c||(0!==c?((0,r.a)(n,n,1/c),0):0===u||((0,r.a)(n,v,1/u),0)))}function f(t,e,n){if(!t||!e)return!1;const{strideIdx:i,offsetIdx:s,data:o}=t;(0,r.s)(n,0,0,0);let a=-1,c=0;for(let t=0;t<e.length;t++){const r=e[t]*i+s;a!==r&&(n[0]+=o[r+0],n[1]+=o[r+1],n[2]+=o[r+2],c++),a=r}return c>1&&(0,r.a)(n,n,1/c),c>0}function d(t,e,n,i){if(!t)return!1;const{strideIdx:s,offsetIdx:o,data:a}=t;(0,r.s)(i,0,0,0),(0,r.s)(v,0,0,0);let c=0,u=0;const l=e?e.length-1:a.length/s-1,f=l+(n?2:0);for(let t=0;t<f;t+=2){const n=t<l?t:l,f=t<l?t+1:0,d=(e?e[n]:n)*s+o,h=(e?e[f]:f)*s+o;m[0]=a[d+0],m[1]=a[d+1],m[2]=a[d+2],b[0]=a[h+0],b[1]=a[h+1],b[2]=a[h+2],(0,r.a)(m,(0,r.b)(m,m,b),.5);const g=(0,r.w)(m,b);g>0?((0,r.b)(i,i,(0,r.a)(m,m,g)),c+=g):((0,r.b)(v,v,m),u++)}return 0!==c?((0,r.a)(i,i,1/c),!0):0!==u&&((0,r.a)(i,v,1/u),!0)}let h=0;function g(){return h++}const m=(0,i.c)(),b=(0,i.c)(),p=(0,i.c)(),v=(0,i.c)()},10346:(t,e,n)=>{"use strict";n.d(e,{hf:()=>l,ow:()=>u});var i=n(11379),r=n(69595),s=n(8634),o=n(74038);const a=[{name:"position",count:2,type:5126,offset:0,stride:8,normalized:!1}],c=[{name:"position",count:2,type:5126,offset:0,stride:16,normalized:!1},{name:"uv0",count:2,type:5126,offset:8,stride:16,normalized:!1}];function u(t,e=a,n=i.i,s=-1,u=1){let l=null;switch(e){case c:l=new Float32Array([s,s,0,0,u,s,1,0,s,u,0,1,u,u,1,1]);break;case a:default:l=new Float32Array([s,s,u,s,s,u,u,u])}return new o.Z(t,n,{geometry:e},{geometry:r.Z.createVertex(t,35044,l)})}function l(t){return new s.Z(t,{target:3553,pixelFormat:6408,dataType:5121,samplingMode:9728,width:1,height:1},new Uint8Array([255,255,255,255]))}},24379:(t,e,n)=>{"use strict";n.d(e,{TU:()=>c,sX:()=>o,PV:()=>a,bA:()=>u});var i=n(33655);function r(t,e,n){const i=n.parameters,r=n.paddingPixelsOverride;return l.scale=Math.min(i.divisor/(e-i.offset),1),l.factor=function(t){return Math.abs(t*t*t)}(t),l.minPixelSize=i.minPixelSize,l.paddingPixels=r,l}function s(t,e){return 0===t?e.minPixelSize:e.minPixelSize*(1+2*e.paddingPixels/t)}function o(t,e){return Math.max((0,i.t7)(t*e.scale,t,e.factor),s(t,e))}function a(t,e,n,i){i.scale=function(t,e,n){const i=r(t,e,n);return i.minPixelSize=0,i.paddingPixels=0,o(1,i)}(t,e,n),i.factor=0,i.minPixelSize=n.parameters.minPixelSize,i.paddingPixels=n.paddingPixelsOverride}function c(t,e,n=[0,0]){const i=Math.min(Math.max(e.scale,s(t[1],e)/t[1]),1);return n[0]=t[0]*i,n[1]=t[1]*i,n}function u(t,e,n,i){return o(t,r(e,n,i))}(0,i.Vl)(10),(0,i.Vl)(12),(0,i.Vl)(70),(0,i.Vl)(40);const l={scale:0,factor:0,minPixelSize:0,paddingPixels:0}},30090:(t,e,n)=>{"use strict";n.d(e,{bj:()=>S,FZ:()=>I,Uf:()=>P,Bw:()=>h,LO:()=>A,Hx:()=>x});var i=n(59472),r=n(33655),s=n(77625),o=n(17387),a=n(69996),c=n(56469),u=n(49366),l=n(24379);const f=(0,a.Ue)(),d=c.Xt;function h(t,e,n,i,r,s,o){const a=(0,u.PD)(e),l=n.tolerance;if(!a)if(t.boundingInfo)(0,c.hu)("triangle"===t.data.primitiveType),m(t.boundingInfo,i,r,l,s,o);else{const e=t.getIndices(d.POSITION),n=t.getAttribute(d.POSITION);v(i,r,0,e.length/3,e,n,void 0,s,o)}}const g=(0,s.c)();function m(t,e,n,r,s,c){const u=function(t,e,n){return(0,o.s)(n,1/(e[0]-t[0]),1/(e[1]-t[1]),1/(e[2]-t[2]))}(e,n,g);if((0,a.op)(f,t.getBBMin()),(0,a.Tn)(f,t.getBBMax()),(0,i.pC)(s)&&s.applyToAabb(f),function(t,e,n,i){return function(t,e,n,i,r){const s=(t[0]-i-e[0])*n[0],o=(t[3]+i-e[0])*n[0];let a=Math.min(s,o),c=Math.max(s,o);const u=(t[1]-i-e[1])*n[1],l=(t[4]+i-e[1])*n[1];if(c=Math.min(c,Math.max(u,l)),c<0)return!1;if(a=Math.max(a,Math.min(u,l)),a>c)return!1;const f=(t[2]-i-e[2])*n[2],d=(t[5]+i-e[2])*n[2];return c=Math.min(c,Math.max(f,d)),!(c<0)&&(a=Math.max(a,Math.min(f,d)),!(a>c)&&a<r)}(t,e,n,i,1/0)}(f,e,u,r)){const i=t.getPrimitiveIndices(),o=t.getIndices(),a=t.getPosition(),u=i?i.length:o.length/3;if(u>w){const i=t.getChildren();if(void 0!==i){for(let t=0;t<8;++t)void 0!==i[t]&&m(i[t],e,n,r,s,c);return}}v(e,n,0,u,o,a,i,s,c)}}const b=2**-52,p=(0,s.c)();function v(t,e,n,r,s,o,a,c,u){if(a)return function(t,e,n,r,s,o,a,c,u){const{data:l,offsetIdx:f,strideIdx:d}=o,h=t[0],g=t[1],m=t[2],v=e[0]-h,_=e[1]-g,M=e[2]-m;for(let t=n;t<r;++t){const e=a[t];let n=3*e,r=f+d*s[n++],o=l[r++],x=l[r++],S=l[r];r=f+d*s[n++];let P=l[r++],A=l[r++],O=l[r];r=f+d*s[n];let I=l[r++],w=l[r++],T=l[r];(0,i.pC)(c)&&([o,x,S]=c.applyToVertex(o,x,S,t),[P,A,O]=c.applyToVertex(P,A,O,t),[I,w,T]=c.applyToVertex(I,w,T,t));const V=P-o,B=A-x,R=O-S,z=I-o,C=w-x,L=T-S,F=_*L-C*M,W=M*z-L*v,N=v*C-z*_,U=V*F+B*W+R*N;if(Math.abs(U)<=b)continue;const E=h-o,j=g-x,D=m-S,H=E*F+j*W+D*N;if(U>0){if(H<0||H>U)continue}else if(H>0||H<U)continue;const k=j*R-B*D,G=D*V-R*E,X=E*B-V*j,q=v*k+_*G+M*X;if(U>0){if(q<0||H+q>U)continue}else if(q>0||H+q<U)continue;const Z=(z*k+C*G+L*X)/U;Z>=0&&u(Z,y(V,B,R,z,C,L,p),e)}}(t,e,n,r,s,o,a,c,u);const{data:l,offsetIdx:f,strideIdx:d}=o,h=t[0],g=t[1],m=t[2],v=e[0]-h,_=e[1]-g,M=e[2]-m;for(let t=n,e=3*n;t<r;++t){let n=f+d*s[e++],r=l[n++],o=l[n++],a=l[n];n=f+d*s[e++];let x=l[n++],S=l[n++],P=l[n];n=f+d*s[e++];let A=l[n++],O=l[n++],I=l[n];(0,i.pC)(c)&&([r,o,a]=c.applyToVertex(r,o,a,t),[x,S,P]=c.applyToVertex(x,S,P,t),[A,O,I]=c.applyToVertex(A,O,I,t));const w=x-r,T=S-o,V=P-a,B=A-r,R=O-o,z=I-a,C=_*z-R*M,L=M*B-z*v,F=v*R-B*_,W=w*C+T*L+V*F;if(Math.abs(W)<=b)continue;const N=h-r,U=g-o,E=m-a,j=N*C+U*L+E*F;if(W>0){if(j<0||j>W)continue}else if(j>0||j<W)continue;const D=U*V-T*E,H=E*w-V*N,k=N*T-w*U,G=v*D+_*H+M*k;if(W>0){if(G<0||j+G>W)continue}else if(G>0||j+G<W)continue;const X=(B*D+R*H+z*k)/W;X>=0&&u(X,y(w,T,V,B,R,z,p),t)}}const _=(0,s.c)(),M=(0,s.c)();function y(t,e,n,i,r,s,a){return(0,o.s)(_,t,e,n),(0,o.s)(M,i,r,s),(0,o.c)(a,_,M),(0,o.n)(a,a),a}function x(t,e,n,i,s){let o=(n.screenLength||0)*t.pixelRatio;s&&(o=(0,l.bA)(o,i,e,s));const a=o*Math.tan(.5*t.fovY)/(.5*t.fullHeight);return(0,r.YU)(a*e,n.minWorldLength||0,null!=n.maxWorldLength?n.maxWorldLength:1/0)}function S(t,e,n){if(!t)return;const i=t.parameters,r=t.paddingPixelsOverride;e.setUniform4f(n,i.divisor,i.offset,i.minPixelSize,r)}function P(t,e){const n=e?P(e):{};for(const e in t){let i=t[e];i&&i.forEach&&(i=O(i)),null==i&&e in n||(n[e]=i)}return n}function A(t,e){let n=!1;for(const i in e){const r=e[i];void 0!==r&&(n=!0,Array.isArray(r)?t[i]=r.slice():t[i]=r)}return n}function O(t){const e=[];return t.forEach((t=>e.push(t))),e}const I={multiply:1,ignore:2,replace:3,tint:4},w=1e3},13405:(t,e,n)=>{"use strict";n.d(e,{SW:()=>a,Vs:()=>l,NK:()=>f,s5:()=>u,ho:()=>c});var i=n(12608),r=n(56469);function s(t,e,n,i,r){const s=n.typedBuffer,o=n.typedBufferStride,a=t.length;if(i*=o,null==r||1===r)for(let n=0;n<a;++n){const r=2*t[n];s[i]=e[r],s[i+1]=e[r+1],i+=o}else for(let n=0;n<a;++n){const a=2*t[n];for(let t=0;t<r;++t)s[i]=e[a],s[i+1]=e[a+1],i+=o}}function o(t,e,n,i,r){const s=n.typedBuffer,o=n.typedBufferStride,a=t.length;if(i*=o,null==r||1===r)for(let n=0;n<a;++n){const r=3*t[n];s[i]=e[r],s[i+1]=e[r+1],s[i+2]=e[r+2],i+=o}else for(let n=0;n<a;++n){const a=3*t[n];for(let t=0;t<r;++t)s[i]=e[a],s[i+1]=e[a+1],s[i+2]=e[a+2],i+=o}}function a(t,e,n,i,r){const s=n.typedBuffer,o=n.typedBufferStride,a=t.length;if(i*=o,null==r||1===r)for(let n=0;n<a;++n){const r=4*t[n];s[i]=e[r],s[i+1]=e[r+1],s[i+2]=e[r+2],s[i+3]=e[r+3],i+=o}else for(let n=0;n<a;++n){const a=4*t[n];for(let t=0;t<r;++t)s[i]=e[a],s[i+1]=e[a+1],s[i+2]=e[a+2],s[i+3]=e[a+3],i+=o}}function c(t,e,n,i,r,s){if(n){const o=n,a=i.typedBuffer,c=i.typedBufferStride,u=t.length;if(r*=c,null==s||1===s)for(let n=0;n<u;++n){const i=3*t[n],s=e[i],u=e[i+1],l=e[i+2];a[r]=o[0]*s+o[4]*u+o[8]*l+o[12],a[r+1]=o[1]*s+o[5]*u+o[9]*l+o[13],a[r+2]=o[2]*s+o[6]*u+o[10]*l+o[14],r+=c}else for(let n=0;n<u;++n){const i=3*t[n],u=e[i],l=e[i+1],f=e[i+2],d=o[0]*u+o[4]*l+o[8]*f+o[12],h=o[1]*u+o[5]*l+o[9]*f+o[13],g=o[2]*u+o[6]*l+o[10]*f+o[14];for(let t=0;t<s;++t)a[r]=d,a[r+1]=h,a[r+2]=g,r+=c}}else o(t,e,i,r,s)}function u(t,e,n,i,r,s){if(n){const o=n,a=i.typedBuffer,c=i.typedBufferStride,u=t.length,l=o[0],f=o[1],d=o[2],h=o[4],g=o[5],m=o[6],b=o[8],p=o[9],v=o[10],_=Math.abs(1-l*l+h*h+b*b)>1e-5||Math.abs(1-f*f+g*g+p*p)>1e-5||Math.abs(1-d*d+m*m+v*v)>1e-5;if(r*=c,null==s||1===s)for(let n=0;n<u;++n){const i=3*t[n],s=e[i],o=e[i+1],u=e[i+2];let M=l*s+h*o+b*u,y=f*s+g*o+p*u,x=d*s+m*o+v*u;if(_){const t=M*M+y*y+x*x;if(t<.999999&&t>1e-6){const e=Math.sqrt(t);M/=e,y/=e,x/=e}}a[r+0]=M,a[r+1]=y,a[r+2]=x,r+=c}else for(let n=0;n<u;++n){const i=3*t[n],o=e[i],u=e[i+1],M=e[i+2];let y=l*o+h*u+b*M,x=f*o+g*u+p*M,S=d*o+m*u+v*M;if(_){const t=y*y+x*x+S*S;if(t<.999999&&t>1e-6){const e=Math.sqrt(t);y/=e,x/=e,S/=e}}for(let t=0;t<s;++t)a[r+0]=y,a[r+1]=x,a[r+2]=S,r+=c}}else o(t,e,i,r,s)}function l(t,e,n,i,r,s){const o=i.typedBuffer,a=i.typedBufferStride,c=t.length;if(r*=a,null==s||1===s){if(4===n)for(let n=0;n<c;++n){const i=4*t[n];o[r]=e[i],o[r+1]=e[i+1],o[r+2]=e[i+2],o[r+3]=e[i+3],r+=a}else if(3===n)for(let n=0;n<c;++n){const i=3*t[n];o[r]=e[i],o[r+1]=e[i+1],o[r+2]=e[i+2],o[r+3]=255,r+=a}}else if(4===n)for(let n=0;n<c;++n){const i=4*t[n];for(let t=0;t<s;++t)o[r]=e[i],o[r+1]=e[i+1],o[r+2]=e[i+2],o[r+3]=e[i+3],r+=a}else if(3===n)for(let n=0;n<c;++n){const i=3*t[n];for(let t=0;t<s;++t)o[r]=e[i],o[r+1]=e[i+1],o[r+2]=e[i+2],o[r+3]=255,r+=a}}function f(t,e,n,o,f,d){for(const h of e.fieldNames){const e=t.vertexAttr[h],g=t.indices[h];if(e&&g)switch(h){case r.Xt.POSITION:{(0,r.hu)(3===e.size);const t=f.getField(h,i.ct);t&&c(g,e.data,n,t,d);break}case r.Xt.NORMAL:{(0,r.hu)(3===e.size);const t=f.getField(h,i.ct);t&&u(g,e.data,o,t,d);break}case r.Xt.UV0:{(0,r.hu)(2===e.size);const t=f.getField(h,i.Eu);t&&s(g,e.data,t,d);break}case r.Xt.UVMAPSPACE:{(0,r.hu)(4===e.size);const t=f.getField(h,i.ek);t&&a(g,e.data,t,d);break}case r.Xt.MEANVERTEXPOSITION:{(0,r.hu)(3===e.size);const t=f.getField(h,i.ct);t&&c(g,e.data,n,t,d);break}case r.Xt.BOUND1:case r.Xt.BOUND2:case r.Xt.BOUND3:{(0,r.hu)(3===e.size);const t=f.getField(h,i.ct);t&&c(g,e.data,n,t,d);break}case r.Xt.COLOR:{(0,r.hu)(3===e.size||4===e.size);const t=f.getField(h,i.mc);t&&l(g,e.data,e.size,t,d);break}case r.Xt.SYMBOLCOLOR:{(0,r.hu)(3===e.size||4===e.size);const t=f.getField(h,i.mc);t&&l(g,e.data,e.size,t,d);break}case r.Xt.TANGENT:{(0,r.hu)(4===e.size);const t=f.getField(h,i.ek);t&&a(g,e.data,t,d);break}}}}},49366:(t,e,n)=>{"use strict";n.d(e,{a9:()=>l,lr:()=>a,Wr:()=>d,PD:()=>u,BX:()=>f,U_:()=>c});var i=n(59472),r=n(67128),s=n(12811),o=n(56469);n(71061);function a(t,e){return(0,i.Wi)(t)&&(t=[]),t.push(e),t}function c(t,e){if((0,i.Wi)(t))return t;const n=t.filter((t=>t!==e));return 0===n.length?null:n}function u(t){return!!(0,i.pC)(t)&&!t.visible}function l(t,e){const n=new Map;return n.set(0,e.acquire(t,0)),n.set(1,e.acquire(t,7)),n.set(4,e.acquire(t,3)),n.set(3,e.acquire(t,2)),n.set(2,e.acquire(t,1)),n.set(5,e.acquire(t,4)),n}function f(t,e){e.release(t,0),e.release(t,7),e.release(t,3),e.release(t,2),e.release(t,1),e.release(t,4)}function d(t,e,n){const s=t.origin.vec3;(0,o.u_)(h,-s[0],-s[1],-s[2]),(0,i.pC)(t.transformation)?(0,r.m)(e,h,t.transformation):(0,r.c)(e,h),n&&((0,r.a)(n,e),(0,r.b)(n,n))}new Float64Array(3),new Float32Array(6);const h=(0,s.a)()}}]);
//# sourceMappingURL=6205.js.map