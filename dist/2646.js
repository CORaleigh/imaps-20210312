/*! For license information please see 2646.js.LICENSE.txt */
(self.webpackChunkimaps=self.webpackChunkimaps||[]).push([[2646],{94850:(e,t,i)=>{"use strict";i.r(t),i.d(t,{default:()=>V});var r,n=i(56140),o=(i(95830),i(36544)),a=i(79881),s=i(60263),l=i(87566),c=(i(10923),i(57002),i(86035),i(82677)),d=i(35470),u=i(22696),p=i(94588),h=i(82550),m=i(68055),y=i(60538),g=i(32656),f=i(39105),v=i(58385),b=i(28293),_=i(78745),w=i(3277),S=i(32105),C=i(809),I=i(1721),E=i(9870);let A=r=class extends v.wq{constructor(e){super(e),this.type="none"}clone(){return new r({type:this.type})}};var x;(0,n._)([(0,E.J)({none:"none",stayAbove:"stay-above"})],A.prototype,"type",void 0),A=r=(0,n._)([(0,l.j)("esri.ground.NavigationConstraint")],A);const T=o.Z.getLogger("esri.Ground");let L=x=class extends((0,v.eC)(C.Z)){constructor(e){super(e),this.opacity=1,this.surfaceColor=null,this.navigationConstraint=null,this.layers=new b.Z;const t=e=>{e.parent&&e.parent!==this&&"remove"in e.parent&&e.parent.remove(e),e.parent=this,"elevation"!==e.type&&"base-elevation"!==e.type&&T.error(`Layer '${e.title}, id:${e.id}' of type '${e.type}' is not supported as a ground layer and will therefore be ignored. Only layers of type 'elevation' are supported.`)};this.layers.on("after-add",(e=>t(e.item))),this.layers.on("after-remove",(e=>(e=>{e.parent=null})(e.item)))}initialize(){this.when().catch((e=>{T.error("#load()","Failed to load ground",e)})),this.resourceInfo&&this.read(this.resourceInfo.data,this.resourceInfo.context)}destroy(){const e=this.layers.removeAll();for(const t of e)t.destroy();this.layers.destroy()}normalizeCtorArgs(e){return e&&"resourceInfo"in e&&(this._set("resourceInfo",e.resourceInfo),delete(e={...e}).resourceInfo),e}set layers(e){this._set("layers",(0,S.Z)(e,this._get("layers")))}writeLayers(e,t,i,r){const n=[];e?(r={...r,layerContainerType:"ground"},e.forEach((e=>{if("write"in e){const t={};(0,p.sM)(e)().write(t,r)&&n.push(t)}else r&&r.messages&&r.messages.push(new g.Z("layer:unsupported",`Layers (${e.title}, ${e.id}) of type '${e.declaredClass}' cannot be persisted in the ground`,{layer:e}))})),t.layers=n):t.layers=n}load(e){return this.addResolvingPromise(this._loadFromSource(e)),Promise.resolve(this)}loadAll(){return(0,I.GZ)(this,(e=>{e(this.layers)}))}async queryElevation(e,t){await this.load({signal:null==t?void 0:t.signal});const{ElevationQuery:r}=await Promise.all([i.e(8157),i.e(7333),i.e(3549)]).then(i.bind(i,93549));(0,f.throwIfAborted)(t);const n=new r,o=this.layers.filter(O).toArray();return n.queryAll(o,e,t)}async createElevationSampler(e,t){await this.load({signal:null==t?void 0:t.signal});const{ElevationQuery:r}=await Promise.all([i.e(8157),i.e(7333),i.e(3549)]).then(i.bind(i,93549));(0,f.throwIfAborted)(t);const n=new r,o=this.layers.filter(O).toArray();return n.createSamplerAll(o,e,t)}clone(){const e={opacity:this.opacity,surfaceColor:(0,h.d9)(this.surfaceColor),navigationConstraint:(0,h.d9)(this.navigationConstraint),layers:this.layers.slice()};return this.loaded&&(e.loadStatus="loaded"),new x({resourceInfo:this.resourceInfo}).set(e)}read(e,t){this.resourceInfo||this._set("resourceInfo",{data:e,context:t}),super.read(e,t)}_loadFromSource(e){const t=this.resourceInfo;return t?this._loadLayersFromJSON(t.data,t.context,e):Promise.resolve(null)}_loadLayersFromJSON(e,t,r){const n=t&&t.origin||"web-scene",o=t&&t.portal||null,a=t&&t.url||null;return i.e(7254).then(i.bind(i,87254)).then((({populateOperationalLayers:t})=>{(0,f.throwIfAborted)(r);const i=[];if(e.layers&&Array.isArray(e.layers)){const r={context:{origin:n,url:a,portal:o,layerContainerType:"ground"},defaultLayerType:"ArcGISTiledElevationServiceLayer"};i.push(t(this.layers,e.layers,r))}return(0,f.eachAlways)(i)})).then((()=>{}))}};function O(e){return"elevation"===e.type||function(e){return e&&"createElevationSampler"in e}(e)}(0,n._)([(0,a.Cb)({json:{read:!1}})],L.prototype,"layers",null),(0,n._)([(0,y.c)("layers")],L.prototype,"writeLayers",null),(0,n._)([(0,a.Cb)({readOnly:!0})],L.prototype,"resourceInfo",void 0),(0,n._)([(0,a.Cb)({type:Number,nonNullable:!0,range:{min:0,max:1},json:{type:m.z8,read:{reader:w.b,source:"transparency"},write:{writer:(e,t)=>{t.transparency=(0,w.a)(e)},target:"transparency"}}})],L.prototype,"opacity",void 0),(0,n._)([(0,a.Cb)({type:_.default,json:{type:[m.z8],write:(e,t)=>{t.surfaceColor=e.toJSON().slice(0,3)}}})],L.prototype,"surfaceColor",void 0),(0,n._)([(0,a.Cb)({type:A,json:{write:!0}})],L.prototype,"navigationConstraint",void 0),L=x=(0,n._)([(0,l.j)("esri.Ground")],L);const M=L;var P=i(78452),j=i(80882);const N=o.Z.getLogger("esri.support.groundUtils"),D={"world-elevation":{id:"worldElevation",url:"//elevation3d.arcgis.com/arcgis/rest/services/WorldElevation3D/Terrain3D/ImageServer",layerType:"ArcGISTiledElevationServiceLayer"},"world-topobathymetry":{id:"worldTopoBathymetry",url:"//elevation3d.arcgis.com/arcgis/rest/services/WorldElevation3D/TopoBathy3D/ImageServer",layerType:"ArcGISTiledElevationServiceLayer"}};var R=i(90921),k=i(16137);const F=o.Z.getLogger("esri.Map");let Z=class extends((0,k.Q)((0,R.K)(d.Z.EventedMixin(c.default)))){constructor(e){super(e),this.allLayers=new P.Z({root:this,rootCollectionNames:["basemap.baseLayers","ground.layers","layers","basemap.referenceLayers"],getChildrenFunction:e=>e.layers}),this.allTables=this._createTablesFlattener(this),this.basemap=null,this.ground=new M,this._basemapCache=(0,j.Df)()}destroy(){var e,t;this.allLayers.destroy(),this.allTables.destroy(),null==(e=this.ground)||e.destroy(),null==(t=this.basemap)||t.destroy(),(0,j.Bf)(this._basemapCache),this._basemapCache=null}castBasemap(e){return(0,j.se)(e,this._basemapCache)}castGround(e){return function(e){let t;"string"==typeof e?e in D?t=new M({resourceInfo:{data:{layers:[D[e]]}}}):N.warn(`Unable to find ground definition for: ${e}. Try "world-elevation"`):t=(0,m.se)(M,e);return t}(e)||(F.error("Map.ground may not be set to null or undefined"),this._get("ground"))}findLayerById(e){return this.allLayers.find((t=>t.id===e))}findTableById(e){return this.allTables.find((t=>t.id===e))}_createTablesFlattener(e){return new P.Z({root:e,rootCollectionNames:["tables","layers"],getChildrenFunction:e=>e&&"group"===e.type?this._createTablesFlattener(e):null,itemFilterFunction:e=>this._isMapOrGroupLayer(e.parent)&&e.parent.tables.includes(e)})}_isMapOrGroupLayer(e){return e&&(e===this||this._isGroupLayer(e))}_isGroupLayer(e){return e&&"group"===e.type}};(0,n._)([(0,a.Cb)({readOnly:!0,dependsOn:[]})],Z.prototype,"allLayers",void 0),(0,n._)([(0,a.Cb)({readOnly:!0})],Z.prototype,"allTables",void 0),(0,n._)([(0,a.Cb)({type:u.default})],Z.prototype,"basemap",void 0),(0,n._)([(0,s.p)("basemap")],Z.prototype,"castBasemap",null),(0,n._)([(0,a.Cb)({type:M,nonNullable:!0})],Z.prototype,"ground",void 0),(0,n._)([(0,s.p)("ground")],Z.prototype,"castGround",null),Z=(0,n._)([(0,l.j)("esri.Map")],Z);const V=Z},65984:(e,t,i)=>{"use strict";i.d(t,{Z:()=>C});var r,n=i(56140),o=(i(95830),i(59472)),a=(i(36544),i(79881)),s=i(60263),l=i(87566),c=(i(10923),i(57002),i(86035),i(58385)),d=i(56885),u=i(36348),p=i(68055),h=i(30590),m=i(60538),y=i(61106),g=i(33655),f=i(17154);let v=r=class extends c.wq{constructor(...e){super(...e),this.position=new y.Z([0,0,0]),this.heading=0,this.tilt=0,this.fov=55}normalizeCtorArgs(e,t,i,r){if(e&&"object"==typeof e&&("x"in e||Array.isArray(e))){const n={position:e};return null!=t&&(n.heading=t),null!=i&&(n.tilt=i),null!=r&&(n.fov=r),n}return e}writePosition(e,t,i,r){const n=e.clone();n.x=(0,p.q9)(e.x||0),n.y=(0,p.q9)(e.y||0),n.z=e.hasZ?(0,p.q9)(e.z||0):e.z,t[i]=n.write(null,r)}readPosition(e,t){const i=new y.Z;return i.read(e,t),i.x=(0,p.q9)(i.x||0),i.y=(0,p.q9)(i.y||0),i.z=i.hasZ?(0,p.q9)(i.z||0):i.z,i}equals(e){return!!e&&this.tilt===e.tilt&&this.heading===e.heading&&this.fov===e.fov&&this.position.equals(e.position)}clone(){return new r({position:this.position.clone(),heading:this.heading,tilt:this.tilt,fov:this.fov})}};(0,n._)([(0,a.Cb)({type:y.Z,json:{write:{isRequired:!0}}})],v.prototype,"position",void 0),(0,n._)([(0,m.c)("position")],v.prototype,"writePosition",null),(0,n._)([(0,h.r)("position")],v.prototype,"readPosition",null),(0,n._)([(0,a.Cb)({type:Number,nonNullable:!0,json:{write:{isRequired:!0}}}),(0,s.p)((e=>f.LU.normalize((0,p.q9)(e))))],v.prototype,"heading",void 0),(0,n._)([(0,a.Cb)({type:Number,nonNullable:!0,json:{write:{isRequired:!0}}}),(0,s.p)((e=>(0,g.uZ)((0,p.q9)(e),-180,180)))],v.prototype,"tilt",void 0),(0,n._)([(0,a.Cb)({type:Number,nonNullable:!0,json:{read:!1,write:!1}})],v.prototype,"fov",void 0),v=r=(0,n._)([(0,l.j)("esri.Camera")],v);const b=v;var _;let w=_=class extends c.wq{constructor(e){super(e),this.rotation=0,this.scale=0,this.targetGeometry=null,this.camera=null}castRotation(e){return(e%=360)<0&&(e+=360),e}clone(){return new _({rotation:this.rotation,scale:this.scale,targetGeometry:(0,o.pC)(this.targetGeometry)?this.targetGeometry.clone():null,camera:(0,o.pC)(this.camera)?this.camera.clone():null})}};function S(){return{enabled:!this.camera}}(0,n._)([(0,a.Cb)({type:Number,json:{write:!0,origins:{"web-map":{default:0,write:!0},"web-scene":{write:{overridePolicy:S}}}}})],w.prototype,"rotation",void 0),(0,n._)([(0,s.p)("rotation")],w.prototype,"castRotation",null),(0,n._)([(0,a.Cb)({type:Number,json:{write:!0,origins:{"web-map":{default:0,write:!0},"web-scene":{write:{overridePolicy:S}}}}})],w.prototype,"scale",void 0),(0,n._)([(0,a.Cb)({types:u.qM,json:{read:d.im,write:!0,origins:{"web-scene":{read:d.im,write:{overridePolicy:S}}}}})],w.prototype,"targetGeometry",void 0),(0,n._)([(0,a.Cb)({type:b,json:{write:!0}})],w.prototype,"camera",void 0),w=_=(0,n._)([(0,l.j)("esri.Viewpoint")],w);const C=w},76910:(e,t,i)=>{"use strict";i.r(t),i.d(t,{default:()=>Ke});var r,n=i(56140),o=(i(95830),i(59472)),a=i(36544),s=i(68055),l=i(79881),c=i(30590),d=i(87566),u=i(60538),p=i(32656),h=i(10923),m=(i(57002),i(86035),i(19677)),y=i(39105),g=i(17771),f=i(73032),v=i(41241),b=i(28293),_=i(23838),w=i(75044),S=i(809),C=i(32797),I=i(1721),E=i(80192),A=i(87837),x=i(80882),T=i(94850),L=i(65984),O=i(43072),M=i(80621),P=i(28885),j=i(97849),N=i(62646),D=i(52411),R=i(82550),k=i(58385);let F=r=class extends k.wq{constructor(e){super(e),this.activeRange=null,this.currentRangeExtent=null,this.fullRangeExtent=null}clone(){return new r((0,R.d9)({activeRange:this.activeRange,currentRangeExtent:this.currentRangeExtent,fullRangeExtent:this.fullRangeExtent}))}};(0,n._)([(0,l.Cb)({type:String,nonNullable:!0,json:{read:{source:"activeRangeName"},write:{target:"activeRangeName",isRequired:!0}}})],F.prototype,"activeRange",void 0),(0,n._)([(0,l.Cb)({type:[Number],json:{write:!0}})],F.prototype,"currentRangeExtent",void 0),(0,n._)([(0,l.Cb)({type:[Number],json:{write:!0}})],F.prototype,"fullRangeExtent",void 0),F=r=(0,n._)([(0,d.j)("esri.webdoc.RangeInfo")],F);const Z=F;var V;const B=new(i(56274).Xn)({slider:"slider",picker:"picker"});let W=V=class extends k.wq{constructor(e){super(e),this.interactionMode=null,this.numStops=null,this.stopInterval=null}clone(){return new V({interactionMode:this.interactionMode,numStops:this.numStops,stopInterval:this.stopInterval})}};(0,n._)([(0,l.Cb)({type:B.apiValues,nonNullable:!0,json:{type:B.jsonValues,default:null,read:{reader:B.read},write:{isRequired:!0,writer:B.write}}})],W.prototype,"interactionMode",void 0),(0,n._)([(0,l.Cb)({type:Number,json:{read:{source:"numberOfStops"},write:{target:"numberOfStops",overridePolicy(){const e=null!=this.stopInterval;return{enabled:!e,isRequired:!e}}}}})],W.prototype,"numStops",void 0),(0,n._)([(0,l.Cb)({type:Number,json:{write:{overridePolicy(){return{isRequired:null==this.numStops}}}}})],W.prototype,"stopInterval",void 0),W=V=(0,n._)([(0,d.j)("esri.webdoc.widgets.Range")],W);const U=W;var q,$=i(10103),G=i(87864),z=i(40522);let X=q=class extends k.wq{constructor(e){super(e),this.currentTimeExtent=null,this.fullTimeExtent=null,this.loop=!1,this.numStops=null,this.numThumbs=null,this.stopDelay=null,this.stopInterval=null,this.stops=null}readCurrentTimeExtent(e){if(!e)return;const t=null!=e[0]?new Date(e[0]):null,i=null!=e[1]?new Date(e[1]):null;return new G.Z({start:t,end:i})}writeCurrentTimeExtent(e,t,i){e&&(0,$.RB)(i,[e.start?e.start.getTime():null,e.end?e.end.getTime():null],t)}readFullTimeExtent(e,t){const i=t.properties;if(!i)return;const r=null!=i.endTime?new Date(i.endTime):null,n=null!=i.startTime?new Date(i.startTime):null;return new G.Z({start:n,end:r})}writeFullTimeExtent(e,t){if(!e)return;const i=t.properties=t.properties||{},r=e.end,n=e.start;r&&(i.endTime=r?r.getTime():null),n&&(i.startTime=n?n.getTime():null)}readStopInterval(e,t,i){return e?z.Z.fromJSON({value:e.interval,unit:e.units},i):null}writeStopInterval(e,t,i,r){if(!e)return;const n=e.toJSON(r);(0,$.RB)(i,{interval:n.value,units:n.unit},t)}readStops(e){return e&&e.length?e.map((e=>new Date(e))):null}writeStops(e,t,i){e&&e.length&&(0,$.RB)(i,e.map((e=>e.getTime())),t)}clone(){return new q((0,R.d9)({currentTimeExtent:this.currentTimeExtent,fullTimeExtent:this.fullTimeExtent,loop:this.loop,numStops:this.numStops,numThumbs:this.numThumbs,stopDelay:this.stopDelay,stopInterval:this.stopInterval,stops:this.stops}))}};(0,n._)([(0,l.Cb)({type:G.Z,json:{read:{source:"properties.currentTimeExtent"},write:{target:"properties.currentTimeExtent"}}})],X.prototype,"currentTimeExtent",void 0),(0,n._)([(0,c.r)("currentTimeExtent")],X.prototype,"readCurrentTimeExtent",null),(0,n._)([(0,u.c)("currentTimeExtent")],X.prototype,"writeCurrentTimeExtent",null),(0,n._)([(0,l.Cb)({type:G.Z,json:{read:{source:["properties.endTime","properties.startTime"]},write:{target:{"properties.endTime":{type:Number},"properties.startTime":{type:Number}}}}})],X.prototype,"fullTimeExtent",void 0),(0,n._)([(0,c.r)("fullTimeExtent")],X.prototype,"readFullTimeExtent",null),(0,n._)([(0,u.c)("fullTimeExtent")],X.prototype,"writeFullTimeExtent",null),(0,n._)([(0,l.Cb)({type:Boolean,nonNullable:!0,json:{default:!1,read:{source:"properties.loop"},write:{target:"properties.loop"}}})],X.prototype,"loop",void 0),(0,n._)([(0,l.Cb)({type:Number,json:{read:{source:"properties.numberOfStops"},write:{target:"properties.numberOfStops",overridePolicy(){var e;const t=!!this.stopInterval,i=!(null==(e=this.stops)||!e.length),r=!(t||i);return{enabled:r,isRequired:r}}}}})],X.prototype,"numStops",void 0),(0,n._)([(0,l.Cb)({type:[1,2],nonNullable:!0,json:{read:{source:"properties.thumbCount"},write:{target:"properties.thumbCount",isRequired:!0}}})],X.prototype,"numThumbs",void 0),(0,n._)([(0,l.Cb)({type:Number,nonNullable:!0,json:{read:{source:"properties.thumbMovingRate"},write:{target:"properties.thumbMovingRate",isRequired:!0}}})],X.prototype,"stopDelay",void 0),(0,n._)([(0,l.Cb)({type:z.Z,json:{read:{source:"properties.timeStopInterval"},write:{target:"properties.timeStopInterval",overridePolicy(){var e;const t=null!=this.numStops,i=!(null==(e=this.stops)||!e.length);return{enabled:!i,isRequired:!(t||i)}}}}})],X.prototype,"stopInterval",void 0),(0,n._)([(0,c.r)("stopInterval")],X.prototype,"readStopInterval",null),(0,n._)([(0,u.c)("stopInterval")],X.prototype,"writeStopInterval",null),(0,n._)([(0,l.Cb)({type:[Date],json:{read:{source:"properties.stops"},write:{target:"properties.stops",overridePolicy(){return{isRequired:null==this.numStops&&!this.stopInterval}}}}})],X.prototype,"stops",void 0),(0,n._)([(0,c.r)("stops")],X.prototype,"readStops",null),(0,n._)([(0,u.c)("stops")],X.prototype,"writeStops",null),X=q=(0,n._)([(0,d.j)("esri.webdoc.widgets.TimeSlider")],X);const H=X;var J;let Y=J=class extends k.wq{constructor(e){super(e),this.range=null,this.timeSlider=null}clone(){return new J((0,R.d9)({range:this.range,timeSlider:this.timeSlider}))}};(0,n._)([(0,l.Cb)({type:U,json:{write:!0}})],Y.prototype,"range",void 0),(0,n._)([(0,l.Cb)({type:H,json:{write:!0}})],Y.prototype,"timeSlider",void 0),Y=J=(0,n._)([(0,d.j)("esri.webdoc.Widgets")],Y);const K=Y,Q={width:600,height:400},ee=1.5;function te(e,t){t=t||Q;let{width:i,height:r}=t;const n=i/r;return n<ee?r=i/ee:n>ee&&(i=r*ee),i>e.width&&(r*=e.width/i,i=e.width),r>e.height&&(i*=e.height/r,r=e.height),{width:Math.round(i),height:Math.round(r)}}function ie(e){return{enabled:!(null==e||!e.length)}}var re,ne=i(9870),oe=i(88210);let ae=re=class extends k.wq{constructor(e){super(e),this.exactMatch=!1,this.name=null,this.type=null}clone(){return new re({exactMatch:this.exactMatch,type:this.type,name:this.name})}};(0,n._)([(0,l.Cb)({type:Boolean,json:{write:!0}})],ae.prototype,"exactMatch",void 0),(0,n._)([(0,l.Cb)({type:String,json:{write:!0}})],ae.prototype,"name",void 0),(0,n._)([(0,ne.J)(oe.v)],ae.prototype,"type",void 0),ae=re=(0,n._)([(0,d.j)("esri.webdoc.applicationProperties.SearchLayerField")],ae);const se=ae;var le;let ce=le=class extends k.wq{constructor(e){super(e),this.field=null,this.id=null,this.subLayer=null}clone(){return new le((0,R.d9)({field:this.field,id:this.id,subLayer:this.subLayer}))}};(0,n._)([(0,l.Cb)({type:se,json:{write:{isRequired:!0}}})],ce.prototype,"field",void 0),(0,n._)([(0,l.Cb)({type:String,json:{write:{isRequired:!0}}})],ce.prototype,"id",void 0),(0,n._)([(0,l.Cb)({type:s.z8,json:{write:!0}})],ce.prototype,"subLayer",void 0),ce=le=(0,n._)([(0,d.j)("esri.webdoc.applicationProperties.SearchLayer")],ce);const de=ce;var ue;let pe=ue=class extends k.wq{constructor(e){super(e),this.exactMatch=!1,this.name=null,this.type=null}clone(){return new ue({exactMatch:this.exactMatch,type:this.type,name:this.name})}};(0,n._)([(0,l.Cb)({type:Boolean,json:{write:!0}})],pe.prototype,"exactMatch",void 0),(0,n._)([(0,l.Cb)({type:String,json:{write:!0}})],pe.prototype,"name",void 0),(0,n._)([(0,ne.J)(oe.v)],pe.prototype,"type",void 0),pe=ue=(0,n._)([(0,d.j)("esri.webdoc.applicationProperties.SearchTableField")],pe);const he=pe;var me;let ye=me=class extends k.wq{constructor(e){super(e),this.field=null,this.id=null}clone(){return new me((0,R.d9)({field:this.field,id:this.id}))}};(0,n._)([(0,l.Cb)({type:he,json:{write:{isRequired:!0}}})],ye.prototype,"field",void 0),(0,n._)([(0,l.Cb)({type:String,json:{write:{isRequired:!0}}})],ye.prototype,"id",void 0),ye=me=(0,n._)([(0,d.j)("esri.webdoc.applicationProperties.SearchTable")],ye);const ge=ye;var fe;const ve=b.Z.ofType(de),be=b.Z.ofType(ge);let _e=fe=class extends k.wq{constructor(e){super(e),this.addressSearchEnabled=!0,this.enabled=!0,this.hintText=null,this.layers=new ve,this.tables=new be}readAddressSearchEnabled(e){return!e}writeAddressSearchEnabled(e,t,i){t[i]=!e}clone(){return new fe((0,R.d9)({addressSearchEnabled:this.addressSearchEnabled,enabled:this.enabled,hintText:this.hintText,layers:this.layers,tables:this.tables}))}};(0,n._)([(0,l.Cb)({type:Boolean,json:{read:{source:"disablePlaceFinder"},write:{target:"disablePlaceFinder"},default:!0,origins:{"web-scene":{read:!1,write:!1}}}})],_e.prototype,"addressSearchEnabled",void 0),(0,n._)([(0,c.r)("addressSearchEnabled")],_e.prototype,"readAddressSearchEnabled",null),(0,n._)([(0,u.c)("addressSearchEnabled")],_e.prototype,"writeAddressSearchEnabled",null),(0,n._)([(0,l.Cb)({type:Boolean,json:{write:!0,default:!0}})],_e.prototype,"enabled",void 0),(0,n._)([(0,l.Cb)({type:String,json:{write:!0}})],_e.prototype,"hintText",void 0),(0,n._)([(0,l.Cb)({type:ve,json:{write:{overridePolicy:ie},origins:{"web-scene":{write:{isRequired:!0}}}}})],_e.prototype,"layers",void 0),(0,n._)([(0,l.Cb)({type:be,json:{read:!0,write:{overridePolicy:ie},origins:{"web-scene":{read:!1,write:!1}}}})],_e.prototype,"tables",void 0),_e=fe=(0,n._)([(0,d.j)("esri.webdoc.applicationProperties.Search")],_e);const we=_e;var Se;let Ce=Se=class extends k.wq{constructor(e){super(e),this.search=null}clone(){return new Se((0,R.d9)({search:this.search}))}};(0,n._)([(0,l.Cb)({type:we,json:{write:!0}})],Ce.prototype,"search",void 0),Ce=Se=(0,n._)([(0,d.j)("esri.webdoc.applicationProperties.Viewing")],Ce);const Ie=Ce;var Ee;let Ae=Ee=class extends k.wq{constructor(e){super(e),this.editing=null,this.offline=null,this.viewing=null}clone(){return new Ee((0,R.d9)({editing:this.editing,offline:this.offline,viewing:this.viewing}))}};(0,n._)([(0,l.Cb)({json:{write:!0}})],Ae.prototype,"editing",void 0),(0,n._)([(0,l.Cb)({json:{write:!0}})],Ae.prototype,"offline",void 0),(0,n._)([(0,l.Cb)({type:Ie,json:{write:!0}})],Ae.prototype,"viewing",void 0),Ae=Ee=(0,n._)([(0,d.j)("esri.webmap.ApplicationProperties")],Ae);const xe=Ae;var Te,Le=i(65892),Oe=i(29155),Me=i(82677);let Pe=Te=class extends Me.default{constructor(e){super(e),this.background=null,this.rangeInfo=null,this.spatialReference=null,this.viewpoint=null}clone(){return new Te((0,R.d9)({background:this.background,rangeInfo:this.rangeInfo,spatialReference:this.spatialReference,viewpoint:this.viewpoint}))}};(0,n._)([(0,l.Cb)({type:Oe.Z})],Pe.prototype,"background",void 0),(0,n._)([(0,l.Cb)({type:Z})],Pe.prototype,"rangeInfo",void 0),(0,n._)([(0,l.Cb)({type:f.Z})],Pe.prototype,"spatialReference",void 0),(0,n._)([(0,l.Cb)({type:L.Z})],Pe.prototype,"viewpoint",void 0),Pe=Te=(0,n._)([(0,d.j)("esri.webmap.InitialViewProperties")],Pe);const je=Pe;var Ne=i(34175);class De extends Ne.G{constructor(e,t){super(e,t,"webmap")}}const Re=new De(2,19),ke="Web Map",Fe=b.Z.ofType(Le.Z),Ze=a.Z.getLogger("esri.WebMap"),Ve=new Map;Ve.set("image/jpeg","jpeg"),Ve.set("image/jpg","jpg"),Ve.set("image/png","png"),Ve.set("image/gif","gif");const Be="CollectorDisabled",We="Collector",Ue="Data Editing",qe="OfflineDisabled",$e="Offline",Ge="Workforce Project",ze="Workforce Worker",Xe="Workforce Dispatcher",He="DeveloperBasemap",Je=["NatGeo_World_Map","Ocean_Basemap","USA_Topo_Maps","World_Imagery","World_Street_Map","World_Terrain_Base","World_Topo_Map","World_Hillshade","Canvas/World_Light_Gray_Base","Canvas/World_Light_Gray_Reference","Canvas/World_Dark_Gray_Base","Canvas/World_Dark_Gray_Reference","Ocean/World_Ocean_Base","Ocean/World_Ocean_Reference","Reference/World_Boundaries_and_Places","Reference/World_Reference_Overlay","Reference/World_Transportation"].map((e=>e.toLowerCase()));let Ye=class extends((0,O.R)(S.Z.LoadableMixin((0,w.v)(T.default)))){constructor(e){super(e),this.applicationProperties=null,this.bookmarks=new Fe,this.initialViewProperties=new je,this.portalItem=null,this.presentation=null,this.sourceVersion=null,this.widgets=null,this.authoringApp=this.authoringAppVersion=null,this._isAuthoringAppSetByUser=this._isAuthoringAppVersionSetByUser=!1}destroy(){const e=this.portalItem;this.portalItem=null,null==e||e.destroy()}initialize(){if(this.when().catch((e=>{Ze.error("#load()","Failed to load web map",e)})),this.resourceInfo){let e;try{e=this._validateJSON(this.resourceInfo)}catch(e){return void this.addResolvingPromise(Promise.reject(e))}this.read(e)}}set authoringApp(e){this._isAuthoringAppSetByUser=!0,this._set("authoringApp",e)}writeAuthoringApp(e,t){e&&this._isAuthoringAppSetByUser?t.authoringApp=e:t.authoringApp="ArcGIS API for JavaScript"}set authoringAppVersion(e){this._isAuthoringAppVersionSetByUser=!0,this._set("authoringAppVersion",e)}writeAuthoringAppVersion(e,t){e&&this._isAuthoringAppVersionSetByUser?t.authoringAppVersion=e:t.authoringAppVersion=_.i8}readInitialViewProperties(e,t){const i=new je;return t.background&&(i.background=Oe.Z.fromJSON(t.background)),t.initialState&&t.initialState.viewpoint&&(i.viewpoint=L.Z.fromJSON(t.initialState.viewpoint)),t.mapRangeInfo&&(i.rangeInfo=Z.fromJSON(t.mapRangeInfo)),t.spatialReference&&(i.spatialReference=f.Z.fromJSON(t.spatialReference)),i}writeInitialViewProperties(e,t,i,r){if(!e)return;const n=e.background;n&&n.color&&(t.background=n.write(null,r)),e.viewpoint&&(t.initialState={viewpoint:e.viewpoint.write(null,r)}),e.rangeInfo&&(t.mapRangeInfo=e.rangeInfo.toJSON(r)),e.spatialReference&&(t.spatialReference=e.spatialReference.write(null,r))}writeLayers(e,t,i,r){t[i]=this._writeLayers(e,r,"operational-layers")}readSourceVersion(e,t){const[i,r]=t.version.split(".");return new De(parseInt(i,10),parseInt(r,10))}writeSourceVersion(e,t,i){t[i]=`${Re.major}.${Re.minor}`}writeTables(e,t,i,r){const n=this._writeLayers(e,r,"tables");n.length&&(t[i]=n)}get thumbnailUrl(){return this.portalItem&&this.portalItem.thumbnailUrl||null}set thumbnailUrl(e){e?(this._override("thumbnailUrl",e),this._thumbnailFilename=this._generateCustomThumbnailFilename(e)):this._clearThumbnailOverride()}load(e){return this.addResolvingPromise(this._loadFromSource()),Promise.resolve(this)}loadAll(){return(0,I.GZ)(this,(e=>{e(this.ground,this.basemap,this.layers,this.tables)}))}read(e,t){t={...t,origin:"web-map"};const i=this._getAuthoringPropsState();(0,g.$Z)(this,e,(t=>super.read(e,t)),t),this._restoreAuthoringPropsFromState(i)}write(e,t){if("loaded"!==this.loadStatus){const e=new p.Z("webmap:not-loaded","Web map must be loaded before it can be serialized");throw Ze.error("#toJSON()","Web map must be loaded before it can be serialized",this.loadError||this.loadStatus),e}return this._removeDanglingLayerRefs(),t={...t,origin:"web-map",restrictedWebMapWriting:!0,webmap:this},super.write(e,t)}async save(e){e=e||{},this._validateItem(),await this._updateFromPromise,await this.load(),await this._loadLayerContainers(),this._validateMap();const t=this.portalItem,i={origin:"web-map",messages:[],writtenProperties:[],url:t.itemUrl&&(0,h.mN)(t.itemUrl),portal:t.portal||C.Z.getDefault()},r=this.write(null,i);return this._validateJSONForWriting(i,e),await this._updateItemProperties(t),await this._updateItem(t,r,i),await this._updateItemThumbnail(),t}async saveAs(e,t){t=t||{};const i=this._getPortalItem(e);await this._updateFromPromise,await this.load(),await this._loadLayerContainers(),this._validateMap();const r={origin:"web-map",messages:[],writtenProperties:[],url:null,portal:i.portal},n=this.write(null,r);this._validateJSONForWriting(r,t),await this._updateItemPropertiesForSaveAs(i);const o=this._getThumbnailState();return await this._createItem(i,n,r,t),this._restoreThumbnailFromState(o),await this._updateItemThumbnail(),i}async updateFrom(e,t){const i=this._updateFromInternal(e,t);this._updateFromPromise=i,await i,i===this._updateFromPromise&&(this._updateFromPromise=null)}getLayerJSONFromResourceInfo(e){var t,i,r,n;const o=this.resourceInfo;return this._collectAllLayersJSON((0,m.xH)([null==o||null==(t=o.baseMap)?void 0:t.baseMapLayers,null==o?void 0:o.operationalLayers,null==(i=this.basemap)||null==(r=i.resourceInfo)||null==(n=r.data)?void 0:n.baseMapLayers])).find((t=>t.id===e.id))}_collectAllLayersJSON(e){return e.reduce(((e,t)=>(e.push(t),"GroupLayer"===t.layerType&&(e=e.concat(this._collectAllLayersJSON(t.layers||[]))),e)),[])}_writeLayers(e,t,i){return t={...t,layerContainerType:i},e.map((e=>(0,o.Wg)((0,A.Nw)(e,"tables"===i?null:this.getLayerJSONFromResourceInfo(e),t)))).filter(Boolean).toArray()}_loadFromSource(){return this.resourceInfo?this._loadFromJSON(this.resourceInfo,{origin:"web-map"}):this.portalItem&&this.portalItem.id?this._loadFromItem(this.portalItem):Promise.resolve(null)}_loadFromItem(e){return e.load().catch((e=>{throw new p.Z("webmap:load-portal-item","Failed to load portal item",{error:e})})).then((()=>{if("Web Map"!==e.type)throw new p.Z("webmap:invalid-portal-item","Invalid portal item type '${type}', expected 'Web Map'",{type:e.type})})).then((()=>e.fetchData())).then((t=>(this.resourceInfo=t,this._readAndLoadFromJSON(t,{origin:"web-map",portal:e.portal||C.Z.getDefault()})))).then((()=>this._computeInitialViewpoint()))}_readAndLoadFromJSON(e,t){const i=this._validateJSON(e);return this.read(i,t),this._loadFromJSON(i,t)}_validateJSON(e){const t=De.parse(e.version||"","webmap");return Re.validate(t),e.version=`${t.major}.${t.minor}`,e}_loadFromJSON(e,t){const r={context:{...t,layerContainerType:"operational-layers"}};return this.portalItem&&(r.context.portal=this.portalItem.portal||C.Z.getDefault()),i.e(8756).then(i.bind(i,87254)).then((({populateOperationalLayers:t})=>{const i=[],n=e.operationalLayers;n&&n.length&&i.push(t(this.layers,n,r));const o={...r,context:{...r.context,layerContainerType:"tables"},defaultLayerType:"ArcGISFeatureLayer"},a=e.tables;return a&&a.length&&i.push(t(this.tables,a,o)),(0,y.eachAlways)(i).then((()=>{}))}))}async _computeInitialViewpoint(){var e,t;let i=this.initialViewProperties;if(null==(e=i)||null==(t=e.viewpoint)?void 0:t.targetGeometry)return;const r=await this._getExtentFromItem();r&&(i=i?i.clone():new je,i.viewpoint=new L.Z,i.viewpoint.targetGeometry=r,this.initialViewProperties=i)}async _getExtentFromItem(){var e,t;const r=null==(e=this.initialViewProperties)?void 0:e.spatialReference,n=null==(t=this.portalItem)?void 0:t.extent;return r&&n?r.isWGS84?n.clone():r.isWebMercator?(0,v.$)(n):(await i.e(6854).then(i.bind(i,75138))).create(this.portalItem).then((e=>{const t=new D.Z;return t.geometries=[n],t.outSpatialReference=r,e.project(t)})).then((e=>e[0])).catch((e=>(Ze.error("Error projecting item's extent:",e),null))):null}_removeDanglingLayerRefs(){const e=this.applicationProperties,t=e&&e.viewing&&e.viewing.search,i=e=>!!this.allLayers.find((t=>t.id===e));t&&t.layers&&(t.layers=t.layers.filter((e=>i(e.id)))),t&&t.tables&&(t.tables=t.tables.filter((e=>!!this.tables.find((t=>t.id===e.id)))));const r=e&&e.editing&&e.editing.locationTracking;r&&r.info&&!i(r.info.layerId)&&(e.editing=null);const n=this.presentation&&this.presentation.slides;n&&n.forEach((e=>{e.visibleLayers&&(e.visibleLayers=e.visibleLayers.filter((e=>i(e.id))))}))}_validateMap(){if(!this.basemap||!this.basemap.baseLayers.length)throw new p.Z("webmap:save","Map does not have a valid basemap with a base layer.")}_validateItem(){if(!this.portalItem)throw Ze.error("save: requires the portalItem property to be set"),new p.Z("webmap:portal-item-not-set","Portal item to save to has not been set on the WebMap");this._validateItemType(this.portalItem)}_validateItemType(e){if(e.type!==ke)throw new p.Z("webmap:portal-item-wrong-type",`Portal item needs to have type "${ke}"`)}_loadLayerContainers(){const e=[];return this.basemap&&e.push(this.basemap.load()),this.ground&&e.push(this.ground.load()),(0,y.eachAlways)(e).then((()=>{}))}_loadAllLayers(){const e=this._getAllLayersAndTables().map((e=>e.load()));return(0,y.eachAlways)(e).then((()=>{}))}_getAllLayersAndTables(){return this.allLayers.concat(this.allTables)}_validateJSONForWriting(e,t){let i=e.messages.filter((e=>"error"===e.type)).map((e=>new p.Z(e.name,e.message,e.details)));if(t.ignoreUnsupported&&(i=i.filter((e=>"layer:unsupported"!==e.name&&"symbol:unsupported"!==e.name&&"symbol-layer:unsupported"!==e.name&&"property:unsupported"!==e.name&&"url:unsupported"!==e.name))),i.length>0)throw new p.Z("webmap:save","Failed to save webmap due to unsupported or invalid content. See 'details.errors' for more detailed information",{errors:i})}async _updateItemProperties(e){e.extent=await this._getWGS84Extent(this.initialViewProperties.viewpoint.targetGeometry),await this._updateTypeKeywords(e)}async _updateItemPropertiesForSaveAs(e){(0,N.ck)(e,Be),(0,N.ck)(e,qe),(0,N.ck)(e,Ge),(0,N.ck)(e,ze),(0,N.ck)(e,Xe),(0,N.ck)(e,"Offline Map Areas"),(0,N.ck)(e,"FieldMapsDisabled"),await this._updateItemProperties(e)}async _getWGS84Extent(e){const t=e.clone().normalize();let i;if(t.length>1)for(const e of t)i?e.width>i.width&&(i=e):i=e;else i=t[0];return this._projectToWGS84(i)}async _projectToWGS84(e){const t=e.spatialReference;if(t.isWGS84)return e.clone();if(t.isWebMercator)return(0,v.Sx)(e);const r=await i.e(6854).then(i.bind(i,75138)),n=await r.create(this.portalItem),o=new D.Z;return o.geometries=[e],o.outSpatialReference=f.Z.WGS84,(await n.project(o))[0]}async _updateTypeKeywords(e){(0,N.qj)(e,"ArcGIS API for JavaScript"),await this._loadAllLayers(),this._evalCollectorKeyword(e),this._evalDataEditingKeyword(e),this._evalOfflineKeyword(e),this._evalDeveloperBasemapKeyword(e),e.typeKeywords&&(e.typeKeywords=e.typeKeywords.filter(((e,t,i)=>i.indexOf(e)===t)))}_evalCollectorKeyword(e){(0,N._$)(e,Be)||(0,N._$)(e,Ge)||(0,N._$)(e,ze)||(0,N._$)(e,Xe)||!this._hasEditableFeatureLayer()?(0,N.ck)(e,We):(0,N.qj)(e,We)}_evalDataEditingKeyword(e){this._hasEditableFeatureLayer()?(0,N.qj)(e,Ue):(0,N.ck)(e,Ue)}_evalOfflineKeyword(e){!(0,N._$)(e,qe)&&this._isOfflineCapableMap()?(0,N.qj)(e,$e):(0,N.ck)(e,$e)}_evalDeveloperBasemapKeyword(e){(0,x.zb)(this.basemap)?(0,N.qj)(e,He):(0,N.ck)(e,He)}_hasEditableFeatureLayer(){return this._getAllLayersAndTables().some((e=>e.loaded&&this._isFeatureServiceLayer(e)&&e.capabilities.operations.supportsEditing&&e.editingEnabled))}_isFeatureServiceLayer(e){return!("feature"!==e.type||!e.source||"feature-layer"!==e.source.type)}_isOfflineCapableMap(){return this._getAllLayersAndTables().filter((e=>"group"!==e.type)).every((e=>e.loaded&&this._isOfflineCapableLayer(e)))}_isOfflineCapableLayer(e){return this._isFeatureServiceLayer(e)&&e.capabilities.operations.supportsSync||("tile"===e.type||"vector-tile"===e.type)&&(e.capabilities.operations.supportsExportTiles||this._isExportableAGOLTileLayer(e)||(0,x.aL)(e))&&e.spatialReference.equals(this.initialViewProperties.spatialReference)}_isExportableAGOLTileLayer(e){return"tile"===e.type&&(0,j.h3)(e.url)&&Je.some((t=>e.url.toLowerCase().indexOf("/"+t+"/")>-1))}async _updateItem(e,t,i){await e.update({data:t}),this._syncUpInstanceWithItem(e,t,i)}async _createItem(e,t,i,r){const n=this.portalItem,o=!!(n&&n.id&&n.portal.user),a=e.portal;if(await a._signIn(),!await this._canCopyItem(n,o,a))throw new p.Z("webmap:save-as-copy-not-allowed","Owner of this map does not allow others to save a copy");await a.user.addItem({item:e,folder:r.folder,data:t}),this.portalItem=e,this._syncUpInstanceWithItem(e,t,i)}async _canCopyItem(e,t,i){return!((0,o.pC)(e)&&e.id&&e.typeKeywords&&e.typeKeywords.indexOf("useOnly")>-1)||e.portal.portalHostname===i.portalHostname&&(t||await e.reload(),"admin"===e.itemControl||"update"===e.itemControl)}_syncUpInstanceWithItem(e,t,i){O.w.prototype.read.call(this,{version:t.version,authoringApp:t.authoringApp,authoringAppVersion:t.authoringAppVersion},{origin:"web-map",ignoreDefaults:!0,url:e.itemUrl&&(0,h.mN)(e.itemUrl)}),(0,P.D)(i),this.resourceInfo=t}async _updateItemThumbnail(){this.thumbnailUrl&&this._isOverridden("thumbnailUrl")&&(await this.portalItem.updateThumbnail({thumbnail:this.thumbnailUrl,filename:this._thumbnailFilename}),this._clearThumbnailOverride())}_getPortalItem(e){let t=E.default.from(e);return t.id&&(t=t.clone(),t.id=null),t.type||(t.type=ke),t.portal||(t.portal=C.Z.getDefault()),this._validateItemType(t),t}async _updateFromInternal(e,t){t=t||{},await(0,M.whenTrueOnce)(e,"ready"),this._updateInitialViewProperties(e,t),await this._updateThumbnailUrl(e,t)}_updateInitialViewProperties(e,t){var i;if(t.backgroundExcluded||(this.initialViewProperties.background=null==(i=e.background)?void 0:i.clone()),this.initialViewProperties.spatialReference=e.spatialReference.clone(),t.viewpointExcluded||(this.initialViewProperties.viewpoint=new L.Z({rotation:e.rotation,scale:t.scalePreserved?e.scale:null,targetGeometry:this._getViewExtent(e)})),!t.widgetsExcluded)for(const t of e.persistableViewModels)t.updateWebDocument(this)}_getViewExtent(e){const t=e.center.clone().normalize(),i=e.extent.clone(),r=i.width/2;return i.xmin=t.x-r,i.xmax=t.x+r,i}async _updateThumbnailUrl(e,t){if(t.thumbnailExcluded)return;const i=te(e,t.thumbnailSize),r=await e.takeScreenshot({format:"png",width:i.width,height:i.height});this._setAutoGeneratedThumbnail(r.dataUrl)}_setAutoGeneratedThumbnail(e){this.thumbnailUrl=e,this._thumbnailFilename=null}_clearThumbnailOverride(){this._clearOverride("thumbnailUrl"),this.clear("thumbnailUrl","user"),this._thumbnailFilename=null}_generateCustomThumbnailFilename(e){if((0,h.HK)(e)){const t=(0,h.sJ)(e),i=t&&t.mediaType,r=i&&Ve.get(i.toLowerCase())||null,n=`thumbnail${Date.now()}`;return r?`${n}.${r}`:n}return null}_getThumbnailState(){let e=this.thumbnailUrl;return e&&(e=this._isOverridden("thumbnailUrl")?e:(0,h.ZN)(e,"w","8192")),{thumbnailUrl:e,filename:this._thumbnailFilename}}_restoreThumbnailFromState(e){this.thumbnailUrl=e.thumbnailUrl,this._thumbnailFilename=e.filename}_getAuthoringPropsState(){return{authoringApp:this.authoringApp,authoringAppVersion:this.authoringAppVersion,isAuthoringAppSetByUser:this._isAuthoringAppSetByUser,isAuthoringAppVersionSetByUser:this._isAuthoringAppVersionSetByUser}}_restoreAuthoringPropsFromState(e){e.isAuthoringAppSetByUser?this.authoringApp=e.authoringApp:this._isAuthoringAppSetByUser=!1,e.isAuthoringAppVersionSetByUser?this.authoringAppVersion=e.authoringAppVersion:this._isAuthoringAppVersionSetByUser=!1}static fromJSON(e){const t=e;if(!t)throw new p.Z("webmap:empty-resource","Expected a JSON resource but got nothing");return new this({resourceInfo:t})}};Ye.VERSION=Re,(0,n._)([(0,l.Cb)({type:xe,json:{write:!0}})],Ye.prototype,"applicationProperties",void 0),(0,n._)([(0,l.Cb)({type:String,json:{write:{allowNull:!0,ignoreOrigin:!0}}})],Ye.prototype,"authoringApp",null),(0,n._)([(0,u.c)("authoringApp")],Ye.prototype,"writeAuthoringApp",null),(0,n._)([(0,l.Cb)({type:String,json:{write:{allowNull:!0,ignoreOrigin:!0}}})],Ye.prototype,"authoringAppVersion",null),(0,n._)([(0,u.c)("authoringAppVersion")],Ye.prototype,"writeAuthoringAppVersion",null),(0,n._)([(0,l.Cb)({json:{read:{source:"baseMap"},write:{target:"baseMap"}}})],Ye.prototype,"basemap",void 0),(0,n._)([(0,l.Cb)({type:Fe,json:{write:{overridePolicy:e=>({enabled:!!(e&&e.length>0),ignoreOrigin:!0})}}})],Ye.prototype,"bookmarks",void 0),(0,n._)([(0,l.Cb)({type:je,nonNullable:!0,json:{read:{source:["background","initialState.viewpoint","mapRangeInfo","spatialReference"]},write:{ignoreOrigin:!0,target:{background:{type:Oe.Z},"initialState.viewpoint":{type:L.Z},mapRangeInfo:{type:Z},spatialReference:{type:f.Z}}}}})],Ye.prototype,"initialViewProperties",void 0),(0,n._)([(0,c.r)("initialViewProperties")],Ye.prototype,"readInitialViewProperties",null),(0,n._)([(0,u.c)("initialViewProperties")],Ye.prototype,"writeInitialViewProperties",null),(0,n._)([(0,l.Cb)({json:{read:!1,write:{target:"operationalLayers",ignoreOrigin:!0}}})],Ye.prototype,"layers",void 0),(0,n._)([(0,u.c)("layers")],Ye.prototype,"writeLayers",null),(0,n._)([(0,l.Cb)({type:E.default})],Ye.prototype,"portalItem",void 0),(0,n._)([(0,l.Cb)({json:{write:!0}})],Ye.prototype,"presentation",void 0),(0,n._)([(0,l.Cb)()],Ye.prototype,"resourceInfo",void 0),(0,n._)([(0,l.Cb)({readOnly:!0,type:De,json:{read:{source:"version"},write:{allowNull:!0,ignoreOrigin:!0,target:"version",isRequired:!0}}})],Ye.prototype,"sourceVersion",void 0),(0,n._)([(0,c.r)("sourceVersion")],Ye.prototype,"readSourceVersion",null),(0,n._)([(0,u.c)("sourceVersion")],Ye.prototype,"writeSourceVersion",null),(0,n._)([(0,l.Cb)({json:{read:!1,write:{ignoreOrigin:!0}}})],Ye.prototype,"tables",void 0),(0,n._)([(0,u.c)("tables")],Ye.prototype,"writeTables",null),(0,n._)([(0,l.Cb)()],Ye.prototype,"thumbnailUrl",null),(0,n._)([(0,l.Cb)({type:K,json:{write:!0}})],Ye.prototype,"widgets",void 0),Ye=(0,n._)([(0,d.j)("esri.WebMap")],Ye);const Ke=Ye},34175:(e,t,i)=>{"use strict";i.d(t,{G:()=>n});var r=i(32656);class n{constructor(e,t,i=""){this.major=e,this.minor=t,this._context=i}lessThan(e,t){return this.major<e||e===this.major&&this.minor<t}since(e,t){return!this.lessThan(e,t)}validate(e){if(this.major!==e.major){const t=this._context&&this._context+":",i=this._context&&this._context+" ";throw new r.Z(t+"unsupported-version",`Required major ${i}version is '${this.major}', but got '\${version.major}.\${version.minor}'`,{version:e})}}clone(){return new n(this.major,this.minor,this._context)}static parse(e,t=""){const[i,o]=e.split("."),a=/^\s*\d+\s*$/;if(!i||!i.match||!i.match(a))throw new r.Z((t&&t+":")+"invalid-version","Expected major version to be a number, but got '${version}'",{version:e});if(!o||!o.match||!o.match(a))throw new r.Z((t&&t+":")+"invalid-version","Expected minor version to be a number, but got '${version}'",{version:e});const s=parseInt(i,10),l=parseInt(o,10);return new n(s,l,t)}}},28885:(e,t,i)=>{"use strict";i.d(t,{D:()=>n});var r=i(96054);function n(e){e&&e.writtenProperties&&e.writtenProperties.forEach((e=>{const t=e.target;e.newOrigin&&e.oldOrigin!==e.newOrigin&&(0,r.l)(t)&&t.updateOrigin(e.propName,e.newOrigin)}))}},62646:(e,t,i)=>{"use strict";function r(e,t){if(!n(e,t)){const i=e.typeKeywords;i?i.push(t):e.typeKeywords=[t]}}function n(e,t){return!!e.typeKeywords&&e.typeKeywords.indexOf(t)>-1}function o(e,t){const i=e.typeKeywords;if(i){const e=i.indexOf(t);e>-1&&i.splice(e,1)}}i.d(t,{qj:()=>r,_$:()=>n,ck:()=>o})},90921:(e,t,i)=>{"use strict";i.d(t,{K:()=>m});var r=i(56140),n=(i(95830),i(36544)),o=(i(68055),i(79881)),a=i(87566),s=(i(10923),i(57002),i(86035),i(39105)),l=i(28293),c=i(32105),d=i(56700);function u(e){return e&&"group"===e.type}function p(e,t,i){let r,n;if(e)for(let o=0,a=e.length;o<a;o++){if(r=e.getItemAt(o),r[t]===i)return r;if(u(r)&&(n=p(r.layers,t,i),n))return n}}const h=n.Z.getLogger("esri.support.LayersMixin"),m=e=>{let t=class extends e{constructor(...e){super(...e),this.layers=new l.Z;const t=e=>{e.parent=this,this.layerAdded(e),"elevation"!==e.type&&"base-elevation"!==e.type||h.error(`Layer 'title:${e.title}, id:${e.id}' of type '${e.type}' is not supported as an operational layer and will therefore be ignored.`)},i=e=>{e.parent=null,this.layerRemoved(e)};this.layers.on("before-add",(e=>(e=>{e.parent&&"remove"in e.parent&&e.parent.remove(e)})(e.item))),this.layers.on("after-add",(e=>t(e.item))),this.layers.on("after-remove",(e=>i(e.item)))}destroy(){const e=this.layers.removeAll();for(const t of e)this.layerRemoved(t),t.destroy();this.layers.destroy()}set layers(e){this._set("layers",(0,c.Z)(e,this._get("layers")))}add(e,t){const i=this.layers;t=i.getNextIndex(t),e instanceof d.Z?e.parent===this?this.reorder(e,t):i.add(e,t):(0,s.isPromiseLike)(e)?e.then((e=>{this.destroyed||this.add(e,t)})):h.error("#add()","The item being added is not a Layer or a Promise that resolves to a Layer.")}addMany(e,t){const i=this.layers;t=i.getNextIndex(t),e.slice().forEach((e=>{e.parent!==this?(i.add(e,t),t+=1):this.reorder(e,t)}))}findLayerById(e){return p(this.layers,"id",e)}findLayerByUid(e){return p(this.layers,"uid",e)}remove(e){return this.layers.remove(e)}removeMany(e){return this.layers.removeMany(e)}removeAll(){return this.layers.removeAll()}reorder(e,t){return this.layers.reorder(e,t)}layerAdded(e){}layerRemoved(e){}};return(0,r._)([(0,o.Cb)()],t.prototype,"layers",null),t=(0,r._)([(0,a.j)("esri.support.LayersMixin")],t),t}},16137:(e,t,i)=>{"use strict";i.d(t,{Q:()=>h});var r=i(56140),n=(i(95830),i(36544)),o=(i(68055),i(79881)),a=i(87566),s=(i(10923),i(57002),i(86035),i(28293)),l=i(32105);const c="esri.support.TablesMixin",d=n.Z.getLogger(c);function u(e){return e&&"group"===e.type}function p(e,t,i){if(e)for(let r=0,n=e.length;r<n;r++){const n=e.getItemAt(r);if(n[t]===i)return n;if(u(n)){const e=p(n.tables,t,i);if(e)return e}}}const h=e=>{let t=class extends e{constructor(...e){super(...e),this.tables=new s.Z,this.tables.on("after-add",(e=>{const t=e.item;t.parent&&t.parent!==this&&"tables"in t.parent&&t.parent.tables.remove(t),t.parent=this,"feature"!==t.type&&d.error(`Layer 'title:${t.title}, id:${t.id}' of type '${t.type}' is not supported as a table and will therefore be ignored.`)})),this.tables.on("after-remove",(e=>{e.item.parent=null}))}destroy(){const e=this.tables.removeAll();for(const t of e)t.destroy();this.tables.destroy()}set tables(e){this._set("tables",(0,l.Z)(e,this._get("tables")))}findTableById(e){return p(this.tables,"id",e)}findTableByUid(e){return p(this.tables,"uid",e)}};return(0,r._)([(0,o.Cb)()],t.prototype,"tables",null),t=(0,r._)([(0,a.j)(c)],t),t}},17154:(e,t,i)=>{"use strict";i.d(t,{jE:()=>c,c5:()=>v,LU:()=>_,Q4:()=>b,tB:()=>d,T:()=>s,u1:()=>a,pG:()=>m,ZA:()=>u,ek:()=>p,_F:()=>l});var r=i(33655),n=i(77625),o=i(17387);function a(e){const t=e[0]*e[0]+e[4]*e[4]+e[8]*e[8],i=e[1]*e[1]+e[5]*e[5]+e[9]*e[9],r=e[2]*e[2]+e[6]*e[6]+e[10]*e[10];return Math.sqrt(Math.max(Math.max(t,i),r))}function s(e,t,i){i=i||e;const r=(0,o.d)(e,t);(0,o.s)(i,e[0]-r*t[0],e[1]-r*t[1],e[2]-r*t[2]),(0,o.n)(i,i)}function l(e,t,i){Math.abs(e[0])>Math.abs(e[1])?(0,o.s)(t,0,1,0):(0,o.s)(t,1,0,0),(0,o.c)(i,e,t),(0,o.n)(t,t),(0,o.c)(t,i,e),(0,o.n)(i,i)}function c(e,t){const i=(0,o.l)(e),n=(0,r.Kt)(e[2]/i),a=Math.atan2(e[1]/i,e[0]/i);return(0,o.s)(t,i,n,a),t}function d(e,t,i){const r=i[0]-t[0],n=i[1]-t[1],o=i[2]-t[2];let a=r*r+n*n+o*o;return a?(a=1/Math.sqrt(a),e[0]=r*a,e[1]=n*a,e[2]=o*a,e):(e[0]=0,e[1]=0,e[2]=0,e)}function u(e,t,i,r=(0,n.c)()){const a=(0,o.l)(e),s=(0,o.l)(t),l=(0,o.d)(e,t)/(a*s);if(l<.9999999999999999){const n=Math.acos(l),c=((1-i)*a+i*s)/Math.sin(n),d=c/a*Math.sin((1-i)*n),u=c/s*Math.sin(i*n);return(0,o.a)(w,e,d),(0,o.a)(S,t,u),(0,o.b)(r,w,S)}return(0,o.e)(r,e,t,i)}function p(e,t,i,r=(0,n.c)(),a=(0,n.c)()){const s=(0,o.l)(e),l=(0,o.l)(t),c=(0,o.d)(e,t)/(s*l);if(c<.9999999999999999){const n=Math.acos(c),d=Math.sin(n),u=Math.sin(i*n),p=Math.sin((1-i)*n),h=(1-i)*s+i*l;{const i=h/d,n=i/l*u;(0,o.a)(w,e,i/s*p),(0,o.a)(S,t,n),(0,o.b)(r,w,S)}{const r=1/s*(-Math.cos((1-i)*n)*n*h+p*(-s+l));(0,o.a)(w,e,r);const c=1/l*(Math.cos(i*n)*n*h+u*(-s+l));(0,o.a)(S,t,c),(0,o.b)(a,w,S),(0,o.a)(a,a,1/d)}return a}return(0,o.e)(r,e,t,i),(0,o.f)(a,t,e),(0,o.n)(a,a),a}class h{constructor(e,t){this.min=e,this.max=t,this.range=t-e}ndiff(e,t=0){return Math.ceil((e-t)/this.range)*this.range+t}_normalize(e,t,i,r=0,n=!1){return(i-=r)<e?i+=this.ndiff(e-i):i>t&&(i-=this.ndiff(i-t)),n&&i===t&&(i=e),i+r}normalize(e,t=0,i=!1){return this._normalize(this.min,this.max,e,t,i)}clamp(e,t=0){return(0,r.uZ)(e-t,this.min,this.max)+t}monotonic(e,t,i){return e<t?t:t+this.ndiff(e-t,i)}minimalMonotonic(e,t,i){return this._normalize(e,e+this.range,t,i)}center(e,t,i){return t=this.monotonic(e,t,i),this.normalize((e+t)/2,i)}diff(e,t,i){return this.monotonic(e,t,i)-e}shortestSignedDiff(e,t){e=this.normalize(e);const i=(t=this.normalize(t))-e,r=t<e?this.minimalMonotonic(e,t)-e:t-this.minimalMonotonic(t,e);return Math.abs(i)<Math.abs(r)?i:r}contains(e,t,i){return t=this.minimalMonotonic(e,t),(i=this.minimalMonotonic(e,i))>e&&i<t}}function m(e,t,i,r){(0,o.f)(y,t,e),(0,o.f)(g,i,e),(0,o.c)(r,y,g),(0,o.n)(r,r),r[3]=-(0,o.d)(e,r)}const y=(0,n.c)(),g=(0,n.c)();function f(e){for(const t in e){const i=e[t];i instanceof Function&&(e[t]=i.bind(e))}return e}const v=f(new h(0,2*Math.PI)),b=f(new h(-Math.PI,Math.PI)),_=f(new h(0,360)),w=((0,n.c)(),(0,n.c)()),S=(0,n.c)()},58836:(e,t,i)=>{"use strict";i.d(t,{Z:()=>c});var r,n=i(56140),o=(i(95830),i(36544),i(68055),i(79881)),a=i(87566),s=(i(10923),i(57002),i(86035),i(58385));let l=r=class extends s.wq{constructor(){super(...arguments),this.url=""}destroy(){this.url=""}clone(){return new r({url:this.url})}};(0,n._)([(0,o.Cb)({type:String,json:{write:{isRequired:!0}}})],l.prototype,"url",void 0),l=r=(0,n._)([(0,a.j)("esri.webdoc.support.Thumbnail")],l);const c=l},65892:(e,t,i)=>{"use strict";i.d(t,{Z:()=>C});var r,n=i(56140),o=(i(95830),i(82550)),a=i(59472),s=i(36544),l=i(68055),c=i(79881),d=i(60263),u=i(87765),p=i(30590),h=i(87566),m=i(32656),y=(i(10923),i(57002),i(86035),i(58385)),g=i(52937),f=i(35326),v=i(65984),b=i(58836);const _="esri.webmap.Bookmark",w=s.Z.getLogger(_);let S=r=class extends((0,f.I)(y.wq)){constructor(e){super(e),this.name=null,this.thumbnail=new b.Z}set extent(e){(0,u.Mr)(w,"extent",{replacement:"viewpoint",version:"4.17"}),this._set("viewpoint",new v.Z({targetGeometry:e.clone()})),this._set("extent",e)}castThumbnail(e){return"string"==typeof e?new b.Z({url:e}):(0,l.se)(b.Z,e)}set viewpoint(e){const t=e.targetGeometry;if((0,a.Wi)(t)||"extent"!==t.type){const t=new m.Z("invalid-viewpoint","'viewpoint.targetGeometry' should be an extent",{viewpoint:e});w.error(t)}else this._set("extent",t.clone()),this._set("viewpoint",e)}readViewpoint(e,t){const{extent:i,viewpoint:r}=t;return v.Z.fromJSON(r||{targetGeometry:i})}clone(){return new r((0,o.d9)({name:this.name,thumbnail:this.thumbnail,viewpoint:this.viewpoint}))}};(0,n._)([(0,c.Cb)({type:g.Z,nonNullable:!0,json:{read:!1,write:{isRequired:!0}}})],S.prototype,"extent",null),(0,n._)([(0,c.Cb)({type:String,nonNullable:!0,json:{write:{isRequired:!0}}})],S.prototype,"name",void 0),(0,n._)([(0,c.Cb)({type:b.Z,json:{write:{overridePolicy:e=>({enabled:!(!e||!e.url)})}}})],S.prototype,"thumbnail",void 0),(0,n._)([(0,d.p)("thumbnail")],S.prototype,"castThumbnail",null),(0,n._)([(0,c.Cb)({type:v.Z,nonNullable:!0,json:{write:!0}})],S.prototype,"viewpoint",null),(0,n._)([(0,p.r)("viewpoint",["extent","viewpoint"])],S.prototype,"readViewpoint",null),S=r=(0,n._)([(0,h.j)(_)],S);const C=S},29155:(e,t,i)=>{"use strict";i.d(t,{Z:()=>u});var r,n=i(56140),o=(i(95830),i(82550)),a=(i(36544),i(68055),i(79881)),s=i(87566),l=(i(10923),i(57002),i(86035),i(58385)),c=i(78745);let d=r=class extends l.wq{constructor(e){super(e),this.color=new c.default([0,0,0,1])}clone(){return new r((0,o.d9)({color:this.color}))}};(0,n._)([(0,a.Cb)({type:c.default,json:{write:!0}})],d.prototype,"color",void 0),d=r=(0,n._)([(0,s.j)("esri.webmap.background.ColorBackground")],d);const u=d},7081:(e,t,i)=>{"use strict";i.r(t),i.d(t,{default:()=>At});var r=i(56140),n=i(95830),o=i(36544),a=i(79881),s=i(51894),l=i(60263),c=i(87765),d=i(87566),u=(i(10923),i(57002),i(86035),i(10180)),p=i(28293),h=i(59691),m=i(80621),y=(i(40450),i(24258)),g=i(9200),f=i(30818),v=i(19401),b=i(90806);const _="hide",w="hide-children";function S(e){if(e)return null!=e.listMode?e.listMode:void 0}function C(e){if(e)return e.listMode===w||"wmts"===e.type?void 0:"group"===e.type?"layers":"sublayers"}function I(e){return S(e)!==_}function E(e,t){e&&e.sort(((e,i)=>{const r=t.indexOf(e.uid),n=t.indexOf(i.uid);return r>n?-1:r<n?1:0}))}function A(e,t){const i=null==e?void 0:e.layer;if(!i)return;const r=C(i);r&&E(i.get(r),t)}function x(e){const t=null==e?void 0:e.layer;return t&&"group"===t.type?t.layers:null}function T(e,t){var i;const r=null==(i=e.layer)?void 0:i.uid;return r&&t.find((e=>{var t;return(null==(t=e.layer)?void 0:t.uid)===r}))}var L,O=i(82677),M=i(35326),P=i(89350),j=i(73186),N=i(59359),D=i(77204),R=i(41452);i(68055);let k=L=class extends P.Z{constructor(e){super(e),this.displayValueEnabled=!1,this.max=1,this.min=0,this.step=.1,this.type="slider",this.value=null}clone(){return new L({active:this.active,className:this.className,disabled:this.disabled,id:this.id,indicator:this.indicator,title:this.title,visible:this.visible,displayValueEnabled:this.displayValueEnabled,max:this.max,min:this.min,step:this.step,value:this.value})}};(0,r._)([(0,a.Cb)()],k.prototype,"displayValueEnabled",void 0),(0,r._)([(0,a.Cb)()],k.prototype,"max",void 0),(0,r._)([(0,a.Cb)()],k.prototype,"min",void 0),(0,r._)([(0,a.Cb)()],k.prototype,"step",void 0),(0,r._)([(0,a.Cb)()],k.prototype,"value",void 0),k=L=(0,r._)([(0,d.j)("esri.support.Action.ActionSlider")],k);const F=k;var Z=i(88266);const V="esri-layer-list-panel",B="esri-layer-list-panel__content",W="esri-layer-list-panel__content--legend",U="esri-layer-list-panel__content--string",q="esri-layer-list-panel__content--html-element",$="esri-layer-list-panel__content--widget";let G=class extends((0,M.I)(b.default)){constructor(e,t){super(e,t),this._legend=null,this._handles=new h.Z,this.content=null,this.image=null,this.listItem=null,this.open=!1,this.visible=!0}initialize(){this.own([(0,m.init)(this,"content",(e=>this._createLegend(e)))])}destroy(){const{_legend:e}=this;e&&e.destroy(),this._legend=null}get className(){const{image:e}=this,t=this._getFirstWidget();return this._get("className")||!e&&t?t.iconClass:""}set className(e){void 0!==e?this._override("className",e):this._clearOverride("className")}get title(){const e=this._getFirstWidget();return this._get("title")||e?e.label:""}set title(e){void 0!==e?this._override("title",e):this._clearOverride("title")}render(){return(0,v.j)("div",{class:V},this._renderContents())}_renderContent(e){const{_legend:t,listItem:i}=this;return e?"legend"===e?i&&i.view&&i.layer&&t?(0,v.j)("div",{class:this.classes(B,W),key:t},t.render()):null:"string"==typeof e?(0,v.j)("div",{class:this.classes(B,U),key:e,innerHTML:e}):(0,Z.isWidget)(e)?(0,v.j)("div",{class:this.classes(B,$),key:e},e.render()):e instanceof HTMLElement?(0,v.j)("div",{class:this.classes(B,q),key:e,bind:e,afterCreate:this._attachToNode}):null:null}_renderContents(){const{content:e}=this;return Array.isArray(e)?e.map((e=>this._renderContent(e))):this._renderContent(e)}_getLegendOptions(e){if(!e)return;const{layer:t,view:i}=e;return t&&i?{view:i,layerInfos:[{layer:t,title:""}]}:void 0}_createLegend(e){this._hasLegend(e)&&!this._legend&&Promise.all([i.e(2673),i.e(6369),i.e(9632),i.e(2551),i.e(2905),i.e(5666),i.e(4288),i.e(8665),i.e(4172)]).then(i.bind(i,78665)).then((({default:e})=>{const{_handles:t,listItem:i}=this,r=new e(this._getLegendOptions(i));this._legend=r,this.notifyChange("className"),this.notifyChange("title");const n=(0,m.init)(this,["listItem.view","listItem.layer"],(()=>this._updateLegend(r)));t.add(n,"legends"),this.scheduleRender()}))}_hasLegend(e){const t="legend";return e===t||!!Array.isArray(e)&&e.some((e=>e===t))}_attachToNode(e){e.appendChild(this)}_updateLegend(e){const{listItem:t}=this;if(!t)return;const{layer:i,view:r}=t;e.view=r,e.layerInfos=[{layer:i,title:null}],this.scheduleRender()}_getWidget(e){return"legend"===e?this._legend:(0,Z.isWidget)(e)?e:null}_getFirstWidget(){const{content:e}=this;if(Array.isArray(e)){let t=null;return e.some((e=>{const i=this._getWidget(e);return i&&(t=i),!!i})),t}return this._getWidget(e)}};(0,r._)([(0,a.Cb)()],G.prototype,"className",null),(0,r._)([(0,a.Cb)()],G.prototype,"content",void 0),(0,r._)([(0,a.Cb)()],G.prototype,"image",void 0),(0,r._)([(0,a.Cb)()],G.prototype,"listItem",void 0),(0,r._)([(0,a.Cb)()],G.prototype,"title",null),(0,r._)([(0,a.Cb)()],G.prototype,"open",void 0),(0,r._)([(0,a.Cb)()],G.prototype,"visible",void 0),G=(0,r._)([(0,d.j)("esri.widgets.LayerList.ListItemPanel")],G);const z=G;var X;const H=p.Z.ofType({key:"type",defaultKeyValue:"button",base:P.Z,typeMap:{button:j.Z,toggle:N.Z,slider:F}}),J=p.Z.ofType(H),Y="layer",K="child-list-mode";let Q=X=class extends((0,M.I)((0,D.p)(O.default))){constructor(e){super(e),this.actionsSections=new J,this.actionsOpen=!1,this.children=new(p.Z.ofType(X)),this.childrenSortable=!0,this.error=null,this.layer=null,this.layerView=null,this.open=!1,this.panel=null,this.parent=null,this.sortable=!0,this.view=null,this.visible=null}initialize(){this.handles.add([(0,m.init)(this,"layer",(e=>this._watchLayerProperties(e))),(0,m.init)(this,"view",(e=>this._updateChildren(e))),(0,m.init)(this,"panel",(e=>this._setListItemOnPanel(e))),(0,m.init)(this,["layer","view"],(()=>this._getLayerView()))])}destroy(){this.view=null}castPanel(e){return this.get("panel.open")&&!e.hasOwnProperty("open")&&(e.open=!0),e?new z(e):null}get title(){const e=this.get("layer.layer");return(!e||e&&this.get("layer.layer.loaded"))&&this.get("layer.title")||""}set title(e){void 0!==e?this._override("title",e):this._clearOverride("title")}get updating(){const e=this.layerView;return e?e.updating:this._isLayerUpdating(this.layer)}get visibleAtCurrentScale(){return!function(e,t){if(!e||isNaN(t))return!1;const i=function(e){if(e)return null!=e.minScale?e.minScale:void 0}(e),r=function(e){if(e)return null!=e.maxScale?e.maxScale:void 0}(e),n=!isNaN(i)&&i>0&&t>i,o=!isNaN(r)&&r>0&&t<r;return n||o}(this.layer,this.get("view.scale"))}get visibilityMode(){return function(e){if(!e)return"inherited";const t=e.get("layer.capabilities.exportMap.supportsSublayerVisibility");if("boolean"==typeof t)return t?"independent":"inherited";const i=e.get("capabilities.exportMap.supportsSublayerVisibility");return"boolean"==typeof i?i?"independent":"inherited":null!=e.visibilityMode?e.visibilityMode:"independent"}(this.layer)}clone(){return new X({actionsSections:this.actionsSections.clone(),actionsOpen:this.actionsOpen,children:this.children.clone(),layer:this.layer,open:this.open,panel:this.panel,title:this.title,view:this.view,visible:this.visible})}_setListItemOnPanel(e){e&&(e.listItem=this)}_updateChildren(e){const t=this.children;t&&t.forEach((t=>t.view=e))}_addChildren(e){if(this.handles.remove(K),this.children.removeAll(),!e)return;e.forEach((t=>{this.handles.add((0,m.watch)(t,"listMode",(()=>this._addChildren(e))),K)}));const t=[];e.filter((e=>"hide"!==S(e))).forEach((e=>{if(I(e)){const i=new X({layer:e,parent:this,view:this.view});t.unshift(i)}})),this.children.addMany(t)}_watchSublayerChanges(e){e&&this.handles.add(e.on("change",(()=>{this._addChildren(e)})),Y)}_initializeChildLayers(e){this._addChildren(e),this._watchSublayerChanges(e)}_watchLayerProperties(e){if(!this.handles)return;if(this.handles.remove(Y),this.handles.remove(K),!e)return;if(this.handles.add((0,m.watch)(e,"listMode",(()=>this._watchLayerProperties(e))),Y),"hide-children"===S(e))return void this.children.removeAll();const t=C(e);t&&this.handles.add((0,m.init)(e,t,(()=>{e.hasOwnProperty(t)&&this._initializeChildLayers(e[t])})),Y)}async _getLayerView(){const{layer:e,view:t}=this;if(e&&t)try{const i=await t.whenLayerView(e);if(i.layer!==this.layer)return;this._set("layerView",i)}catch{}}_isLayerUpdating(e){return!(e instanceof R.Z)&&e&&"loading"===e.loadStatus}};(0,r._)([(0,a.Cb)({type:J})],Q.prototype,"actionsSections",void 0),(0,r._)([(0,a.Cb)()],Q.prototype,"actionsOpen",void 0),(0,r._)([(0,a.Cb)({type:p.Z})],Q.prototype,"children",void 0),(0,r._)([(0,a.Cb)()],Q.prototype,"childrenSortable",void 0),(0,r._)([(0,s.B)("layer.loadError?")],Q.prototype,"error",void 0),(0,r._)([(0,a.Cb)()],Q.prototype,"layer",void 0),(0,r._)([(0,a.Cb)({readOnly:!0})],Q.prototype,"layerView",void 0),(0,r._)([(0,a.Cb)()],Q.prototype,"open",void 0),(0,r._)([(0,a.Cb)({type:z})],Q.prototype,"panel",void 0),(0,r._)([(0,l.p)("panel")],Q.prototype,"castPanel",null),(0,r._)([(0,a.Cb)()],Q.prototype,"parent",void 0),(0,r._)([(0,a.Cb)()],Q.prototype,"sortable",void 0),(0,r._)([(0,a.Cb)()],Q.prototype,"title",null),(0,r._)([(0,a.Cb)({readOnly:!0})],Q.prototype,"updating",null),(0,r._)([(0,a.Cb)({value:null})],Q.prototype,"view",void 0),(0,r._)([(0,s.B)("layer.visible")],Q.prototype,"visible",void 0),(0,r._)([(0,a.Cb)({readOnly:!0})],Q.prototype,"visibleAtCurrentScale",null),(0,r._)([(0,a.Cb)({readOnly:!0})],Q.prototype,"visibilityMode",null),Q=X=(0,r._)([(0,d.j)("esri.widgets.LayerList.ListItem")],Q);const ee=Q;var te=i(51474),ie=i(35470);const re="view",ne="view-layers",oe="map-layers",ae="layer-views",se="layer-list-mode",le=p.Z.ofType(ee);let ce=class extends ie.Z.EventedAccessor{constructor(e){super(e),this._handles=new h.Z,this.listItemCreatedFunction=null,this.operationalItems=new le,this.view=null}initialize(){this._handles.add((0,m.init)(this,["view","view.ready"],(()=>this._viewHandles())),re)}destroy(){this._handles.destroy(),this._handles=null,this.view=null,this.operationalItems.removeAll()}get state(){const e=this.get("view");return this.get("view.ready")?"ready":e?"loading":"disabled"}triggerAction(e,t){e&&!e.disabled&&this.emit("trigger-action",{action:e,item:t})}moveListItem(e,t,i,r){var n,o;const a=null==e?void 0:e.layer;if(!a)return;const s=null==(n=this.view)||null==(o=n.map)?void 0:o.layers,l=t?x(t):s,c=i?x(i):s;if(!l||!c)return;const{operationalItems:d}=this,u=(null==t?void 0:t.children)||d,p=(null==i?void 0:i.children)||d,h=c.length-r;e.parent=i||null,u.includes(e)&&u.remove(e),l.includes(a)&&l.remove(a),p.includes(e)||p.add(e,h),c.includes(a)||c.add(a,h)}_createLayerViewHandles(e){const{_handles:t}=this;t.remove(ae),this._compileList(),e&&t.add(e.on("change",(()=>this._compileList())),ae)}_createMapLayerHandles(e){const{_handles:t}=this;t.remove(oe),this._compileList(),e&&t.add(e.on("change",(()=>this._compileList())),oe)}_watchItemProperties(e){this._handles.add([e.children.on("change",(()=>{this._modifyListItemChildren(e.children)}))],`children-change-${e.uid}`)}_modifyListItemChildren(e){e.forEach((e=>this._modifyListItem(e)))}_modifyListItem(e){if("function"==typeof this.listItemCreatedFunction){const t={item:e};this.listItemCreatedFunction.call(null,t)}this._modifyListItemChildren(e.children)}_createListItem(e){const{view:t}=this,i=new ee({layer:e,view:t});return this._watchItemProperties(i),i}_removeAllItems(){const{_handles:e,operationalItems:t}=this;t.forEach((t=>{e.remove(`children-change-${t.uid}`)})),t.removeAll()}_getViewableLayers(e){if(e)return e.filter((e=>"hide"!==S(e)))}_watchLayersListMode(e){const{_handles:t}=this;t.remove(se),e&&e.forEach((e=>{t.add((0,m.watch)(e,"listMode",(()=>this._compileList())),se)}))}_compileList(){const e=this.get("view.map.layers");this._watchLayersListMode(e);const t=this._getViewableLayers(e);t&&t.length?(this._createNewItems(t),this._modifyOrRemoveItems(t),this._sortItems(t)):this._removeAllItems()}_createNewItems(e){const{operationalItems:t}=this;e.forEach((e=>{t.find((t=>t.layer===e))||t.add(this._createListItem(e))}))}_modifyOrRemoveItems(e){const{_handles:t,operationalItems:i}=this,r=[];i.forEach((i=>{i&&e&&e.find((e=>i.layer===e))?this._modifyListItem(i):(t.remove(`children-change-${i.uid}`),r.push(i))})),i.removeMany(r)}_sortItems(e){const{operationalItems:t}=this;t.sort(((t,i)=>{const r=e.indexOf(t.layer),n=e.indexOf(i.layer);return r>n?-1:r<n?1:0}))}_viewHandles(){const{_handles:e,view:t}=this;e.remove([oe,ae,ne]),this._compileList(),t&&t.ready&&e.add([(0,m.init)(this,"view.map.layers",(e=>this._createMapLayerHandles(e))),(0,m.init)(this,"view.layerViews",(e=>this._createLayerViewHandles(e))),(0,m.init)(this,"listItemCreatedFunction",(()=>this._compileList()))],ne)}};(0,r._)([(0,a.Cb)()],ce.prototype,"listItemCreatedFunction",void 0),(0,r._)([(0,a.Cb)({type:le})],ce.prototype,"operationalItems",void 0),(0,r._)([(0,a.Cb)({readOnly:!0})],ce.prototype,"state",null),(0,r._)([(0,a.Cb)()],ce.prototype,"view",void 0),ce=(0,r._)([(0,d.j)("esri.widgets.LayerList.LayerListViewModel")],ce);const de=ce;function ue(e,t,i){e.splice(i,0,e.splice(t,1)[0])}const pe=p.Z.ofType(ee),he="data-sort-filter",me="data-layer-uid",ye="esri-layer-list esri-widget esri-widget--panel",ge="esri-layer-list--new-ui",fe="esri-layer-list__no-items",ve="esri-layer-list__list",be="esri-layer-list__list--root",_e="esri-layer-list__list--exclusive",we="esri-layer-list__list--inherited",Se="esri-layer-list__list--independent",Ce="esri-layer-list__item",Ie="esri-layer-list__item--error",Ee="esri-layer-list__item--invisible",Ae="esri-layer-list__item--invisible-at-scale",xe="esri-layer-list__item--updating",Te="esri-layer-list__item--has-children",Le="esri-layer-list__item--selectable",Oe="esri-layer-list__item-container",Me="esri-layer-list__item-actions-menu",Pe="esri-layer-list__item-actions-menu-item",je="esri-layer-list__item-actions-menu-item--active",Ne="esri-layer-list__item-actions",De="esri-layer-list__item-actions-list",Re="esri-layer-list__item-action",ke="esri-layer-list__item-action-icon",Fe="esri-layer-list__item-action-image",Ze="esri-layer-list__item-action-title",Ve="esri-layer-list__action-toggle",Be="esri-layer-list__action-toggle--on",We="esri-layer-list__item-label",Ue="esri-layer-list__item-error-message",qe="esri-layer-list__item-title",$e="esri-layer-list__item-toggle",Ge="esri-layer-list__item-toggle-icon",ze="esri-layer-list__item-toggle-icon",Xe="esri-layer-list__item-radio-icon",He="esri-layer-list__child-toggle",Je="esri-layer-list__child-toggle--open",Ye="esri-layer-list__child-toggle-icon--opened",Ke="esri-layer-list__child-toggle-icon--closed",Qe="esri-layer-list__child-toggle-icon--closed-rtl",et="esri-layer-list--chosen",tt="esri-disabled",it="esri-disabled-element",rt="esri-hidden",nt="esri-rotating",ot="esri-icon-handle-horizontal",at="esri-icon-visible",st="esri-icon-non-visible",lt="esri-icon-radio-checked",ct="esri-icon-radio-unchecked",dt="esri-icon-notice-triangle",ut="esri-icon-down-arrow",pt="esri-icon-right-triangle-arrow",ht="esri-icon-left-triangle-arrow",mt="esri-icon-loading-indicator",yt="esri-icon-default-action",gt="esri-icon-layers",ft="actions",vt="action-section",bt="items",_t={exclusive:"exclusive",inherited:"inherited",independent:"independent"};function wt(e){const{actionsOpen:t,children:i}=e;t&&(e.actionsOpen=!1),i.forEach((e=>wt(e)))}const St="root",Ct=o.Z.getLogger("esri.widgets.LayerList"),It={statusIndicators:!0};let Et=class extends b.default{constructor(e,t){super(e,t),this._handles=new h.Z,this._sortableNodes=new Map,this._sortableMap=new Map,this._focusSortUid=null,this._newUI=(0,n.Z)("esri-layerlist-new-ui"),this.visibleItems=null,this.iconClass=gt,this.label=void 0,this.listItemCreatedFunction=null,this.messages=null,this.messagesCommon=null,this.multipleSelectionEnabled=!1,this.operationalItems=null,this.selectionEnabled=!1,this.selectedItems=new pe,this.view=null,this.viewModel=new de,this.visibleElements={...It},this._onSortableSort=({to:e,from:t,item:i,newIndex:r})=>{t&&e&&(t===e?this._sortLayers(this._sortableMap.get(t.dataset.group)):this._moveLayerFromChildList({to:e,from:t,item:i,newIndex:r}))},this._sortableCanPut=(e,t,i)=>{var r,n;const o=e.el.dataset.group,a=t.el.dataset.group,s=e.el["data-item"],l=i["data-item"],c=null==l||null==(r=l.layer)?void 0:r.type,d=null==s||null==(n=s.layer)?void 0:n.type;return o&&a&&c&&!("group"===d&&"group"===c)},this._sortableCanPull=(e,t,i)=>{var r;const n=e.el.dataset.group,o=t.el.dataset.group,a=i["data-item"],s=null==a||null==(r=a.layer)?void 0:r.type;return n&&o&&!!s},this._onSortableEnd=({oldIndex:e,from:t,to:i,item:r})=>{t!==i&&t.insertBefore(r,t.children[e])}}initialize(){const e=this.operationalItems;this._setVisibleItems(e),this.own((0,m.on)(this,"operationalItems","change",(()=>this._itemsChanged(e))),(0,m.init)(this,"selectionEnabled",(()=>this._toggleAllSorting())))}destroy(){this._destroySortables(),this._handles.destroy(),this._handles=null}set statusIndicatorsVisible(e){(0,c.Mr)(Ct,"statusIndicatorsVisible",{replacement:"visibleElements.statusIndicators",version:"4.15"}),this.visibleElements={...this.visibleElements,statusIndicators:e}}castVisibleElements(e){return{...It,...e}}triggerAction(e,t){this.viewModel.triggerAction(e,t)}render(){var e;const{visibleItems:t,_newUI:i}=this,r=null==(e=this.viewModel)?void 0:e.state,n={[ge]:i,[rt]:"loading"===r,[tt]:"disabled"===r};return(0,v.j)("div",{class:this.classes(ye,n)},null!=t&&t.length?this.renderItems():this.renderNoItems())}renderNoItems(){return(0,v.j)("div",{class:fe},this.messages.noItemsToDisplay)}renderItems(){const{visibleItems:e,selectionEnabled:t,messages:i}=this;return(0,v.j)("ul",{"aria-label":i.widgetLabel,role:t?"listbox":void 0,afterCreate:this._sortNodeCreated,afterUpdate:this._sortNodeCreated,afterRemoved:this._sortNodeRemoved,"data-group":St,bind:this,class:this.classes(ve,be,Se)},null==e?void 0:e.map((e=>this.renderItem(e,null))).toArray())}renderActionsMenuIcon(e,t){const{messages:i}=this,r={[je]:e.actionsOpen},n=e.actionsOpen?i.closeActions:i.openActions;return(0,v.j)("div",{key:"actions-menu-toggle","data-item":e,bind:this,onclick:this._toggleActionsOpen,onkeydown:this._toggleActionsOpen,class:this.classes(Pe,r),tabindex:"0",role:"button","aria-controls":t,"aria-label":n,title:n},(0,v.j)("span",{"aria-hidden":"true",class:ot}))}renderActionsMenu(e,t,i,r){const{panel:n}=e,o=n&&n.visible?this.renderPanelButton(n):null,a=1===i&&this._getSingleActionButton(t),s=a?this.renderAction({item:e,action:a,singleAction:!0}):null,l=!a&&i?this.renderActionsMenuIcon(e,r):null;return l||o||a?(0,v.j)("div",{key:"actions-menu",class:Me},o,s,l):null}renderChildList(e,t){var i;const{selectionEnabled:r}=this,{visibilityMode:n,children:o}=e,a=!!e.error,s=!!o.length&&!a,l=!s&&r&&"group"===(null==(i=e.layer)?void 0:i.type),{exclusive:c,inherited:d}=_t,u={[_e]:n===c,[we]:n===d,[Se]:n!==d&&n!==c};return s||l?(0,v.j)("ul",{bind:this,key:"list-items",id:t,"data-group":e.uid,"data-item":e,afterCreate:this._sortNodeCreated,afterUpdate:this._sortNodeCreated,afterRemoved:this._sortNodeRemoved,class:this.classes(ve,u),"aria-expanded":e.open?"true":"false",role:r?"listbox":n===c?"radiogroup":"group",hidden:!e.open&&!l||null},null==o?void 0:o.map((t=>this.renderItem(t,e))).toArray()):null}renderChildrenToggle(e,t){const{messagesCommon:i}=this,{children:r}=e,n=!!e.error,o=!!r.length&&!n,a={[Je]:e.open},s=e.open?i.collapse:i.expand;return o?(0,v.j)("span",{onclick:this._toggleChildrenClick,onkeydown:this._toggleChildrenClick,"data-item":e,key:"toggle-children",class:this.classes(He,a),tabindex:"0",role:"button","aria-controls":t,"aria-label":s,title:s},(0,v.j)("span",{"aria-hidden":"true",class:this.classes(Ke,pt)}),(0,v.j)("span",{"aria-hidden":"true",class:this.classes(Ye,ut)}),(0,v.j)("span",{"aria-hidden":"true",class:this.classes(Qe,ht)})):null}renderError(e){return e.error?(0,v.j)("div",{key:"esri-layer-list__error",class:Ue,role:"alert"},(0,v.j)("span",null,this.messages.layerError)):null}renderItemContent(e,t,i){const{id:r}=this,n=`${r}_${e.uid}`,o=`${n}_actions`,a=`${n}__list`,{panel:s}=e,l=this._filterActions(e.actionsSections),c=this._countActions(l);return[(0,v.j)("div",{key:"list-item-container",class:Oe},this.renderChildrenToggle(e,a),this.renderLabel(e,t,i),this.renderActionsMenu(e,l,c,o)),this.renderError(e),c?this.renderActionsSections(e,l,o):null,s&&s.open?s.render():null,this.renderChildList(e,a)]}renderItem(e,t){const{_newUI:i,id:r,selectionEnabled:n,selectedItems:o,visibleElements:a}=this,{children:s}=e,l=`${r}_${e.uid}__title`,c=!!e.error,d=!!s.length&&!c,u={[Te]:d,[Ie]:!!c,[xe]:e.updating&&!t&&a.statusIndicators,[Ee]:i&&!e.visible,[Ae]:!e.visibleAtCurrentScale,[Le]:n};if(n){var p;const i={[me]:null==(p=e.layer)?void 0:p.uid,[he]:(!e.sortable).toString()};return(0,v.j)("li",Object.assign({key:`item-with-selection-${e.uid}`,bind:this,afterCreate:this._focusListItem,afterUpdate:this._focusListItem,class:this.classes(Ce,u),"aria-labelledby":l,onclick:this._toggleSelection,onkeydown:this._selectionKeydown,"data-item":e,"data-group":t?t.uid:St,tabIndex:0,"aria-selected":T(e,o)?"true":"false",role:"option"},i),this.renderItemContent(e,t,l))}return(0,v.j)("li",{key:`item-no-selection-${e.uid}`,bind:this,afterCreate:this._focusListItem,afterUpdate:this._focusListItem,class:this.classes(Ce,u),"aria-labelledby":l},this.renderItemContent(e,t,l))}renderItemTitle(e,t){const{messages:i}=this,r=e.title||i.untitledLayer,n=e.visibleAtCurrentScale?r:`${r} (${i.layerInvisibleAtScale})`;return(0,v.j)("span",{key:"layer-title-container",id:t,title:n,"aria-label":n,class:qe},r)}renderItemToggleIcon(e,t){const{_newUI:i}=this,{exclusive:r}=_t,n=t&&t.visibilityMode,o={[Ge]:i,[ze]:i&&n!==r,[Xe]:i&&n===r,[lt]:n===r&&e.visible,[ct]:n===r&&!e.visible,[at]:n!==r&&e.visible,[st]:n!==r&&!e.visible};return(0,v.j)("span",{key:"item-toggle-icon",class:this.classes(o),"aria-hidden":"true"})}renderItemToggle(e,t,i){const{selectionEnabled:r}=this,{exclusive:n}=_t,o=t&&t.visibilityMode,a=o===n?"radio":"switch";return(0,v.j)("span",r?{key:"item-toggle-selection-enabled",class:$e,bind:this,onclick:this._toggleVisibility,onkeydown:this._toggleVisibility,"data-item":e,"data-parent-visibility":o,tabIndex:0,"aria-checked":e.visible?"true":"false",role:a,"aria-labelledby":i}:{key:"item-toggle",class:$e},this.renderItemToggleIcon(e,t))}renderItemError(e){return e.error?(0,v.j)("span",{key:"notice-triangle","aria-hidden":"true",class:dt}):null}renderLabel(e,t,i){const{selectionEnabled:r,_newUI:n}=this,{inherited:o,exclusive:a}=_t,s=null==t?void 0:t.visibilityMode,l=s===a?"radio":"switch",c=[this.renderItemToggle(e,t,i),this.renderItemTitle(e,i)];n&&c.reverse();const d=(0,v.j)("div",r?{key:`item-label-no-selection-${e.uid}`,class:We}:{key:`item-label-with-selection-${e.uid}`,class:We,bind:this,onclick:this._toggleVisibility,onkeydown:this._toggleVisibility,"data-item":e,"data-parent-visibility":s,tabIndex:0,"aria-checked":e.visible?"true":"false",role:l,"aria-labelledby":i},c);return s===o||e.error?(0,v.j)("div",{key:`item-label-container-${e.uid}`,class:We},this.renderItemError(e),this.renderItemTitle(e,i)):d}renderPanelButton(e){const{className:t,open:i,title:r,image:n}=e,o=n||t?t:yt,a=this._getIconImageStyles(e),s={[je]:i},l={[Fe]:!!a["background-image"]};return o&&(l[o]=!!o),(0,v.j)("div",{key:`panel-${e.uid}`,bind:this,"data-panel":e,onclick:this._triggerPanel,onkeydown:this._triggerPanel,class:this.classes(Pe,s),role:"button",tabindex:"0",title:r,"aria-label":r},(0,v.j)("span",{class:this.classes(l),styles:a}))}renderActionsSections(e,t,i){const r=t.toArray().map(((t,i)=>(0,v.j)("ul",{key:`${e}-action-section-${i}`,class:De},this.renderActionSection(e,t))));return(0,v.j)("div",{role:"group","aria-expanded":e.actionsOpen?"true":"false",key:"actions-section",id:i,class:Ne,hidden:!e.actionsOpen||null},r)}renderActionSection(e,t){return(t&&t.toArray()).map((t=>this.renderAction({item:e,action:t})))}renderActionIcon(e){const{active:t,className:i}=e,r=this._getIconImageStyles(e),n="button"!==e.type||e.image||i?i:yt,o={[Fe]:!t&&!!r["background-image"],[mt]:t,[nt]:t};return n&&!t&&(o[n]=!0),(0,v.j)("span",{key:"action-icon","aria-hidden":"true",class:this.classes(ke,o),styles:r})}renderActionTitle(e,t){return t?null:(0,v.j)("span",{key:"action-title",class:Ze},e)}renderAction(e){const{item:t,action:i,singleAction:r}=e,{active:n,disabled:o,title:a}=i,s={[Pe]:r&&"button"===i.type,[Re]:n||!r&&"toggle"!==i.type,[Ve]:!n&&"toggle"===i.type,[Be]:!n&&"toggle"===i.type&&i.value,[it]:o},l=[this.renderActionIcon(i),this.renderActionTitle(a,r)];return r?(0,v.j)("div",{bind:this,"data-item":t,"data-action":i,role:"button",key:`single-action-${i.uid}`,onclick:this._triggerAction,onkeydown:this._triggerAction,classes:s,tabindex:"0",title:a,"aria-label":a},l):(0,v.j)("li",{bind:this,"data-item":t,"data-action":i,key:`action-${i.uid}`,onclick:this._triggerAction,onkeydown:this._triggerAction,classes:s,tabindex:"0",role:"button",title:a,"aria-label":a},l)}_sortNodeRemoved(e){const{_sortableMap:t}=this,i=e.dataset.group,r=t.get(i);r&&r.destroy(),t.delete(i)}_destroySortables(){const{_sortableMap:e,_sortableNodes:t}=this;e.forEach((e=>e&&e.destroy())),e.clear(),t.clear()}_moveLayerFromChildList({to:e,from:t,item:i,newIndex:r}){const n=i["data-item"],o=e["data-item"],a=t["data-item"];this.viewModel.moveListItem(n,a,o,r)}_sortLayers(e){if(!e)return;const t=e.el["data-item"],i=e.toArray();var r,n;t?A(t,i):E(null==(r=this.view)||null==(n=r.map)?void 0:n.layers,i)}_toggleSorting(e,t){const{_sortableMap:i,selectionEnabled:r}=this,n=i.get(t),o=e["data-item"],a=(t===St||o.childrenSortable&&function(e){const t=e&&(e.get("layer.layer")||e.layer);if(!t)return!1;const i=t.get("capabilities.exportMap.supportsSublayersChanges");return"boolean"!=typeof i||i}(o))&&r;if(n)n.option("disabled",!a);else if(a){const r=te.ZP.create(e,{dataIdAttr:me,group:{name:t,pull:this._sortableCanPull,put:this._sortableCanPut},filter:`[${he}="true"]`,fallbackTolerance:4,onSort:this._onSortableSort,onEnd:this._onSortableEnd,disabled:!a,chosenClass:et});i.set(t,r)}}_toggleAllSorting(){this._sortableNodes.forEach(((e,t)=>this._toggleSorting(e,t)))}_sortNodeCreated(e){const t=e.dataset.group;t&&(this._sortableNodes.set(t,e),this._toggleSorting(e,t))}_setVisibleItems(e){this.visibleItems=null==e?void 0:e.filter((e=>this.errorsVisible||!e.error))}_getSingleActionButton(e){return e.reduce((e=>e)).filter((e=>e&&"button"===e.type)).getItemAt(0)}_focusListItem(e){var t;const{_focusSortUid:i}=this;e&&i&&(null==(t=e["data-item"].layer)?void 0:t.uid)===i&&(e.focus(),this._focusSortUid=null)}_watchActionSectionChanges(e,t){const i=vt+t;this._handles.add(e.on("change",this.scheduleRender.bind(this)),i),e.forEach((e=>this._renderOnActionChanges(e,t)))}_renderOnActionChanges(e,t){const i=ft+t;"toggle"!==e.type?"slider"!==e.type?this._handles.add([(0,m.init)(e,["className","image","id","title","visible"],(()=>this.scheduleRender()))],i):this._handles.add([(0,m.init)(e,["className","id","title","visible","value","displayValueEnabled","max","min","step"],(()=>this.scheduleRender()))],i):this._handles.add([(0,m.init)(e,["className","image","id","title","visible","value"],(()=>this.scheduleRender()))],i)}_renderOnItemChanges(e){const t=e.uid,i=bt+t;this._handles.add([(0,m.init)(e,["actionsOpen","visible","open","updating","title","visibleAtCurrentScale","error","visibilityMode","panel","panel.title","panel.content","panel.className","sortable","childrenSortable"],(()=>this.scheduleRender())),e.actionsSections.on("change",(()=>this.scheduleRender())),e.children.on("change",(()=>this.scheduleRender()))],i),e.children.forEach((e=>this._renderOnItemChanges(e))),e.actionsSections.forEach((e=>this._watchActionSectionChanges(e,t)))}_itemsChanged(e){this._handles.removeAll(),e.forEach((e=>this._renderOnItemChanges(e))),this._setVisibleItems(e),this.scheduleRender()}_filterActions(e){return e.map((e=>e.filter((e=>e.visible))))}_countActions(e){return e.reduce(((e,t)=>e+t.length),0)}_getIconImageStyles(e){const t="esri.widgets.LayerList.ListItemPanel"===e.declaredClass||"esri.support.Action.ActionButton"===e.declaredClass||"esri.support.Action.ActionToggle"===e.declaredClass?e.image:null;return{"background-image":t?`url("${t}")`:null}}_selectionKeydown(e){const t=(0,u.kK)(e);if(-1===["ArrowDown","ArrowUp"].indexOf(t))return void this._toggleSelection(e);e.stopPropagation();const i=e.currentTarget,r=i["data-item"],{_sortableMap:n,selectedItems:o}=this,a=i.dataset.group,s=n.get(a);if(!s)return;const l=T(r,o),c=s.toArray(),d=e.target,p=c.indexOf(d.dataset.layerUid);if(-1!==p){if("ArrowDown"===t){const e=p+1;if(e>=c.length)return;var h,m;l?(ue(c,p,e),s.sort(c),this._sortLayers(s),this._focusSortUid=null==(h=r.layer)?void 0:h.uid):(this._focusSortUid=null==(m=r.layer)?void 0:m.uid,this.scheduleRender())}if("ArrowUp"===t){const e=p-1;if(e<=-1)return;var y,g;l?(ue(c,p,e),s.sort(c),this._sortLayers(s),this._focusSortUid=null==(y=r.layer)?void 0:y.uid):(this._focusSortUid=null==(g=r.layer)?void 0:g.uid,this.scheduleRender())}}}_toggleActionsOpen(e){const t=e.currentTarget["data-item"],{actionsOpen:i}=t,r=!i;r&&this.operationalItems.forEach((e=>wt(e))),t.actionsOpen=r,e.stopPropagation()}_triggerPanel(e){const t=e.currentTarget["data-panel"];t&&(t.open=!t.open),e.stopPropagation()}_triggerAction(e){const t=e.currentTarget,i=t["data-action"],r=t["data-item"];"toggle"===i.type&&(i.value=!i.value),this.triggerAction(i,r),e.stopPropagation()}_toggleVisibility(e){const t=e.currentTarget,i=t.getAttribute("data-parent-visibility"),r=t["data-item"];i===_t.exclusive&&r.visible||(r.visible=!r.visible),e.stopPropagation()}_toggleChildrenClick(e){const t=e.currentTarget["data-item"];t.open=!t.open,e.stopPropagation()}_toggleSelection(e){e.stopPropagation();const{multipleSelectionEnabled:t,selectedItems:i}=this,r=t&&(e.metaKey||e.ctrlKey),n=e.currentTarget["data-item"],o=T(n,i),{length:a}=i;if(!r)return!a||o&&1===a?void(o?i.remove(o):i.add(n)):(i.removeAll(),void i.add(n));o?i.remove(o):i.add(n)}};(0,r._)([(0,a.Cb)()],Et.prototype,"visibleItems",void 0),(0,r._)([(0,a.Cb)()],Et.prototype,"iconClass",void 0),(0,r._)([(0,a.Cb)()],Et.prototype,"errorsVisible",void 0),(0,r._)([(0,a.Cb)({aliasOf:{source:"messages.widgetLabel",overridable:!0}})],Et.prototype,"label",void 0),(0,r._)([(0,s.B)("viewModel.listItemCreatedFunction")],Et.prototype,"listItemCreatedFunction",void 0),(0,r._)([(0,a.Cb)(),(0,g.H)("esri/widgets/LayerList/t9n/LayerList")],Et.prototype,"messages",void 0),(0,r._)([(0,a.Cb)(),(0,g.H)("esri/t9n/common")],Et.prototype,"messagesCommon",void 0),(0,r._)([(0,a.Cb)()],Et.prototype,"multipleSelectionEnabled",void 0),(0,r._)([(0,s.B)("viewModel.operationalItems")],Et.prototype,"operationalItems",void 0),(0,r._)([(0,a.Cb)()],Et.prototype,"selectionEnabled",void 0),(0,r._)([(0,a.Cb)()],Et.prototype,"selectedItems",void 0),(0,r._)([(0,a.Cb)()],Et.prototype,"statusIndicatorsVisible",null),(0,r._)([(0,s.B)("viewModel.view")],Et.prototype,"view",void 0),(0,r._)([(0,f.s)("trigger-action"),(0,a.Cb)({type:de})],Et.prototype,"viewModel",void 0),(0,r._)([(0,a.Cb)()],Et.prototype,"visibleElements",void 0),(0,r._)([(0,l.p)("visibleElements")],Et.prototype,"castVisibleElements",null),(0,r._)([(0,s.B)("viewModel.triggerAction")],Et.prototype,"triggerAction",null),(0,r._)([(0,y.h)()],Et.prototype,"_toggleActionsOpen",null),(0,r._)([(0,y.h)()],Et.prototype,"_triggerPanel",null),(0,r._)([(0,y.h)()],Et.prototype,"_triggerAction",null),(0,r._)([(0,y.h)()],Et.prototype,"_toggleVisibility",null),(0,r._)([(0,y.h)()],Et.prototype,"_toggleChildrenClick",null),(0,r._)([(0,y.h)()],Et.prototype,"_toggleSelection",null),Et=(0,r._)([(0,d.j)("esri.widgets.LayerList")],Et);const At=Et},52646:function(e,t,i){"use strict";function r(e,t){for(var i=0;i<t.length;i++){var r=t[i];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function n(e,t){return(n=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function o(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var i,r=s(e);if(t){var n=s(this).constructor;i=Reflect.construct(r,arguments,n)}else i=r.apply(this,arguments);return a(this,i)}}function a(e,t){return!t||"object"!==l(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function s(e){return(s=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function l(e){return(l="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}var c=this&&this.__decorate||function(e,t,i,r){var n,o=arguments.length,a=o<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,i):r;if("object"===("undefined"==typeof Reflect?"undefined":l(Reflect))&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,i,r);else for(var s=e.length-1;s>=0;s--)(n=e[s])&&(a=(o<3?n(a):o>3?n(t,i,a):n(t,i))||a);return o>3&&a&&Object.defineProperty(t,i,a),a},d=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});var u=i(83781),p=i(88266),h=d(i(90806)),m=d(i(13538)),y=d(i(76910));i(45829);var g="esri-widget layers-base",f=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&n(e,t)}(l,e);var t,i,a,s=o(l);function l(e){var t;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,l),(t=s.call(this,e)).viewModel=new m.default,t.filterLayers=function(e){t.layerList.operationalItems.forEach((function(t){var i,r,n,o,a,s,l,c,d,u,p,h;if("group"===t.layer.type){var m=!1;t.layer.layers.forEach((function(t){t.title.toLowerCase().includes(e.toLowerCase())?(t.listMode="show",m=!0):t.listMode="hide"})),e.length?m?(t.open=!0,null===(h=null===(p=null===(u=null===(d=document.querySelector("#layerDiv_".concat(t.uid,"__title")))||void 0===d?void 0:d.parentElement)||void 0===u?void 0:u.parentElement)||void 0===p?void 0:p.parentElement)||void 0===h||h.classList.remove("hidden")):(t.open=!1,null===(c=null===(l=null===(s=null===(a=document.querySelector("#layerDiv_".concat(t.uid,"__title")))||void 0===a?void 0:a.parentElement)||void 0===s?void 0:s.parentElement)||void 0===l?void 0:l.parentElement)||void 0===c||c.classList.add("hidden")):(t.open=!1,null===(o=null===(n=null===(r=null===(i=document.querySelector("#layerDiv_".concat(t.uid,"__title")))||void 0===i?void 0:i.parentElement)||void 0===r?void 0:r.parentElement)||void 0===n?void 0:n.parentElement)||void 0===o||o.classList.remove("hidden"))}}))},t._createLayers=function(){t.layerList&&(t.layerList.container="layerWidget")},t.clearClick=function(){var e;t.filterLayers(""),null===(e=document.querySelector("#layerSearch .calcite-input-clear-button"))||void 0===e||e.removeEventListener("click",t.clearClick)},t._createSearch=function(e){e.addEventListener("input",(function(i){var r;t.filterLayers(i.target.value),null===(r=e.querySelector(".calcite-input-clear-button"))||void 0===r||r.addEventListener("click",t.clearClick,{passive:!0})}),{passive:!0})},t._reset=function(){new y.default({portalItem:t.view.map.portalItem.clone()}).load().then((function(e){e.allLayers.forEach((function(e){t.view.map.findLayerById(e.id).visible=e.visible,"group"===e.type&&e.layers.forEach((function(e){t.view.map.findLayerById(e.id).visible=e.visible}))}))}))},t}return t=l,(i=[{key:"render",value:function(){return p.tsx("div",{class:g},p.tsx("div",{class:"flex sticky"},p.tsx("calcite-input",{clearable:!0,placeholder:"Filter by layer name",scale:"s",afterCreate:this._createSearch,id:"layerSearch"}),p.tsx("calcite-button",{"icon-start":"viewHide",scale:"s",color:"light",onclick:this._reset})),p.tsx("div",{afterCreate:this._createLayers,id:"layerWidget"}))}}])&&r(t.prototype,i),a&&r(t,a),l}(h.default);c([u.aliasOf("viewModel.view")],f.prototype,"view",void 0),c([u.aliasOf("viewModel.layerList")],f.prototype,"layerList",void 0),c([u.property({type:m.default}),p.renderable()],f.prototype,"viewModel",void 0),f=c([u.subclass("app.widgets.Layers")],f),t.default=f},13538:function(e,t,i){"use strict";function r(e,t){for(var i=0;i<t.length;i++){var r=t[i];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function n(e,t){return(n=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function o(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var i,r=l(e);if(t){var n=l(this).constructor;i=Reflect.construct(r,arguments,n)}else i=r.apply(this,arguments);return a(this,i)}}function a(e,t){return!t||"object"!==c(t)&&"function"!=typeof t?s(e):t}function s(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function l(e){return(l=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function c(e){return(c="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}var d=this&&this.__decorate||function(e,t,i,r){var n,o=arguments.length,a=o<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,i):r;if("object"===("undefined"==typeof Reflect?"undefined":c(Reflect))&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,i,r);else for(var s=e.length-1;s>=0;s--)(n=e[s])&&(a=(o<3?n(a):o>3?n(t,i,a):n(t,i))||a);return o>3&&a&&Object.defineProperty(t,i,a),a},u=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});var p=u(i(82677)),h=i(83781),m=i(80621),y=u(i(7081)),g=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&n(e,t)}(c,e);var t,i,a,l=o(c);function c(e){var t;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,c),t=l.call(this,e),m.whenDefinedOnce(s(t),"view",t.init.bind(s(t))),t}return t=c,(i=[{key:"init",value:function(e){this.layerList=new y.default({view:e,container:"layerWidget",listItemCreatedFunction:function(t){var i=t.item;if("group"!=i.layer.type){var r=document.createElement("calcite-slider");r.setAttribute("min","0"),r.setAttribute("max","100"),r.setAttribute("min-label","0%"),r.setAttribute("max-label","100%"),r.setAttribute("label-handles",""),r.setAttribute("value",(100*(null==i?void 0:i.layer.opacity)).toString()),r.setAttribute("data",i.layer.id),r.addEventListener("calciteSliderUpdate",(function(t){var i;e.map.findLayerById(t.target.getAttribute("data")).opacity=parseInt(null===(i=null==t?void 0:t.target)||void 0===i?void 0:i.getAttribute("value"))/100}),{passive:!0}),i.panel={content:[r,"legend"],open:i.layer.visible},"Property"===i.layer.title&&(i.actionsSections=[[{title:"Show Labels",type:"toggle",id:"property-labels",value:i.layer.labelsVisible}]])}}}),this.layerList.on("trigger-action",(function(e){"property-labels"===e.action.id&&(e.item.layer.labelsVisible=e.action.value)}))}}])&&r(t.prototype,i),a&&r(t,a),c}(p.default);d([h.property()],g.prototype,"view",void 0),g=d([h.subclass("app.widgets.Layers.LayersViewModel")],g),t.default=g},17004:(e,t,i)=>{"use strict";i.d(t,{Z:()=>s});var r=i(94015),n=i.n(r),o=i(23645),a=i.n(o)()(n());a.push([e.id,".layers-base{padding:0}","",{version:3,sources:["webpack://./src/widgets/Layers/styles/Layers.scss"],names:[],mappings:"AAAA,aACE,SAAA",sourcesContent:[".layers-base {\n  padding: 0;\n}\n\n"],sourceRoot:""}]);const s=a},51474:(e,t,i)=>{"use strict";function r(e){return(r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function n(e,t,i){return t in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}function o(){return(o=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var i=arguments[t];for(var r in i)Object.prototype.hasOwnProperty.call(i,r)&&(e[r]=i[r])}return e}).apply(this,arguments)}function a(e){for(var t=1;t<arguments.length;t++){var i=null!=arguments[t]?arguments[t]:{},r=Object.keys(i);"function"==typeof Object.getOwnPropertySymbols&&(r=r.concat(Object.getOwnPropertySymbols(i).filter((function(e){return Object.getOwnPropertyDescriptor(i,e).enumerable})))),r.forEach((function(t){n(e,t,i[t])}))}return e}function s(e,t){if(null==e)return{};var i,r,n=function(e,t){if(null==e)return{};var i,r,n={},o=Object.keys(e);for(r=0;r<o.length;r++)i=o[r],t.indexOf(i)>=0||(n[i]=e[i]);return n}(e,t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(r=0;r<o.length;r++)i=o[r],t.indexOf(i)>=0||Object.prototype.propertyIsEnumerable.call(e,i)&&(n[i]=e[i])}return n}i.d(t,{ZP:()=>nt});function l(e){if("undefined"!=typeof window&&window.navigator)return!!navigator.userAgent.match(e)}var c=l(/(?:Trident.*rv[ :]?11\.|msie|iemobile|Windows Phone)/i),d=l(/Edge/i),u=l(/firefox/i),p=l(/safari/i)&&!l(/chrome/i)&&!l(/android/i),h=l(/iP(ad|od|hone)/i),m=l(/chrome/i)&&l(/android/i),y={capture:!1,passive:!1};function g(e,t,i){e.addEventListener(t,i,!c&&y)}function f(e,t,i){e.removeEventListener(t,i,!c&&y)}function v(e,t){if(t){if(">"===t[0]&&(t=t.substring(1)),e)try{if(e.matches)return e.matches(t);if(e.msMatchesSelector)return e.msMatchesSelector(t);if(e.webkitMatchesSelector)return e.webkitMatchesSelector(t)}catch(e){return!1}return!1}}function b(e){return e.host&&e!==document&&e.host.nodeType?e.host:e.parentNode}function _(e,t,i,r){if(e){i=i||document;do{if(null!=t&&(">"===t[0]?e.parentNode===i&&v(e,t):v(e,t))||r&&e===i)return e;if(e===i)break}while(e=b(e))}return null}var w,S=/\s+/g;function C(e,t,i){if(e&&t)if(e.classList)e.classList[i?"add":"remove"](t);else{var r=(" "+e.className+" ").replace(S," ").replace(" "+t+" "," ");e.className=(r+(i?" "+t:"")).replace(S," ")}}function I(e,t,i){var r=e&&e.style;if(r){if(void 0===i)return document.defaultView&&document.defaultView.getComputedStyle?i=document.defaultView.getComputedStyle(e,""):e.currentStyle&&(i=e.currentStyle),void 0===t?i:i[t];t in r||-1!==t.indexOf("webkit")||(t="-webkit-"+t),r[t]=i+("string"==typeof i?"":"px")}}function E(e,t){var i="";if("string"==typeof e)i=e;else do{var r=I(e,"transform");r&&"none"!==r&&(i=r+" "+i)}while(!t&&(e=e.parentNode));var n=window.DOMMatrix||window.WebKitCSSMatrix||window.CSSMatrix||window.MSCSSMatrix;return n&&new n(i)}function A(e,t,i){if(e){var r=e.getElementsByTagName(t),n=0,o=r.length;if(i)for(;n<o;n++)i(r[n],n);return r}return[]}function x(){var e=document.scrollingElement;return e||document.documentElement}function T(e,t,i,r,n){if(e.getBoundingClientRect||e===window){var o,a,s,l,d,u,p;if(e!==window&&e.parentNode&&e!==x()?(a=(o=e.getBoundingClientRect()).top,s=o.left,l=o.bottom,d=o.right,u=o.height,p=o.width):(a=0,s=0,l=window.innerHeight,d=window.innerWidth,u=window.innerHeight,p=window.innerWidth),(t||i)&&e!==window&&(n=n||e.parentNode,!c))do{if(n&&n.getBoundingClientRect&&("none"!==I(n,"transform")||i&&"static"!==I(n,"position"))){var h=n.getBoundingClientRect();a-=h.top+parseInt(I(n,"border-top-width")),s-=h.left+parseInt(I(n,"border-left-width")),l=a+o.height,d=s+o.width;break}}while(n=n.parentNode);if(r&&e!==window){var m=E(n||e),y=m&&m.a,g=m&&m.d;m&&(l=(a/=g)+(u/=g),d=(s/=y)+(p/=y))}return{top:a,left:s,bottom:l,right:d,width:p,height:u}}}function L(e,t,i){for(var r=N(e,!0),n=T(e)[t];r;){var o=T(r)[i];if(!("top"===i||"left"===i?n>=o:n<=o))return r;if(r===x())break;r=N(r,!1)}return!1}function O(e,t,i){for(var r=0,n=0,o=e.children;n<o.length;){if("none"!==o[n].style.display&&o[n]!==ke.ghost&&o[n]!==ke.dragged&&_(o[n],i.draggable,e,!1)){if(r===t)return o[n];r++}n++}return null}function M(e,t){for(var i=e.lastElementChild;i&&(i===ke.ghost||"none"===I(i,"display")||t&&!v(i,t));)i=i.previousElementSibling;return i||null}function P(e,t){var i=0;if(!e||!e.parentNode)return-1;for(;e=e.previousElementSibling;)"TEMPLATE"===e.nodeName.toUpperCase()||e===ke.clone||t&&!v(e,t)||i++;return i}function j(e){var t=0,i=0,r=x();if(e)do{var n=E(e),o=n.a,a=n.d;t+=e.scrollLeft*o,i+=e.scrollTop*a}while(e!==r&&(e=e.parentNode));return[t,i]}function N(e,t){if(!e||!e.getBoundingClientRect)return x();var i=e,r=!1;do{if(i.clientWidth<i.scrollWidth||i.clientHeight<i.scrollHeight){var n=I(i);if(i.clientWidth<i.scrollWidth&&("auto"==n.overflowX||"scroll"==n.overflowX)||i.clientHeight<i.scrollHeight&&("auto"==n.overflowY||"scroll"==n.overflowY)){if(!i.getBoundingClientRect||i===document.body)return x();if(r||t)return i;r=!0}}}while(i=i.parentNode);return x()}function D(e,t){return Math.round(e.top)===Math.round(t.top)&&Math.round(e.left)===Math.round(t.left)&&Math.round(e.height)===Math.round(t.height)&&Math.round(e.width)===Math.round(t.width)}function R(e,t){return function(){if(!w){var i=arguments,r=this;1===i.length?e.call(r,i[0]):e.apply(r,i),w=setTimeout((function(){w=void 0}),t)}}}function k(e,t,i){e.scrollLeft+=t,e.scrollTop+=i}function F(e){var t=window.Polymer,i=window.jQuery||window.Zepto;return t&&t.dom?t.dom(e).cloneNode(!0):i?i(e).clone(!0)[0]:e.cloneNode(!0)}var Z="Sortable"+(new Date).getTime();function V(){var e,t=[];return{captureAnimationState:function(){(t=[],this.options.animation)&&[].slice.call(this.el.children).forEach((function(e){if("none"!==I(e,"display")&&e!==ke.ghost){t.push({target:e,rect:T(e)});var i=a({},t[t.length-1].rect);if(e.thisAnimationDuration){var r=E(e,!0);r&&(i.top-=r.f,i.left-=r.e)}e.fromRect=i}}))},addAnimationState:function(e){t.push(e)},removeAnimationState:function(e){t.splice(function(e,t){for(var i in e)if(e.hasOwnProperty(i))for(var r in t)if(t.hasOwnProperty(r)&&t[r]===e[i][r])return Number(i);return-1}(t,{target:e}),1)},animateAll:function(i){var r=this;if(!this.options.animation)return clearTimeout(e),void("function"==typeof i&&i());var n=!1,o=0;t.forEach((function(e){var t=0,i=e.target,a=i.fromRect,s=T(i),l=i.prevFromRect,c=i.prevToRect,d=e.rect,u=E(i,!0);u&&(s.top-=u.f,s.left-=u.e),i.toRect=s,i.thisAnimationDuration&&D(l,s)&&!D(a,s)&&(d.top-s.top)/(d.left-s.left)==(a.top-s.top)/(a.left-s.left)&&(t=function(e,t,i,r){return Math.sqrt(Math.pow(t.top-e.top,2)+Math.pow(t.left-e.left,2))/Math.sqrt(Math.pow(t.top-i.top,2)+Math.pow(t.left-i.left,2))*r.animation}(d,l,c,r.options)),D(s,a)||(i.prevFromRect=a,i.prevToRect=s,t||(t=r.options.animation),r.animate(i,d,s,t)),t&&(n=!0,o=Math.max(o,t),clearTimeout(i.animationResetTimer),i.animationResetTimer=setTimeout((function(){i.animationTime=0,i.prevFromRect=null,i.fromRect=null,i.prevToRect=null,i.thisAnimationDuration=null}),t),i.thisAnimationDuration=t)})),clearTimeout(e),n?e=setTimeout((function(){"function"==typeof i&&i()}),o):"function"==typeof i&&i(),t=[]},animate:function(e,t,i,r){if(r){I(e,"transition",""),I(e,"transform","");var n=E(this.el),o=n&&n.a,a=n&&n.d,s=(t.left-i.left)/(o||1),l=(t.top-i.top)/(a||1);e.animatingX=!!s,e.animatingY=!!l,I(e,"transform","translate3d("+s+"px,"+l+"px,0)"),this.forRepaintDummy=function(e){return e.offsetWidth}(e),I(e,"transition","transform "+r+"ms"+(this.options.easing?" "+this.options.easing:"")),I(e,"transform","translate3d(0,0,0)"),"number"==typeof e.animated&&clearTimeout(e.animated),e.animated=setTimeout((function(){I(e,"transition",""),I(e,"transform",""),e.animated=!1,e.animatingX=!1,e.animatingY=!1}),r)}}}}var B=[],W={initializeByDefault:!0},U={mount:function(e){for(var t in W)W.hasOwnProperty(t)&&!(t in e)&&(e[t]=W[t]);B.forEach((function(t){if(t.pluginName===e.pluginName)throw"Sortable: Cannot mount plugin ".concat(e.pluginName," more than once")})),B.push(e)},pluginEvent:function(e,t,i){var r=this;this.eventCanceled=!1,i.cancel=function(){r.eventCanceled=!0};var n=e+"Global";B.forEach((function(r){t[r.pluginName]&&(t[r.pluginName][n]&&t[r.pluginName][n](a({sortable:t},i)),t.options[r.pluginName]&&t[r.pluginName][e]&&t[r.pluginName][e](a({sortable:t},i)))}))},initializePlugins:function(e,t,i,r){for(var n in B.forEach((function(r){var n=r.pluginName;if(e.options[n]||r.initializeByDefault){var a=new r(e,t,e.options);a.sortable=e,a.options=e.options,e[n]=a,o(i,a.defaults)}})),e.options)if(e.options.hasOwnProperty(n)){var a=this.modifyOption(e,n,e.options[n]);void 0!==a&&(e.options[n]=a)}},getEventProperties:function(e,t){var i={};return B.forEach((function(r){"function"==typeof r.eventProperties&&o(i,r.eventProperties.call(t[r.pluginName],e))})),i},modifyOption:function(e,t,i){var r;return B.forEach((function(n){e[n.pluginName]&&n.optionListeners&&"function"==typeof n.optionListeners[t]&&(r=n.optionListeners[t].call(e[n.pluginName],i))})),r}};function q(e){var t=e.sortable,i=e.rootEl,r=e.name,n=e.targetEl,o=e.cloneEl,s=e.toEl,l=e.fromEl,u=e.oldIndex,p=e.newIndex,h=e.oldDraggableIndex,m=e.newDraggableIndex,y=e.originalEvent,g=e.putSortable,f=e.extraEventProperties;if(t=t||i&&i[Z]){var v,b=t.options,_="on"+r.charAt(0).toUpperCase()+r.substr(1);!window.CustomEvent||c||d?(v=document.createEvent("Event")).initEvent(r,!0,!0):v=new CustomEvent(r,{bubbles:!0,cancelable:!0}),v.to=s||i,v.from=l||i,v.item=n||i,v.clone=o,v.oldIndex=u,v.newIndex=p,v.oldDraggableIndex=h,v.newDraggableIndex=m,v.originalEvent=y,v.pullMode=g?g.lastPutMode:void 0;var w=a({},f,U.getEventProperties(r,t));for(var S in w)v[S]=w[S];i&&i.dispatchEvent(v),b[_]&&b[_].call(t,v)}}var $=function(e,t){var i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},r=i.evt,n=s(i,["evt"]);U.pluginEvent.bind(ke)(e,t,a({dragEl:z,parentEl:X,ghostEl:H,rootEl:J,nextEl:Y,lastDownEl:K,cloneEl:Q,cloneHidden:ee,dragStarted:he,putSortable:ae,activeSortable:ke.active,originalEvent:r,oldIndex:te,oldDraggableIndex:re,newIndex:ie,newDraggableIndex:ne,hideGhostForTarget:je,unhideGhostForTarget:Ne,cloneNowHidden:function(){ee=!0},cloneNowShown:function(){ee=!1},dispatchSortableEvent:function(e){G({sortable:t,name:e,originalEvent:r})}},n))};function G(e){q(a({putSortable:ae,cloneEl:Q,targetEl:z,rootEl:J,oldIndex:te,oldDraggableIndex:re,newIndex:ie,newDraggableIndex:ne},e))}var z,X,H,J,Y,K,Q,ee,te,ie,re,ne,oe,ae,se,le,ce,de,ue,pe,he,me,ye,ge,fe,ve=!1,be=!1,_e=[],we=!1,Se=!1,Ce=[],Ie=!1,Ee=[],Ae="undefined"!=typeof document,xe=h,Te=d||c?"cssFloat":"float",Le=Ae&&!m&&!h&&"draggable"in document.createElement("div"),Oe=function(){if(Ae){if(c)return!1;var e=document.createElement("x");return e.style.cssText="pointer-events:auto","auto"===e.style.pointerEvents}}(),Me=function(e,t){var i=I(e),r=parseInt(i.width)-parseInt(i.paddingLeft)-parseInt(i.paddingRight)-parseInt(i.borderLeftWidth)-parseInt(i.borderRightWidth),n=O(e,0,t),o=O(e,1,t),a=n&&I(n),s=o&&I(o),l=a&&parseInt(a.marginLeft)+parseInt(a.marginRight)+T(n).width,c=s&&parseInt(s.marginLeft)+parseInt(s.marginRight)+T(o).width;if("flex"===i.display)return"column"===i.flexDirection||"column-reverse"===i.flexDirection?"vertical":"horizontal";if("grid"===i.display)return i.gridTemplateColumns.split(" ").length<=1?"vertical":"horizontal";if(n&&a.float&&"none"!==a.float){var d="left"===a.float?"left":"right";return!o||"both"!==s.clear&&s.clear!==d?"horizontal":"vertical"}return n&&("block"===a.display||"flex"===a.display||"table"===a.display||"grid"===a.display||l>=r&&"none"===i[Te]||o&&"none"===i[Te]&&l+c>r)?"vertical":"horizontal"},Pe=function(e){function t(e,i){return function(r,n,o,a){var s=r.options.group.name&&n.options.group.name&&r.options.group.name===n.options.group.name;if(null==e&&(i||s))return!0;if(null==e||!1===e)return!1;if(i&&"clone"===e)return e;if("function"==typeof e)return t(e(r,n,o,a),i)(r,n,o,a);var l=(i?r:n).options.group.name;return!0===e||"string"==typeof e&&e===l||e.join&&e.indexOf(l)>-1}}var i={},n=e.group;n&&"object"==r(n)||(n={name:n}),i.name=n.name,i.checkPull=t(n.pull,!0),i.checkPut=t(n.put),i.revertClone=n.revertClone,e.group=i},je=function(){!Oe&&H&&I(H,"display","none")},Ne=function(){!Oe&&H&&I(H,"display","")};Ae&&document.addEventListener("click",(function(e){if(be)return e.preventDefault(),e.stopPropagation&&e.stopPropagation(),e.stopImmediatePropagation&&e.stopImmediatePropagation(),be=!1,!1}),!0);var De=function(e){if(z){e=e.touches?e.touches[0]:e;var t=(n=e.clientX,o=e.clientY,_e.some((function(e){if(!M(e)){var t=T(e),i=e[Z].options.emptyInsertThreshold,r=n>=t.left-i&&n<=t.right+i,s=o>=t.top-i&&o<=t.bottom+i;return i&&r&&s?a=e:void 0}})),a);if(t){var i={};for(var r in e)e.hasOwnProperty(r)&&(i[r]=e[r]);i.target=i.rootEl=t,i.preventDefault=void 0,i.stopPropagation=void 0,t[Z]._onDragOver(i)}}var n,o,a},Re=function(e){z&&z.parentNode[Z]._isOutsideThisEl(e.target)};function ke(e,t){if(!e||!e.nodeType||1!==e.nodeType)throw"Sortable: `el` must be an HTMLElement, not ".concat({}.toString.call(e));this.el=e,this.options=t=o({},t),e[Z]=this;var i={group:null,sort:!0,disabled:!1,store:null,handle:null,draggable:/^[uo]l$/i.test(e.nodeName)?">li":">*",swapThreshold:1,invertSwap:!1,invertedSwapThreshold:null,removeCloneOnHide:!0,direction:function(){return Me(e,this.options)},ghostClass:"sortable-ghost",chosenClass:"sortable-chosen",dragClass:"sortable-drag",ignore:"a, img",filter:null,preventOnFilter:!0,animation:0,easing:null,setData:function(e,t){e.setData("Text",t.textContent)},dropBubble:!1,dragoverBubble:!1,dataIdAttr:"data-id",delay:0,delayOnTouchOnly:!1,touchStartThreshold:(Number.parseInt?Number:window).parseInt(window.devicePixelRatio,10)||1,forceFallback:!1,fallbackClass:"sortable-fallback",fallbackOnBody:!1,fallbackTolerance:0,fallbackOffset:{x:0,y:0},supportPointer:!1!==ke.supportPointer&&"PointerEvent"in window&&!p,emptyInsertThreshold:5};for(var r in U.initializePlugins(this,e,i),i)!(r in t)&&(t[r]=i[r]);for(var n in Pe(t),this)"_"===n.charAt(0)&&"function"==typeof this[n]&&(this[n]=this[n].bind(this));this.nativeDraggable=!t.forceFallback&&Le,this.nativeDraggable&&(this.options.touchStartThreshold=1),t.supportPointer?g(e,"pointerdown",this._onTapStart):(g(e,"mousedown",this._onTapStart),g(e,"touchstart",this._onTapStart)),this.nativeDraggable&&(g(e,"dragover",this),g(e,"dragenter",this)),_e.push(this.el),t.store&&t.store.get&&this.sort(t.store.get(this)||[]),o(this,V())}function Fe(e,t,i,r,n,o,a,s){var l,u,p=e[Z],h=p.options.onMove;return!window.CustomEvent||c||d?(l=document.createEvent("Event")).initEvent("move",!0,!0):l=new CustomEvent("move",{bubbles:!0,cancelable:!0}),l.to=t,l.from=e,l.dragged=i,l.draggedRect=r,l.related=n||t,l.relatedRect=o||T(t),l.willInsertAfter=s,l.originalEvent=a,e.dispatchEvent(l),h&&(u=h.call(p,l,a)),u}function Ze(e){e.draggable=!1}function Ve(){Ie=!1}function Be(e){for(var t=e.tagName+e.className+e.src+e.href+e.textContent,i=t.length,r=0;i--;)r+=t.charCodeAt(i);return r.toString(36)}function We(e){return setTimeout(e,0)}function Ue(e){return clearTimeout(e)}ke.prototype={constructor:ke,_isOutsideThisEl:function(e){this.el.contains(e)||e===this.el||(me=null)},_getDirection:function(e,t){return"function"==typeof this.options.direction?this.options.direction.call(this,e,t,z):this.options.direction},_onTapStart:function(e){if(e.cancelable){var t=this,i=this.el,r=this.options,n=r.preventOnFilter,o=e.type,a=e.touches&&e.touches[0]||e.pointerType&&"touch"===e.pointerType&&e,s=(a||e).target,l=e.target.shadowRoot&&(e.path&&e.path[0]||e.composedPath&&e.composedPath()[0])||s,c=r.filter;if(function(e){Ee.length=0;var t=e.getElementsByTagName("input"),i=t.length;for(;i--;){var r=t[i];r.checked&&Ee.push(r)}}(i),!z&&!(/mousedown|pointerdown/.test(o)&&0!==e.button||r.disabled)&&!l.isContentEditable&&(this.nativeDraggable||!p||!s||"SELECT"!==s.tagName.toUpperCase())&&!((s=_(s,r.draggable,i,!1))&&s.animated||K===s)){if(te=P(s),re=P(s,r.draggable),"function"==typeof c){if(c.call(this,e,s,this))return G({sortable:t,rootEl:l,name:"filter",targetEl:s,toEl:i,fromEl:i}),$("filter",t,{evt:e}),void(n&&e.cancelable&&e.preventDefault())}else if(c&&(c=c.split(",").some((function(r){if(r=_(l,r.trim(),i,!1))return G({sortable:t,rootEl:r,name:"filter",targetEl:s,fromEl:i,toEl:i}),$("filter",t,{evt:e}),!0}))))return void(n&&e.cancelable&&e.preventDefault());r.handle&&!_(l,r.handle,i,!1)||this._prepareDragStart(e,a,s)}}},_prepareDragStart:function(e,t,i){var r,n=this,o=n.el,a=n.options,s=o.ownerDocument;if(i&&!z&&i.parentNode===o){var l=T(i);if(J=o,X=(z=i).parentNode,Y=z.nextSibling,K=i,oe=a.group,ke.dragged=z,se={target:z,clientX:(t||e).clientX,clientY:(t||e).clientY},ue=se.clientX-l.left,pe=se.clientY-l.top,this._lastX=(t||e).clientX,this._lastY=(t||e).clientY,z.style["will-change"]="all",r=function(){$("delayEnded",n,{evt:e}),ke.eventCanceled?n._onDrop():(n._disableDelayedDragEvents(),!u&&n.nativeDraggable&&(z.draggable=!0),n._triggerDragStart(e,t),G({sortable:n,name:"choose",originalEvent:e}),C(z,a.chosenClass,!0))},a.ignore.split(",").forEach((function(e){A(z,e.trim(),Ze)})),g(s,"dragover",De),g(s,"mousemove",De),g(s,"touchmove",De),g(s,"mouseup",n._onDrop),g(s,"touchend",n._onDrop),g(s,"touchcancel",n._onDrop),u&&this.nativeDraggable&&(this.options.touchStartThreshold=4,z.draggable=!0),$("delayStart",this,{evt:e}),!a.delay||a.delayOnTouchOnly&&!t||this.nativeDraggable&&(d||c))r();else{if(ke.eventCanceled)return void this._onDrop();g(s,"mouseup",n._disableDelayedDrag),g(s,"touchend",n._disableDelayedDrag),g(s,"touchcancel",n._disableDelayedDrag),g(s,"mousemove",n._delayedDragTouchMoveHandler),g(s,"touchmove",n._delayedDragTouchMoveHandler),a.supportPointer&&g(s,"pointermove",n._delayedDragTouchMoveHandler),n._dragStartTimer=setTimeout(r,a.delay)}}},_delayedDragTouchMoveHandler:function(e){var t=e.touches?e.touches[0]:e;Math.max(Math.abs(t.clientX-this._lastX),Math.abs(t.clientY-this._lastY))>=Math.floor(this.options.touchStartThreshold/(this.nativeDraggable&&window.devicePixelRatio||1))&&this._disableDelayedDrag()},_disableDelayedDrag:function(){z&&Ze(z),clearTimeout(this._dragStartTimer),this._disableDelayedDragEvents()},_disableDelayedDragEvents:function(){var e=this.el.ownerDocument;f(e,"mouseup",this._disableDelayedDrag),f(e,"touchend",this._disableDelayedDrag),f(e,"touchcancel",this._disableDelayedDrag),f(e,"mousemove",this._delayedDragTouchMoveHandler),f(e,"touchmove",this._delayedDragTouchMoveHandler),f(e,"pointermove",this._delayedDragTouchMoveHandler)},_triggerDragStart:function(e,t){t=t||"touch"==e.pointerType&&e,!this.nativeDraggable||t?this.options.supportPointer?g(document,"pointermove",this._onTouchMove):g(document,t?"touchmove":"mousemove",this._onTouchMove):(g(z,"dragend",this),g(J,"dragstart",this._onDragStart));try{document.selection?We((function(){document.selection.empty()})):window.getSelection().removeAllRanges()}catch(e){}},_dragStarted:function(e,t){if(ve=!1,J&&z){$("dragStarted",this,{evt:t}),this.nativeDraggable&&g(document,"dragover",Re);var i=this.options;!e&&C(z,i.dragClass,!1),C(z,i.ghostClass,!0),ke.active=this,e&&this._appendGhost(),G({sortable:this,name:"start",originalEvent:t})}else this._nulling()},_emulateDragOver:function(){if(le){this._lastX=le.clientX,this._lastY=le.clientY,je();for(var e=document.elementFromPoint(le.clientX,le.clientY),t=e;e&&e.shadowRoot&&(e=e.shadowRoot.elementFromPoint(le.clientX,le.clientY))!==t;)t=e;if(z.parentNode[Z]._isOutsideThisEl(e),t)do{if(t[Z]){if(t[Z]._onDragOver({clientX:le.clientX,clientY:le.clientY,target:e,rootEl:t})&&!this.options.dragoverBubble)break}e=t}while(t=t.parentNode);Ne()}},_onTouchMove:function(e){if(se){var t=this.options,i=t.fallbackTolerance,r=t.fallbackOffset,n=e.touches?e.touches[0]:e,o=H&&E(H,!0),a=H&&o&&o.a,s=H&&o&&o.d,l=xe&&fe&&j(fe),c=(n.clientX-se.clientX+r.x)/(a||1)+(l?l[0]-Ce[0]:0)/(a||1),d=(n.clientY-se.clientY+r.y)/(s||1)+(l?l[1]-Ce[1]:0)/(s||1);if(!ke.active&&!ve){if(i&&Math.max(Math.abs(n.clientX-this._lastX),Math.abs(n.clientY-this._lastY))<i)return;this._onDragStart(e,!0)}if(H){o?(o.e+=c-(ce||0),o.f+=d-(de||0)):o={a:1,b:0,c:0,d:1,e:c,f:d};var u="matrix(".concat(o.a,",").concat(o.b,",").concat(o.c,",").concat(o.d,",").concat(o.e,",").concat(o.f,")");I(H,"webkitTransform",u),I(H,"mozTransform",u),I(H,"msTransform",u),I(H,"transform",u),ce=c,de=d,le=n}e.cancelable&&e.preventDefault()}},_appendGhost:function(){if(!H){var e=this.options.fallbackOnBody?document.body:J,t=T(z,!0,xe,!0,e),i=this.options;if(xe){for(fe=e;"static"===I(fe,"position")&&"none"===I(fe,"transform")&&fe!==document;)fe=fe.parentNode;fe!==document.body&&fe!==document.documentElement?(fe===document&&(fe=x()),t.top+=fe.scrollTop,t.left+=fe.scrollLeft):fe=x(),Ce=j(fe)}C(H=z.cloneNode(!0),i.ghostClass,!1),C(H,i.fallbackClass,!0),C(H,i.dragClass,!0),I(H,"transition",""),I(H,"transform",""),I(H,"box-sizing","border-box"),I(H,"margin",0),I(H,"top",t.top),I(H,"left",t.left),I(H,"width",t.width),I(H,"height",t.height),I(H,"opacity","0.8"),I(H,"position",xe?"absolute":"fixed"),I(H,"zIndex","100000"),I(H,"pointerEvents","none"),ke.ghost=H,e.appendChild(H),I(H,"transform-origin",ue/parseInt(H.style.width)*100+"% "+pe/parseInt(H.style.height)*100+"%")}},_onDragStart:function(e,t){var i=this,r=e.dataTransfer,n=i.options;$("dragStart",this,{evt:e}),ke.eventCanceled?this._onDrop():($("setupClone",this),ke.eventCanceled||((Q=F(z)).draggable=!1,Q.style["will-change"]="",this._hideClone(),C(Q,this.options.chosenClass,!1),ke.clone=Q),i.cloneId=We((function(){$("clone",i),ke.eventCanceled||(i.options.removeCloneOnHide||J.insertBefore(Q,z),i._hideClone(),G({sortable:i,name:"clone"}))})),!t&&C(z,n.dragClass,!0),t?(be=!0,i._loopId=setInterval(i._emulateDragOver,50)):(f(document,"mouseup",i._onDrop),f(document,"touchend",i._onDrop),f(document,"touchcancel",i._onDrop),r&&(r.effectAllowed="move",n.setData&&n.setData.call(i,r,z)),g(document,"drop",i),I(z,"transform","translateZ(0)")),ve=!0,i._dragStartId=We(i._dragStarted.bind(i,t,e)),g(document,"selectstart",i),he=!0,p&&I(document.body,"user-select","none"))},_onDragOver:function(e){var t,i,r,n,o=this.el,s=e.target,l=this.options,c=l.group,d=ke.active,u=oe===c,p=l.sort,h=ae||d,m=this,y=!1;if(!Ie){if(void 0!==e.preventDefault&&e.cancelable&&e.preventDefault(),s=_(s,l.draggable,o,!0),R("dragOver"),ke.eventCanceled)return y;if(z.contains(e.target)||s.animated&&s.animatingX&&s.animatingY||m._ignoreWhileAnimating===s)return V(!1);if(be=!1,d&&!l.disabled&&(u?p||(r=!J.contains(z)):ae===this||(this.lastPutMode=oe.checkPull(this,d,z,e))&&c.checkPut(this,d,z,e))){if(n="vertical"===this._getDirection(e,s),t=T(z),R("dragOverValid"),ke.eventCanceled)return y;if(r)return X=J,F(),this._hideClone(),R("revert"),ke.eventCanceled||(Y?J.insertBefore(z,Y):J.appendChild(z)),V(!0);var g=M(o,l.draggable);if(!g||function(e,t,i){var r=T(M(i.el,i.options.draggable)),n=10;return t?e.clientX>r.right+n||e.clientX<=r.right&&e.clientY>r.bottom&&e.clientX>=r.left:e.clientX>r.right&&e.clientY>r.top||e.clientX<=r.right&&e.clientY>r.bottom+n}(e,n,this)&&!g.animated){if(g===z)return V(!1);if(g&&o===e.target&&(s=g),s&&(i=T(s)),!1!==Fe(J,o,z,t,s,i,e,!!s))return F(),o.appendChild(z),X=o,B(),V(!0)}else if(s.parentNode===o){i=T(s);var f,v,b,w=z.parentNode!==o,S=!function(e,t,i){var r=i?e.left:e.top,n=i?e.right:e.bottom,o=i?e.width:e.height,a=i?t.left:t.top,s=i?t.right:t.bottom,l=i?t.width:t.height;return r===a||n===s||r+o/2===a+l/2}(z.animated&&z.toRect||t,s.animated&&s.toRect||i,n),E=n?"top":"left",A=L(s,"top","top")||L(z,"top","top"),x=A?A.scrollTop:void 0;if(me!==s&&(v=i[E],we=!1,Se=!S&&l.invertSwap||w),0!==(f=function(e,t,i,r,n,o,a,s){var l=r?e.clientY:e.clientX,c=r?i.height:i.width,d=r?i.top:i.left,u=r?i.bottom:i.right,p=!1;if(!a)if(s&&ge<c*n){if(!we&&(1===ye?l>d+c*o/2:l<u-c*o/2)&&(we=!0),we)p=!0;else if(1===ye?l<d+ge:l>u-ge)return-ye}else if(l>d+c*(1-n)/2&&l<u-c*(1-n)/2)return function(e){return P(z)<P(e)?1:-1}(t);if((p=p||a)&&(l<d+c*o/2||l>u-c*o/2))return l>d+c/2?1:-1;return 0}(e,s,i,n,S?1:l.swapThreshold,null==l.invertedSwapThreshold?l.swapThreshold:l.invertedSwapThreshold,Se,me===s))){var O=P(z);do{O-=f,b=X.children[O]}while(b&&("none"===I(b,"display")||b===H))}if(0===f||b===s)return V(!1);me=s,ye=f;var j=s.nextElementSibling,N=!1,D=Fe(J,o,z,t,s,i,e,N=1===f);if(!1!==D)return 1!==D&&-1!==D||(N=1===D),Ie=!0,setTimeout(Ve,30),F(),N&&!j?o.appendChild(z):s.parentNode.insertBefore(z,N?j:s),A&&k(A,0,x-A.scrollTop),X=z.parentNode,void 0===v||Se||(ge=Math.abs(v-T(s)[E])),B(),V(!0)}if(o.contains(z))return V(!1)}return!1}function R(l,c){$(l,m,a({evt:e,isOwner:u,axis:n?"vertical":"horizontal",revert:r,dragRect:t,targetRect:i,canSort:p,fromSortable:h,target:s,completed:V,onMove:function(i,r){return Fe(J,o,z,t,i,T(i),e,r)},changed:B},c))}function F(){R("dragOverAnimationCapture"),m.captureAnimationState(),m!==h&&h.captureAnimationState()}function V(t){return R("dragOverCompleted",{insertion:t}),t&&(u?d._hideClone():d._showClone(m),m!==h&&(C(z,ae?ae.options.ghostClass:d.options.ghostClass,!1),C(z,l.ghostClass,!0)),ae!==m&&m!==ke.active?ae=m:m===ke.active&&ae&&(ae=null),h===m&&(m._ignoreWhileAnimating=s),m.animateAll((function(){R("dragOverAnimationComplete"),m._ignoreWhileAnimating=null})),m!==h&&(h.animateAll(),h._ignoreWhileAnimating=null)),(s===z&&!z.animated||s===o&&!s.animated)&&(me=null),l.dragoverBubble||e.rootEl||s===document||(z.parentNode[Z]._isOutsideThisEl(e.target),!t&&De(e)),!l.dragoverBubble&&e.stopPropagation&&e.stopPropagation(),y=!0}function B(){ie=P(z),ne=P(z,l.draggable),G({sortable:m,name:"change",toEl:o,newIndex:ie,newDraggableIndex:ne,originalEvent:e})}},_ignoreWhileAnimating:null,_offMoveEvents:function(){f(document,"mousemove",this._onTouchMove),f(document,"touchmove",this._onTouchMove),f(document,"pointermove",this._onTouchMove),f(document,"dragover",De),f(document,"mousemove",De),f(document,"touchmove",De)},_offUpEvents:function(){var e=this.el.ownerDocument;f(e,"mouseup",this._onDrop),f(e,"touchend",this._onDrop),f(e,"pointerup",this._onDrop),f(e,"touchcancel",this._onDrop),f(document,"selectstart",this)},_onDrop:function(e){var t=this.el,i=this.options;ie=P(z),ne=P(z,i.draggable),$("drop",this,{evt:e}),X=z&&z.parentNode,ie=P(z),ne=P(z,i.draggable),ke.eventCanceled||(ve=!1,Se=!1,we=!1,clearInterval(this._loopId),clearTimeout(this._dragStartTimer),Ue(this.cloneId),Ue(this._dragStartId),this.nativeDraggable&&(f(document,"drop",this),f(t,"dragstart",this._onDragStart)),this._offMoveEvents(),this._offUpEvents(),p&&I(document.body,"user-select",""),I(z,"transform",""),e&&(he&&(e.cancelable&&e.preventDefault(),!i.dropBubble&&e.stopPropagation()),H&&H.parentNode&&H.parentNode.removeChild(H),(J===X||ae&&"clone"!==ae.lastPutMode)&&Q&&Q.parentNode&&Q.parentNode.removeChild(Q),z&&(this.nativeDraggable&&f(z,"dragend",this),Ze(z),z.style["will-change"]="",he&&!ve&&C(z,ae?ae.options.ghostClass:this.options.ghostClass,!1),C(z,this.options.chosenClass,!1),G({sortable:this,name:"unchoose",toEl:X,newIndex:null,newDraggableIndex:null,originalEvent:e}),J!==X?(ie>=0&&(G({rootEl:X,name:"add",toEl:X,fromEl:J,originalEvent:e}),G({sortable:this,name:"remove",toEl:X,originalEvent:e}),G({rootEl:X,name:"sort",toEl:X,fromEl:J,originalEvent:e}),G({sortable:this,name:"sort",toEl:X,originalEvent:e})),ae&&ae.save()):ie!==te&&ie>=0&&(G({sortable:this,name:"update",toEl:X,originalEvent:e}),G({sortable:this,name:"sort",toEl:X,originalEvent:e})),ke.active&&(null!=ie&&-1!==ie||(ie=te,ne=re),G({sortable:this,name:"end",toEl:X,originalEvent:e}),this.save())))),this._nulling()},_nulling:function(){$("nulling",this),J=z=X=H=Y=Q=K=ee=se=le=he=ie=ne=te=re=me=ye=ae=oe=ke.dragged=ke.ghost=ke.clone=ke.active=null,Ee.forEach((function(e){e.checked=!0})),Ee.length=ce=de=0},handleEvent:function(e){switch(e.type){case"drop":case"dragend":this._onDrop(e);break;case"dragenter":case"dragover":z&&(this._onDragOver(e),function(e){e.dataTransfer&&(e.dataTransfer.dropEffect="move");e.cancelable&&e.preventDefault()}(e));break;case"selectstart":e.preventDefault()}},toArray:function(){for(var e,t=[],i=this.el.children,r=0,n=i.length,o=this.options;r<n;r++)_(e=i[r],o.draggable,this.el,!1)&&t.push(e.getAttribute(o.dataIdAttr)||Be(e));return t},sort:function(e,t){var i={},r=this.el;this.toArray().forEach((function(e,t){var n=r.children[t];_(n,this.options.draggable,r,!1)&&(i[e]=n)}),this),t&&this.captureAnimationState(),e.forEach((function(e){i[e]&&(r.removeChild(i[e]),r.appendChild(i[e]))})),t&&this.animateAll()},save:function(){var e=this.options.store;e&&e.set&&e.set(this)},closest:function(e,t){return _(e,t||this.options.draggable,this.el,!1)},option:function(e,t){var i=this.options;if(void 0===t)return i[e];var r=U.modifyOption(this,e,t);i[e]=void 0!==r?r:t,"group"===e&&Pe(i)},destroy:function(){$("destroy",this);var e=this.el;e[Z]=null,f(e,"mousedown",this._onTapStart),f(e,"touchstart",this._onTapStart),f(e,"pointerdown",this._onTapStart),this.nativeDraggable&&(f(e,"dragover",this),f(e,"dragenter",this)),Array.prototype.forEach.call(e.querySelectorAll("[draggable]"),(function(e){e.removeAttribute("draggable")})),this._onDrop(),this._disableDelayedDragEvents(),_e.splice(_e.indexOf(this.el),1),this.el=e=null},_hideClone:function(){if(!ee){if($("hideClone",this),ke.eventCanceled)return;I(Q,"display","none"),this.options.removeCloneOnHide&&Q.parentNode&&Q.parentNode.removeChild(Q),ee=!0}},_showClone:function(e){if("clone"===e.lastPutMode){if(ee){if($("showClone",this),ke.eventCanceled)return;z.parentNode!=J||this.options.group.revertClone?Y?J.insertBefore(Q,Y):J.appendChild(Q):J.insertBefore(Q,z),this.options.group.revertClone&&this.animate(z,Q),I(Q,"display",""),ee=!1}}else this._hideClone()}},Ae&&g(document,"touchmove",(function(e){(ke.active||ve)&&e.cancelable&&e.preventDefault()})),ke.utils={on:g,off:f,css:I,find:A,is:function(e,t){return!!_(e,t,e,!1)},extend:function(e,t){if(e&&t)for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i]);return e},throttle:R,closest:_,toggleClass:C,clone:F,index:P,nextTick:We,cancelNextTick:Ue,detectDirection:Me,getChild:O},ke.get=function(e){return e[Z]},ke.mount=function(){for(var e=arguments.length,t=new Array(e),i=0;i<e;i++)t[i]=arguments[i];t[0].constructor===Array&&(t=t[0]),t.forEach((function(e){if(!e.prototype||!e.prototype.constructor)throw"Sortable: Mounted plugin must be a constructor function, not ".concat({}.toString.call(e));e.utils&&(ke.utils=a({},ke.utils,e.utils)),U.mount(e)}))},ke.create=function(e,t){return new ke(e,t)},ke.version="1.13.0";var qe,$e,Ge,ze,Xe,He,Je=[],Ye=!1;function Ke(){Je.forEach((function(e){clearInterval(e.pid)})),Je=[]}function Qe(){clearInterval(He)}var et=R((function(e,t,i,r){if(t.scroll){var n,o=(e.touches?e.touches[0]:e).clientX,a=(e.touches?e.touches[0]:e).clientY,s=t.scrollSensitivity,l=t.scrollSpeed,c=x(),d=!1;$e!==i&&($e=i,Ke(),qe=t.scroll,n=t.scrollFn,!0===qe&&(qe=N(i,!0)));var u=0,p=qe;do{var h=p,m=T(h),y=m.top,g=m.bottom,f=m.left,v=m.right,b=m.width,_=m.height,w=void 0,S=void 0,C=h.scrollWidth,E=h.scrollHeight,A=I(h),L=h.scrollLeft,O=h.scrollTop;h===c?(w=b<C&&("auto"===A.overflowX||"scroll"===A.overflowX||"visible"===A.overflowX),S=_<E&&("auto"===A.overflowY||"scroll"===A.overflowY||"visible"===A.overflowY)):(w=b<C&&("auto"===A.overflowX||"scroll"===A.overflowX),S=_<E&&("auto"===A.overflowY||"scroll"===A.overflowY));var M=w&&(Math.abs(v-o)<=s&&L+b<C)-(Math.abs(f-o)<=s&&!!L),P=S&&(Math.abs(g-a)<=s&&O+_<E)-(Math.abs(y-a)<=s&&!!O);if(!Je[u])for(var j=0;j<=u;j++)Je[j]||(Je[j]={});Je[u].vx==M&&Je[u].vy==P&&Je[u].el===h||(Je[u].el=h,Je[u].vx=M,Je[u].vy=P,clearInterval(Je[u].pid),0==M&&0==P||(d=!0,Je[u].pid=setInterval(function(){r&&0===this.layer&&ke.active._onTouchMove(Xe);var t=Je[this.layer].vy?Je[this.layer].vy*l:0,i=Je[this.layer].vx?Je[this.layer].vx*l:0;"function"==typeof n&&"continue"!==n.call(ke.dragged.parentNode[Z],i,t,e,Xe,Je[this.layer].el)||k(Je[this.layer].el,i,t)}.bind({layer:u}),24))),u++}while(t.bubbleScroll&&p!==c&&(p=N(p,!1)));Ye=d}}),30),tt=function(e){var t=e.originalEvent,i=e.putSortable,r=e.dragEl,n=e.activeSortable,o=e.dispatchSortableEvent,a=e.hideGhostForTarget,s=e.unhideGhostForTarget;if(t){var l=i||n;a();var c=t.changedTouches&&t.changedTouches.length?t.changedTouches[0]:t,d=document.elementFromPoint(c.clientX,c.clientY);s(),l&&!l.el.contains(d)&&(o("spill"),this.onSpill({dragEl:r,putSortable:i}))}};function it(){}function rt(){}it.prototype={startIndex:null,dragStart:function(e){var t=e.oldDraggableIndex;this.startIndex=t},onSpill:function(e){var t=e.dragEl,i=e.putSortable;this.sortable.captureAnimationState(),i&&i.captureAnimationState();var r=O(this.sortable.el,this.startIndex,this.options);r?this.sortable.el.insertBefore(t,r):this.sortable.el.appendChild(t),this.sortable.animateAll(),i&&i.animateAll()},drop:tt},o(it,{pluginName:"revertOnSpill"}),rt.prototype={onSpill:function(e){var t=e.dragEl,i=e.putSortable||this.sortable;i.captureAnimationState(),t.parentNode&&t.parentNode.removeChild(t),i.animateAll()},drop:tt},o(rt,{pluginName:"removeOnSpill"});ke.mount(new function(){function e(){for(var e in this.defaults={scroll:!0,scrollSensitivity:30,scrollSpeed:10,bubbleScroll:!0},this)"_"===e.charAt(0)&&"function"==typeof this[e]&&(this[e]=this[e].bind(this))}return e.prototype={dragStarted:function(e){var t=e.originalEvent;this.sortable.nativeDraggable?g(document,"dragover",this._handleAutoScroll):this.options.supportPointer?g(document,"pointermove",this._handleFallbackAutoScroll):t.touches?g(document,"touchmove",this._handleFallbackAutoScroll):g(document,"mousemove",this._handleFallbackAutoScroll)},dragOverCompleted:function(e){var t=e.originalEvent;this.options.dragOverBubble||t.rootEl||this._handleAutoScroll(t)},drop:function(){this.sortable.nativeDraggable?f(document,"dragover",this._handleAutoScroll):(f(document,"pointermove",this._handleFallbackAutoScroll),f(document,"touchmove",this._handleFallbackAutoScroll),f(document,"mousemove",this._handleFallbackAutoScroll)),Qe(),Ke(),clearTimeout(w),w=void 0},nulling:function(){Xe=$e=qe=Ye=He=Ge=ze=null,Je.length=0},_handleFallbackAutoScroll:function(e){this._handleAutoScroll(e,!0)},_handleAutoScroll:function(e,t){var i=this,r=(e.touches?e.touches[0]:e).clientX,n=(e.touches?e.touches[0]:e).clientY,o=document.elementFromPoint(r,n);if(Xe=e,t||d||c||p){et(e,this.options,o,t);var a=N(o,!0);!Ye||He&&r===Ge&&n===ze||(He&&Qe(),He=setInterval((function(){var o=N(document.elementFromPoint(r,n),!0);o!==a&&(a=o,Ke()),et(e,i.options,o,t)}),10),Ge=r,ze=n)}else{if(!this.options.bubbleScroll||N(o,!0)===x())return void Ke();et(e,this.options,N(o,!1),!1)}}},o(e,{pluginName:"scroll",initializeByDefault:!0})}),ke.mount(rt,it);const nt=ke},45829:(e,t,i)=>{"use strict";i.r(t),i.d(t,{default:()=>s});var r=i(93379),n=i.n(r),o=i(17004),a={insert:"head",singleton:!1};n()(o.Z,a);const s=o.Z.locals||{}}}]);
//# sourceMappingURL=2646.js.map