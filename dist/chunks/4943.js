(self.webpackChunkimaps=self.webpackChunkimaps||[]).push([[4943],{30663:(t,e,n)=>{"use strict";function r(){return[1,0,0,0,1,0,0,0,1]}function o(t,e){return new Float64Array(t,e,9)}n.d(e,{a:()=>r,c:()=>o});Object.freeze({__proto__:null,create:r,clone:function(t){return[t[0],t[1],t[2],t[3],t[4],t[5],t[6],t[7],t[8]]},fromValues:function(t,e,n,r,o,i,s,l,a){return[t,e,n,r,o,i,s,l,a]},createView:o})},2847:(t,e,n)=>{"use strict";n.d(e,{c:()=>h,g:()=>c,i:()=>p,r:()=>S});var r=n(77625),o=n(60418),i=n(17387),s=n(30663),l=n(32232),a=n(34353);function u(t,e,n){n*=.5;const r=Math.sin(n);return t[0]=r*e[0],t[1]=r*e[1],t[2]=r*e[2],t[3]=Math.cos(n),t}function c(t,e){const n=2*Math.acos(e[3]),r=Math.sin(n/2);return r>o.E?(t[0]=e[0]/r,t[1]=e[1]/r,t[2]=e[2]/r):(t[0]=1,t[1]=0,t[2]=0),n}function f(t,e,n){const r=e[0],o=e[1],i=e[2],s=e[3],l=n[0],a=n[1],u=n[2],c=n[3];return t[0]=r*c+s*l+o*u-i*a,t[1]=o*c+s*a+i*l-r*u,t[2]=i*c+s*u+r*a-o*l,t[3]=s*c-r*l-o*a-i*u,t}function d(t,e,n,r){const i=e[0],s=e[1],l=e[2],a=e[3];let u,c,f,d,p,h=n[0],y=n[1],b=n[2],w=n[3];return c=i*h+s*y+l*b+a*w,c<0&&(c=-c,h=-h,y=-y,b=-b,w=-w),1-c>o.E?(u=Math.acos(c),f=Math.sin(u),d=Math.sin((1-r)*u)/f,p=Math.sin(r*u)/f):(d=1-r,p=r),t[0]=d*i+p*h,t[1]=d*s+p*y,t[2]=d*l+p*b,t[3]=d*a+p*w,t}function p(t,e){const n=e[0],r=e[1],o=e[2],i=e[3],s=n*n+r*r+o*o+i*i,l=s?1/s:0;return t[0]=-n*l,t[1]=-r*l,t[2]=-o*l,t[3]=i*l,t}function h(t,e){return t[0]=-e[0],t[1]=-e[1],t[2]=-e[2],t[3]=e[3],t}function y(t,e){const n=e[0]+e[4]+e[8];let r;if(n>0)r=Math.sqrt(n+1),t[3]=.5*r,r=.5/r,t[0]=(e[5]-e[7])*r,t[1]=(e[6]-e[2])*r,t[2]=(e[1]-e[3])*r;else{let n=0;e[4]>e[0]&&(n=1),e[8]>e[3*n+n]&&(n=2);const o=(n+1)%3,i=(n+2)%3;r=Math.sqrt(e[3*n+n]-e[3*o+o]-e[3*i+i]+1),t[n]=.5*r,r=.5/r,t[3]=(e[3*o+i]-e[3*i+o])*r,t[o]=(e[3*o+n]+e[3*n+o])*r,t[i]=(e[3*i+n]+e[3*n+i])*r}return t}const b=a.c,w=a.s,m=a.a,g=f,v=a.b,C=a.d,M=a.l,_=a.e,T=_,U=a.f,A=U,x=a.n,I=a.g,Z=a.h;function S(t,e,n){const r=(0,i.d)(e,n);return r<-.999999?((0,i.c)(j,V,e),(0,i.j)(j)<1e-6&&(0,i.c)(j,z,e),(0,i.n)(j,j),u(t,j,Math.PI),t):r>.999999?(t[0]=0,t[1]=0,t[2]=0,t[3]=1,t):((0,i.c)(j,e,n),t[0]=j[0],t[1]=j[1],t[2]=j[2],t[3]=1+r,x(t,t))}const j=(0,r.c)(),V=(0,r.f)(1,0,0),z=(0,r.f)(0,1,0);const O=(0,l.a)(),F=(0,l.a)();const B=(0,s.a)();Object.freeze({__proto__:null,identity:function(t){return t[0]=0,t[1]=0,t[2]=0,t[3]=1,t},setAxisAngle:u,getAxisAngle:c,multiply:f,rotateX:function(t,e,n){n*=.5;const r=e[0],o=e[1],i=e[2],s=e[3],l=Math.sin(n),a=Math.cos(n);return t[0]=r*a+s*l,t[1]=o*a+i*l,t[2]=i*a-o*l,t[3]=s*a-r*l,t},rotateY:function(t,e,n){n*=.5;const r=e[0],o=e[1],i=e[2],s=e[3],l=Math.sin(n),a=Math.cos(n);return t[0]=r*a-i*l,t[1]=o*a+s*l,t[2]=i*a+r*l,t[3]=s*a-o*l,t},rotateZ:function(t,e,n){n*=.5;const r=e[0],o=e[1],i=e[2],s=e[3],l=Math.sin(n),a=Math.cos(n);return t[0]=r*a+o*l,t[1]=o*a-r*l,t[2]=i*a+s*l,t[3]=s*a-i*l,t},calculateW:function(t,e){const n=e[0],r=e[1],o=e[2];return t[0]=n,t[1]=r,t[2]=o,t[3]=Math.sqrt(Math.abs(1-n*n-r*r-o*o)),t},slerp:d,random:function(t){const e=(0,o.R)(),n=(0,o.R)(),r=(0,o.R)(),i=Math.sqrt(1-e),s=Math.sqrt(e);return t[0]=i*Math.sin(2*Math.PI*n),t[1]=i*Math.cos(2*Math.PI*n),t[2]=s*Math.sin(2*Math.PI*r),t[3]=s*Math.cos(2*Math.PI*r),t},invert:p,conjugate:h,fromMat3:y,fromEuler:function(t,e,n,r){const o=.5*Math.PI/180;e*=o,n*=o,r*=o;const i=Math.sin(e),s=Math.cos(e),l=Math.sin(n),a=Math.cos(n),u=Math.sin(r),c=Math.cos(r);return t[0]=i*a*c-s*l*u,t[1]=s*l*c+i*a*u,t[2]=s*a*u-i*l*c,t[3]=s*a*c+i*l*u,t},str:function(t){return"quat("+t[0]+", "+t[1]+", "+t[2]+", "+t[3]+")"},copy:b,set:w,add:m,mul:g,scale:v,dot:C,lerp:M,length:_,len:T,squaredLength:U,sqrLen:A,normalize:x,exactEquals:I,equals:Z,rotationTo:S,sqlerp:function(t,e,n,r,o,i){return d(O,e,o,i),d(F,n,r,i),d(t,O,F,2*i*(1-i)),t},setAxes:function(t,e,n,r){const o=B;return o[0]=n[0],o[3]=n[1],o[6]=n[2],o[1]=r[0],o[4]=r[1],o[7]=r[2],o[2]=-e[0],o[5]=-e[1],o[8]=-e[2],x(t,y(t,o))}})},32232:(t,e,n)=>{"use strict";function r(){return[0,0,0,1]}function o(t,e){return new Float64Array(t,e,4)}n.d(e,{a:()=>r,c:()=>o});Object.freeze({__proto__:null,create:r,clone:function(t){return[t[0],t[1],t[2],t[3]]},fromValues:function(t,e,n,r){return[t,e,n,r]},createView:o,IDENTITY:[0,0,0,1]})},69236:(t,e,n)=>{"use strict";function r(){return new Float32Array(3)}function o(t){const e=new Float32Array(3);return e[0]=t[0],e[1]=t[1],e[2]=t[2],e}function i(t,e,n){const r=new Float32Array(3);return r[0]=t,r[1]=e,r[2]=n,r}function s(){return r()}function l(){return i(1,1,1)}function a(){return i(1,0,0)}function u(){return i(0,1,0)}function c(){return i(0,0,1)}n.d(e,{a:()=>o,c:()=>r,f:()=>i});const f=s(),d=l(),p=a(),h=u(),y=c();Object.freeze({__proto__:null,create:r,clone:o,fromValues:i,createView:function(t,e){return new Float32Array(t,e,3)},zeros:s,ones:l,unitX:a,unitY:u,unitZ:c,ZEROS:f,ONES:d,UNIT_X:p,UNIT_Y:h,UNIT_Z:y})},34353:(t,e,n)=>{"use strict";n.d(e,{a:()=>s,b:()=>c,c:()=>o,d:()=>b,e:()=>p,f:()=>h,g:()=>g,h:()=>v,i:()=>d,l:()=>w,n:()=>y,s:()=>i,t:()=>m});var r=n(60418);function o(t,e){return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t}function i(t,e,n,r,o){return t[0]=e,t[1]=n,t[2]=r,t[3]=o,t}function s(t,e,n){return t[0]=e[0]+n[0],t[1]=e[1]+n[1],t[2]=e[2]+n[2],t[3]=e[3]+n[3],t}function l(t,e,n){return t[0]=e[0]-n[0],t[1]=e[1]-n[1],t[2]=e[2]-n[2],t[3]=e[3]-n[3],t}function a(t,e,n){return t[0]=e[0]*n[0],t[1]=e[1]*n[1],t[2]=e[2]*n[2],t[3]=e[3]*n[3],t}function u(t,e,n){return t[0]=e[0]/n[0],t[1]=e[1]/n[1],t[2]=e[2]/n[2],t[3]=e[3]/n[3],t}function c(t,e,n){return t[0]=e[0]*n,t[1]=e[1]*n,t[2]=e[2]*n,t[3]=e[3]*n,t}function f(t,e){const n=e[0]-t[0],r=e[1]-t[1],o=e[2]-t[2],i=e[3]-t[3];return Math.sqrt(n*n+r*r+o*o+i*i)}function d(t,e){const n=e[0]-t[0],r=e[1]-t[1],o=e[2]-t[2],i=e[3]-t[3];return n*n+r*r+o*o+i*i}function p(t){const e=t[0],n=t[1],r=t[2],o=t[3];return Math.sqrt(e*e+n*n+r*r+o*o)}function h(t){const e=t[0],n=t[1],r=t[2],o=t[3];return e*e+n*n+r*r+o*o}function y(t,e){const n=e[0],r=e[1],o=e[2],i=e[3];let s=n*n+r*r+o*o+i*i;return s>0&&(s=1/Math.sqrt(s),t[0]=n*s,t[1]=r*s,t[2]=o*s,t[3]=i*s),t}function b(t,e){return t[0]*e[0]+t[1]*e[1]+t[2]*e[2]+t[3]*e[3]}function w(t,e,n,r){const o=e[0],i=e[1],s=e[2],l=e[3];return t[0]=o+r*(n[0]-o),t[1]=i+r*(n[1]-i),t[2]=s+r*(n[2]-s),t[3]=l+r*(n[3]-l),t}function m(t,e,n){const r=e[0],o=e[1],i=e[2],s=e[3];return t[0]=n[0]*r+n[4]*o+n[8]*i+n[12]*s,t[1]=n[1]*r+n[5]*o+n[9]*i+n[13]*s,t[2]=n[2]*r+n[6]*o+n[10]*i+n[14]*s,t[3]=n[3]*r+n[7]*o+n[11]*i+n[15]*s,t}function g(t,e){return t[0]===e[0]&&t[1]===e[1]&&t[2]===e[2]&&t[3]===e[3]}function v(t,e){const n=t[0],o=t[1],i=t[2],s=t[3],l=e[0],a=e[1],u=e[2],c=e[3];return Math.abs(n-l)<=r.E*Math.max(1,Math.abs(n),Math.abs(l))&&Math.abs(o-a)<=r.E*Math.max(1,Math.abs(o),Math.abs(a))&&Math.abs(i-u)<=r.E*Math.max(1,Math.abs(i),Math.abs(u))&&Math.abs(s-c)<=r.E*Math.max(1,Math.abs(s),Math.abs(c))}let C=l,M=a,_=u,T=f,U=d,A=p,x=h;Object.freeze({__proto__:null,copy:o,set:i,add:s,subtract:l,multiply:a,divide:u,ceil:function(t,e){return t[0]=Math.ceil(e[0]),t[1]=Math.ceil(e[1]),t[2]=Math.ceil(e[2]),t[3]=Math.ceil(e[3]),t},floor:function(t,e){return t[0]=Math.floor(e[0]),t[1]=Math.floor(e[1]),t[2]=Math.floor(e[2]),t[3]=Math.floor(e[3]),t},min:function(t,e,n){return t[0]=Math.min(e[0],n[0]),t[1]=Math.min(e[1],n[1]),t[2]=Math.min(e[2],n[2]),t[3]=Math.min(e[3],n[3]),t},max:function(t,e,n){return t[0]=Math.max(e[0],n[0]),t[1]=Math.max(e[1],n[1]),t[2]=Math.max(e[2],n[2]),t[3]=Math.max(e[3],n[3]),t},round:function(t,e){return t[0]=Math.round(e[0]),t[1]=Math.round(e[1]),t[2]=Math.round(e[2]),t[3]=Math.round(e[3]),t},scale:c,scaleAndAdd:function(t,e,n,r){return t[0]=e[0]+n[0]*r,t[1]=e[1]+n[1]*r,t[2]=e[2]+n[2]*r,t[3]=e[3]+n[3]*r,t},distance:f,squaredDistance:d,length:p,squaredLength:h,negate:function(t,e){return t[0]=-e[0],t[1]=-e[1],t[2]=-e[2],t[3]=-e[3],t},inverse:function(t,e){return t[0]=1/e[0],t[1]=1/e[1],t[2]=1/e[2],t[3]=1/e[3],t},normalize:y,dot:b,lerp:w,random:function(t,e){let n,o,i,s,l,a;e=e||1;do{n=2*(0,r.R)()-1,o=2*(0,r.R)()-1,l=n*n+o*o}while(l>=1);do{i=2*(0,r.R)()-1,s=2*(0,r.R)()-1,a=i*i+s*s}while(a>=1);const u=Math.sqrt((1-l)/a);return t[0]=e*n,t[1]=e*o,t[2]=e*i*u,t[3]=e*s*u,t},transformMat4:m,transformQuat:function(t,e,n){const r=e[0],o=e[1],i=e[2],s=n[0],l=n[1],a=n[2],u=n[3],c=u*r+l*i-a*o,f=u*o+a*r-s*i,d=u*i+s*o-l*r,p=-s*r-l*o-a*i;return t[0]=c*u+p*-s+f*-a-d*-l,t[1]=f*u+p*-l+d*-s-c*-a,t[2]=d*u+p*-a+c*-l-f*-s,t[3]=e[3],t},str:function(t){return"vec4("+t[0]+", "+t[1]+", "+t[2]+", "+t[3]+")"},exactEquals:g,equals:v,sub:C,mul:M,div:_,dist:T,sqrDist:U,len:A,sqrLen:x})},50897:(t,e,n)=>{"use strict";n.d(e,{Gv:()=>C,SO:()=>d,d9:()=>i,r3:()=>m,BD:()=>p,Qn:()=>h,Zm:()=>b,jE:()=>y,Ue:()=>o,cS:()=>v,Ho:()=>u,oJ:()=>l,al:()=>s,Cb:()=>f,kK:()=>w,vk:()=>g,HH:()=>a,bf:()=>c});n(95830);var r=n(52937);function o(t=M){return[t[0],t[1],t[2],t[3]]}function i(t){return[t[0],t[1],t[2],t[3]]}function s(t,e,n,r,i=o()){return i[0]=t,i[1]=e,i[2]=n,i[3]=r,i}function l(t,e=o()){return e[0]=t.xmin,e[1]=t.ymin,e[2]=t.xmax,e[3]=t.ymax,e}function a(t,e){return new r.Z({xmin:t[0],ymin:t[1],xmax:t[2],ymax:t[3],spatialReference:e})}function u(t,e){e[0]<t[0]&&(t[0]=e[0]),e[0]>t[2]&&(t[2]=e[0]),e[1]<t[1]&&(t[1]=e[1]),e[1]>t[3]&&(t[3]=e[1])}function c(t){return t[0]>=t[2]?0:t[2]-t[0]}function f(t){return t[1]>=t[3]?0:t[3]-t[1]}function d(t){return c(t)*f(t)}function p(t,e){return y(t,e[0],e[1])}function h(t,e){return y(t,e.x,e.y)}function y(t,e,n){return e>=t[0]&&n>=t[1]&&e<=t[2]&&n<=t[3]}function b(t,e,n){return e[0]>=t[0]-n&&e[1]>=t[1]-n&&e[0]<=t[2]+n&&e[1]<=t[3]+n}function w(t,e){return Math.max(e[0],t[0])<=Math.min(e[2],t[2])&&Math.max(e[1],t[1])<=Math.min(e[3],t[3])}function m(t,e){return e[0]>=t[0]&&e[2]<=t[2]&&e[1]>=t[1]&&e[3]<=t[3]}function g(t,e,n=t){return n[0]=t[0]-e,n[1]=t[1]-e,n[2]=t[2]+e,n[3]=t[3]+e,n}function v(t){return t?function(t,e){return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t}(t,C):o(C)}const C=[1/0,1/0,-1/0,-1/0],M=[0,0,0,0]},1434:(t,e,n)=>{"use strict";n.d(e,{Z:()=>m});var r,o=n(56140),i=(n(95830),n(82550)),s=(n(36544),n(68055)),l=n(79881),a=n(9870),u=n(87566),c=(n(10923),n(57002),n(86035),n(92768)),f=n(50560),d=n(58385),p=n(78745);let h=r=class extends d.wq{constructor(){super(...arguments),this.description=null,this.label=null,this.minValue=0,this.maxValue=0,this.color=null}clone(){return new r({description:this.description,label:this.label,minValue:this.minValue,maxValue:this.maxValue,color:(0,i.d9)(this.color)})}};(0,o._)([(0,l.Cb)({type:String,json:{write:!0}})],h.prototype,"description",void 0),(0,o._)([(0,l.Cb)({type:String,json:{write:!0}})],h.prototype,"label",void 0),(0,o._)([(0,l.Cb)({type:Number,json:{read:{source:"classMinValue"},write:{target:"classMinValue"}}})],h.prototype,"minValue",void 0),(0,o._)([(0,l.Cb)({type:Number,json:{read:{source:"classMaxValue"},write:{target:"classMaxValue"}}})],h.prototype,"maxValue",void 0),(0,o._)([(0,l.Cb)({type:p.default,json:{type:[s.z8],write:!0}})],h.prototype,"color",void 0),h=r=(0,o._)([(0,u.j)("esri.renderers.support.pointCloud.ColorClassBreakInfo")],h);const y=h;var b;let w=b=class extends c.Z{constructor(t){super(t),this.type="point-cloud-class-breaks",this.field=null,this.legendOptions=null,this.fieldTransformType=null,this.colorClassBreakInfos=null}clone(){return new b({...this.cloneProperties(),field:this.field,fieldTransformType:this.fieldTransformType,colorClassBreakInfos:(0,i.d9)(this.colorClassBreakInfos),legendOptions:(0,i.d9)(this.legendOptions)})}};(0,o._)([(0,a.J)({pointCloudClassBreaksRenderer:"point-cloud-class-breaks"})],w.prototype,"type",void 0),(0,o._)([(0,l.Cb)({json:{write:!0},type:String})],w.prototype,"field",void 0),(0,o._)([(0,l.Cb)({type:f.Z,json:{write:!0}})],w.prototype,"legendOptions",void 0),(0,o._)([(0,l.Cb)({type:c.Z.fieldTransformTypeKebabDict.apiValues,json:{type:c.Z.fieldTransformTypeKebabDict.jsonValues,read:c.Z.fieldTransformTypeKebabDict.read,write:c.Z.fieldTransformTypeKebabDict.write}})],w.prototype,"fieldTransformType",void 0),(0,o._)([(0,l.Cb)({type:[y],json:{write:!0}})],w.prototype,"colorClassBreakInfos",void 0),w=b=(0,o._)([(0,u.j)("esri.renderers.PointCloudClassBreaksRenderer")],w);const m=w},92768:(t,e,n)=>{"use strict";n.d(e,{Z:()=>T});var r,o=n(56140),i=(n(95830),n(82550)),s=(n(36544),n(68055),n(79881)),l=n(56274),a=n(87566),u=(n(10923),n(57002),n(86035),n(58385));let c=r=class extends u.wq{constructor(){super(...arguments),this.field=null,this.minValue=0,this.maxValue=255}clone(){return new r({field:this.field,minValue:this.minValue,maxValue:this.maxValue})}};(0,o._)([(0,s.Cb)({type:String,json:{write:!0}})],c.prototype,"field",void 0),(0,o._)([(0,s.Cb)({type:Number,nonNullable:!0,json:{write:!0}})],c.prototype,"minValue",void 0),(0,o._)([(0,s.Cb)({type:Number,nonNullable:!0,json:{write:!0}})],c.prototype,"maxValue",void 0),c=r=(0,o._)([(0,a.j)("esri.renderers.support.pointCloud.ColorModulation")],c);const f=c,d=new l.Xn({pointCloudFixedSizeAlgorithm:"fixed-size",pointCloudSplatAlgorithm:"splat"});let p=class extends u.wq{};(0,o._)([(0,s.Cb)({type:d.apiValues,readOnly:!0,nonNullable:!0,json:{type:d.jsonValues,read:!1,write:d.write}})],p.prototype,"type",void 0),p=(0,o._)([(0,a.j)("esri.renderers.support.pointCloud.PointSizeAlgorithm")],p);const h=p;var y,b=n(9870);let w=y=class extends h{constructor(){super(...arguments),this.type="fixed-size",this.size=0,this.useRealWorldSymbolSizes=null}clone(){return new y({size:this.size,useRealWorldSymbolSizes:this.useRealWorldSymbolSizes})}};(0,o._)([(0,b.J)({pointCloudFixedSizeAlgorithm:"fixed-size"})],w.prototype,"type",void 0),(0,o._)([(0,s.Cb)({type:Number,nonNullable:!0,json:{write:!0}})],w.prototype,"size",void 0),(0,o._)([(0,s.Cb)({type:Boolean,json:{write:!0}})],w.prototype,"useRealWorldSymbolSizes",void 0),w=y=(0,o._)([(0,a.j)("esri.renderers.support.pointCloud.PointSizeFixedSizeAlgorithm")],w);const m=w;var g;let v=g=class extends h{constructor(){super(...arguments),this.type="splat",this.scaleFactor=1}clone(){return new g({scaleFactor:this.scaleFactor})}};(0,o._)([(0,b.J)({pointCloudSplatAlgorithm:"splat"})],v.prototype,"type",void 0),(0,o._)([(0,s.Cb)({type:Number,value:1,nonNullable:!0,json:{write:!0}})],v.prototype,"scaleFactor",void 0),v=g=(0,o._)([(0,a.j)("esri.renderers.support.pointCloud.PointSizeSplatAlgorithm")],v);const C={key:"type",base:h,typeMap:{"fixed-size":m,splat:v}},M=(0,l.wY)()({pointCloudClassBreaksRenderer:"point-cloud-class-breaks",pointCloudRGBRenderer:"point-cloud-rgb",pointCloudStretchRenderer:"point-cloud-stretch",pointCloudUniqueValueRenderer:"point-cloud-unique-value"});let _=class extends u.wq{constructor(t){super(t),this.type=void 0,this.pointSizeAlgorithm=null,this.colorModulation=null,this.pointsPerInch=10}clone(){return console.warn(".clone() is not implemented for "+this.declaredClass),null}cloneProperties(){return{pointSizeAlgorithm:(0,i.d9)(this.pointSizeAlgorithm),colorModulation:(0,i.d9)(this.colorModulation),pointsPerInch:(0,i.d9)(this.pointsPerInch)}}};(0,o._)([(0,s.Cb)({type:M.apiValues,readOnly:!0,nonNullable:!0,json:{type:M.jsonValues,read:!1,write:M.write}})],_.prototype,"type",void 0),(0,o._)([(0,s.Cb)({types:C,json:{write:!0}})],_.prototype,"pointSizeAlgorithm",void 0),(0,o._)([(0,s.Cb)({type:f,json:{write:!0}})],_.prototype,"colorModulation",void 0),(0,o._)([(0,s.Cb)({json:{write:!0},nonNullable:!0,type:Number})],_.prototype,"pointsPerInch",void 0),_=(0,o._)([(0,a.j)("esri.renderers.PointCloudRenderer")],_),(_||(_={})).fieldTransformTypeKebabDict=new l.Xn({none:"none",lowFourBit:"low-four-bit",highFourBit:"high-four-bit",absoluteValue:"absolute-value",moduloTen:"modulo-ten"});const T=_},81751:(t,e,n)=>{"use strict";n.d(e,{Z:()=>m});var r,o=n(56140),i=(n(95830),n(82550)),s=(n(36544),n(68055)),l=n(79881),a=n(9870),u=n(87566),c=(n(10923),n(57002),n(86035),n(92768)),f=n(50560),d=n(58385),p=n(78745);let h=r=class extends d.wq{constructor(){super(...arguments),this.label=null,this.value=0,this.color=null}clone(){return new r({label:this.label,value:this.value,color:(0,i.d9)(this.color)})}};(0,o._)([(0,l.Cb)({type:String,json:{write:!0}})],h.prototype,"label",void 0),(0,o._)([(0,l.Cb)({type:Number,nonNullable:!0,json:{write:!0}})],h.prototype,"value",void 0),(0,o._)([(0,l.Cb)({type:p.default,json:{type:[s.z8],write:!0}})],h.prototype,"color",void 0),h=r=(0,o._)([(0,u.j)("esri.renderers.support.pointCloud.StopInfo")],h);const y=h;var b;let w=b=class extends c.Z{constructor(t){super(t),this.type="point-cloud-stretch",this.field=null,this.legendOptions=null,this.fieldTransformType=null,this.stops=null}clone(){return new b({...this.cloneProperties(),field:(0,i.d9)(this.field),fieldTransformType:(0,i.d9)(this.fieldTransformType),stops:(0,i.d9)(this.stops),legendOptions:(0,i.d9)(this.legendOptions)})}};(0,o._)([(0,a.J)({pointCloudStretchRenderer:"point-cloud-stretch"})],w.prototype,"type",void 0),(0,o._)([(0,l.Cb)({json:{write:!0},type:String})],w.prototype,"field",void 0),(0,o._)([(0,l.Cb)({type:f.Z,json:{write:!0}})],w.prototype,"legendOptions",void 0),(0,o._)([(0,l.Cb)({type:c.Z.fieldTransformTypeKebabDict.apiValues,json:{type:c.Z.fieldTransformTypeKebabDict.jsonValues,read:c.Z.fieldTransformTypeKebabDict.read,write:c.Z.fieldTransformTypeKebabDict.write}})],w.prototype,"fieldTransformType",void 0),(0,o._)([(0,l.Cb)({type:[y],json:{write:!0}})],w.prototype,"stops",void 0),w=b=(0,o._)([(0,u.j)("esri.renderers.PointCloudStretchRenderer")],w);const m=w},5041:(t,e,n)=>{"use strict";n.d(e,{Z:()=>m});var r,o=n(56140),i=(n(95830),n(82550)),s=(n(36544),n(68055)),l=n(79881),a=n(9870),u=n(87566),c=(n(10923),n(57002),n(86035),n(92768)),f=n(50560),d=n(58385),p=n(78745);let h=r=class extends d.wq{constructor(){super(...arguments),this.description=null,this.label=null,this.values=null,this.color=null}clone(){return new r({description:this.description,label:this.label,values:(0,i.d9)(this.values),color:(0,i.d9)(this.color)})}};(0,o._)([(0,l.Cb)({type:String,json:{write:!0}})],h.prototype,"description",void 0),(0,o._)([(0,l.Cb)({type:String,json:{write:!0}})],h.prototype,"label",void 0),(0,o._)([(0,l.Cb)({type:[String],json:{write:!0}})],h.prototype,"values",void 0),(0,o._)([(0,l.Cb)({type:p.default,json:{type:[s.z8],write:!0}})],h.prototype,"color",void 0),h=r=(0,o._)([(0,u.j)("esri.renderers.support.pointCloud.ColorUniqueValueInfo")],h);const y=h;var b;let w=b=class extends c.Z{constructor(t){super(t),this.type="point-cloud-unique-value",this.field=null,this.fieldTransformType=null,this.colorUniqueValueInfos=null,this.legendOptions=null}clone(){return new b({...this.cloneProperties(),field:(0,i.d9)(this.field),fieldTransformType:(0,i.d9)(this.fieldTransformType),colorUniqueValueInfos:(0,i.d9)(this.colorUniqueValueInfos),legendOptions:(0,i.d9)(this.legendOptions)})}};(0,o._)([(0,a.J)({pointCloudUniqueValueRenderer:"point-cloud-unique-value"})],w.prototype,"type",void 0),(0,o._)([(0,l.Cb)({json:{write:!0},type:String})],w.prototype,"field",void 0),(0,o._)([(0,l.Cb)({type:c.Z.fieldTransformTypeKebabDict.apiValues,json:{type:c.Z.fieldTransformTypeKebabDict.jsonValues,read:c.Z.fieldTransformTypeKebabDict.read,write:c.Z.fieldTransformTypeKebabDict.write}})],w.prototype,"fieldTransformType",void 0),(0,o._)([(0,l.Cb)({type:[y],json:{write:!0}})],w.prototype,"colorUniqueValueInfos",void 0),(0,o._)([(0,l.Cb)({type:f.Z,json:{write:!0}})],w.prototype,"legendOptions",void 0),w=b=(0,o._)([(0,u.j)("esri.renderers.PointCloudUniqueValueRenderer")],w);const m=w},50560:(t,e,n)=>{"use strict";n.d(e,{Z:()=>u});var r,o=n(56140),i=(n(95830),n(36544),n(68055),n(79881)),s=n(87566),l=(n(10923),n(57002),n(86035),n(58385));let a=r=class extends l.wq{constructor(){super(...arguments),this.title=null}clone(){return new r({title:this.title})}};(0,o._)([(0,i.Cb)({type:String,json:{write:!0}})],a.prototype,"title",void 0),a=r=(0,o._)([(0,s.j)("esri.renderers.support.LegendOptions")],a);const u=a},74199:(t,e,n)=>{"use strict";n.r(e),n.d(e,{default:()=>q});var r=n(6962),o=n(59472),i=n(39105),s=n(73032),l=n(17387),a=n(17333),u=n(2847),c=n(69236);function f(){const t=new Float32Array(4);return t[3]=1,t}Object.freeze({__proto__:null,create:f,clone:function(t){const e=new Float32Array(4);return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e},fromValues:function(t,e,n,r){const o=new Float32Array(4);return o[0]=t,o[1]=e,o[2]=n,o[3]=r,o},createView:function(t,e){return new Float32Array(t,e,4)}});var d=n(1434),p=n(81751),h=n(5041),y=n(32656);function b(t,e,n){return{identifier:String.fromCharCode.apply(null,new Uint8Array(t,n+0,10)),version:e.getUint16(n+10,!0),checksum:e.getUint32(n+12,!0)}}function w(t,e,n){const r=[];e=m(t,e,r);const o=[];for(let i=0;i<r.length;i++){o.length=0,e=m(t,e,o);for(let t=0;t<o.length;t++)n.push(o[t]+r[i])}return e}function m(t,e,n){const r=new DataView(t,e),o=r.getUint8(0),i=31&o,s=!!(32&o),l=(192&o)>>6;let a=0;if(0===l)a=r.getUint32(1,!0),e+=5;else if(1===l)a=r.getUint16(1,!0),e+=3;else{if(2!==l)throw new y.Z("lepcc-decode-error","Bad count type");a=r.getUint8(1),e+=2}if(s)throw new y.Z("lepcc-decode-error","LUT not implemented");const u=Math.ceil(a*i/8),c=new Uint8Array(t,e,u);let f=0,d=0,p=0;const h=-1>>>32-i;for(let t=0;t<a;t++){for(;d<i;)f|=c[p]<<d,d+=8,p+=1;n[t]=f&h,f>>>=i,d-=i,d+i>32&&(f|=c[p-1]>>8-d)}return e+p}var g=n(82550);const v=n(36544).Z.getLogger("esri.views.3d.layers.i3s.I3SBinaryReader");function C(t,e,n){let r="",o=0;for(;o<n;){const i=t[e+o];if(i<128)r+=String.fromCharCode(i),o++;else if(i>=192&&i<224){if(o+1>=n)throw new y.Z("utf8-decode-error","UTF-8 Decode failed. Two byte character was truncated.");const s=(31&i)<<6|63&t[e+o+1];r+=String.fromCharCode(s),o+=2}else if(i>=224&&i<240){if(o+2>=n)throw new y.Z("utf8-decode-error","UTF-8 Decode failed. Multi byte character was truncated.");const s=(15&i)<<12|(63&t[e+o+1])<<6|63&t[e+o+2];r+=String.fromCharCode(s),o+=3}else{if(!(i>=240&&i<248))throw new y.Z("utf8-decode-error","UTF-8 Decode failed. Invalid multi byte sequence.");{if(o+3>=n)throw new y.Z("utf8-decode-error","UTF-8 Decode failed. Multi byte character was truncated.");const s=(7&i)<<18|(63&t[e+o+1])<<12|(63&t[e+o+2])<<6|63&t[e+o+3];if(s>=65536){const t=55296+(s-65536>>10),e=56320+(1023&s);r+=String.fromCharCode(t,e)}else r+=String.fromCharCode(s);o+=4}}}return r}function M(t,e){const n={byteOffset:0,byteCount:0,fields:Object.create(null)};let r=0;for(let o=0;o<e.length;o++){const i=e[o],s=i.valueType||i.type,l=I[s];n.fields[i.property]=l(t,r),r+=x[s].BYTES_PER_ELEMENT}return n.byteCount=r,n}function _(t,e){return new(0,x[e.valueType])(t,e.byteOffset,e.count*e.valuesPerElement)}function T(t,e,n){if(e!==t&&v.error(`Invalid ${n} buffer size\n expected: ${t}, actual: ${e})`),e<t)throw new y.Z("buffer-too-small","Binary buffer is too small",{expectedSize:t,actualSize:e})}const U={position:"position",normal:"normal",color:"color",uv0:"uv0",region:"uvRegion"};function A(t,e,n){if("lepcc-rgb"===t.encoding)return function(t){const e=new DataView(t,0);let n=0;const{identifier:r,version:o}=b(t,e,n);if(n+=16,"ClusterRGB"!==r)throw new y.Z("lepcc-decode-error","Bad identifier");if(o>1)throw new y.Z("lepcc-decode-error","Unknown version");const i=function(t,e){return{sizeLo:t.getUint32(e+0,!0),sizeHi:t.getUint32(e+4,!0),count:t.getUint32(e+8,!0),colorMapCount:t.getUint16(e+12,!0),lookupMethod:t.getUint8(e+14),compressionMethod:t.getUint8(e+15)}}(e,n);if(n+=16,i.sizeHi*Math.pow(2,32)+i.sizeLo!==t.byteLength)throw new y.Z("lepcc-decode-error","Bad size");if((2===i.lookupMethod||1===i.lookupMethod)&&0===i.compressionMethod){if(3*i.colorMapCount+i.count+n!==t.byteLength||i.colorMapCount>256)throw new y.Z("lepcc-decode-error","Bad count");const e=new Uint8Array(t,n,3*i.colorMapCount),r=new Uint8Array(t,n+3*i.colorMapCount,i.count),o=new Uint8Array(3*i.count);for(let t=0;t<i.count;t++){const n=r[t];o[3*t]=e[3*n],o[3*t+1]=e[3*n+1],o[3*t+2]=e[3*n+2]}return o}if(0===i.lookupMethod&&0===i.compressionMethod){if(3*i.count+n!==t.byteLength||0!==i.colorMapCount)throw new y.Z("lepcc-decode-error","Bad count");return new Uint8Array(t,n).slice()}if(i.lookupMethod<=2&&1===i.compressionMethod){if(n+3!==t.byteLength||1!==i.colorMapCount)throw new y.Z("lepcc-decode-error","Bad count");const r=e.getUint8(n),o=e.getUint8(n+1),s=e.getUint8(n+2),l=new Uint8Array(3*i.count);for(let t=0;t<i.count;t++)l[3*t]=r,l[3*t+1]=o,l[3*t+2]=s;return l}throw new y.Z("lepcc-decode-error","Bad method "+i.lookupMethod+","+i.compressionMethod)}(e);if("lepcc-intensity"===t.encoding)return function(t){const e=new DataView(t,0);let n=0;const{identifier:r,version:o}=b(t,e,n);if(n+=16,"Intensity "!==r)throw new y.Z("lepcc-decode-error","Bad identifier");if(o>1)throw new y.Z("lepcc-decode-error","Unknown version");const i=function(t,e){return{sizeLo:t.getUint32(e+0,!0),sizeHi:t.getUint32(e+4,!0),count:t.getUint32(e+8,!0),scaleFactor:t.getUint16(e+12,!0),bitsPerPoint:t.getUint8(e+14),reserved:t.getUint8(e+15)}}(e,n);if(n+=16,i.sizeHi*Math.pow(2,32)+i.sizeLo!==t.byteLength)throw new y.Z("lepcc-decode-error","Bad size");const s=new Uint16Array(i.count);if(8===i.bitsPerPoint){if(i.count+n!==t.byteLength)throw new y.Z("lepcc-decode-error","Bad size");const e=new Uint8Array(t,n,i.count);for(let t=0;t<i.count;t++)s[t]=e[t]*i.scaleFactor}else if(16===i.bitsPerPoint){if(2*i.count+n!==t.byteLength)throw new y.Z("lepcc-decode-error","Bad size");const e=new Uint16Array(t,n,i.count);for(let t=0;t<i.count;t++)s[t]=e[t]*i.scaleFactor}else{const e=[];if(m(t,n,e)!==t.byteLength)throw new y.Z("lepcc-decode-error","Bad size");for(let t=0;t<i.count;t++)s[t]=e[t]*i.scaleFactor}return s}(e);if(null!=t.encoding&&""!==t.encoding)throw new y.Z("unknown-attribute-storage-info-encoding","Unknown Attribute Storage Info Encoding");t["attributeByteCounts "]&&!t.attributeByteCounts&&(v.warn("Warning: Trailing space in 'attributeByteCounts '."),t.attributeByteCounts=t["attributeByteCounts "]),"ObjectIds"===t.ordering[0]&&t.hasOwnProperty("objectIds")&&(v.warn("Warning: Case error in objectIds"),t.ordering[0]="objectIds");const r=function(t,e,n){const r=null!=e.header?M(t,e.header):{byteOffset:0,byteCount:0,fields:{count:n}},o={header:r,byteOffset:r.byteCount,byteCount:0,entries:Object.create(null)};let i=r.byteCount;for(let t=0;t<e.ordering.length;t++){const n=e.ordering[t],s=(0,g.d9)(e[n]);if(s.count=r.fields.count,"String"===s.valueType){if(s.byteOffset=i,s.byteCount=r.fields[n+"ByteCount"],"UTF-8"!==s.encoding)throw new y.Z("unsupported-encoding","Unsupported String encoding.",{encoding:s.encoding})}else{if(!Z(s.valueType))throw new y.Z("unsupported-value-type","Unsupported binary valueType",{valueType:s.valueType});{const t=S(s.valueType);i+=i%t!=0?t-i%t:0,s.byteOffset=i,s.byteCount=t*s.valuesPerElement*s.count}}i+=s.byteCount,o.entries[n]=s}return o.byteCount=i-o.byteOffset,o}(e,t,n);T(r.byteOffset+r.byteCount,e.byteLength,"attribute");const o=r.entries.attributeValues||r.entries.objectIds;if(o){if("String"===o.valueType){const t=r.entries.attributeByteCounts,n=_(e,t),i=function(t,e){return new Uint8Array(t,e.byteOffset,e.byteCount)}(e,o);return function(t,e,n){const r=[];let o,i,s=0;for(i=0;i<t;i+=1){if(o=e[i],o>0){if(r.push(C(n,s,o-1)),0!==n[s+o-1])throw new y.Z("string-array-error","Invalid string array: missing null termination.")}else r.push(null);s+=o}return r}(t.count,n,i)}return _(e,o)}throw new y.Z("bad-attribute-storage-info","Bad attributeStorageInfo specification.")}const x={Float32:Float32Array,Float64:Float64Array,UInt8:Uint8Array,Int8:Int8Array,UInt16:Uint16Array,Int16:Int16Array,UInt32:Uint32Array,Int32:Int32Array},I={Float32:(t,e)=>new DataView(t,0).getFloat32(e,!0),Float64:(t,e)=>new DataView(t,0).getFloat64(e,!0),UInt8:(t,e)=>new DataView(t,0).getUint8(e),Int8:(t,e)=>new DataView(t,0).getInt8(e),UInt16:(t,e)=>new DataView(t,0).getUint16(e,!0),Int16:(t,e)=>new DataView(t,0).getInt16(e,!0),UInt32:(t,e)=>new DataView(t,0).getUint32(e,!0),Int32:(t,e)=>new DataView(t,0).getInt32(e,!0)};function Z(t){return x.hasOwnProperty(t)}function S(t){return Z(t)?x[t].BYTES_PER_ELEMENT:0}function j(t,e){if(null==t.encoding||""===t.encoding){const n=function(t,e){const n=M(t,e&&e.header);let r=n.byteCount;const o={isDraco:!1,header:n,byteOffset:n.byteCount,byteCount:0,vertexAttributes:{}},i=n.fields,s=null!=i.vertexCount?i.vertexCount:i.count;for(const t of e.ordering){if(!e.vertexAttributes[t])continue;const n={...e.vertexAttributes[t],byteOffset:r,count:s},i=U[t]?U[t]:"_"+t;o.vertexAttributes[i]=n,r+=S(n.valueType)*n.valuesPerElement*s}const l=i.faceCount;if(e.faces&&l){o.faces={};for(const t of e.ordering){if(!e.faces[t])continue;const n={...e.faces[t],byteOffset:r,count:l};o.faces[t]=n,r+=S(n.valueType)*n.valuesPerElement*l}}const a=i.featureCount;if(e.featureAttributes&&e.featureAttributeOrder&&a){o.featureAttributes={};for(const t of e.featureAttributeOrder){if(!e.featureAttributes[t])continue;const n={...e.featureAttributes[t],byteOffset:r,count:a};o.featureAttributes[t]=n,r+=("UInt64"===n.valueType?8:S(n.valueType))*n.valuesPerElement*a}}return T(r,t.byteLength,"geometry"),o.byteCount=r-o.byteOffset,o}(e,t);if((0,o.Wi)(n.vertexAttributes.position))return;const r=_(e,n.vertexAttributes.position),i=n.header.fields,s=[i.offsetX,i.offsetY,i.offsetZ],l=[i.scaleX,i.scaleY,i.scaleZ],a=r.length/3,u=new Float64Array(3*a);for(let t=0;t<a;t++)u[3*t]=r[3*t]*l[0]+s[0],u[3*t+1]=r[3*t+1]*l[1]+s[1],u[3*t+2]=r[3*t+2]*l[2]+s[2];return u}if("lepcc-xyz"===t.encoding)return function(t){const e=new DataView(t,0);let n=0;const{identifier:r,version:o}=b(t,e,n);if(n+=16,"LEPCC     "!==r)throw new y.Z("lepcc-decode-error","Bad identifier");if(o>1)throw new y.Z("lepcc-decode-error","Unknown version");const i=function(t,e){return{sizeLo:t.getUint32(e+0,!0),sizeHi:t.getUint32(e+4,!0),minX:t.getFloat64(e+8,!0),minY:t.getFloat64(e+16,!0),minZ:t.getFloat64(e+24,!0),maxX:t.getFloat64(e+32,!0),maxY:t.getFloat64(e+40,!0),maxZ:t.getFloat64(e+48,!0),errorX:t.getFloat64(e+56,!0),errorY:t.getFloat64(e+64,!0),errorZ:t.getFloat64(e+72,!0),count:t.getUint32(e+80,!0),reserved:t.getUint32(e+84,!0)}}(e,n);if(n+=88,i.sizeHi*Math.pow(2,32)+i.sizeLo!==t.byteLength)throw new y.Z("lepcc-decode-error","Bad size");const s=new Float64Array(3*i.count),l=[],a=[],u=[],c=[];if(n=w(t,n,l),n=w(t,n,a),n=w(t,n,u),n=w(t,n,c),n!==t.byteLength)throw new y.Z("lepcc-decode-error","Bad length");let f=0,d=0;for(let t=0;t<l.length;t++){d+=l[t];let e=0;for(let n=0;n<a[t];n++){e+=u[f];const t=c[f];s[3*f]=Math.min(i.maxX,i.minX+2*i.errorX*e),s[3*f+1]=Math.min(i.maxY,i.minY+2*i.errorY*d),s[3*f+2]=Math.min(i.maxZ,i.minZ+2*i.errorZ*t),f++}}return{errorX:i.errorX,errorY:i.errorY,errorZ:i.errorZ,result:s}}(e).result}function V(t,e,n){return(0,o.pC)(t)&&t.attributeInfo.useElevation?function(t,e){const n=new Float64Array(e);for(let r=0;r<e;r++)n[r]=t[3*r+2];return n}(e,n):(0,o.pC)(t)?A(t.attributeInfo.storageInfo,t.buffer,n):null}function z(t){return null==t||"none"===t?null:"low-four-bit"===t?t=>15&t:"high-four-bit"===t?t=>(240&t)>>4:"absolute-value"===t?t=>Math.abs(t):"modulo-ten"===t?t=>t%10:null}function O(t){let e=0;for(const n of t||[])e|=1<<n;return e}class F{transform(t){const e=this._transform(t),n=[e.points.buffer,e.rgb.buffer];(0,o.pC)(e.pointIdFilterMap)&&n.push(e.pointIdFilterMap.buffer);for(const t of e.attributes)"buffer"in t.values&&(0,r.eP)(t.values.buffer)&&t.values.buffer!==e.rgb.buffer&&n.push(t.values.buffer);return(0,i.resolve)({result:e,transferList:n})}_transform(t){const e=j(t.schema,t.geometryBuffer);let n=e.length/3,r=null;const i=[],l=V(t.primaryAttributeData,e,n);(0,o.pC)(t.primaryAttributeData)&&l&&i.push({attributeInfo:t.primaryAttributeData.attributeInfo,values:l});const a=V(t.modulationAttributeData,e,n);(0,o.pC)(t.modulationAttributeData)&&a&&i.push({attributeInfo:t.modulationAttributeData.attributeInfo,values:a});let u=function(t,e,n,r){const{rendererJSON:o,isRGBRenderer:i}=t;let s=null,l=null;if(e&&i)s=e;else if(e&&"pointCloudUniqueValueRenderer"===o.type){l=h.Z.fromJSON(o);const t=l.colorUniqueValueInfos;s=new Uint8Array(3*r);const n=z(l.fieldTransformType);for(let o=0;o<r;o++){const r=(n?n(e[o]):e[o])+"";for(let e=0;e<t.length;e++)if(t[e].values.indexOf(r)>=0){s[3*o]=t[e].color.r,s[3*o+1]=t[e].color.g,s[3*o+2]=t[e].color.b;break}}}else if(e&&"pointCloudStretchRenderer"===o.type){l=p.Z.fromJSON(o);const t=l.stops;s=new Uint8Array(3*r);const n=z(l.fieldTransformType);for(let o=0;o<r;o++){const r=n?n(e[o]):e[o],i=t.length-1;if(r<t[0].value)s[3*o]=t[0].color.r,s[3*o+1]=t[0].color.g,s[3*o+2]=t[0].color.b;else if(r>=t[i].value)s[3*o]=t[i].color.r,s[3*o+1]=t[i].color.g,s[3*o+2]=t[i].color.b;else for(let e=1;e<t.length;e++)if(r<t[e].value){const n=(r-t[e-1].value)/(t[e].value-t[e-1].value);s[3*o]=t[e].color.r*n+t[e-1].color.r*(1-n),s[3*o+1]=t[e].color.g*n+t[e-1].color.g*(1-n),s[3*o+2]=t[e].color.b*n+t[e-1].color.b*(1-n);break}}}else if(e&&"pointCloudClassBreaksRenderer"===o.type){l=d.Z.fromJSON(o);const t=l.colorClassBreakInfos;s=new Uint8Array(3*r);const n=z(l.fieldTransformType);for(let o=0;o<r;o++){const r=n?n(e[o]):e[o];for(let e=0;e<t.length;e++)if(r>=t[e].minValue&&r<=t[e].maxValue){s[3*o]=t[e].color.r,s[3*o+1]=t[e].color.g,s[3*o+2]=t[e].color.b;break}}}else{s=new Uint8Array(3*r);for(let t=0;t<s.length;t++)s[t]=255}if(n&&l&&l.colorModulation){const t=l.colorModulation.minValue,e=l.colorModulation.maxValue,o=.3;for(let i=0;i<r;i++){const r=n[i],l=r>=e?1:r<=t?o:o+(1-o)*(r-t)/(e-t);s[3*i]=l*s[3*i],s[3*i+1]=l*s[3*i+1],s[3*i+2]=l*s[3*i+2]}}return s}(t.rendererInfo,l,a,n);if(t.filterInfo&&t.filterInfo.length>0&&(0,o.pC)(t.filterAttributesData)){const o=t.filterAttributesData.map((t=>{const r=V(t,e,n),o={attributeInfo:t.attributeInfo,values:r};return i.push(o),o}));r=new Uint32Array(n),n=function(t,e,n,r,o){const i=t.length/3;let s=0;for(let l=0;l<i;l++){let i=!0;for(let t=0;t<r.length&&i;t++){const{filterJSON:e}=r[t],n=o[t].values[l];switch(e.type){case"pointCloudValueFilter":{const t="exclude"===e.mode;-1!==e.values.indexOf(n)===t&&(i=!1);break}case"pointCloudBitfieldFilter":{const t=O(e.requiredSetBits),r=O(e.requiredClearBits);(n&t)===t&&0==(n&r)||(i=!1);break}case"pointCloudReturnFilter":{const t=15&n,r=n>>>4&15,o=r>1,s=1===t,l=t===r;let a=!1;for(const t of e.includedReturns)if("last"===t&&l||"firstOfMany"===t&&s&&o||"lastOfMany"===t&&l&&o||"single"===t&&!o){a=!0;break}a||(i=!1);break}}}i&&(n[s]=l,t[3*s]=t[3*l],t[3*s+1]=t[3*l+1],t[3*s+2]=t[3*l+2],e[3*s]=e[3*l],e[3*s+1]=e[3*l+1],e[3*s+2]=e[3*l+2],s++)}return s}(e,u,r,t.filterInfo,o)}for(const r of t.userAttributesData){const t=V(r,e,n);i.push({attributeInfo:r.attributeInfo,values:t})}3*n<u.length&&(u=new Uint8Array(u.buffer.slice(0,3*n))),this._applyElevationOffsetInPlace(e,n,t.elevationOffset);const c=this._transformCoordinates(e,n,t.obb,s.Z.fromJSON(t.inSR),s.Z.fromJSON(t.outSR));return{obb:t.obb,points:c,rgb:u,attributes:i,pointIdFilterMap:r}}_transformCoordinates(t,e,n,r,o){if(!(0,a.CM)(t,r,0,t,o,0,e))throw Error("Can't reproject");const i=(0,c.f)(n.center[0],n.center[1],n.center[2]),s=(0,c.c)(),f=(0,c.c)();(0,u.c)(B,n.quaternion);const d=new Float32Array(3*e);for(let r=0;r<e;r++)s[0]=t[3*r]-i[0],s[1]=t[3*r+1]-i[1],s[2]=t[3*r+2]-i[2],(0,l.q)(f,s,B),n.halfSize[0]=Math.max(n.halfSize[0],Math.abs(f[0])),n.halfSize[1]=Math.max(n.halfSize[1],Math.abs(f[1])),n.halfSize[2]=Math.max(n.halfSize[2],Math.abs(f[2])),d[3*r]=s[0],d[3*r+1]=s[1],d[3*r+2]=s[2];return d}_applyElevationOffsetInPlace(t,e,n){if(0!==n)for(let r=0;r<e;r++)t[3*r+2]+=n}}const B=f();const q=function(){return new F}}}]);
//# sourceMappingURL=4943.js.map