{"version":3,"sources":["webpack://imaps/./node_modules/@arcgis/core/renderers/support/heatmapUtils.js","webpack://imaps/./node_modules/@arcgis/core/views/2d/engine/Bitmap.js","webpack://imaps/./node_modules/@arcgis/core/views/2d/engine/BitmapTile.js","webpack://imaps/./node_modules/@arcgis/core/views/2d/engine/BitmapTileContainer.js","webpack://imaps/./node_modules/@arcgis/core/views/2d/engine/ImageryBitmapSource.js","webpack://imaps/./node_modules/@arcgis/core/views/2d/engine/webgl/TileContainer.js","webpack://imaps/./node_modules/@arcgis/core/views/2d/engine/webgl/TiledDisplayObject.js","webpack://imaps/./node_modules/@arcgis/core/views/2d/layers/features/tileRenderers/BaseTileRenderer.js","webpack://imaps/./node_modules/@arcgis/core/views/2d/layers/features/tileRenderers/support/HeatmapSource.js","webpack://imaps/./node_modules/@arcgis/core/views/2d/layers/features/tileRenderers/HeatmapTileRenderer.js"],"names":["r","e","document","createElement","getContext","height","width","t","clearRect","n","createLinearGradient","ratio","color","colorStops","addColorStop","Math","max","fillStyle","fillRect","getImageData","data","o","blurRadius","fieldOffset","a","field","f","c","Float64Array","l","i","s","round","h","m","Number","NEGATIVE_INFINITY","d","readAttribute","u","g","Set","getCursor","next","getObjectId","has","add","readLegacyPointGeometry","x","y","b","min","matrix","buffer","canvas","set","Uint8ClampedArray","Uint32Array","Uint8Array","length","floor","putImageData","exp","sqrt","PI","target","pixelFormat","internalFormat","dataType","wrapMode","_","super","this","requestRenderOnSourceChangedEnabled","_textureInvalidated","stencilRef","coordScale","_height","pixelRatio","resolution","rotation","_source","_width","transforms","dvs","source","requestRender","bind","_texture","dispose","sourceWidth","sourceHeight","invalidateTexture","HTMLImageElement","naturalHeight","naturalWidth","beforeRender","updateTexture","toScreenNoRotation","displayViewMat3","mips","descriptor","hasMipmap","generateMipmap","setSamplingMode","samplingMode","context","bindTexture","stage","resize","getRenderedRasterPixels","setData","renderedRasterPixels","render","ready","bitmap","once","destroy","afterRender","setTransform","_tileInfoView","getTileBounds","tileInfo","size","registerRenderPass","name","brushes","children","map","drawPhase","prepareRenderPasses","visible","doRender","pixelBlock","extent","originalPixelBlock","filter","getAsRGBA","createImageData","key","level","row","col","sortChildren","setStencilReference","renderChildren","state","createRenderParams","requiredLevel","getClosestInfoForScale","scale","displayLevel","scaleToZoom","getStencilTarget","getTileResolution","triangleCountReportedInDebug","tileMat3","triangleCount","bounds","coordRange","texture","_coords","_bounds","coords","tiles","Map","clear","layer","layerView","tileInfoView","isUpdating","createTile","notifyChange","id","forEach","delete","disposeTile","isReady","requestUpdate","prototype","gradient","intensities","minPixelIntensity","maxPixelIntensity","_intensityInfo","featuresView","attributeView","initialize","_container","getTileCoords","renderer","type","_gradient","toJSON","Promise","resolve","addChild","removeAllChildren","removeChild","get","tileKey","intensityInfo","console","error"],"mappings":"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","file":"chunks/1590.js","sourcesContent":["/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.19/esri/copyright.txt for details.\n*/\nimport t from\"../../core/global.js\";import{clamp as e}from\"../../core/mathUtils.js\";const r=(()=>{if(!(\"document\"in t))return()=>null;const e=document.createElement(\"canvas\"),r=e.getContext(\"2d\"),n=512;return e.height=n,e.width=1,t=>{r.clearRect(0,0,1,e.height);const n=r.createLinearGradient(0,0,0,e.height);for(const{ratio:e,color:r}of t.colorStops)n.addColorStop(Math.max(e,.001),`rgba(${r[0]}, ${r[1]}, ${r[2]}, ${r[3]})`);return r.fillStyle=n,r.fillRect(0,0,1,e.height),r.getImageData(0,0,1,e.height).data}})();function n(t,e,r,n){const{blurRadius:o,fieldOffset:a,field:f}=e,u=new Float64Array(r*n),l=i(o),s=Math.round(3*o);let h,m=Number.NEGATIVE_INFINITY;const d=c(f,a);for(const{geometry:i,attributes:c}of t){const t=i.x-s,e=i.y-s,o=Math.max(0,t),a=Math.max(0,e),f=Math.min(n,i.y+s),g=Math.min(r,i.x+s),y=+d(c);for(let n=a;n<f;n++){const a=l[n-e];for(let e=o;e<g;e++){const o=l[e-t];h=u[n*r+e]+=a*o*y,h>m&&(m=h)}}}return{matrix:u.buffer,max:m}}function o(t,e,r,n){const{blurRadius:o,fieldOffset:a,field:f}=e,c=new Float64Array(r*n),l=i(o),s=Math.round(3*o);let h,m=Number.NEGATIVE_INFINITY;const d=u(f,a),g=new Set;for(const i of t){const t=i.getCursor();for(;t.next();){const e=t.getObjectId();if(g.has(e))continue;g.add(e);const o=t.readLegacyPointGeometry(),a=+d(t),f=o.x-s,i=o.y-s,u=Math.max(0,f),y=Math.max(0,i),b=Math.min(n,o.y+s),x=Math.min(r,o.x+s);for(let t=y;t<b;t++){const e=l[t-i];for(let n=u;n<x;n++){const o=l[n-f];h=c[t*r+n]+=e*o*a,h>m&&(m=h)}}}}return{matrix:c.buffer,max:m}}function a(t,e,r,n,o,a){t.canvas.width=t.canvas.height=e,t.clearRect(0,0,e,e);const i=t.getImageData(0,0,e,e);r&&n&&i.data.set(new Uint8ClampedArray(f(e,r,n,o,a))),t.putImageData(i,0,0)}function f(t,r,n,o,a){const f=new Uint32Array(t*t),i=\"buffer\"in r?r:new Float64Array(r),c=\"buffer\"in n?new Uint32Array(n.buffer):new Uint32Array(new Uint8Array(n).buffer),u=c.length/(a-o);for(let l=0;l<i.length;l++){const t=i[l],r=Math.floor((t-o)*u);f[l]=c[e(r,0,c.length-1)]}return f.buffer}function i(t){const e=Math.round(3*t),r=2*t*t,n=new Float64Array(2*e+1);for(let o=0;o<=n.length;o++)n[o]=Math.exp(-((o-e)**2)/r)/Math.sqrt(2*Math.PI)*(t/2);return n}function c(t,e){return\"function\"==typeof t?t:t?\"string\"==typeof e?e=>-1*+e[t]:r=>+r[t]+e:()=>1}function u(t,e){return null!=t?\"string\"==typeof e?e=>-1*+e.readAttribute(t):r=>+r.readAttribute(t)+e:t=>1}export{n as calculateHeatmapIntensityInfo,o as calculateHeatmapIntensityInfoReaders,f as createHeatmapImageData,i as createKernel,c as createValueFunction,u as createValueFunctionCursor,a as drawHeatmap,r as generateGradient};\n","/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.19/esri/copyright.txt for details.\n*/\nimport\"../../../core/has.js\";import{i as t,b as e,r as i,j as s,m as r}from\"../../../chunks/mat3.js\";import{c as h}from\"../../../chunks/mat3f32.js\";import{f as n}from\"../../../chunks/vec2f32.js\";import\"../../../chunks/builtins.js\";import o from\"../../webgl/Texture.js\";import\"../../webgl/FramebufferObject.js\";import{DisplayObject as u}from\"./DisplayObject.js\";import a from\"./ImageryBitmapSource.js\";function d(t){return t&&\"render\"in t}function c(t){return t&&!(\"render\"in t)}function l(t){const e=document.createElement(\"canvas\");return e.width=t.width,e.height=t.height,t.render(e.getContext(\"2d\")),e}function x(t,e,i){const s={target:3553,pixelFormat:6408,internalFormat:6408,dataType:5121,wrapMode:33071};return e&&i&&(s.width=e,s.height=i),new o(t,s)}class _ extends u{constructor(t=null,e=!0){super(),this.requestRenderOnSourceChangedEnabled=e,this._textureInvalidated=!0,this.stencilRef=0,this.coordScale=[1,1],this._height=void 0,this.pixelRatio=1,this.resolution=0,this.rotation=0,this._source=null,this._width=void 0,this.x=0,this.y=0,this.transforms={dvs:h()},this.source=t,this.requestRender=this.requestRender.bind(this)}destroy(){this._texture&&(this._texture.dispose(),this._texture=null)}get isSourceScaled(){return this.width!==this.sourceWidth||this.height!==this.sourceHeight}get height(){return void 0!==this._height?this._height:this.sourceHeight}set height(t){this._height=t}get source(){return this._source}set source(t){this._source=t,this.invalidateTexture()}get sourceHeight(){return this._source instanceof HTMLImageElement?this._source.naturalHeight:this._source.height}get sourceWidth(){return this._source instanceof HTMLImageElement?this._source.naturalWidth:this._source.width}get width(){return void 0!==this._width?this._width:this.sourceWidth}set width(t){this._width=t}beforeRender(t){super.beforeRender(t),this.updateTexture(t)}invalidateTexture(){this._textureInvalidated||(this._textureInvalidated=!0,this.requestRenderOnSourceChangedEnabled&&this.requestRender())}setTransform(h){const o=t(this.transforms.dvs),[u,a]=h.toScreenNoRotation([0,0],this.x,this.y),d=this.resolution/this.pixelRatio/h.resolution,c=d*this.width,l=d*this.height,x=Math.PI*this.rotation/180;e(o,o,n(u,a)),e(o,o,n(c/2,l/2)),i(o,o,-x),e(o,o,n(-c/2,-l/2)),s(o,o,n(c,l)),r(this.transforms.dvs,h.displayViewMat3,o)}setSamplingProfile(t){this._texture&&(t.mips&&!this._texture.descriptor.hasMipmap&&this._texture.generateMipmap(),this._texture.setSamplingMode(t.samplingMode))}bind({context:t},e){this._texture&&t.bindTexture(this._texture,e)}updateTexture({context:t}){var e;if(!this.stage)return null==(e=this._texture)||e.dispose(),void(this._texture=null);if(!this._textureInvalidated)return;this._textureInvalidated=!1,this._texture||(this.source?this._texture=x(t,this.sourceWidth,this.sourceHeight):this._texture=x(t));const i=this.source;if(i){if(this._texture.resize(this.sourceWidth,this.sourceHeight),d(i))if(i instanceof a){const t=i.getRenderedRasterPixels();this._texture.setData(t.renderedRasterPixels)}else this._texture.setData(l(i));else c(i)&&this._texture.setData(i);this.ready()}else this._texture.setData(null)}onAttach(){this.invalidateTexture()}onDetach(){this.invalidateTexture()}}export{_ as Bitmap};\n","/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.19/esri/copyright.txt for details.\n*/\nimport{TiledDisplayObject as t}from\"./webgl/TiledDisplayObject.js\";import{Bitmap as e}from\"./Bitmap.js\";class s extends t{constructor(t,s,r,i=null){super(t,s,r,r),this.bitmap=new e(i),this.bitmap.coordScale=r,this.bitmap.once(\"isReady\",(()=>this.ready()))}destroy(){super.destroy(),this.bitmap.destroy()}beforeRender(t){super.beforeRender(t),this.bitmap.beforeRender(t)}afterRender(t){super.afterRender(t),this.bitmap.afterRender(t)}set stencilRef(t){this.bitmap.stencilRef=t}get stencilRef(){return this.bitmap.stencilRef}setTransform(t,e){super.setTransform(t,e),this.bitmap.transforms.dvs=this.transforms.dvs}onAttach(){this.bitmap.stage=this.stage}onDetach(){this.bitmap&&(this.bitmap.stage=null)}}export{s as BitmapTile};\n","/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.19/esri/copyright.txt for details.\n*/\nimport{create as e}from\"../../../geometry/support/aaBoundingRect.js\";import{WGLDrawPhase as r}from\"./webgl/enums.js\";import{brushes as s}from\"./brushes.js\";import t from\"./webgl/TileContainer.js\";import{BitmapTile as i}from\"./BitmapTile.js\";class o extends t{createTile(r){const s=this._tileInfoView.getTileBounds(e(),r);return new i(r,s,this._tileInfoView.tileInfo.size)}destroyTile(){}prepareRenderPasses(e){const t=e.registerRenderPass({name:\"bitmap (tile)\",brushes:[s.bitmap],target:()=>this.children.map((e=>e.bitmap)),drawPhase:r.MAP});return[...super.prepareRenderPasses(e),t]}doRender(e){this.visible&&e.drawPhase===r.MAP&&super.doRender(e)}}export{o as BitmapTileContainer};\n","/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.19/esri/copyright.txt for details.\n*/\nclass e{constructor(e,t,i){this.pixelBlock=e,this.extent=t,this.originalPixelBlock=i}get width(){return this.pixelBlock?this.pixelBlock.width:0}get height(){return this.pixelBlock?this.pixelBlock.height:0}render(e){const t=this.pixelBlock;if(!t)return;const i=this.filter({pixelBlock:t}),l=i.pixelBlock.getAsRGBA(),h=e.createImageData(i.pixelBlock.width,i.pixelBlock.height);h.data.set(l),e.putImageData(h,0,0)}getRenderedRasterPixels(){const e=this.filter({pixelBlock:this.pixelBlock});return{width:e.pixelBlock.width,height:e.pixelBlock.height,renderedRasterPixels:new Uint8Array(e.pixelBlock.getAsRGBA().buffer)}}}export default e;\n","/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.19/esri/copyright.txt for details.\n*/\nimport{WGLDrawPhase as e}from\"./enums.js\";import r from\"./brushes/WGLBrushInfo.js\";import s from\"./brushes/WGLBrushStencil.js\";import t from\"./WGLContainer.js\";const n=(e,r)=>e.key.level-r.key.level!=0?e.key.level-r.key.level:e.key.row-r.key.row!=0?e.key.row-r.key.row:e.key.col-r.key.col;class i extends t{constructor(e){super(),this._tileInfoView=e}renderChildren(e){this.sortChildren(n),this.setStencilReference(),super.renderChildren(e)}createRenderParams(e){const{state:r}=e;return{...super.createRenderParams(e),requiredLevel:this._tileInfoView.getClosestInfoForScale(r.scale).level,displayLevel:this._tileInfoView.tileInfo.scaleToZoom(r.scale)}}prepareRenderPasses(t){const n=t.registerRenderPass({name:\"stencil\",brushes:[s],drawPhase:e.DEBUG|e.MAP|e.HIGHLIGHT,target:()=>this.getStencilTarget()}),i=t.registerRenderPass({name:\"tileInfo\",brushes:[r],drawPhase:e.DEBUG,target:()=>this.children,has:\"esri-tiles-debug\"});return[...super.prepareRenderPasses(t),n,i]}getStencilTarget(){return this.children}updateTransforms(e){for(const r of this.children){const s=this._tileInfoView.getTileResolution(r.key);r.setTransform(e,s)}}setStencilReference(){let e=1;for(const r of this.children)r.stencilRef=e++}}export default i;export{n as sortByLevel};\n","/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.19/esri/copyright.txt for details.\n*/\nimport\"../../../../core/has.js\";import{s,m as t}from\"../../../../chunks/mat3.js\";import o from\"../../tiling/TileKey.js\";import{c as i}from\"../../../../chunks/mat3f32.js\";import{DisplayObject as e}from\"../DisplayObject.js\";class r extends e{constructor(s,t,e,r=e){super(),this.triangleCountReportedInDebug=0,this.transforms={dvs:i(),tileMat3:i()},this.triangleCount=0,this.key=new o(s),this.bounds=t,this.size=e,this.coordRange=r}destroy(){this.texture&&(this.texture.dispose(),this.texture=null)}get coords(){return this._coords}get bounds(){return this._bounds}set bounds(s){this._coords=[s[0],s[3]],this._bounds=s}setTransform(o,i){const e=i/(o.resolution*o.pixelRatio),r=this.transforms.tileMat3,[n,h]=o.toScreenNoRotation([0,0],this.coords),a=this.size[0]/this.coordRange[0]*e,d=this.size[1]/this.coordRange[1]*e;s(r,a,0,0,0,d,0,n,h,1),t(this.transforms.dvs,o.displayViewMat3,r)}}export{r as TiledDisplayObject};\n","/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.19/esri/copyright.txt for details.\n*/\nimport{_ as e}from\"../../../../../chunks/tslib.es6.js\";import\"../../../../../core/has.js\";import\"../../../../../core/Logger.js\";import\"../../../../../core/accessorSupport/ensureType.js\";import{property as t}from\"../../../../../core/accessorSupport/decorators/property.js\";import{subclass as r}from\"../../../../../core/accessorSupport/decorators/subclass.js\";import\"../../../../../core/urlUtils.js\";import\"../../../../../core/uuid.js\";import\"../../../../../portal/support/resourceExtension.js\";import{HandleOwner as s}from\"../../../../../core/HandleOwner.js\";let i=class extends s{constructor(e){super(e),this.tiles=new Map}destroy(){this.tiles.clear(),this.layer=this.layerView=this.tileInfoView=this.tiles=null}get updating(){return this.isUpdating()}acquireTile(e){const t=this.createTile(e);return t.once(\"isReady\",(()=>this.notifyChange(\"updating\"))),this.tiles.set(e.id,t),t}forceAttributeTextureUpload(){}forEachTile(e){this.tiles.forEach(e)}releaseTile(e){this.tiles.delete(e.key.id),this.disposeTile(e)}isUpdating(){let e=!0;return this.tiles.forEach((t=>{e=e&&t.isReady})),!e}setHighlight(){}invalidateLabels(){}requestUpdate(){this.layerView.requestUpdate()}};e([t()],i.prototype,\"layer\",void 0),e([t()],i.prototype,\"layerView\",void 0),e([t()],i.prototype,\"tileInfoView\",void 0),e([t()],i.prototype,\"updating\",null),i=e([r(\"esri.views.2d.layers.features.tileRenderers.BaseTileRenderer\")],i);var o=i;export default o;\n","/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.19/esri/copyright.txt for details.\n*/\nimport{drawHeatmap as t}from\"../../../../../../renderers/support/heatmapUtils.js\";class i{constructor(){this.gradient=null,this.height=512,this.width=512}render(i){t(i,512,this.intensities,this.gradient,this.minPixelIntensity,this.maxPixelIntensity)}}export{i as HeatmapSource};\n","/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.19/esri/copyright.txt for details.\n*/\nimport{_ as e}from\"../../../../../chunks/tslib.es6.js\";import\"../../../../../core/has.js\";import\"../../../../../core/Logger.js\";import\"../../../../../core/accessorSupport/ensureType.js\";import\"../../../../../core/accessorSupport/decorators/property.js\";import{subclass as t}from\"../../../../../core/accessorSupport/decorators/subclass.js\";import\"../../../../../core/urlUtils.js\";import\"../../../../../core/uuid.js\";import\"../../../../../portal/support/resourceExtension.js\";import{generateGradient as i}from\"../../../../../renderers/support/heatmapUtils.js\";import{BitmapTileContainer as r}from\"../../../engine/BitmapTileContainer.js\";import s from\"./BaseTileRenderer.js\";import{HeatmapSource as n}from\"./support/HeatmapSource.js\";let o=class extends s{constructor(e){super(e),this._intensityInfo={minPixelIntensity:0,maxPixelIntensity:0},this.featuresView={attributeView:{initialize:()=>{},requestUpdate:()=>{}},requestRender:()=>{}},this._container=new r(e.tileInfoView)}createTile(e){const t=this._container.createTile(e);return this.tileInfoView.getTileCoords(t.bitmap,e),t.bitmap.resolution=this.tileInfoView.getTileResolution(e),t}onConfigUpdate(){const e=this.layer.renderer;if(\"heatmap\"===e.type){const{minPixelIntensity:t,maxPixelIntensity:r}=e;this._intensityInfo.minPixelIntensity=t,this._intensityInfo.maxPixelIntensity=r,this._gradient=i(e.toJSON()),this.tiles.forEach((e=>{const i=e.bitmap.source;i&&(i.minPixelIntensity=t,i.maxPixelIntensity=r,i.gradient=this._gradient,e.bitmap.invalidateTexture())}))}}hitTest(){return Promise.resolve([])}install(e){e.addChild(this._container)}uninstall(e){this._container.removeAllChildren(),e.removeChild(this._container)}disposeTile(e){this._container.removeChild(e),e.destroy()}supportsRenderer(e){return e&&\"heatmap\"===e.type}onTileData(e){const t=this.tiles.get(e.tileKey);if(!t)return;const i=e.intensityInfo,{minPixelIntensity:r,maxPixelIntensity:s}=this._intensityInfo,o=t.bitmap.source||new n;o.intensities=i&&i.matrix||null,o.minPixelIntensity=r,o.maxPixelIntensity=s,o.gradient=this._gradient,t.bitmap.source=o,this._container.addChild(t),this.requestUpdate()}onTileError(e){console.error(e)}lockGPUUploads(){}unlockGPUUploads(){}};o=e([t(\"esri.views.2d.layers.features.tileRenderers.HeatmapTileRenderer\")],o);var a=o;export default a;\n"],"sourceRoot":""}