{"version":3,"sources":["webpack://imaps/./node_modules/@arcgis/core/layers/support/ExportImageParameters.js","webpack://imaps/./node_modules/@arcgis/core/layers/support/commonProperties.js","webpack://imaps/./node_modules/@arcgis/core/layers/support/sublayerUtils.js","webpack://imaps/./node_modules/@arcgis/core/renderers/support/clickToleranceUtils.js","webpack://imaps/./node_modules/@arcgis/core/renderers/support/lengthUtils.js","webpack://imaps/./node_modules/@arcgis/core/symbols/support/FeatureExpressionInfo.js","webpack://imaps/./node_modules/@arcgis/core/symbols/support/ElevationInfo.js","webpack://imaps/./node_modules/@arcgis/core/symbols/support/unitConversionUtils.js","webpack://imaps/./node_modules/@arcgis/core/views/layers/MapImageLayerView.js","webpack://imaps/./node_modules/@arcgis/core/views/2d/layers/MapImageLayerView2D.js","webpack://imaps/./node_modules/@arcgis/core/views/layers/support/popupUtils.js","webpack://imaps/./node_modules/@arcgis/core/views/support/drapedUtils.js"],"names":["o","visible","definitionExpression","labelingInfo","labelsVisible","opacity","minScale","maxScale","renderer","source","y","super","arguments","this","_scale","view","layer","hasDynamicLayers","e","visibleSublayers","map","toExportImageJSON","length","JSON","stringify","serviceSublayers","_get","_set","handles","remove","add","allSublayers","on","notifyChange","propertyName","id","join","filter","reduce","s","scale","layers","layerDefs","dynamicLayers","timeExtent","dpi","imageFormat","imageTransparency","gdbVersion","sublayers","r","i","a","t","l","forEach","unshift","some","format","transparent","readOnly","dependsOn","prototype","type","Number","Boolean","value","json","origins","read","screenSizePerspective","originOf","store","set","write","ignoreOrigin","target","n","name","reader","disablePopup","enabled","p","String","isRequired","writer","c","service","d","f","u","default","origin","drawingInfo","transparency","layerDefinition","m","timeInfo","useViewTime","intersection","isEmpty","timeOffset","offset","unit","equals","flatten","originIdOf","mapLayerId","slice","reverse","toArray","xoffset","Math","max","abs","yoffset","stops","size","event","pointerType","maxSize","minSize","floor","visualVariables","symbol","uniqueValueInfos","classBreakInfos","inches","feet","yards","miles","millimeters","centimeters","decimeters","meters","kilometers","expression","title","onTheGround","relativeToGround","relativeToScene","absoluteHeight","foot","kilometer","meter","mile","yard","featureExpression","_isOverridden","featureExpressionInfo","_override","mode","clone","apiValues","nonNullable","jsonValues","Object","keys","sort","get","async","popupEnabled","defaultPopupTemplateEnabled","push","sublayer","popupTemplate","load","catch","createQuery","createFetchPopupFeaturesQueryGeometry","geometry","outFields","_loadArcadeModules","arcadeUtils","hasGeometryOperations","maxAllowableOffset","width","queryFeatures","features","canResume","imageParameters","_exportImageVersion","strategy","update","error","imageMaxWidth","imageMaxHeight","version","_bitmapContainer","container","addChild","fetchSource","fetchImage","bind","requestUpdate","imageRotationSupported","imageNormalizationSupported","hidpi","destroy","removeChild","removeAllChildren","updating","updateRequested","timestamp","refreshTimestamp","getRequiredFields","fields","lastEditInfoEnabled","objectIdField","typeIdField","globalIdField","relationships","includes","indexOf","keyField","defaultPopupTemplate","resolution","overlayPixelSizeInMapUnits","basemapSpatialReference","spatialReference","x","xmin","min","ymin","xmax","ymax","toMap","intersects"],"mappings":"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","file":"chunks/4005.js","sourcesContent":["/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.18/esri/copyright.txt for details.\n*/\nimport{_ as e}from\"../../chunks/tslib.es6.js\";import\"../../core/has.js\";import\"../../core/Logger.js\";import\"../../core/accessorSupport/ensureType.js\";import{property as s}from\"../../core/accessorSupport/decorators/property.js\";import{subclass as r}from\"../../core/accessorSupport/decorators/subclass.js\";import\"../../core/urlUtils.js\";import\"../../core/uuid.js\";import\"../../portal/support/resourceExtension.js\";import i from\"../../core/Accessor.js\";import{combinedViewLayerTimeExtentProperty as a}from\"./commonProperties.js\";import{HandleOwnerMixin as t}from\"../../core/HandleOwner.js\";import{isExportDynamic as l}from\"./sublayerUtils.js\";import n from\"../../views/View.js\";const o={visible:\"visibleSublayers\",definitionExpression:\"layerDefs\",labelingInfo:\"hasDynamicLayers\",labelsVisible:\"hasDynamicLayers\",opacity:\"hasDynamicLayers\",minScale:\"visibleSublayers\",maxScale:\"visibleSublayers\",renderer:\"hasDynamicLayers\",source:\"hasDynamicLayers\"};let y=class extends(t(i)){constructor(){super(...arguments),this._scale=null,this.view=null}destroy(){this.layer=this.view=null}get dynamicLayers(){if(!this.hasDynamicLayers)return null;const e=this.visibleSublayers.map((e=>e.toExportImageJSON()));return e.length?JSON.stringify(e):null}get hasDynamicLayers(){return this.layer&&l(this.visibleSublayers,this.layer.serviceSublayers,this.layer)}set layer(e){this._get(\"layer\")!==e&&(this._set(\"layer\",e),this.handles.remove(\"layer\"),e&&this.handles.add([e.allSublayers.on(\"change\",(()=>this.notifyChange(\"visibleSublayers\"))),e.on(\"sublayer-update\",(e=>this.notifyChange(o[e.propertyName])))],\"layer\"))}get layers(){const e=this.visibleSublayers;return e?e.length?\"show:\"+e.map((e=>e.id)).join(\",\"):\"show:-1\":null}get layerDefs(){const e=this.visibleSublayers.filter((e=>null!=e.definitionExpression));return e.length?JSON.stringify(e.reduce(((e,s)=>(e[s.id]=s.definitionExpression,e)),{})):null}get scale(){return null!=this._scale?this._scale:this.view&&this.view.scale||0}set scale(e){this.view||(this._scale=e,this.notifyChange(\"scale\"))}get version(){const e=this;e.layers,e.layerDefs,e.dynamicLayers,e.timeExtent;const s=e.layer;return s&&(s.dpi,s.imageFormat,s.imageTransparency,s.gdbVersion),(this._get(\"version\")||0)+1}set version(e){this._set(\"version\",e)}get visibleSublayers(){const e=[];if(!this.layer)return e;const s=this.layer.sublayers,r=s=>{const i=this.scale,a=0===i,t=0===s.minScale||i<=s.minScale,l=0===s.maxScale||i>=s.maxScale;s.visible&&(a||t&&l)&&(s.sublayers?s.sublayers.forEach(r):e.unshift(s))};s&&s.forEach(r);const i=this._get(\"visibleSublayers\");return!i||i.length!==e.length||i.some(((s,r)=>e[r]!==s))?e:i}toJSON(){const e=this.layer;let s={dpi:e.dpi,format:e.imageFormat,transparent:e.imageTransparency,gdbVersion:e.gdbVersion||null};return this.hasDynamicLayers&&this.dynamicLayers?s.dynamicLayers=this.dynamicLayers:s={...s,layers:this.layers,layerDefs:this.layerDefs},s}};e([s({readOnly:!0,dependsOn:[\"hasDynamicLayers\",\"visibleSublayers\"]})],y.prototype,\"dynamicLayers\",null),e([s({readOnly:!0,dependsOn:[\"visibleSublayers\",\"layer.serviceSublayers\",\"layer.capabilities\"]})],y.prototype,\"hasDynamicLayers\",null),e([s()],y.prototype,\"layer\",null),e([s({readOnly:!0,dependsOn:[\"visibleSublayers\"]})],y.prototype,\"layers\",null),e([s({readOnly:!0,dependsOn:[\"visibleSublayers\"]})],y.prototype,\"layerDefs\",null),e([s({type:Number,dependsOn:[\"view.scale\"]})],y.prototype,\"scale\",null),e([s(a)],y.prototype,\"timeExtent\",void 0),e([s({dependsOn:[\"layers\",\"layerDefs\",\"dynamicLayers\",\"layer.dpi\",\"layer.imageFormat\",\"layer.imageTransparency\",\"layer.gdbVersion\",\"timeExtent\"]})],y.prototype,\"version\",null),e([s({type:n})],y.prototype,\"view\",void 0),e([s({readOnly:!0,dependsOn:[\"layer.sublayers\",\"scale\"]})],y.prototype,\"visibleSublayers\",null),y=e([r(\"esri.layers.mixins.ExportImageParameters\")],y);export{y as ExportImageParameters};\n","/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.18/esri/copyright.txt for details.\n*/\nimport{getProperties as e}from\"../../core/accessorSupport/utils.js\";import{w as i}from\"../../chunks/persistableUrlUtils.js\";import{willPropertyWrite as r}from\"../../core/accessorSupport/write.js\";import{transparencyToOpacity as n}from\"../../webdoc/support/opacityUtils.js\";import t from\"../../TimeExtent.js\";import o from\"../../symbols/support/ElevationInfo.js\";const s={type:Boolean,value:!0,json:{origins:{\"web-scene\":{read:{source:[\"id\",\"url\",\"layerType\"],reader(i,r){if(null!=r.screenSizePerspective||\"defaults\"!==this.originOf(\"screenSizePerspectiveEnabled\"))return r.screenSizePerspective;e(this).store.set(\"screenSizePerspectiveEnabled\",!1,0)}},write:{ignoreOrigin:!0,target:\"screenSizePerspective\",writer(e,i,n,t){(\"defaults\"===this.originOf(\"screenSizePerspectiveEnabled\")&&e||r(this,\"screenSizePerspectiveEnabled\",{},t))&&(i[n]=e)}}}}}},a={type:Boolean,value:!0,json:{name:\"disablePopup\",read:{reader:(e,i)=>!i.disablePopup},write:{enabled:!0,writer(e,i,r){i[r]=!e}}}},l={type:Boolean,value:!0,json:{name:\"showLabels\",write:!0}},p={type:String,json:{origins:{\"portal-item\":{write:!1}},write:{isRequired:!0,ignoreOrigin:!0,writer:i}}},c={type:Boolean,value:!0,json:{origins:{service:{read:{enabled:!1}}},name:\"showLegend\",write:!0}},d={value:null,type:o,json:{origins:{service:{name:\"elevationInfo\",write:!0}},name:\"layerDefinition.elevationInfo\",write:!0}};function f(e){return{type:e,readOnly:!0,json:{origins:{service:{read:!0}},read:!1}}}const u={type:Number,json:{origins:{\"web-document\":{default:1,write:!0,read:!0},\"portal-item\":{write:!0}}}},y={...u,json:{...u.json,origins:{\"web-document\":{...u.json.origins[\"web-document\"],write:{enabled:!0,target:{opacity:{type:Number},\"layerDefinition.drawingInfo.transparency\":{type:Number}}}}},read:{source:[\"layerDefinition.drawingInfo.transparency\",\"drawingInfo.transparency\"],reader:(e,i,r)=>r&&\"service\"!==r.origin||!i.drawingInfo||void 0===i.drawingInfo.transparency?i.layerDefinition&&i.layerDefinition.drawingInfo&&void 0!==i.layerDefinition.drawingInfo.transparency?n(i.layerDefinition.drawingInfo.transparency):void 0:n(i.drawingInfo.transparency)}}},m={type:t,dependsOn:[\"view.timeExtent\",\"layer.timeExtent\",\"layer.timeInfo\",\"layer.timeOffset\",\"layer.timeOffset.value\",\"layer.timeOffset.unit\",\"layer.useViewTime\"],readOnly:!0,get(){var e,i;if(null==(e=this.layer)||!e.timeInfo)return null;const r=null==(i=this.view)?void 0:i.timeExtent,n=this.layer.timeExtent,t=this.layer.useViewTime?r&&n?r.intersection(n):r||n:n;if(!t||t.isEmpty)return t;const o=this.layer.timeOffset,s=o?t.offset(-o.value,o.unit):t,a=this._get(\"timeExtent\");return s.equals(a)?a:s}};export{m as combinedViewLayerTimeExtentProperty,d as elevationInfo,l as labelsVisible,c as legendEnabled,u as opacity,y as opacityDrawingInfo,a as popupEnabled,f as readOnlyService,s as screenSizePerspectiveEnabled,p as url};\n","/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.18/esri/copyright.txt for details.\n*/\nfunction e(e,n,i){if(n.flatten((({sublayers:e})=>e)).length!==e.length)return!0;return!!e.some((e=>e.originIdOf(\"minScale\")>i||e.originIdOf(\"maxScale\")>i||e.originIdOf(\"renderer\")>i||e.originIdOf(\"labelingInfo\")>i||e.originIdOf(\"opacity\")>i||e.originIdOf(\"labelsVisible\")>i||e.originIdOf(\"source\")>i))||!r(e,n)}function n(e,n,i){return!!e.some((e=>{const n=e.source;return!(!n||\"map-layer\"===n.type&&n.mapLayerId===e.id&&(!n.gdbVersion||n.gdbVersion===i.gdbVersion))||e.originIdOf(\"renderer\")>2||e.originIdOf(\"labelingInfo\")>2||e.originIdOf(\"opacity\")>2||e.originIdOf(\"labelsVisible\")>2}))||!r(e,n)}function r(e,n){if(!e||!e.length)return!0;const r=n.slice().reverse().flatten((({sublayers:e})=>e&&e.toArray().reverse())).map((e=>e.id)).toArray();if(e.length>r.length)return!1;let i=0;const o=r.length;for(const{id:n}of e){for(;i<o&&r[i]!==n;)i++;if(i>=o)return!1}return!0}function i(e){return!!e&&e.some((e=>null!=e.minScale||e.layerDefinition&&null!=e.layerDefinition.minScale))}export{n as isExportDynamic,i as isSublayerOverhaul,e as shouldWriteSublayerStructure};\n","/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.18/esri/copyright.txt for details.\n*/\nfunction t(t,e){return e?\"xoffset\"in e&&e.xoffset?Math.max(t,Math.abs(e.xoffset)):\"yoffset\"in e&&e.yoffset?Math.max(t,Math.abs(e.yoffset||0)):t:t}function e(t,e){return\"number\"==typeof t?t:t&&t.stops&&t.stops.length?function(t){let e=0,n=0;for(let r=0;r<t.length;r++){const s=t[r].size;\"number\"==typeof s&&(e+=s,n++)}return e/n}(t.stops):e}function n(n){const r=n&&n.renderer,s=\"touch\"===(n&&n.event&&n.event.pointerType)?9:6;if(!r)return s;const o=\"visualVariables\"in r?function(t,n){if(!n)return t;const r=n.filter((t=>\"size\"===t.type)).map((n=>{const{maxSize:r,minSize:s}=n;return(e(r,t)+e(s,t))/2}));let s=0;const o=r.length;if(0===o)return t;for(let t=0;t<o;t++)s+=r[t];const f=Math.floor(s/o);return Math.max(f,t)}(s,r.visualVariables):s;if(\"simple\"===r.type)return t(o,r.symbol);if(\"unique-value\"===r.type){let e=o;return r.uniqueValueInfos.forEach((n=>{e=t(e,n.symbol)})),e}if(\"class-breaks\"===r.type){let e=o;return r.classBreakInfos.forEach((n=>{e=t(e,n.symbol)})),e}return r.type,o}export{n as calculateTolerance};\n","/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.18/esri/copyright.txt for details.\n*/\nimport{earth as e}from\"../../geometry/support/Ellipsoid.js\";import{convertUnit as s,lengthToDegrees as t}from\"../../core/unitUtils.js\";const m={inches:s(1,\"meters\",\"inches\"),feet:s(1,\"meters\",\"feet\"),\"us-feet\":s(1,\"meters\",\"us-feet\"),yards:s(1,\"meters\",\"yards\"),miles:s(1,\"meters\",\"miles\"),\"nautical-miles\":s(1,\"meters\",\"nautical-miles\"),millimeters:s(1,\"meters\",\"millimeters\"),centimeters:s(1,\"meters\",\"centimeters\"),decimeters:s(1,\"meters\",\"decimeters\"),meters:s(1,\"meters\",\"meters\"),kilometers:s(1,\"meters\",\"kilometers\"),\"decimal-degrees\":1/t(1,\"meters\",e.radius)};export{m as meterIn};\n","/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.18/esri/copyright.txt for details.\n*/\nimport{_ as r}from\"../../chunks/tslib.es6.js\";import\"../../core/has.js\";import\"../../core/Logger.js\";import\"../../core/accessorSupport/ensureType.js\";import{property as o}from\"../../core/accessorSupport/decorators/property.js\";import{subclass as e}from\"../../core/accessorSupport/decorators/subclass.js\";import\"../../core/urlUtils.js\";import\"../../core/uuid.js\";import\"../../portal/support/resourceExtension.js\";import{JSONSupport as s}from\"../../core/JSONSupport.js\";import{collectArcadeFieldNames as t}from\"../../layers/support/fieldUtils.js\";var p;let i=p=class extends s{async collectRequiredFields(r,o){return t(r,o,this.expression)}clone(){return new p({expression:this.expression,title:this.title})}};r([o({type:String,json:{write:!0}})],i.prototype,\"expression\",void 0),r([o({type:String,json:{write:!0}})],i.prototype,\"title\",void 0),i=p=r([e(\"esri.layers.support.FeatureExpressionInfo\")],i);var c=i;export default c;\n","/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.18/esri/copyright.txt for details.\n*/\nimport{_ as e}from\"../../chunks/tslib.es6.js\";import\"../../core/has.js\";import{isSome as r}from\"../../core/maybe.js\";import\"../../core/Logger.js\";import\"../../core/accessorSupport/ensureType.js\";import{property as o}from\"../../core/accessorSupport/decorators/property.js\";import{strict as t,JSONMap as s}from\"../../core/jsonMap.js\";import{reader as i}from\"../../core/accessorSupport/decorators/reader.js\";import{subclass as n}from\"../../core/accessorSupport/decorators/subclass.js\";import{writer as p}from\"../../core/accessorSupport/decorators/writer.js\";import\"../../core/urlUtils.js\";import\"../../core/uuid.js\";import\"../../portal/support/resourceExtension.js\";import{JSONSupport as u}from\"../../core/JSONSupport.js\";import a from\"./FeatureExpressionInfo.js\";import{supportedUnits as f}from\"./unitConversionUtils.js\";var l;const m=t()({onTheGround:\"on-the-ground\",relativeToGround:\"relative-to-ground\",relativeToScene:\"relative-to-scene\",absoluteHeight:\"absolute-height\"}),d=new s({foot:\"feet\",kilometer:\"kilometers\",meter:\"meters\",mile:\"miles\",\"us-foot\":\"us-feet\",yard:\"yards\"});let c=l=class extends u{constructor(){super(...arguments),this.offset=null}readFeatureExpressionInfo(e,r){return null!=e?e:r.featureExpression&&0===r.featureExpression.value?{expression:\"0\"}:void 0}writeFeatureExpressionInfo(e,r,o,t){r[o]=e.write(null,t),\"0\"===e.expression&&(r.featureExpression={value:0})}get mode(){return this._isOverridden(\"mode\")?this._get(\"mode\"):r(this.offset)||this.featureExpressionInfo?\"relative-to-ground\":\"on-the-ground\"}set mode(e){this._override(\"mode\",e)}set unit(e){this._set(\"unit\",e)}write(e,r){return this.offset||this.mode||this.featureExpressionInfo||this.unit?super.write(e,r):null}clone(){return new l({mode:this.mode,offset:this.offset,featureExpressionInfo:this.featureExpressionInfo?this.featureExpressionInfo.clone():void 0,unit:this.unit})}};e([o({type:a,json:{write:!0}})],c.prototype,\"featureExpressionInfo\",void 0),e([i(\"featureExpressionInfo\",[\"featureExpressionInfo\",\"featureExpression\"])],c.prototype,\"readFeatureExpressionInfo\",null),e([p(\"featureExpressionInfo\",{featureExpressionInfo:{type:a},\"featureExpression.value\":{type:[0]}})],c.prototype,\"writeFeatureExpressionInfo\",null),e([o({type:m.apiValues,dependsOn:[\"offset\",\"featureExpressionInfo\"],nonNullable:!0,json:{type:m.jsonValues,read:m.read,write:{writer:m.write,isRequired:!0}}})],c.prototype,\"mode\",null),e([o({type:Number,json:{write:!0}})],c.prototype,\"offset\",void 0),e([o({type:f,json:{type:String,read:d.read,write:d.write}})],c.prototype,\"unit\",null),c=l=e([n(\"esri.layers.support.ElevationInfo\")],c);var x=c;export default x;\n","/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.18/esri/copyright.txt for details.\n*/\nimport{meterIn as t}from\"../../renderers/support/lengthUtils.js\";function n(n){return null!=t[n]}function r(n){return 1/(t[n]||1)}const e=function(){const n=Object.keys(t);return n.sort(),n}();export{r as getMetersPerUnit,e as supportedUnits,n as supportsUnit};\n","/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.18/esri/copyright.txt for details.\n*/\nimport{_ as e}from\"../../chunks/tslib.es6.js\";import\"../../core/has.js\";import{isSome as r}from\"../../core/maybe.js\";import\"../../core/Logger.js\";import\"../../core/accessorSupport/ensureType.js\";import{property as t}from\"../../core/accessorSupport/decorators/property.js\";import{subclass as s}from\"../../core/accessorSupport/decorators/subclass.js\";import o from\"../../core/Error.js\";import\"../../core/urlUtils.js\";import\"../../core/uuid.js\";import\"../../portal/support/resourceExtension.js\";import{reject as a,all as p,eachAlways as i}from\"../../core/promiseUtils.js\";import{loadArcade as u}from\"../../support/arcadeOnDemand.js\";import{calculateTolerance as c}from\"../../renderers/support/clickToleranceUtils.js\";import{getRequiredFields as l,getFetchPopupTemplate as m}from\"./support/popupUtils.js\";const n=n=>{let d=class extends n{async fetchPopupFeatures(e,t){const{layer:s}=this;if(!e)return a(new o(\"mapimagelayerview:fetchPopupFeatures\",\"Nothing to fetch without area\",{layer:s}));const u=this.get(\"view.scale\"),n=[],d=async e=>{const s=0===e.minScale||u<=e.minScale,o=0===e.maxScale||u>=e.maxScale;if(e.visible&&s&&o)if(e.sublayers)e.sublayers.forEach(d);else if(e.popupEnabled){const s=m(e,{...t,defaultPopupTemplateEnabled:!1});r(s)&&n.push({sublayer:e,popupTemplate:s})}},y=s.sublayers.toArray().map(d);await p(y);const f=n.map((async({sublayer:s,popupTemplate:o})=>{await s.load().catch((()=>{}));const a=s.createQuery(),p=r(t)?t.event:null,i=c({renderer:s.renderer,event:p}),u=this.createFetchPopupFeaturesQueryGeometry(e,i);a.geometry=u,a.outFields=await l(s,o);const m=await this._loadArcadeModules(o);m&&m.arcadeUtils.hasGeometryOperations(o)||(a.maxAllowableOffset=u.width/i);return(await s.queryFeatures(a)).features}));return(await i(f)).reduce(((e,r)=>r.value?[...e,...r.value]:e),[]).filter((e=>null!=e))}canResume(){var e,r;return!!super.canResume()&&(null==(e=this.imageParameters)||null==(r=e.timeExtent)||!r.isEmpty)}_loadArcadeModules(e){if(e.get(\"expressionInfos.length\"))return u()}};return e([t()],d.prototype,\"imageParameters\",void 0),e([t()],d.prototype,\"layer\",void 0),e([t({dependsOn:[\"imageParameters.timeExtent\"]})],d.prototype,\"suspended\",void 0),d=e([s(\"esri.views.layers.MapImageLayerView\")],d),d};export{n as MapImageLayerView};\n","/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.18/esri/copyright.txt for details.\n*/\nimport{_ as e}from\"../../../chunks/tslib.es6.js\";import\"../../../core/has.js\";import t from\"../../../core/Logger.js\";import\"../../../core/accessorSupport/ensureType.js\";import{property as r}from\"../../../core/accessorSupport/decorators/property.js\";import{subclass as i}from\"../../../core/accessorSupport/decorators/subclass.js\";import\"../../../core/urlUtils.js\";import\"../../../core/uuid.js\";import\"../../../portal/support/resourceExtension.js\";import{isAbortError as s}from\"../../../core/promiseUtils.js\";import{init as a}from\"../../../core/watchUtils.js\";import{RefreshableLayerView as o}from\"../../layers/RefreshableLayerView.js\";import{ExportImageParameters as p}from\"../../../layers/support/ExportImageParameters.js\";import m from\"../../layers/LayerView.js\";import{createQueryGeometry as h}from\"../../support/drapedUtils.js\";import{MapImageLayerView as n}from\"../../layers/MapImageLayerView.js\";import{BitmapContainer as d}from\"../engine/BitmapContainer.js\";import{LayerView2DMixin as g}from\"./LayerView2D.js\";import u from\"./support/ExportStrategy.js\";const c=t.getLogger(\"esri.views.2d.layers.MapImageLayerView2D\");let l=class extends(n(o(g(m)))){constructor(){super(...arguments),this._exportImageVersion=-1}hitTest(){return null}update(e){this.strategy.update(e).catch((e=>{s(e)||c.error(e)}))}attach(){const{imageMaxWidth:e,imageMaxHeight:t,version:r}=this.layer,i=r>=10.3,s=r>=10;this._bitmapContainer=new d,this.container.addChild(this._bitmapContainer),this.strategy=new u({container:this._bitmapContainer,fetchSource:this.fetchImage.bind(this),requestUpdate:this.requestUpdate.bind(this),imageMaxWidth:e,imageMaxHeight:t,imageRotationSupported:i,imageNormalizationSupported:s,hidpi:!0}),this.imageParameters=new p({view:this.view,layer:this.layer}),this.handles.add(a(this.imageParameters,\"version\",(e=>{this._exportImageVersion!==e&&(this._exportImageVersion=e,this.requestUpdate())})),\"mapimagelayerview-update\")}detach(){this.strategy.destroy(),this.handles.remove(\"mapimagelayerview-update\"),this.imageParameters.destroy(),this.imageParameters=null,this._exportImageVersion=-1,this.container.removeChild(this._bitmapContainer),this._bitmapContainer.removeAllChildren()}moveStart(){}viewChange(){}moveEnd(){this.requestUpdate()}createFetchPopupFeaturesQueryGeometry(e,t){return h(e,t,this.view)}async doRefresh(){this.requestUpdate()}isUpdating(){return this.strategy.updating||this.updateRequested}fetchImage(e,t,r,i){return this.layer.fetchImage(e,t,r,{timeExtent:this.imageParameters.timeExtent,timestamp:this.refreshTimestamp,...i})}};e([r()],l.prototype,\"strategy\",void 0),e([r({dependsOn:[\"strategy.updating\"]})],l.prototype,\"updating\",void 0),l=e([i(\"esri.views.2d.layers.MapImageLayerView2D\")],l);var y=l;export default y;\n","/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.18/esri/copyright.txt for details.\n*/\nimport{isSome as e}from\"../../../core/maybe.js\";import{getFeatureEditFields as p,fixFields as l,hasField as t}from\"../../../layers/support/fieldUtils.js\";async function i(i,d=i.popupTemplate){if(!e(d))return[];const o=await d.getRequiredFields(i.fields),{lastEditInfoEnabled:s}=d,{objectIdField:u,typeIdField:a,globalIdField:n,relationships:f}=i;if(o.includes(\"*\"))return[\"*\"];const r=s?await p(i):[],m=l(i.fields,[...o,...r]);return a&&m.push(a),m&&u&&t(i.fields,u)&&-1===m.indexOf(u)&&m.push(u),m&&n&&t(i.fields,n)&&-1===m.indexOf(n)&&m.push(n),f&&f.forEach((e=>{const{keyField:p}=e;m&&p&&t(i.fields,p)&&-1===m.indexOf(p)&&m.push(p)})),m}function d(p,l){return p.popupTemplate?p.popupTemplate:e(l)&&l.defaultPopupTemplateEnabled&&e(p.defaultPopupTemplate)?p.defaultPopupTemplate:null}export{d as getFetchPopupTemplate,i as getRequiredFields};\n","/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.18/esri/copyright.txt for details.\n*/\nimport{isSome as e,isNone as t}from\"../../core/maybe.js\";import r from\"../../geometry/Extent.js\";import\"../../geometry.js\";import{getMetersPerUnitForSR as n}from\"../../core/unitUtils.js\";import{calculateTolerance as i}from\"../../renderers/support/clickToleranceUtils.js\";function a(t,i,a,o=new r){let s;if(\"2d\"===a.type)s=i*a.resolution;else if(\"3d\"===a.type){const r=a.overlayPixelSizeInMapUnits(t),o=a.basemapSpatialReference;s=e(o)&&!o.equals(a.spatialReference)?n(o)/n(a.spatialReference):i*r}const m=t.x-s,p=t.y-s,c=t.x+s,l=t.y+s,{spatialReference:f}=a;return o.xmin=Math.min(m,c),o.ymin=Math.min(p,l),o.xmax=Math.max(m,c),o.ymax=Math.max(p,l),o.spatialReference=f,o}function o(e,r,n){const o=n.toMap(e);if(t(o))return!1;return a(o,i(),n,s).intersects(r)}const s=new r;export{a as createQueryGeometry,o as intersectsDrapedGeometry};\n"],"sourceRoot":""}