(self.webpackChunkimaps=self.webpackChunkimaps||[]).push([[2366],{47977:(e,t,r)=>{"use strict";r.d(t,{E:()=>o});class s{constructor(e={}){this._options=e}toQueryParams(e){if(!e)return null;const t=e.toJSON(),r={};return Object.keys(t).forEach((e=>{const s=this._options[e];if(s){const o="boolean"!=typeof s&&s.name?s.name:e,n="boolean"!=typeof s&&s.getter?s.getter(t):t[e];null!=n&&(r[o]=(e=>{if(!Array.isArray(e))return!1;const[t]=e;return"number"==typeof t||"string"==typeof t})(n)?n.join(","):"object"==typeof n?JSON.stringify(n):n)}else r[e]=t[e]}),this),r}}function o(e){return new s(e)}},91535:(e,t,r)=>{"use strict";r.d(t,{aX:()=>x,or:()=>A});var s=r(34926),o=r(59472),n=r(36544),i=r(32656),a=r(39105),l=r(27780),u=r(73032),c=r(41241),p=r(53817),f=r(93833),y=r(10923),d=r(56885),h=(r(36348),r(54721));async function g(e,t,r){const s="string"==typeof e?(0,y.mN)(e):e,o=t[0].spatialReference,n=(0,d.Ji)(t[0]),i={...r,query:{...s.query,f:"json",sr:o.wkid?o.wkid:JSON.stringify(o),geometries:JSON.stringify((a=t,{geometryType:(0,d.Ji)(a[0]),geometries:a.map((e=>e.toJSON()))}))}};var a;return function(e,t,r){const s=(0,d.q9)(t);return e.map((e=>{const t=s.fromJSON(e);return t.spatialReference=r,t}))}((await(0,h.default)(s.path+"/simplify",i)).data,n,o)}const m=n.Z.getLogger("esri.geometry.support.normalizeUtils"),v={102100:{maxX:20037508.342788905,minX:-20037508.342788905,plus180Line:new f.Z({paths:[[[20037508.342788905,-20037508.342788905],[20037508.342788905,20037508.342788905]]],spatialReference:u.Z.WebMercator}),minus180Line:new f.Z({paths:[[[-20037508.342788905,-20037508.342788905],[-20037508.342788905,20037508.342788905]]],spatialReference:u.Z.WebMercator})},4326:{maxX:180,minX:-180,plus180Line:new f.Z({paths:[[[180,-180],[180,180]]],spatialReference:u.Z.WGS84}),minus180Line:new f.Z({paths:[[[-180,-180],[-180,180]]],spatialReference:u.Z.WGS84})}};function w(e){return"polygon"===e.type}function b(e){return"polyline"===e[0].type}function S(e){return w(e)?e.rings:e.paths}function _(e,t){return Math.ceil((e-t)/(2*t))}function M(e,t){const r=S(e);for(const e of r)for(const r of e)r[0]+=t;return e}function T(e,t,r){if(t){const t=function(e,t){if(!(e instanceof f.Z||e instanceof p.Z)){const e="straightLineDensify: the input geometry is neither polyline nor polygon";throw m.error(e),new i.Z(e)}const r=S(e),s=[];for(const e of r){const r=[];s.push(r),r.push([e[0][0],e[0][1]]);for(let s=0;s<e.length-1;s++){const o=e[s][0],n=e[s][1],i=e[s+1][0],a=e[s+1][1],l=Math.sqrt((i-o)*(i-o)+(a-n)*(a-n)),u=(a-n)/l,c=(i-o)/l,p=l/t;if(p>1){for(let e=1;e<=p-1;e++){const s=e*t,i=c*s+o,a=u*s+n;r.push([i,a])}const e=(l+Math.floor(p-1)*t)/2,s=c*e+o,i=u*e+n;r.push([s,i])}r.push([i,a])}}return w(e)?new p.Z({rings:s,spatialReference:e.spatialReference}):new f.Z({paths:s,spatialReference:e.spatialReference})}(e,1e6);e=(0,c.Sx)(t,!0)}return r&&(e=M(e,r)),e}function Z(e,t,r){if(Array.isArray(e)){const s=e[0];if(s>t){const r=_(s,t);e[0]=s+r*(-2*t)}else if(s<r){const t=_(s,r);e[0]=s+t*(-2*r)}}else{const s=e.x;if(s>t){const r=_(s,t);e=e.clone().offset(r*(-2*t),0)}else if(s<r){const t=_(s,r);e=e.clone().offset(t*(-2*r),0)}}return e}async function x(e,t,r){if(!Array.isArray(e))return x([e],t);const n=t?t.url:s.Z.geometryServiceUrl;let i,u,m,w,A,B,N,P,C=0;const J=[],O=[];for(const t of e)if((0,o.Wi)(t))O.push(t);else if(i||(i=t.spatialReference,u=(0,l.C5)(i),m=i.isWebMercator,B=m?102100:4326,w=v[B].maxX,A=v[B].minX,N=v[B].plus180Line,P=v[B].minus180Line),u)if("mesh"===t.type)O.push(t);else if("point"===t.type)O.push(Z(t.clone(),w,A));else if("multipoint"===t.type){const e=t.clone();e.points=e.points.map((e=>Z(e,w,A))),O.push(e)}else if("extent"===t.type){const e=t.clone()._normalize(!1,!1,u);O.push(e.rings?new p.Z(e):e)}else if(t.extent){const e=t.extent,r=_(e.xmin,A)*(2*w);let s=0===r?t.clone():M(t.clone(),r);e.offset(r,0),e.intersects(N)&&e.xmax!==w?(C=e.xmax>C?e.xmax:C,s=T(s,m),J.push(s),O.push("cut")):e.intersects(P)&&e.xmin!==A?(C=e.xmax*(2*w)>C?e.xmax*(2*w):C,s=T(s,m,360),J.push(s),O.push("cut")):O.push(s)}else O.push(t.clone());else O.push(t);let k=_(C,w),R=-90;const j=k,q=new f.Z;for(;k>0;){const e=360*k-180;q.addPath([[e,R],[e,-1*R]]),R*=-1,k--}if(J.length>0&&j>0){const t=function(e,t){let r=-1;for(let s=0;s<t.cutIndexes.length;s++){const o=t.cutIndexes[s],n=t.geometries[s],i=S(n);for(let e=0;e<i.length;e++){const t=i[e];t.some((r=>{if(r[0]<180)return!0;{let r=0;for(let e=0;e<t.length;e++){const s=t[e][0];r=s>r?s:r}r=Number(r.toFixed(9));const s=-360*_(r,180);for(let r=0;r<t.length;r++){const t=n.getPoint(e,r);n.setPoint(e,r,t.clone().offset(s,0))}return!0}}))}if(o===r){if("polygon"===e[0].type)for(const t of S(n))e[o]=e[o].addRing(t);else if(b(e))for(const t of S(n))e[o]=e[o].addPath(t)}else r=o,e[o]=n}return e}(J,await async function(e,t,r,s){const o="string"==typeof e?(0,y.mN)(e):e,n=t[0].spatialReference,i={...s,query:{...o.query,f:"json",sr:JSON.stringify(n),target:JSON.stringify({geometryType:(0,d.Ji)(t[0]),geometries:t}),cutter:JSON.stringify(r)}},a=await(0,h.default)(o.path+"/cut",i),{cutIndexes:l,geometries:u=[]}=a.data;return{cutIndexes:l,geometries:u.map((e=>{const t=(0,d.im)(e);return t.spatialReference=n,t}))}}(n,J,q,r)),s=[],i=[];for(let r=0;r<O.length;r++){const n=O[r];if("cut"!==n)i.push(n);else{const n=t.shift(),a=e[r];(0,o.pC)(a)&&"polygon"===a.type&&a.rings&&a.rings.length>1&&n.rings.length>=a.rings.length?(s.push(n),i.push("simplify")):i.push(m?(0,c.$)(n):n)}}if(!s.length)return i;const a=await g(n,s,r),l=[];for(let e=0;e<i.length;e++){const t=i[e];"simplify"!==t?l.push(t):l.push(m?(0,c.$)(a.shift()):a.shift())}return l}const G=[];for(let e=0;e<O.length;e++){const t=O[e];if("cut"!==t)G.push(t);else{const e=J.shift();G.push(!0===m?(0,c.$)(e):e)}}return(0,a.resolve)(G)}function A(e,t){const r=(0,l.C5)(t);if(r){const[t,s]=r.valid,o=s-t;if(e<t)for(;e<t;)e+=o;if(e>s)for(;e>s;)e-=o}return e}},62366:(e,t,r)=>{"use strict";r.r(t),r.d(t,{default:()=>B});var s=r(56140),o=(r(95830),r(36544),r(68055),r(79881)),n=r(87566),i=(r(10923),r(57002),r(86035),r(39105)),a=r(54721),l=r(91535),u=r(95986),c=r(47977),p=r(10532),f=r(59472),y=r(30590),d=r(58385),h=r(73032),g=r(61106),m=r(53817),v=r(93833),w=r(56885),b=(r(36348),r(15988)),S=r(36405);function _(e){return e.features.map((t=>{const r=h.Z.fromJSON(e.spatialReference),s=b.default.fromJSON(t);return(0,f.Wg)(s.geometry).spatialReference=r,s}))}function M(e){return e.features.map((t=>(t.geometry.spatialReference=e.spatialReference,(0,w.im)(t.geometry))))}let T=class extends d.wq{constructor(e){super(e),this.facilities=null,this.messages=null,this.pointBarriers=null,this.polylineBarriers=null,this.polygonBarriers=null,this.serviceAreaPolylines=null,this.serviceAreaPolygons=null}readFacilities(e){return M(e)}readPointBarriers(e,t){return M(t.barriers)}readPolylineBarriers(e){return M(e)}readPolygonBarriers(e){return M(e)}readIncidents(e,t){return _(t.saPolylines)}readServiceAreaPolygons(e,t){return _(t.saPolygons)}};(0,s._)([(0,o.Cb)({type:[g.Z]})],T.prototype,"facilities",void 0),(0,s._)([(0,y.r)("facilities")],T.prototype,"readFacilities",null),(0,s._)([(0,o.Cb)({type:[S.Z]})],T.prototype,"messages",void 0),(0,s._)([(0,o.Cb)({type:[g.Z]})],T.prototype,"pointBarriers",void 0),(0,s._)([(0,y.r)("pointBarriers",["barriers"])],T.prototype,"readPointBarriers",null),(0,s._)([(0,o.Cb)({type:[v.Z]})],T.prototype,"polylineBarriers",void 0),(0,s._)([(0,y.r)("polylineBarriers")],T.prototype,"readPolylineBarriers",null),(0,s._)([(0,o.Cb)({type:[m.Z]})],T.prototype,"polygonBarriers",void 0),(0,s._)([(0,y.r)("polygonBarriers")],T.prototype,"readPolygonBarriers",null),(0,s._)([(0,o.Cb)({type:[b.default]})],T.prototype,"serviceAreaPolylines",void 0),(0,s._)([(0,y.r)("serviceAreaPolylines",["saPolylines"])],T.prototype,"readIncidents",null),(0,s._)([(0,o.Cb)({type:[b.default]})],T.prototype,"serviceAreaPolygons",void 0),(0,s._)([(0,y.r)("serviceAreaPolygons",["saPolygons"])],T.prototype,"readServiceAreaPolygons",null),T=(0,s._)([(0,n.j)("esri.tasks.support.ServiceAreaSolveResult")],T);const Z=T,x=(0,c.E)({accumulateAttributes:{name:"accumulateAttributeNames"},attributeParameterValues:!0,defaultBreaks:!0,facilities:!0,outSpatialReference:{name:"outSR",getter:e=>e.outSpatialReference.wkid},pointBarriers:{name:"barriers"},polylineBarriers:!0,polygonBarriers:!0,restrictionAttributes:{name:"restrictionAttributeNames"},returnPointBarriers:{name:"returnBarriers"},travelMode:!0});let A=class extends((0,p.Y)(u.Z)){constructor(e){super(e),this.url=null}solve(e,t){const r=[],s=[],o={},n={};return e.facilities&&e.facilities.features&&this._collectGeometries(e.facilities.features,s,"facilities.features",o),e.pointBarriers&&e.pointBarriers.features&&this._collectGeometries(e.pointBarriers.features,s,"pointBarriers.features",o),e.polylineBarriers&&e.polylineBarriers.features&&this._collectGeometries(e.polylineBarriers.features,s,"polylineBarriers.features",o),e.polygonBarriers&&e.polygonBarriers.features&&this._collectGeometries(e.polygonBarriers.features,s,"polygonBarriers.features",o),(0,l.aX)(s).then((e=>{for(const t in o){const s=o[t];r.push(t),n[t]=e.slice(s[0],s[1])}return this._isInputGeometryZAware(n,r)?this.getServiceDescription():(0,i.resolve)({dontCheck:!0})})).then((s=>{("dontCheck"in s?s.dontCheck:s.hasZ)||this._dropZValuesOffInputGeometry(n,r);for(const t in n)n[t].forEach(((r,s)=>{e.get(t)[s].geometry=r}));let o={query:{...this.parsedUrl.query,f:"json",...x.toQueryParams(e)}};return(this.requestOptions||t)&&(o={...this.requestOptions,...t,...o}),(0,a.default)(`${this.parsedUrl.path}/solveServiceArea`,o)})).then((e=>Z.fromJSON(e.data)))}_collectGeometries(e,t,r,s){s[r]=[t.length,t.length+e.length],e.forEach((e=>{t.push(e.geometry)}))}};(0,s._)([(0,o.Cb)()],A.prototype,"url",void 0),A=(0,s._)([(0,n.j)("esri.tasks.ServiceAreaTask")],A);const B=A},95986:(e,t,r)=>{"use strict";r.d(t,{Z:()=>u});var s=r(56140),o=(r(95830),r(36544),r(68055),r(79881)),n=r(87566),i=r(10923),a=(r(57002),r(86035),r(82677));let l=class extends a.default{constructor(...e){super(...e),this.requestOptions=null,this.url=null}normalizeCtorArgs(e,t){return"string"!=typeof e?e:{url:e,...t}}get parsedUrl(){return this._parseUrl(this.url)}_parseUrl(e){return e?(0,i.mN)(e):null}_encode(e,t,r){const s={};for(const o in e){if("declaredClass"===o)continue;const n=e[o];if(null!=n&&"function"!=typeof n)if(Array.isArray(n)){s[o]=[];for(let e=0;e<n.length;e++)s[o][e]=this._encode(n[e])}else if("object"==typeof n)if(n.toJSON){const e=n.toJSON(r&&r[o]);s[o]=t?e:JSON.stringify(e)}else s[o]=t?n:JSON.stringify(n);else s[o]=n}return s}};(0,s._)([(0,o.Cb)({readOnly:!0,dependsOn:["url"]})],l.prototype,"parsedUrl",null),(0,s._)([(0,o.Cb)()],l.prototype,"requestOptions",void 0),(0,s._)([(0,o.Cb)({type:String})],l.prototype,"url",void 0),l=(0,s._)([(0,n.j)("esri.tasks.Task")],l);const u=l},10532:(e,t,r)=>{"use strict";r.d(t,{Y:()=>p});var s=r(56140),o=(r(95830),r(10103)),n=r(59472),i=(r(36544),r(68055),r(79881),r(87566)),a=r(32656),l=r(10923),u=(r(57002),r(86035),r(54721)),c=r(95986);const p=e=>{let t=class extends e{async getServiceDescription(){return this._serviceDescriptionPromise||(this._serviceDescriptionPromise=this._fetchServiceDescription()),this._serviceDescriptionPromise}async _fetchServiceDescription(){if(!this.url||!this.parsedUrl)throw new a.Z("network-service:missing-url","Url to Network service is missing");const e=this.url,{data:t}=await(0,u.default)(e,{query:{f:"json"}});t.supportedTravelModes||(t.supportedTravelModes=[]);for(let e=0;e<t.supportedTravelModes.length;e++)t.supportedTravelModes[e].id||(t.supportedTravelModes[e].id=t.supportedTravelModes[e].itemId);const r=t.currentVersion>=10.4?async function(e){try{const{data:{supportedTravelModes:t,defaultTravelMode:r}}=await(0,u.default)(e+("/"===e[e.length-1]?"":"/")+"retrieveTravelModes",{query:{f:"json"}});return{supportedTravelModes:t,defaultTravelMode:r}}catch(e){throw new a.Z("network-service:retrieveTravelModes","Could not get to the NAServer's retrieveTravelModes.",{error:e})}}(e):async function(e){const{data:t}=await(0,u.default)(e.substring(0,e.indexOf("/rest/")+6)+"info",{query:{f:"json"}});if(!t||!t.owningSystemUrl)return{supportedTravelModes:[],defaultTravelMode:null};e=t.owningSystemUrl;const{data:r}=await(0,u.default)(e+("/"===e[e.length-1]?"":"/")+"sharing/rest/portals/self",{query:{f:"json"}}),s=(0,o.hS)("helperServices.routingUtilities.url",r);if(!s)return{supportedTravelModes:[],defaultTravelMode:null};const n=(0,l.mN)(e),i=/\/solveClosestFacility$/.test(n.path)?"Route":/\/solveClosestFacility$/.test(n.path)?"ClosestFacility":"ServiceAreas",a=await(0,u.default)(s+("/"===s[s.length-1]?"":"/")+"GetTravelModes/execute",{query:{f:"json",serviceName:i}}),c=[];let p=null;if(a&&a.data&&a.data.results&&a.data.results.length){const e=a.data.results;for(const t of e)if("supportedTravelModes"===t.paramName){if(t.value&&t.value.features)for(const{attributes:e}of t.value.features)if(e){const t=JSON.parse(e.TravelMode);c.push(t)}}else"defaultTravelMode"===t.paramName&&(p=t.value)}return{supportedTravelModes:c,defaultTravelMode:p}}(e),{defaultTravelMode:s,supportedTravelModes:n}=await r;return t.defaultTravelMode=s,t.supportedTravelModes=n,t}_isInputGeometryZAware(e,t){for(let r=0;r<t.length;r++){const s=e[t[r]];if(s&&s.length)for(const e of s)if((0,n.pC)(e)&&e.hasZ)return!0}return!1}_dropZValuesOffInputGeometry(e,t){for(let r=0;r<t.length;r++){const s=e[t[r]];if(s&&s.length)for(const e of s)e.z=void 0}console.log("The remote Network Analysis service is powered by a network dataset which is not Z-aware.\nZ-coordinates of the input geometry are ignored.")}};return t=(0,s._)([(0,i.j)("esri.tasks.mixins.NAServiceDescription")],t),t};let f=class extends(p(c.Z)){};f=(0,s._)([(0,i.j)("esri.tasks.mixins.NAServiceDescription")],f)},21544:(e,t,r)=>{"use strict";r.d(t,{Z:()=>c});var s=r(56140),o=(r(95830),r(36544),r(68055),r(79881)),n=r(56274),i=r(87566),a=(r(10923),r(57002),r(86035),r(58385));const l=new n.Xn({esriJobMessageTypeInformative:"informative",esriJobMessageTypeProcessDefinition:"process-definition",esriJobMessageTypeProcessStart:"process-start",esriJobMessageTypeProcessStop:"process-stop",esriJobMessageTypeWarning:"warning",esriJobMessageTypeError:"error",esriJobMessageTypeEmpty:"empty",esriJobMessageTypeAbort:"abort"});let u=class extends a.wq{constructor(e){super(e),this.description=null,this.type=null}};(0,s._)([(0,o.Cb)({type:String,json:{write:!0}})],u.prototype,"description",void 0),(0,s._)([(0,o.Cb)({type:String,json:{read:l.read,write:l.write}})],u.prototype,"type",void 0),u=(0,s._)([(0,i.j)("esri.tasks.support.GPMessage")],u);const c=u},36405:(e,t,r)=>{"use strict";r.d(t,{Z:()=>c});var s=r(56140),o=(r(95830),r(36544),r(68055),r(79881)),n=r(56274),i=r(87566),a=(r(10923),r(57002),r(86035),r(21544));const l=new n.Xn({0:"informative",1:"process-definition",2:"process-start",3:"process-stop",50:"warning",100:"error",101:"empty",200:"abort"});let u=class extends a.Z{constructor(e){super(e),this.type=null}};(0,s._)([(0,o.Cb)({type:String,json:{read:l.read,write:l.write}})],u.prototype,"type",void 0),u=(0,s._)([(0,i.j)("esri.tasks.support.NAMessage")],u);const c=u}}]);
//# sourceMappingURL=2366.js.map