(self.webpackChunkimaps=self.webpackChunkimaps||[]).push([[1328],{37969:(e,t,r)=>{"use strict";r.d(t,{pJ:()=>o,XO:()=>s});var n=r(7584);function s(e){return e=e||n.Z.location.hostname,c.some((t=>{var r;return null!=(null==(r=e)?void 0:r.match(t))}))}function o(e,t){return e&&(t=t||n.Z.location.hostname)?null!=t.match(l)||null!=t.match(i)?e.replace("static.arcgis.com","staticdev.arcgis.com"):null!=t.match(a)||null!=t.match(m)?e.replace("static.arcgis.com","staticqa.arcgis.com"):e:e}const l=/^devext.arcgis.com$/,a=/^qaext.arcgis.com$/,i=/^[\w-]*\.mapsdevext.arcgis.com$/,m=/^[\w-]*\.mapsqa.arcgis.com$/,c=[/^([\w-]*\.)?[\w-]*\.zrh-dev-local.esri.com$/,l,a,/^jsapps.esri.com$/,i,m]},50285:(e,t,r)=>{"use strict";r.d(t,{kL:()=>l,K3:()=>o});var n=r(95830);function s(e){return!!(0,n.Z)(`enable-feature:${e}`)}const o=()=>s("force-wosr"),l=()=>s("extent-transform-tool")},41328:(e,t,r)=>{"use strict";r.r(t),r.d(t,{fetchStyle:()=>b,fetchSymbolFromStyle:()=>w,resolveWebStyleSymbol:()=>h,styleNameFromItem:()=>N});var n=r(32656),s=r(10923),o=r(37704),l=r(36654),a=r(56798),i=r(32797),m=r(87484),c=r(36875),u=r(54734),y=r(37969),f=r(50285);const p={};function d(e,t,r){const s=t.portal||i.Z.getDefault();let o;const l=`${s.url} - ${s.user&&s.user.username} - ${e}`;return p[l]||(p[l]=function(e,t,r){return t.load(r).then((()=>{const n=new a.Z({disableExtraQuery:!0,query:`owner:${S} AND type:${Z} AND typekeywords:"${e}"`});return t.queryItems(n,r)})).then((({results:t})=>{let s=null;const o=e.toLowerCase();if(t&&Array.isArray(t))for(const e of t)if(e.typeKeywords.some((e=>e.toLowerCase()===o))&&e.type===Z&&e.owner===S){s=e;break}if(!s)throw new n.Z("symbolstyleutils:style-not-found",`The style '${e}' could not be found`,{styleName:e});return s.load(r)}))}(e,s,r).then((e=>(o=e,e.fetchData()))).then((t=>({data:t,baseUrl:o.itemUrl,styleName:e})))),p[l]}function b(e,t,r){return e.styleUrl?function(e,t){return $(e,t).then((t=>({data:t.data,baseUrl:(0,s.Yd)(e),styleUrl:e})))}(e.styleUrl,r):e.styleName?d(e.styleName,t,r):Promise.reject(new n.Z("symbolstyleutils:style-url-and-name-missing","Either styleUrl or styleName is required to resolve a style"))}function h(e,t,r,o){return e.name?e.styleName&&"Esri2DPointSymbolsStyle"===e.styleName?function(e,t,r){const n=v.replace(/\{SymbolName\}/gi,e.name);return $(n,r).then((e=>{const r=g(e.data);return(0,u.f)(r,{portal:t.portal,url:(0,s.mN)((0,s.Yd)(n)),origin:"portal-item"})}))}(e,t,o):b(e,t,o).then((n=>w(n,e.name,t,r,o))):Promise.reject(new n.Z("symbolstyleutils:style-symbol-reference-name-missing","Missing name in style symbol reference"))}function w(e,t,r,l,a){const i=e.data,p={portal:r.portal,url:(0,s.mN)(e.baseUrl),origin:"portal-item"},d=i.items.find((e=>e.name===t));if(!d){const e=`The symbol name '${t}' could not be found`;return Promise.reject(new n.Z("symbolstyleutils:symbol-name-not-found",e,{symbolName:t}))}let b=(0,o.f)(function(e,t){if("cimRef"===t)return e.cimRef;if(e.formatInfos&&!(0,f.K3)())for(const t of e.formatInfos)if("gltf"===t.type)return t.href;return e.webRef}(d,l),p),h=d.thumbnail&&d.thumbnail.href;const w=d.thumbnail&&d.thumbnail.imageData;(0,y.XO)()&&(b=(0,y.pJ)(b),h=(0,y.pJ)(h));const N={portal:r.portal,url:(0,s.mN)((0,s.Yd)(b)),origin:"portal-item"};return $(b,a).then((n=>{const s="cimRef"===l?g(n.data):n.data,a=(0,u.f)(s,N);if(a&&(0,u.i)(a)){if(h){const e=(0,o.f)(h,p);a.thumbnail=new c.Z({url:e})}else w&&(a.thumbnail=new c.Z({url:`data:image/png;base64,${w}`}));e.styleUrl?a.styleOrigin=new m.Z({portal:r.portal,styleUrl:e.styleUrl,name:t}):e.styleName&&(a.styleOrigin=new m.Z({portal:r.portal,styleName:e.styleName,name:t}))}return a}))}function g(e){return null===e||"CIMSymbolReference"===e.type?e:{type:"CIMSymbolReference",symbol:e}}function N(e){for(const t of e.typeKeywords)if(/^Esri.*Style$/.test(t)&&"Esri Style"!==t)return t}function $(e,t){const r={responseType:"json",query:{f:"json"},...t};return(0,l.default)((0,s.Fv)(e),r)}const S="esri_en",Z="Style",v="https://cdn.arcgis.com/sharing/rest/content/items/220936cc6ed342c9937abd8f180e7d1e/resources/styles/cim/{SymbolName}.json?f=json"}}]);
//# sourceMappingURL=1328.js.map