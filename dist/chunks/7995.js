(self.webpackChunkimaps=self.webpackChunkimaps||[]).push([[7995],{40522:(e,t,n)=>{"use strict";n.d(t,{Z:()=>c});var r,s=n(56140),i=(n(95830),n(36544),n(68055),n(79881)),o=n(87566),a=(n(10923),n(57002),n(86035),n(58385)),l=n(98034);let u=r=class extends a.wq{constructor(e){super(e),this.value=0,this.unit="milliseconds"}toMilliseconds(){return this.value*l.fM[this.unit]}clone(){return new r({value:this.value,unit:this.unit})}};(0,s._)([(0,i.Cb)({type:Number,json:{write:!0},nonNullable:!0})],u.prototype,"value",void 0),(0,s._)([(0,i.Cb)({type:l.vU.apiValues,json:{type:l.vU.jsonValues,read:l.vU.read,write:l.vU.write},nonNullable:!0})],u.prototype,"unit",void 0),u=r=(0,s._)([(0,o.j)("esri.TimeInterval")],u);const c=u},87040:(e,t,n)=>{"use strict";n.d(t,{q:()=>r});var r=(0,n(71012).c)((function(e){var t;void 0!==(t=function(){function e(n,r,s,i,o){for(;i>s;){if(i-s>600){var a=i-s+1,l=r-s+1,u=Math.log(a),c=.5*Math.exp(2*u/3),h=.5*Math.sqrt(u*c*(a-c)/a)*(l-a/2<0?-1:1);e(n,r,Math.max(s,Math.floor(r-l*c/a+h)),Math.min(i,Math.floor(r+(a-l)*c/a+h)),o)}var d=n[r],f=s,p=i;for(t(n,s,r),o(n[i],d)>0&&t(n,s,i);f<p;){for(t(n,f,p),f++,p--;o(n[f],d)<0;)f++;for(;o(n[p],d)>0;)p--}0===o(n[s],d)?t(n,s,p):t(n,++p,i),p<=r&&(s=p+1),r<=p&&(i=p-1)}}function t(e,t,n){var r=e[t];e[t]=e[n],e[n]=r}function n(e,t){return e<t?-1:e>t?1:0}return function(t,r,s,i,o){e(t,r,s||0,i||t.length-1,o||n)}}())&&(e.exports=t)}))},96233:(e,t,n)=>{"use strict";n.d(t,{r:()=>s});var r=n(87040);function s(e,t){if(!(this instanceof s))return new s(e,t);this._maxEntries=Math.max(4,e||9),this._minEntries=Math.max(2,Math.ceil(.4*this._maxEntries)),t&&("function"==typeof t?this.toBBox=t:this._initFormat(t)),this.clear()}function i(e,t,n){if(!n)return t.indexOf(e);for(var r=0;r<t.length;r++)if(n(e,t[r]))return r;return-1}function o(e,t){a(e,0,e.children.length,t,e)}function a(e,t,n,r,s){s||(s=y(null)),s.minX=1/0,s.minY=1/0,s.maxX=-1/0,s.maxY=-1/0;for(var i,o=t;o<n;o++)i=e.children[o],l(s,e.leaf?r(i):i);return s}function l(e,t){return e.minX=Math.min(e.minX,t.minX),e.minY=Math.min(e.minY,t.minY),e.maxX=Math.max(e.maxX,t.maxX),e.maxY=Math.max(e.maxY,t.maxY),e}function u(e,t){return e.minX-t.minX}function c(e,t){return e.minY-t.minY}function h(e){return(e.maxX-e.minX)*(e.maxY-e.minY)}function d(e){return e.maxX-e.minX+(e.maxY-e.minY)}function f(e,t){return(Math.max(t.maxX,e.maxX)-Math.min(t.minX,e.minX))*(Math.max(t.maxY,e.maxY)-Math.min(t.minY,e.minY))}function p(e,t){var n=Math.max(e.minX,t.minX),r=Math.max(e.minY,t.minY),s=Math.min(e.maxX,t.maxX),i=Math.min(e.maxY,t.maxY);return Math.max(0,s-n)*Math.max(0,i-r)}function g(e,t){return e.minX<=t.minX&&e.minY<=t.minY&&t.maxX<=e.maxX&&t.maxY<=e.maxY}function m(e,t){return t.minX<=e.maxX&&t.minY<=e.maxY&&t.maxX>=e.minX&&t.maxY>=e.minY}function y(e){return{children:e,height:1,leaf:!0,minX:1/0,minY:1/0,maxX:-1/0,maxY:-1/0}}function _(e,t,n,s,i){for(var o,a=[t,n];a.length;)(n=a.pop())-(t=a.pop())<=s||(o=t+Math.ceil((n-t)/s/2)*s,(0,r.q)(e,o,t,n,i),a.push(t,o,o,n))}s.prototype={all:function(){return this._all(this.data,[])},search:function(e){var t=this.data,n=[],r=this.toBBox;if(!m(e,t))return n;for(var s,i,o,a,l=[];t;){for(s=0,i=t.children.length;s<i;s++)o=t.children[s],m(e,a=t.leaf?r(o):o)&&(t.leaf?n.push(o):g(e,a)?this._all(o,n):l.push(o));t=l.pop()}return n},collides:function(e){var t=this.data,n=this.toBBox;if(!m(e,t))return!1;for(var r,s,i,o,a=[];t;){for(r=0,s=t.children.length;r<s;r++)if(i=t.children[r],m(e,o=t.leaf?n(i):i)){if(t.leaf||g(e,o))return!0;a.push(i)}t=a.pop()}return!1},load:function(e){if(!e||!e.length)return this;if(e.length<this._minEntries){for(var t=0,n=e.length;t<n;t++)this.insert(e[t]);return this}var r=this._build(e.slice(),0,e.length-1,0);if(this.data.children.length)if(this.data.height===r.height)this._splitRoot(this.data,r);else{if(this.data.height<r.height){var s=this.data;this.data=r,r=s}this._insert(r,this.data.height-r.height-1,!0)}else this.data=r;return this},insert:function(e){return e&&this._insert(e,this.data.height-1),this},clear:function(){return this.data=y([]),this},remove:function(e,t){if(!e)return this;for(var n,r,s,o,a=this.data,l=this.toBBox(e),u=[],c=[];a||u.length;){if(a||(a=u.pop(),r=u[u.length-1],n=c.pop(),o=!0),a.leaf&&-1!==(s=i(e,a.children,t)))return a.children.splice(s,1),u.push(a),this._condense(u),this;o||a.leaf||!g(a,l)?r?(n++,a=r.children[n],o=!1):a=null:(u.push(a),c.push(n),n=0,r=a,a=a.children[0])}return this},toBBox:function(e){return e},compareMinX:u,compareMinY:c,toJSON:function(){return this.data},fromJSON:function(e){return this.data=e,this},_all:function(e,t){for(var n=[];e;)e.leaf?t.push.apply(t,e.children):n.push.apply(n,e.children),e=n.pop();return t},_build:function(e,t,n,r){var s,i=n-t+1,a=this._maxEntries;if(i<=a)return o(s=y(e.slice(t,n+1)),this.toBBox),s;r||(r=Math.ceil(Math.log(i)/Math.log(a)),a=Math.ceil(i/Math.pow(a,r-1))),(s=y([])).leaf=!1,s.height=r;var l,u,c,h,d=Math.ceil(i/a),f=d*Math.ceil(Math.sqrt(a));for(_(e,t,n,f,this.compareMinX),l=t;l<=n;l+=f)for(_(e,l,c=Math.min(l+f-1,n),d,this.compareMinY),u=l;u<=c;u+=d)h=Math.min(u+d-1,c),s.children.push(this._build(e,u,h,r-1));return o(s,this.toBBox),s},_chooseSubtree:function(e,t,n,r){for(var s,i,o,a,l,u,c,d;r.push(t),!t.leaf&&r.length-1!==n;){for(c=d=1/0,s=0,i=t.children.length;s<i;s++)l=h(o=t.children[s]),(u=f(e,o)-l)<d?(d=u,c=l<c?l:c,a=o):u===d&&l<c&&(c=l,a=o);t=a||t.children[0]}return t},_insert:function(e,t,n){var r=this.toBBox,s=n?e:r(e),i=[],o=this._chooseSubtree(s,this.data,t,i);for(o.children.push(e),l(o,s);t>=0&&i[t].children.length>this._maxEntries;)this._split(i,t),t--;this._adjustParentBBoxes(s,i,t)},_split:function(e,t){var n=e[t],r=n.children.length,s=this._minEntries;this._chooseSplitAxis(n,s,r);var i=this._chooseSplitIndex(n,s,r),a=y(n.children.splice(i,n.children.length-i));a.height=n.height,a.leaf=n.leaf,o(n,this.toBBox),o(a,this.toBBox),t?e[t-1].children.push(a):this._splitRoot(n,a)},_splitRoot:function(e,t){this.data=y([e,t]),this.data.height=e.height+1,this.data.leaf=!1,o(this.data,this.toBBox)},_chooseSplitIndex:function(e,t,n){var r,s,i,o,l,u,c,d;for(u=c=1/0,r=t;r<=n-t;r++)o=p(s=a(e,0,r,this.toBBox),i=a(e,r,n,this.toBBox)),l=h(s)+h(i),o<u?(u=o,d=r,c=l<c?l:c):o===u&&l<c&&(c=l,d=r);return d},_chooseSplitAxis:function(e,t,n){var r=e.leaf?this.compareMinX:u,s=e.leaf?this.compareMinY:c;this._allDistMargin(e,t,n,r)<this._allDistMargin(e,t,n,s)&&e.children.sort(r)},_allDistMargin:function(e,t,n,r){e.children.sort(r);var s,i,o=this.toBBox,u=a(e,0,t,o),c=a(e,n-t,n,o),h=d(u)+d(c);for(s=t;s<n-t;s++)i=e.children[s],l(u,e.leaf?o(i):i),h+=d(u);for(s=n-t-1;s>=t;s--)i=e.children[s],l(c,e.leaf?o(i):i),h+=d(c);return h},_adjustParentBBoxes:function(e,t,n){for(var r=n;r>=0;r--)l(t[r],e)},_condense:function(e){for(var t,n=e.length-1;n>=0;n--)0===e[n].children.length?n>0?(t=e[n-1].children).splice(t.indexOf(e[n]),1):this.clear():o(e[n],this.toBBox)},_initFormat:function(e){var t=["return a"," - b",";"];this.compareMinX=new Function("a","b",t.join(e[0])),this.compareMinY=new Function("a","b",t.join(e[1])),this.toBBox=new Function("a","return {minX: a"+e[0]+", minY: a"+e[1]+", maxX: a"+e[2]+", maxY: a"+e[3]+"};")}}},90011:(e,t,n)=>{"use strict";n.d(t,{Z:()=>u});var r=n(95830),s=n(38035);const i=4294967296,o=(0,r.Z)("esri-text-decoder")?new TextDecoder("utf-8"):null,a=(0,r.Z)("safari")||(0,r.Z)("ios")?6:(0,r.Z)("ff")?12:32;class l{constructor(e,t,n=0,r=(e?e.byteLength:0)){this._tag=0,this._dataType=99,this.init(e,t,n,r)}init(e,t,n,r){this._data=e,this._dataView=t,this._pos=n,this._end=r}clone(){return new l(this._data,this._dataView,this._pos,this._end)}pos(){return this._pos}move(e){this._pos=e}nextTag(e){for(;;){if(this._pos===this._end)return!1;const t=this._decodeVarint();if(this._tag=t>>3,this._dataType=7&t,!e||e===this._tag)break;this.skip()}return!0}next(){if(this._pos===this._end)return!1;const e=this._decodeVarint();return this._tag=e>>3,this._dataType=7&e,!0}empty(){return this._pos>=this._end}tag(){return this._tag}getInt32(){return this._decodeVarint()}getInt64(){return this._decodeVarint()}getUInt32(){let e=4294967295;return e=(127&this._data[this._pos])>>>0,this._data[this._pos++]<128?e:(e=(e|(127&this._data[this._pos])<<7)>>>0,this._data[this._pos++]<128?e:(e=(e|(127&this._data[this._pos])<<14)>>>0,this._data[this._pos++]<128?e:(e=(e|(127&this._data[this._pos])<<21)>>>0,this._data[this._pos++]<128?e:(e=(e|(15&this._data[this._pos])<<28)>>>0,this._data[this._pos++]<128?e:void 0))))}getUInt64(){return this._decodeVarint()}getSInt32(){const e=this.getUInt32();return e>>>1^-(1&e)|0}getSInt64(){return this._decodeSVarint()}getBool(){const e=0!==this._data[this._pos];return this._skip(1),e}getEnum(){return this._decodeVarint()}getFixed64(){const e=this._dataView,t=this._pos,n=e.getUint32(t,!0)+e.getUint32(t+4,!0)*i;return this._skip(8),n}getSFixed64(){const e=this._dataView,t=this._pos,n=e.getUint32(t,!0)+e.getInt32(t+4,!0)*i;return this._skip(8),n}getDouble(){const e=this._dataView.getFloat64(this._pos,!0);return this._skip(8),e}getFixed32(){const e=this._dataView.getUint32(this._pos,!0);return this._skip(4),e}getSFixed32(){const e=this._dataView.getInt32(this._pos,!0);return this._skip(4),e}getFloat(){const e=this._dataView.getFloat32(this._pos,!0);return this._skip(4),e}getString(){const e=this._getLength(),t=this._pos,n=this._toString(this._data,t,t+e);return this._skip(e),n}getBytes(){const e=this._getLength(),t=this._pos,n=this._toBytes(this._data,t,t+e);return this._skip(e),n}getLength(){return this._getLengthUnsafe()}processMessageWithArgs(e,t,n,r){const s=this.getMessage(),i=e(s,t,n,r);return s.release(),i}processMessage(e){const t=this.getMessage(),n=e(t);return t.release(),n}getMessage(){const e=this._getLength(),t=l.pool.acquire();return t.init(this._data,this._dataView,this._pos,this._pos+e),this._skip(e),t}release(){l.pool.release(this)}dataType(){return this._dataType}skip(){switch(this._dataType){case 0:this._decodeVarint();break;case 1:this._skip(8);break;case 2:this._skip(this._getLength());break;case 5:this._skip(4);break;default:throw new Error("Invalid data type!")}}skipLen(e){this._skip(e)}_skip(e){if(this._pos+e>this._end)throw new Error("Attempt to skip past the end of buffer!");this._pos+=e}_decodeVarint(){const e=this._data;let t,n=this._pos,r=0;if(this._end-n>=10)do{if(t=e[n++],r|=127&t,0==(128&t))break;if(t=e[n++],r|=(127&t)<<7,0==(128&t))break;if(t=e[n++],r|=(127&t)<<14,0==(128&t))break;if(t=e[n++],r|=(127&t)<<21,0==(128&t))break;if(t=e[n++],r+=268435456*(127&t),0==(128&t))break;if(t=e[n++],r+=34359738368*(127&t),0==(128&t))break;if(t=e[n++],r+=4398046511104*(127&t),0==(128&t))break;if(t=e[n++],r+=562949953421312*(127&t),0==(128&t))break;if(t=e[n++],r+=72057594037927940*(127&t),0==(128&t))break;if(t=e[n++],r+=0x8000000000000000*(127&t),0==(128&t))break;throw new Error("Varint too long!")}while(0);else{let s=1;for(;n!==this._end&&(t=e[n],0!=(128&t));)++n,r+=(127&t)*s,s*=128;if(n===this._end)throw new Error("Varint overrun!");++n,r+=t*s}return this._pos=n,r}_decodeSVarint(){const e=this._decodeVarint();return e%2?-(e+1)/2:e/2}_getLength(){if(2!==this._dataType)throw new Error("Not a delimited data type!");return this._decodeVarint()}_getLengthUnsafe(){return this.getUInt32()}_toString(e,t,n){if((n=Math.min(this._end,n))-t>a&&o){const r=e.subarray(t,n);return o.decode(r)}let r="",s="";for(let i=t;i<n;++i){const t=e[i];128&t?s+="%"+t.toString(16):(r+=decodeURIComponent(s)+String.fromCharCode(t),s="")}return s.length&&(r+=decodeURIComponent(s)),r}_toBytes(e,t,n){return n=Math.min(this._end,n),new Uint8Array(e.buffer,t,n-t)}}l.pool=new s.Z(l,null,(e=>{e._data=null,e._dataView=null}));const u=l},10165:(e,t,n)=>{"use strict";n.d(t,{N:()=>r});const r={convertToGEGeometry:function(e,t){return null==t?null:e.convertJSONToGeometry(t)},exportPoint:function(e,t,n){const r=new s(e.getPointX(t),e.getPointY(t),n),i=e.hasZ(t),o=e.hasM(t);return i&&(r.z=e.getPointZ(t)),o&&(r.m=e.getPointM(t)),r},exportPolygon:function(e,t,n){return new i(e.exportPaths(t),n,e.hasZ(t),e.hasM(t))},exportPolyline:function(e,t,n){return new o(e.exportPaths(t),n,e.hasZ(t),e.hasM(t))},exportMultipoint:function(e,t,n){return new a(e.exportPoints(t),n,e.hasZ(t),e.hasM(t))},exportExtent:function(e,t,n){const r=e.hasZ(t),s=e.hasM(t),i=new l(e.getXMin(t),e.getYMin(t),e.getXMax(t),e.getYMax(t),n);if(r){const n=e.getZExtent(t);i.zmin=n.vmin,i.zmax=n.vmax}if(s){const n=e.getMExtent(t);i.mmin=n.vmin,i.mmax=n.vmax}return i}};class s{constructor(e,t,n){this.x=e,this.y=t,this.spatialReference=n,this.z=void 0,this.m=void 0}}class i{constructor(e,t,n,r){this.rings=e,this.spatialReference=t,this.hasZ=void 0,this.hasM=void 0,n&&(this.hasZ=n),r&&(this.hasM=r)}}class o{constructor(e,t,n,r){this.paths=e,this.spatialReference=t,this.hasZ=void 0,this.hasM=void 0,n&&(this.hasZ=n),r&&(this.hasM=r)}}class a{constructor(e,t,n,r){this.points=e,this.spatialReference=t,this.hasZ=void 0,this.hasM=void 0,n&&(this.hasZ=n),r&&(this.hasM=r)}}class l{constructor(e,t,n,r,s){this.xmin=e,this.ymin=t,this.xmax=n,this.ymax=r,this.spatialReference=s,this.zmin=void 0,this.zmax=void 0,this.mmin=void 0,this.mmax=void 0}}},78712:(e,t,n)=>{"use strict";n.d(t,{ym:()=>b,RF:()=>m,vY:()=>a,J9:()=>x,U1:()=>I,Ie:()=>v,G6:()=>w});var r=n(56885);const s=(e,t,n)=>[t,n],i=(e,t,n)=>[t,n,e[2]],o=(e,t,n)=>[t,n,e[2],e[3]];function a(e){return e?{originPosition:"upper-left"===e.originPosition?"upperLeft":"lower-left"===e.originPosition?"lowerLeft":e.originPosition,scale:e.tolerance?[e.tolerance,e.tolerance]:[1,1],translate:e.extent?[e.extent.xmin,e.extent.ymax]:[0,0]}:null}function l({scale:e,translate:t},n){return Math.round((n-t[0])/e[0])}function u({scale:e,translate:t},n){return Math.round((t[1]-n)/e[1])}function c(e,t,n){const r=[];let s,i,o,a;for(let c=0;c<n.length;c++){const h=n[c];c>0?(o=l(e,h[0]),a=u(e,h[1]),o===s&&a===i||(r.push(t(h,o-s,a-i)),s=o,i=a)):(s=l(e,h[0]),i=u(e,h[1]),r.push(t(h,s,i)))}return r.length>0?r:null}function h({scale:e,translate:t},n){return n*e[0]+t[0]}function d({scale:e,translate:t},n){return t[1]-n*e[1]}function f(e,t,n){const r=new Array(n.length);if(!n.length)return r;const[s,i]=e.scale;let o=h(e,n[0][0]),a=d(e,n[0][1]);r[0]=t(n[0],o,a);for(let e=1;e<n.length;e++){const l=n[e];o+=l[0]*s,a-=l[1]*i,r[e]=t(l,o,a)}return r}function p(e,t,n){const r=new Array(n.length);for(let s=0;s<n.length;s++)r[s]=f(e,t,n[s]);return r}function g(e,t,n,r,a){return t.points=function(e,t,n,r){return c(e,n?r?o:i:r?i:s,t)}(e,n.points,r,a),t}function m(e,t,n,r,s){return t.x=l(e,n.x),t.y=u(e,n.y),t!==n&&(r&&(t.z=n.z),s&&(t.m=n.m)),t}function y(e,t,n,r,a){const l=function(e,t,n,r){const a=[],l=n?r?o:i:r?i:s;for(let n=0;n<t.length;n++){const r=c(e,l,t[n]);r&&r.length>=3&&a.push(r)}return a.length?a:null}(e,n.rings,r,a);return l?(t.rings=l,t):null}function _(e,t,n,r,a){const l=function(e,t,n,r){const a=[],l=n?r?o:i:r?i:s;for(let n=0;n<t.length;n++){const r=c(e,l,t[n]);r&&r.length>=2&&a.push(r)}return a.length?a:null}(e,n.paths,r,a);return l?(t.paths=l,t):null}function b(e,t){return e&&t?(0,r.wp)(t)?m(e,{},t,!1,!1):(0,r.l9)(t)?_(e,{},t,!1,!1):(0,r.oU)(t)?y(e,{},t,!1,!1):(0,r.aW)(t)?g(e,{},t,!1,!1):(0,r.YX)(t)?(o=!1,a=!1,(s={}).xmin=l(n=e,(i=t).xmin),s.ymin=u(n,i.ymin),s.xmax=l(n,i.xmax),s.ymax=u(n,i.ymax),s!==i&&(o&&(s.zmin=i.zmin,s.zmax=i.zmax),a&&(s.mmin=i.mmin,s.mmax=i.mmax)),s):null:null;var n,s,i,o,a}function x(e,t,n,r,a){return t.points=function(e,t,n,r){return f(e,n?r?o:i:r?i:s,t)}(e,n.points,r,a),t}function I(e,t,n,r,s){return t.x=h(e,n.x),t.y=d(e,n.y),t!==n&&(r&&(t.z=n.z),s&&(t.m=n.m)),t}function v(e,t,n,r,a){return t.rings=function(e,t,n,r){return p(e,n?r?o:i:r?i:s,t)}(e,n.rings,r,a),t}function w(e,t,n,r,a){return t.paths=function(e,t,n,r){return p(e,n?r?o:i:r?i:s,t)}(e,n.paths,r,a),t}},44195:(e,t,n)=>{"use strict";n.d(t,{Z:()=>s});class r{constructor(e=null,t={},n,r){this.displayId=0,this.geohashIndexed=!1,this.geohashX=0,this.geohashY=0,this.geometry=e,t&&(this.attributes=t),n&&(this.centroid=n),null!=r&&(this.objectId=r)}get hasGeometry(){return!(!this.geometry||!this.geometry.coords||!this.geometry.coords.length)}weakClone(){const e=new r(this.geometry,this.attributes,this.centroid,this.objectId);return e.displayId=this.displayId,e.geohashIndexed=this.geohashIndexed,e.geohashX=this.geohashX,e.geohashY=this.geohashY,e}}const s=r},60151:(e,t,n)=>{"use strict";n.d(t,{Z:()=>s});class r{constructor(){this.objectIdFieldName=null,this.globalIdFieldName=null,this.geohashFieldName=null,this.geometryProperties=null,this.geometryType=null,this.spatialReference=null,this.hasZ=!1,this.hasM=!1,this.features=[],this.fields=[],this.transform=null,this.exceededTransferLimit=!1,this.uniqueIdField=null,this.queryGeometryType=null,this.queryGeometry=null}weakClone(){const e=new r;return e.objectIdFieldName=this.objectIdFieldName,e.globalIdFieldName=this.globalIdFieldName,e.geohashFieldName=this.geohashFieldName,e.geometryProperties=this.geometryProperties,e.geometryType=this.geometryType,e.spatialReference=this.spatialReference,e.hasZ=this.hasZ,e.hasM=this.hasM,e.features=this.features,e.fields=this.fields,e.transform=this.transform,e.exceededTransferLimit=this.exceededTransferLimit,e.uniqueIdField=this.uniqueIdField,e.queryGeometry=this.queryGeometry,e.queryGeometryType=this.queryGeometryType,e}}const s=r},73127:(e,t,n)=>{"use strict";n.d(t,{Z:()=>s});class r{constructor(e=[],t=[],n=!1){this.lengths=null!=e?e:[],this.coords=null!=t?t:[],this.hasIndeterminateRingOrder=n}get isPoint(){return 0===this.lengths.length}forEachVertex(e){let t=0;this.lengths.length||e(this.coords[0],this.coords[1]);for(let n=0;n<this.lengths.length;n++){const r=this.lengths[n];for(let n=0;n<r;n++)e(this.coords[2*(n+t)],this.coords[2*(n+t)+1]);t+=r}}clone(){return new r(this.lengths.slice(),this.coords.slice(),this.hasIndeterminateRingOrder)}}const s=r},24179:(e,t,n)=>{"use strict";function r(e,t){return e?t?4:3:t?3:2}function s(e,t,n,s,a){if(!t||!t.lengths.length)return null;const l="upperLeft"===(null==a?void 0:a.originPosition)?-1:1;e.lengths.length&&(e.lengths.length=0),e.coords.length&&(e.coords.length=0);const u=e.coords,c=[],h=n?[Number.POSITIVE_INFINITY,Number.NEGATIVE_INFINITY,Number.POSITIVE_INFINITY,Number.NEGATIVE_INFINITY,Number.POSITIVE_INFINITY,Number.NEGATIVE_INFINITY]:[Number.POSITIVE_INFINITY,Number.NEGATIVE_INFINITY,Number.POSITIVE_INFINITY,Number.NEGATIVE_INFINITY],{lengths:d,coords:f}=t,p=r(n,s);let g=0;for(const e of d){const t=i(h,f,g,e,n,s,l);t&&c.push(t),g+=e*p}if(c.sort(((e,t)=>{let r=l*e[2]-l*t[2];return 0===r&&n&&(r=e[4]-t[4]),r})),c.length){let e=6*c[0][2];u[0]=c[0][0]/e,u[1]=c[0][1]/e,n&&(e=6*c[0][4],u[2]=0!==e?c[0][3]/e:0),(u[0]<h[0]||u[0]>h[1]||u[1]<h[2]||u[1]>h[3]||n&&(u[2]<h[4]||u[2]>h[5]))&&(u.length=0)}if(!u.length){const e=t.lengths[0]?o(f,0,d[0],n,s):null;if(!e)return null;u[0]=e[0],u[1]=e[1],n&&e.length>2&&(u[2]=e[2])}return e}function i(e,t,n,s,i,o,a=1){const l=r(i,o);let u=n,c=n+l,h=0,d=0,f=0,p=0,g=0;for(let n=0,r=s-1;n<r;n++,u+=l,c+=l){const n=t[u],r=t[u+1],s=t[u+2],o=t[c],a=t[c+1],l=t[c+2];let m=n*a-o*r;p+=m,h+=(n+o)*m,d+=(r+a)*m,i&&(m=n*l-o*s,f+=(s+l)*m,g+=m),n<e[0]&&(e[0]=n),n>e[1]&&(e[1]=n),r<e[2]&&(e[2]=r),r>e[3]&&(e[3]=r),i&&(s<e[4]&&(e[4]=s),s>e[5]&&(e[5]=s))}if(p*a>0&&(p*=-1),g*a>0&&(g*=-1),!p)return null;const m=[h,d,.5*p];return i&&(m[3]=f,m[4]=.5*g),m}function o(e,t,n,s,i){const o=r(s,i);let h=t,d=t+o,f=0,p=0,g=0,m=0;for(let t=0,r=n-1;t<r;t++,h+=o,d+=o){const t=e[h],n=e[h+1],r=e[h+2],i=e[d],o=e[d+1],y=e[d+2],_=s?l(t,n,r,i,o,y):a(t,n,i,o);if(_)if(f+=_,s){const e=c(t,n,r,i,o,y);p+=_*e[0],g+=_*e[1],m+=_*e[2]}else{const e=u(t,n,i,o);p+=_*e[0],g+=_*e[1]}}return f>0?s?[p/f,g/f,m/f]:[p/f,g/f]:n>0?s?[e[t],e[t+1],e[t+2]]:[e[t],e[t+1]]:null}function a(e,t,n,r){const s=n-e,i=r-t;return Math.sqrt(s*s+i*i)}function l(e,t,n,r,s,i){const o=r-e,a=s-t,l=i-n;return Math.sqrt(o*o+a*a+l*l)}function u(e,t,n,r){return[e+.5*(n-e),t+.5*(r-t)]}function c(e,t,n,r,s,i){return[e+.5*(r-e),t+.5*(s-t),n+.5*(i-n)]}n.d(t,{Y:()=>s})},77142:(e,t,n)=>{"use strict";n.d(t,{Z:()=>_});var r=n(59472),s=n(36544),i=n(32656),o=n(35470),a=n(50897),l=n(69996),u=n(31036),c=n(95830),h=n(96233);const d={minX:0,minY:0,maxX:0,maxY:0};class f{constructor(){this._indexInvalid=!1,this._boundsToLoad=[],this._boundsById=new Map,this._idByBounds=new Map,this._index=(0,h.r)(9,(0,c.Z)("csp-restrictions")?e=>({minX:e[0],minY:e[1],maxX:e[2],maxY:e[3]}):["[0]","[1]","[2]","[3]"]),this._loadIndex=()=>{if(this._indexInvalid){const e=new Array(this._idByBounds.size);let t=0;this._idByBounds.forEach(((n,r)=>{e[t++]=r})),this._indexInvalid=!1,this._index.clear(),this._index.load(e)}else this._boundsToLoad.length&&(this._index.load(this._boundsToLoad.filter((e=>this._idByBounds.has(e)))),this._boundsToLoad.length=0)}}clear(){this._indexInvalid=!1,this._boundsToLoad.length=0,this._boundsById.clear(),this._idByBounds.clear(),this._index.clear()}delete(e){const t=this._boundsById.get(e);this._boundsById.delete(e),t&&(this._idByBounds.delete(t),this._indexInvalid||this._index.remove(t))}forEachInBounds(e,t){this._loadIndex();for(const n of function(e,t){return d.minX=t[0],d.minY=t[1],d.maxX=t[2],d.maxY=t[3],e.search(d)}(this._index,e))t(this._idByBounds.get(n))}get(e){return this._boundsById.get(e)}has(e){return this._boundsById.has(e)}invalidateIndex(){this._indexInvalid||(this._indexInvalid=!0,this._boundsToLoad.length=0)}set(e,t){if(!this._indexInvalid){const t=this._boundsById.get(e);t&&(this._index.remove(t),this._idByBounds.delete(t))}this._boundsById.set(e,t),t&&(this._idByBounds.set(t,e),this._indexInvalid||(this._boundsToLoad.push(t),this._boundsToLoad.length>5e4&&this._loadIndex()))}}var p=n(44195),g=n(73127),m=n(24179);const y={getObjectId:e=>e.objectId,getAttributes:e=>e.attributes,getAttribute:(e,t)=>e.attributes[t],cloneWithGeometry:(e,t)=>new p.Z(t,e.attributes,null,e.objectId),getGeometry:e=>e.geometry,getCentroid:(e,t)=>(e.centroid||(e.centroid=(0,m.Y)(new g.Z,e.geometry,t.hasZ,t.hasM)),e.centroid)};const _=class{constructor(e){this.geometryInfo=e,this._boundsStore=new f,this._featuresById=new Map,this._markedIds=new Set,this.events=new o.Z,this.featureAdapter=y}get geometryType(){return this.geometryInfo.geometryType}get hasM(){return this.geometryInfo.hasM}get hasZ(){return this.geometryInfo.hasZ}get numFeatures(){return this._featuresById.size}get fullBounds(){if(!this.numFeatures)return null;const e=(0,a.Ue)(a.Gv);return this._featuresById.forEach((t=>{const n=this._boundsStore.get(t.objectId);n&&(e[0]=Math.min(n[0],e[0]),e[1]=Math.min(n[1],e[1]),e[2]=Math.max(n[2],e[2]),e[3]=Math.max(n[3],e[3]))})),e}get storeStatistics(){let e=0;return this._featuresById.forEach((t=>{t.geometry&&t.geometry.coords&&(e+=t.geometry.coords.length)})),{featureCount:this._featuresById.size,vertexCount:e/(this.hasZ?this.hasM?4:3:this.hasM?3:2)}}add(e){this._add(e),this._emitChanged()}addMany(e){for(const t of e)this._add(t);this._emitChanged()}clear(){this._featuresById.clear(),this._boundsStore.clear(),this._emitChanged()}removeById(e){const t=this._featuresById.get(e);return t?(this._remove(t),this._emitChanged(),t):null}removeManyById(e){this._boundsStore.invalidateIndex();for(const t of e){const e=this._featuresById.get(t);e&&this._remove(e)}this._emitChanged()}forEachBounds(e,t,n){for(const r of e){const e=this._boundsStore.get(r.objectId);e&&t((0,l.JR)(n,e))}}getFeature(e){return this._featuresById.get(e)}has(e){return this._featuresById.has(e)}forEach(e){this._featuresById.forEach((t=>e(t)))}forEachInBounds(e,t){this._boundsStore.forEachInBounds(e,(e=>{t(this._featuresById.get(e))}))}startMarkingUsedFeatures(){this._boundsStore.invalidateIndex(),this._markedIds.clear()}sweep(){let e=!1;this._featuresById.forEach(((t,n)=>{this._markedIds.has(n)||(e=!0,this._remove(t))})),this._markedIds.clear(),e&&this._emitChanged()}_emitChanged(){this.events.emit("changed",void 0)}_add(e){if(!e)return;const t=e.objectId;if(null==t)return void s.Z.getLogger("esri.layers.graphics.data.FeatureStore").error(new i.Z("featurestore:invalid-feature","feature id is missing",{feature:e}));const n=this._featuresById.get(t);let o;if(this._markedIds.add(t),n?(e.displayId=n.displayId,o=this._boundsStore.get(t),this._boundsStore.delete(t)):(0,r.pC)(this.onFeatureAdd)&&this.onFeatureAdd(e),!e.geometry||!e.geometry.coords||!e.geometry.coords.length)return this._boundsStore.set(t,null),void this._featuresById.set(t,e);o=(0,u.$)(o||(0,a.Ue)(),e.geometry,this.geometryInfo.hasZ,this.geometryInfo.hasM),this._boundsStore.set(t,o),this._featuresById.set(t,e)}_remove(e){return(0,r.pC)(this.onFeatureRemove)&&this.onFeatureRemove(e),this._markedIds.delete(e.objectId),this._boundsStore.delete(e.objectId),this._featuresById.delete(e.objectId),e}}},71951:(e,t,n)=>{"use strict";n.d(t,{_W:()=>h,iV:()=>p,oj:()=>m});var r=n(27780),s=n(41241),i=n(17333),o=n(10165);const a=[0,0];function l(e,t){if(!t)return null;if("x"in t){const n={x:0,y:0};return[n.x,n.y]=e(t.x,t.y,a),null!=t.z&&(n.z=t.z),null!=t.m&&(n.m=t.m),n}if("xmin"in t){const n={xmin:0,ymin:0,xmax:0,ymax:0};return[n.xmin,n.ymin]=e(t.xmin,t.ymin,a),[n.xmax,n.ymax]=e(t.xmax,t.ymax,a),t.hasZ&&(n.zmin=t.zmin,n.zmax=t.zmax,n.hasZ=!0),t.hasM&&(n.mmin=t.mmin,n.mmax=t.mmax,n.hasM=!0),n}return"rings"in t?{rings:u(t.rings,e),hasM:t.hasM,hasZ:t.hasZ}:"paths"in t?{paths:u(t.paths,e),hasM:t.hasM,hasZ:t.hasZ}:"points"in t?{points:c(t.points,e),hasM:t.hasM,hasZ:t.hasZ}:void 0}function u(e,t){const n=[];for(const r of e)n.push(c(r,t));return n}function c(e,t){const n=[];for(const r of e){const e=t(r[0],r[1],[0,0]);n.push(e),r.length>2&&e.push(r[2]),r.length>3&&e.push(r[3])}return n}async function h(e,t){if(!t)return;const n=Array.isArray(e)?e.map((e=>{var t;return null==(t=e.geometry)?void 0:t.spatialReference})):[e];await(0,i.iQ)(n.map((e=>({source:e,dest:t}))))}const d=l.bind(null,s.hG),f=l.bind(null,s.R6);function p(e,t,n){return e?(n||(n=t,t=e.spatialReference),(0,r.JY)(t)&&(0,r.JY)(n)&&!(0,r.fS)(t,n)?(0,s.Q8)(t,n)?(0,r.sS)(n)?d(e):f(e):(0,i.oj)(o.N,[e],t,n,null)[0]:e):e}const g=new class{constructor(){this._jobs=[],this._timer=null,this._process=this._process.bind(this)}async push(e,t,n){!e||!e.length||!t||!n||(0,r.fS)(t,n);const s={geometries:e,inSpatialReference:t,outSpatialReference:n,resolve:null};return this._jobs.push(s),new Promise((e=>{s.resolve=e,null===this._timer&&(this._timer=setTimeout(this._process,10))}))}_process(){this._timer=null;const e=this._jobs.shift();if(!e)return;const{geometries:t,inSpatialReference:n,outSpatialReference:a,resolve:l}=e;(0,s.Q8)(n,a)?(0,r.sS)(a)?l(t.map(d)):l(t.map(f)):l((0,i.oj)(o.N,t,n,a,null)),this._jobs.length>0&&(this._timer=setTimeout(this._process,10))}};async function m(e,t,n){return g.push(e,t,n)}},31036:(e,t,n)=>{"use strict";n.d(t,{XA:()=>z,h_:()=>K,Yn:()=>U,GH:()=>J,E7:()=>L,ks:()=>V,Uy:()=>Y,u0:()=>j,EI:()=>A,cn:()=>$,di:()=>Q,Iv:()=>E,fQ:()=>I,eG:()=>C,J6:()=>q,oB:()=>ce,zj:()=>ne,$:()=>ie,lz:()=>ue,RZ:()=>ee,Nh:()=>te,Jd:()=>y,IN:()=>_,hY:()=>ae,lM:()=>H,$g:()=>oe});var r=n(36544),s=n(32656),i=n(56885),o=n(44195),a=n(60151),l=n(73127);function u(e,t){return e?t?4:3:t?3:2}const c=r.Z.getLogger("esri.tasks.support.optimizedFeatureSet"),h={esriGeometryPoint:0,esriGeometryPolyline:2,esriGeometryPolygon:3,esriGeometryMultipoint:0},d=(e,t,n,r,s,i)=>{e[n]=s,e[n+1]=i},f=(e,t,n,r,s,i)=>{e[n]=s,e[n+1]=i,e[n+2]=t[r+2]},p=(e,t,n,r,s,i)=>{e[n]=s,e[n+1]=i,e[n+2]=t[r+3]},g=(e,t,n,r,s,i)=>{e[n]=s,e[n+1]=i,e[n+2]=t[r+2],e[n+3]=t[r+3]};function m(e,t,n,r){if(e){if(n)return t&&r?g:f;if(t&&r)return p}else if(t&&r)return f;return d}function y({scale:e,translate:t},n){return Math.round((n-t[0])/e[0])}function _({scale:e,translate:t},n){return Math.round((t[1]-n)/e[1])}function b({scale:e,translate:t},n){return n*e[0]+t[0]}function x({scale:e,translate:t},n){return t[1]-n*e[1]}function I(e,t,n){return e?t?n?k(e):T(e):n?S(e):v(e):null}function v(e){const t=e.coords;return{x:t[0],y:t[1]}}function w(e,t){return e.coords[0]=t.x,e.coords[1]=t.y,e}function T(e){const t=e.coords;return{x:t[0],y:t[1],z:t[2]}}function F(e,t){return e.coords[0]=t.x,e.coords[1]=t.y,e.coords[2]=t.z,e}function S(e){const t=e.coords;return{x:t[0],y:t[1],m:t[2]}}function M(e,t){return e.coords[0]=t.x,e.coords[1]=t.y,e.coords[2]=t.m,e}function k(e){const t=e.coords;return{x:t[0],y:t[1],z:t[2],m:t[3]}}function N(e,t){return e.coords[0]=t.x,e.coords[1]=t.y,e.coords[2]=t.z,e.coords[3]=t.m,e}function Z(e,t){return e&&t?N:e?F:t?M:w}function B(e,t,n,r,s){const i=Z(n,r);for(const n of t){const{geometry:t,attributes:r}=n;let a;t&&(a=i(new l.Z,t)),e.push(new o.Z(a,r,null,r[s]))}return e}function E(e,t,n){if(!e)return null;const r=u(t,n),s=[];for(let t=0;t<e.coords.length;t+=r){const n=[];for(let s=0;s<r;s++)n.push(e.coords[t+s]);s.push(n)}return t?n?{points:s,hasZ:t,hasM:n}:{points:s,hasZ:t}:n?{points:s,hasM:n}:{points:s}}function R(e,t,n,r,s){const i=u(n,r);for(const n of t){const t=n.geometry,r=n.attributes;let a;t&&(a=P(new l.Z,t,i)),e.push(new o.Z(a,r,null,r[s]))}return e}function P(e,t,n=u(t.hasZ,t.hasM)){e.lengths[0]=t.points.length;const r=e.coords;let s=0;for(const e of t.points)for(let t=0;t<n;t++)r[s++]=e[t];return e}function q(e,t,n){if(!e)return null;const r=u(t,n),{coords:s,lengths:i}=e,o=[];let a=0;for(const e of i){const t=[];for(let n=0;n<e;n++){const e=[];for(let t=0;t<r;t++)e.push(s[a++]);t.push(e)}o.push(t)}return t?n?{paths:o,hasZ:t,hasM:n}:{paths:o,hasZ:t}:n?{paths:o,hasM:n}:{paths:o}}function G(e,t,n,r,s){const i=u(n,r);for(const n of t){const t=n.geometry,r=n.attributes;let a;t&&(a=j(new l.Z,t,i)),e.push(new o.Z(a,r,null,r[s]))}return e}function j(e,t,n=u(t.hasZ,t.hasM)){const{lengths:r,coords:s}=e;let i=0;for(const e of t.paths){for(const t of e)for(let e=0;e<n;e++)s[i++]=t[e];r.push(e.length)}return e}function C(e,t,n){if(!e)return null;const r=u(t,n),{coords:s,lengths:i}=e,o=[];let a=0;for(const e of i){const t=[];for(let n=0;n<e;n++){const e=[];for(let t=0;t<r;t++)e.push(s[a++]);t.push(e)}o.push(t)}return t?n?{rings:o,hasZ:t,hasM:n}:{rings:o,hasZ:t}:n?{rings:o,hasM:n}:{rings:o}}function O(e,t,n,r,s){for(const i of t){const t=i.geometry,a=i.centroid,u=i.attributes;let c;t&&(c=Y(new l.Z,t,n,r)),a?e.push(new o.Z(c,u,w(new l.Z,a),u[s])):e.push(new o.Z(c,u,null,u[s]))}return e}function Y(e,t,n=t.hasZ,r=t.hasM){return V(e,t.rings,n,r),e}function V(e,t,n,r){const s=u(n,r),{lengths:i,coords:o}=e;let a=0;i.length=o.length=0;for(const e of t){for(const t of e)for(let e=0;e<s;e++)o[a++]=t[e];i.push(e.length)}return e}const X=[],D=[];function z(e,t,n,r,s){X[0]=e;const[i]=U(D,X,t,n,r,s);return X.length=D.length=0,i}function U(e,t,n,r,i,a){if(e.length=0,!n){for(const n of t){const t=n.attributes[a];e.push(new o.Z(null,n.attributes,null,t))}return e}switch(n){case"esriGeometryPoint":return B(e,t,r,i,a);case"esriGeometryMultipoint":return R(e,t,r,i,a);case"esriGeometryPolyline":return G(e,t,r,i,a);case"esriGeometryPolygon":return O(e,t,r,i,a);default:c.error("convertToFeatureSet:unknown-geometry",new s.Z(`Unable to parse unknown geometry type '${n}'`)),e.length=0}return e}function L(e,t,n,r,i,o){const a=e.length;switch(n){case"esriGeometryPoint":B(e,t,r,i,o);break;case"esriGeometryMultipoint":R(e,t,r,i,o);break;case"esriGeometryPolyline":G(e,t,r,i,o);break;case"esriGeometryPolygon":O(e,t,r,i,o);break;default:c.error("convertToFeatureSet:unknown-geometry",new s.Z(`Unable to parse unknown geometry type '${n}'`))}for(let r=0;r<t.length;r++)e[r+a].geometryType=n,e[r+a].insertAfter=t[r].insertAfter,e[r+a].groupId=t[r].groupId;return e}function A(e,t,n,r){D[0]=e,W(X,D,t,n,r);const s=X[0];return X.length=D.length=0,s}function J(e,t,n){if(!e)return null;const r=new l.Z;return"hasZ"in e&&null==t&&(t=e.hasZ),"hasM"in e&&null==n&&(n=e.hasM),(0,i.wp)(e)?Z(null!=t?t:null!=e.z,null!=n?n:null!=e.m)(r,e):(0,i.oU)(e)?Y(r,e,t,n):(0,i.l9)(e)?j(r,e,u(t,n)):(0,i.aW)(e)?P(r,e,u(t,n)):void c.error("convertFromGeometry:unknown-geometry",new s.Z(`Unable to parse unknown geometry type '${e}'`))}function Q(e,t,n,r){const i=e&&("coords"in e?e:e.geometry);if(!i)return null;switch(t){case"esriGeometryPoint":{let e=v;return n&&r?e=k:n?e=T:r&&(e=S),e(i)}case"esriGeometryMultipoint":return E(i,n,r);case"esriGeometryPolyline":return q(i,n,r);case"esriGeometryPolygon":return C(i,n,r);default:return void c.error("convertToGeometry:unknown-geometry",new s.Z(`Unable to parse unknown geometry type '${t}'`))}}function W(e,t,n,r,i){switch(e.length=0,n){case"esriGeometryPoint":return function(e,t,n,r){let s=v;n&&r?s=k:n?s=T:r&&(s=S);for(const n of t){const{geometry:t,attributes:r}=n,i=t?s(t):null;e.push({attributes:r,geometry:i})}return e}(e,t,r,i);case"esriGeometryMultipoint":return function(e,t,n,r){for(const s of t){const{geometry:t,attributes:i}=s;let o;t&&(o=E(t,n,r)),e.push({attributes:i,geometry:o})}return e}(e,t,r,i);case"esriGeometryPolyline":return function(e,t,n,r){for(const s of t){const{geometry:t,attributes:i}=s;let o;t&&(o=q(t,n,r)),e.push({attributes:i,geometry:o})}return e}(e,t,r,i);case"esriGeometryPolygon":return function(e,t,n,r){for(const s of t){const{geometry:t,attributes:i,centroid:o}=s;let a;if(t&&(a=C(t,n,r)),o){const t=v(o);e.push({attributes:i,centroid:t,geometry:a})}else e.push({attributes:i,geometry:a})}return e}(e,t,r,i);default:c.error("convertToFeatureSet:unknown-geometry",new s.Z(`Unable to parse unknown geometry type '${n}'`))}return e}function $(e){const{objectIdFieldName:t,spatialReference:n,transform:r,fields:s,hasM:i,hasZ:o,features:a,geometryType:l,exceededTransferLimit:u,uniqueIdField:c,queryGeometry:h,queryGeometryType:d}=e,f={features:W([],a,l,o,i),fields:s,geometryType:l,objectIdFieldName:t,spatialReference:n,uniqueIdField:c,queryGeometry:Q(h,d,!1,!1)};return r&&(f.transform=r),u&&(f.exceededTransferLimit=u),i&&(f.hasM=i),o&&(f.hasZ=o),f}function K(e,t){const n=new a.Z,{hasM:r,hasZ:i,features:o,objectIdFieldName:l,spatialReference:u,geometryType:h,exceededTransferLimit:d,transform:f,fields:p}=e;return p&&(n.fields=p),n.geometryType=h,n.objectIdFieldName=l||t,n.spatialReference=u,n.objectIdFieldName?(o&&U(n.features,o,h,i,r,n.objectIdFieldName),d&&(n.exceededTransferLimit=d),r&&(n.hasM=r),i&&(n.hasZ=i),f&&(n.transform=f),n):(c.error(new s.Z("optimized-features:invalid-objectIdFieldName","objectIdFieldName is missing")),n)}function H(e){const{transform:t,features:n,hasM:r,hasZ:s}=e;if(!t)return e;for(const e of n)e.geometry&&oe(e.geometry,e.geometry,r,s,t),e.centroid&&oe(e.centroid,e.centroid,r,s,t);return e.transform=null,e}function ee(e,t){const{geometryType:n,features:r,hasM:s,hasZ:i}=t;if(!e)return t;for(let t=0;t<r.length;t++){const o=r[t],a=o.weakClone();a.geometry=new l.Z,te(a.geometry,o.geometry,s,i,n,e),o.centroid&&(a.centroid=new l.Z,te(a.centroid,o.centroid,s,i,"esriGeometryPoint",e)),r[t]=a}return t.transform=e,t}function te(e,t,n,r,s,i,o=n,a=r){if(e.lengths.length&&(e.lengths.length=0),e.coords.length&&(e.coords.length=0),!t||!t.coords.length)return null;const l=h[s],{coords:c,lengths:d}=t,f=u(n,r),p=u(n&&o,r&&a),g=m(n,r,o,a);if(!d.length)return g(e.coords,c,0,0,y(i,c[0]),_(i,c[1])),e.lengths.length&&(e.lengths.length=0),e.coords.length=f,e;let b,x,I,v,w=0,T=0,F=T;for(const t of d){if(t<l)continue;let n=0;T=F,I=b=y(i,c[w]),v=x=_(i,c[w+1]),g(e.coords,c,T,w,I,v),n++,w+=f,T+=p;for(let r=1;r<t;r++,w+=f)I=y(i,c[w]),v=_(i,c[w+1]),I===b&&v===x||(g(e.coords,c,T,w,I-b,v-x),T+=p,n++,b=I,x=v);n>=l&&(e.lengths.push(n),F=T)}return e.coords.length=F,e.coords.length?e:null}function ne(e,t,n,r,s,i,o=n,a=r){if(e.lengths.length&&(e.lengths.length=0),e.coords.length&&(e.coords.length=0),!t||!t.coords.length)return null;const l=h[s],{coords:c,lengths:d}=t,f=u(n,r),p=u(n&&o,r&&a),g=m(n,r,o,a);if(!d.length)return g(e.coords,c,0,0,c[0],c[1]),e.lengths.length&&(e.lengths.length=0),e.coords.length=f,e;let y=0;const _=i*i;for(const t of d){if(t<l){y+=t*f;continue}const n=e.coords.length/p,r=y,s=y+(t-1)*f;g(e.coords,c,e.coords.length,r,c[r],c[r+1]),se(e.coords,c,f,_,g,r,s),g(e.coords,c,e.coords.length,s,c[s],c[s+1]);const i=e.coords.length/p-n;i>=l?e.lengths.push(i):e.coords.length=n*p,y+=t*f}return e.coords.length?e:null}function re(e,t,n,r){const s=e[t],i=e[t+1],o=e[n],a=e[n+1],l=e[r],u=e[r+1];let c=o,h=a,d=l-c,f=u-h;if(0!==d||0!==f){const e=((s-c)*d+(i-h)*f)/(d*d+f*f);e>1?(c=l,h=u):e>0&&(c+=d*e,h+=f*e)}return d=s-c,f=i-h,d*d+f*f}function se(e,t,n,r,s,i,o){let a,l=r,u=0;for(let e=i+n;e<o;e+=n)a=re(t,e,i,o),a>l&&(u=e,l=a);l>r&&(u-i>n&&se(e,t,n,r,s,i,u),s(e,t,e.length,u,t[u],t[u+1]),o-u>n&&se(e,t,n,r,s,u,o))}function ie(e,t,n,r){if(!t||!t.coords||!t.coords.length)return null;const s=u(n,r);let i=Number.POSITIVE_INFINITY,o=Number.POSITIVE_INFINITY,a=Number.NEGATIVE_INFINITY,l=Number.NEGATIVE_INFINITY;if(t&&t.coords){const e=t.coords;for(let t=0;t<e.length;t+=s){const n=e[t],r=e[t+1];i=Math.min(i,n),a=Math.max(a,n),o=Math.min(o,r),l=Math.max(l,r)}}return e[0]=i,e[1]=o,e[2]=a,e[3]=l,e}function oe(e,t,n,r,s){const{coords:i,lengths:o}=t,a=n?r?g:f:r?f:d,l=u(n,r);if(!i.length)return e!==t&&(e.lengths.length=0,e.coords.length=0),e;if(!o.length)return a(e.coords,i,0,0,b(s,i[0]),x(s,i[1])),e!==t&&(e.lengths.length=0,e.coords.length=l),e;const[c,h]=s.scale;let p=0;for(let t=0;t<o.length;t++){const n=o[t];e.lengths[t]=n;let r=b(s,i[p]),u=x(s,i[p+1]);a(e.coords,i,p,p,r,u),p+=l;for(let t=1;t<n;t++,p+=l)r+=i[p]*c,u-=i[p+1]*h,a(e.coords,i,p,p,r,u)}return e!==t&&(e.lengths.length=o.length,e.coords.length=i.length),e}function ae(e,t,n,r,s,i){const o=u(n,r),a=m(n,r,s,i),l=t.coords;e.coords.length=0,e.lengths.length=0,e.lengths.push(...t.lengths);for(let t=0;t<l.length;t+=o)a(e.coords,l,e.coords.length,t,l[t],l[t+1]);return e}function le(e,t,n,r){let s=0,i=e[r*t],o=e[r*(t+1)];for(let a=1;a<n;a++){const n=i+e[r*(t+a)],l=o+e[r*(t+a)+1],u=(n-i)*(l+o);i=n,o=l,s+=u}return.5*s}function ue(e,t){const{coords:n,lengths:r}=e;let s=0,i=0;for(let e=0;e<r.length;e++)i+=le(n,s,r[e],t),s+=e;return Math.abs(i)}function ce(e,t){const n=e.clone(),r=e.coords,s=e.lengths;let i=0;for(let e=0;e<s.length;e++){const o=s[e];let a=r[t*i],l=r[t*i+1];for(let e=1;e<o;e++){const s=a+r[t*(i+e)],o=l+r[t*(i+e)+1];n.coords[t*(i+e)]=s,n.coords[t*(i+e)+1]=o,a=s,l=o}i+=o}return n}},70834:(e,t,n)=>{"use strict";n.d(t,{Z:()=>m});var r,s=n(56140),i=(n(95830),n(36544),n(68055)),o=n(79881),a=n(56274),l=n(9870),u=n(30590),c=n(87566),h=(n(10923),n(57002),n(86035),n(58385)),d=n(6585),f=n(88210);const p=new a.Xn({binary:"binary",coordinate:"coordinate",countOrAmount:"count-or-amount",dateAndTime:"date-and-time",description:"description",locationOrPlaceName:"location-or-place-name",measurement:"measurement",nameOrTitle:"name-or-title",none:"none",orderedOrRanked:"ordered-or-ranked",percentageOrRatio:"percentage-or-ratio",typeOrCategory:"type-or-category",uniqueIdentifier:"unique-identifier"});let g=r=class extends h.wq{constructor(e){super(e),this.alias=null,this.defaultValue=void 0,this.description=null,this.domain=null,this.editable=!0,this.length=-1,this.name=null,this.nullable=!0,this.type=null,this.valueType=null}readDescription(e,{description:t}){let n;try{n=JSON.parse(t)}catch(e){}return n?n.value:null}readValueType(e,{description:t}){let n;try{n=JSON.parse(t)}catch(e){}return n?p.fromJSON(n.fieldValueType):null}clone(){return new r({alias:this.alias,defaultValue:this.defaultValue,description:this.description,domain:this.domain&&this.domain.clone()||null,editable:this.editable,length:this.length,name:this.name,nullable:this.nullable,type:this.type,valueType:this.valueType})}};(0,s._)([(0,o.Cb)({type:String,json:{write:!0}})],g.prototype,"alias",void 0),(0,s._)([(0,o.Cb)({type:[String,Number],json:{write:{allowNull:!0}}})],g.prototype,"defaultValue",void 0),(0,s._)([(0,o.Cb)()],g.prototype,"description",void 0),(0,s._)([(0,u.r)("description")],g.prototype,"readDescription",null),(0,s._)([(0,o.Cb)({types:d.V5,json:{read:{reader:d.im},write:!0}})],g.prototype,"domain",void 0),(0,s._)([(0,o.Cb)({type:Boolean,json:{write:!0}})],g.prototype,"editable",void 0),(0,s._)([(0,o.Cb)({type:i.z8,json:{write:!0}})],g.prototype,"length",void 0),(0,s._)([(0,o.Cb)({type:String,json:{write:!0}})],g.prototype,"name",void 0),(0,s._)([(0,o.Cb)({type:Boolean,json:{write:!0}})],g.prototype,"nullable",void 0),(0,s._)([(0,l.J)(f.v)],g.prototype,"type",void 0),(0,s._)([(0,o.Cb)()],g.prototype,"valueType",void 0),(0,s._)([(0,u.r)("valueType",["description"])],g.prototype,"readValueType",null),g=r=(0,s._)([(0,c.j)("esri.layers.support.Field")],g);const m=g},56602:(e,t,n)=>{"use strict";n.d(t,{Z:()=>_});var r,s=n(56140),i=(n(95830),n(82550)),o=(n(36544),n(68055),n(79881)),a=n(30590),l=n(87566),u=n(60538),c=(n(10923),n(57002),n(86035),n(58385)),h=n(98034),d=n(87864),f=n(40522);let p=r=class extends c.wq{constructor(e){super(e),this.respectsDaylightSaving=!1,this.timezone=null}readRespectsDaylightSaving(e,t){return void 0!==t.respectsDaylightSaving?t.respectsDaylightSaving:void 0!==t.respectDaylightSaving&&t.respectDaylightSaving}clone(){const{respectsDaylightSaving:e,timezone:t}=this;return new r({respectsDaylightSaving:e,timezone:t})}};(0,s._)([(0,o.Cb)({type:Boolean,json:{write:!0}})],p.prototype,"respectsDaylightSaving",void 0),(0,s._)([(0,a.r)("respectsDaylightSaving",["respectsDaylightSaving","respectDaylightSaving"])],p.prototype,"readRespectsDaylightSaving",null),(0,s._)([(0,o.Cb)({type:String,json:{read:{source:"timeZone"},write:{target:"timeZone"}}})],p.prototype,"timezone",void 0),p=r=(0,s._)([(0,l.j)("esri.layers.support.TimeReference")],p);const g=p;var m;let y=m=class extends c.wq{constructor(e){super(e),this.cumulative=!1,this.endField=null,this.fullTimeExtent=null,this.hasLiveData=!1,this.interval=null,this.startField=null,this.timeReference=null,this.trackIdField=null,this.useTime=!0}readFullTimeExtent(e,t){if(!t.timeExtent||!Array.isArray(t.timeExtent)||2!==t.timeExtent.length)return null;const n=new Date(t.timeExtent[0]),r=new Date(t.timeExtent[1]);return new d.Z({start:n,end:r})}writeFullTimeExtent(e,t){e&&e.start&&e.end?t.timeExtent=[e.start.getTime(),e.end.getTime()]:t.timeExtent=null}readInterval(e,t){return t.timeInterval&&t.timeIntervalUnits?new f.Z({value:t.timeInterval,unit:h.vU.fromJSON(t.timeIntervalUnits)}):t.defaultTimeInterval&&t.defaultTimeIntervalUnits?new f.Z({value:t.defaultTimeInterval,unit:h.vU.fromJSON(t.defaultTimeIntervalUnits)}):null}writeInterval(e,t){if(e){const n=e.toJSON();t.timeInterval=n.value,t.timeIntervalUnits=n.unit}else t.timeInterval=null,t.timeIntervalUnits=null}clone(){const{cumulative:e,endField:t,hasLiveData:n,interval:r,startField:s,timeReference:o,fullTimeExtent:a,trackIdField:l,useTime:u}=this;return new m({cumulative:e,endField:t,hasLiveData:n,interval:r,startField:s,timeReference:(0,i.d9)(o),fullTimeExtent:(0,i.d9)(a),trackIdField:l,useTime:u})}};(0,s._)([(0,o.Cb)({type:Boolean,json:{read:{source:"exportOptions.timeDataCumulative"},write:{target:"exportOptions.timeDataCumulative"}}})],y.prototype,"cumulative",void 0),(0,s._)([(0,o.Cb)({type:String,json:{read:{source:"endTimeField"},write:{target:"endTimeField",allowNull:!0}}})],y.prototype,"endField",void 0),(0,s._)([(0,o.Cb)({type:d.Z,json:{write:{enabled:!0,allowNull:!0}}})],y.prototype,"fullTimeExtent",void 0),(0,s._)([(0,a.r)("fullTimeExtent",["timeExtent"])],y.prototype,"readFullTimeExtent",null),(0,s._)([(0,u.c)("fullTimeExtent")],y.prototype,"writeFullTimeExtent",null),(0,s._)([(0,o.Cb)({type:Boolean,json:{write:!0}})],y.prototype,"hasLiveData",void 0),(0,s._)([(0,o.Cb)({type:f.Z,json:{write:{enabled:!0,allowNull:!0}}})],y.prototype,"interval",void 0),(0,s._)([(0,a.r)("interval",["timeInterval","timeIntervalUnits","defaultTimeInterval","defaultTimeIntervalUnits"])],y.prototype,"readInterval",null),(0,s._)([(0,u.c)("interval")],y.prototype,"writeInterval",null),(0,s._)([(0,o.Cb)({type:String,json:{read:{source:"startTimeField"},write:{target:"startTimeField",allowNull:!0}}})],y.prototype,"startField",void 0),(0,s._)([(0,o.Cb)({type:g,json:{write:{enabled:!0,allowNull:!0}}})],y.prototype,"timeReference",void 0),(0,s._)([(0,o.Cb)({type:String,json:{write:{enabled:!0,allowNull:!0}}})],y.prototype,"trackIdField",void 0),(0,s._)([(0,o.Cb)({type:Boolean,json:{read:{source:"exportOptions.useTime"},write:{target:"exportOptions.useTime"}}})],y.prototype,"useTime",void 0),y=m=(0,s._)([(0,l.j)("esri.layers.support.TimeInfo")],y);const _=y},88210:(e,t,n)=>{"use strict";n.d(t,{v:()=>r});const r=new(n(56274).Xn)({esriFieldTypeSmallInteger:"small-integer",esriFieldTypeInteger:"integer",esriFieldTypeSingle:"single",esriFieldTypeDouble:"double",esriFieldTypeLong:"long",esriFieldTypeString:"string",esriFieldTypeDate:"date",esriFieldTypeOID:"oid",esriFieldTypeGeometry:"geometry",esriFieldTypeBlob:"blob",esriFieldTypeRaster:"raster",esriFieldTypeGUID:"guid",esriFieldTypeGlobalID:"global-id",esriFieldTypeXML:"xml"})},42162:(e,t,n)=>{"use strict";n.d(t,{K9:()=>B,O7:()=>f,G$:()=>S});var r=n(59472),s=n(36544),i=n(32656),o=n(73127),a=n(90011),l=n(95157);const u=s.Z.getLogger("esri.tasks.operations.pbfFeatureServiceParser"),c=["esriFieldTypeSmallInteger","esriFieldTypeInteger","esriFieldTypeSingle","esriFieldTypeDouble","esriFieldTypeString","esriFieldTypeDate","esriFieldTypeOID","esriFieldTypeGeometry","esriFieldTypeBlob","esriFieldTypeRaster","esriFieldTypeGUID","esriFieldTypeGlobalID","esriFieldTypeXML"],h=["sqlTypeBigInt","sqlTypeBinary","sqlTypeBit","sqlTypeChar","sqlTypeDate","sqlTypeDecimal","sqlTypeDouble","sqlTypeFloat","sqlTypeGeometry","sqlTypeGUID","sqlTypeInteger","sqlTypeLongNVarchar","sqlTypeLongVarbinary","sqlTypeLongVarchar","sqlTypeNChar","sqlTypeNVarchar","sqlTypeOther","sqlTypeReal","sqlTypeSmallInt","sqlTypeSqlXml","sqlTypeTime","sqlTypeTimestamp","sqlTypeTimestamp2","sqlTypeTinyInt","sqlTypeVarbinary","sqlTypeVarchar"],d=["upperLeft","lowerLeft"];function f(e){return e>=c.length?null:c[e]}function p(e){return e>=h.length?null:h[e]}function g(e){return e>=d.length?null:d[e]}function m(e,t){return t>=e.geometryTypes.length?null:e.geometryTypes[t]}function y(e,t,n){const r=t.createPointGeometry(n);for(;e.next();)switch(e.tag()){case 3:{const n=e.getUInt32(),s=e.pos()+n;let i=0;for(;e.pos()<s;)t.addCoordinatePoint(r,e.getSInt64(),i++);break}case 1:case 2:default:e.skip()}return r}function _(e,t,n){const r=t.createGeometry(n),s=2+(n.hasZ?1:0)+(n.hasM?1:0);for(;e.next();)switch(e.tag()){case 2:{const n=e.getUInt32(),s=e.pos()+n;let i=0;for(;e.pos()<s;)t.addLength(r,e.getUInt32(),i++);break}case 3:{const n=e.getUInt32(),i=e.pos()+n;let o=0;for(;e.pos()<i;)t.addCoordinate(r,e.getSInt64(),o),o++,o===s&&(o=0);break}case 1:default:e.skip()}return r}function b(e){const t=new o.Z;let n="esriGeometryPoint";for(;e.next();)switch(e.tag()){case 2:{const n=e.getUInt32(),r=e.pos()+n;for(;e.pos()<r;)t.lengths.push(e.getUInt32());break}case 3:{const n=e.getUInt32(),r=e.pos()+n;for(;e.pos()<r;)t.coords.push(e.getSInt64());break}case 1:n=l.A[e.getEnum()];break;default:e.skip()}return{queryGeometry:t,queryGeometryType:n}}function x(e){for(;e.next();)switch(e.tag()){case 1:return e.getString();case 2:return e.getFloat();case 3:return e.getDouble();case 4:return e.getSInt32();case 5:return e.getUInt32();case 6:return e.getInt64();case 7:return e.getUInt64();case 8:return e.getSInt64();case 9:return e.getBool();default:return e.skip(),null}return null}function I(e){const t={type:f(0)};for(;e.next();)switch(e.tag()){case 1:t.name=e.getString();break;case 2:t.type=f(e.getEnum());break;case 3:t.alias=e.getString();break;case 4:t.sqlType=p(e.getEnum());break;case 5:try{t.domain=JSON.parse(e.getString())}catch(e){u.error(new i.Z("query:parsing-pbf","Failed to parse domain",{error:e})),t.domain=null}break;case 6:t.defaultValue=e.getString();break;default:e.skip()}return t}function v(e){const t={};for(;e.next();)switch(e.tag()){case 1:t.name=e.getString();break;case 2:t.isSystemMaintained=e.getBool();break;default:e.skip()}return t}function w(e,t,n,r){const s=t.createFeature(n);let i=0;for(;e.next();)switch(e.tag()){case 1:{const t=r[i++].name;s.attributes[t]=e.processMessage(x);break}case 2:s.geometry=e.processMessageWithArgs(_,t,n);break;case 4:s.centroid=e.processMessageWithArgs(y,t,n);break;default:e.skip()}return s}function T(e){const t=[1,1,1,1];for(;e.next();)switch(e.tag()){case 1:t[0]=e.getDouble();break;case 2:t[1]=e.getDouble();break;case 4:t[2]=e.getDouble();break;case 3:t[3]=e.getDouble();break;default:e.skip()}return t}function F(e){const t=[0,0,0,0];for(;e.next();)switch(e.tag()){case 1:t[0]=e.getDouble();break;case 2:t[1]=e.getDouble();break;case 4:t[2]=e.getDouble();break;case 3:t[3]=e.getDouble();break;default:e.skip()}return t}function S(e){const t={originPosition:g(0)};for(;e.next();)switch(e.tag()){case 1:t.originPosition=g(e.getEnum());break;case 2:t.scale=e.processMessage(T);break;case 3:t.translate=e.processMessage(F);break;default:e.skip()}return t}function M(e){const t={};for(;e.next();)switch(e.tag()){case 1:t.shapeAreaFieldName=e.getString();break;case 2:t.shapeLengthFieldName=e.getString();break;case 3:t.units=e.getString();break;default:e.skip()}return t}function k(e,t){const n=t.createSpatialReference();for(;e.next();)switch(e.tag()){case 1:n.wkid=e.getUInt32();break;case 5:n.wkt=e.getString();break;case 2:n.latestWkid=e.getUInt32();break;case 3:n.vcsWkid=e.getUInt32();break;case 4:n.latestVcsWkid=e.getUInt32();break;default:e.skip()}return n}function N(e,t){const n=t.createFeatureResult();n.geometryType=m(t,0);let r=!1;for(;e.next();)switch(e.tag()){case 1:n.objectIdFieldName=e.getString();break;case 3:n.globalIdFieldName=e.getString();break;case 4:n.geohashFieldName=e.getString();break;case 5:n.geometryProperties=e.processMessage(M);break;case 7:n.geometryType=m(t,e.getEnum());break;case 8:n.spatialReference=e.processMessageWithArgs(k,t);break;case 10:n.hasZ=e.getBool();break;case 11:n.hasM=e.getBool();break;case 12:n.transform=e.processMessage(S);break;case 9:{const t=e.getBool();n.exceededTransferLimit=t;break}case 13:t.addField(n,e.processMessage(I));break;case 15:r||(t.prepareFeatures(n),r=!0),t.addFeature(n,e.processMessageWithArgs(w,t,n,n.fields));break;case 2:n.uniqueIdField=e.processMessage(v);break;case 6:default:e.skip()}return t.finishFeatureResult(n),n}function Z(e,t){const n={};let s=null;for(;e.next();)switch(e.tag()){case 4:s=e.processMessageWithArgs(b);break;case 1:n.featureResult=e.processMessageWithArgs(N,t);break;case 2:case 3:default:e.skip()}return(0,r.pC)(s)&&n.featureResult&&t.addQueryGeometry(n,s),n}function B(e,t){try{const n=2,r=new a.Z(new Uint8Array(e),new DataView(e)),s={};for(;r.next();)switch(r.tag()){case n:s.queryResult=r.processMessageWithArgs(Z,t);break;default:r.skip()}return s}catch(e){throw new i.Z("query:parsing-pbf","Error while parsing FeatureSet PBF payload",{error:e})}}},95157:(e,t,n)=>{"use strict";n.d(t,{A:()=>l,J:()=>u});var r=n(27780),s=n(93533),i=n(44195),o=n(60151),a=n(73127);const l=["esriGeometryPoint","esriGeometryMultipoint","esriGeometryPolyline","esriGeometryPolygon"];class u{constructor(e){this.options=e,this.geometryTypes=l}createFeatureResult(){return new o.Z}prepareFeatures(){}finishFeatureResult(e){if(!e||!e.features||!e.hasZ||!this.options.sourceSpatialReference||!e.spatialReference||(0,r.fS)(e.spatialReference,this.options.sourceSpatialReference)||e.spatialReference.vcsWkid)return;const t=(0,s._R)(this.options.sourceSpatialReference)/(0,s._R)(e.spatialReference);if(1!==t)for(const n of e.features){if(!n.geometry||!n.geometry.coords)continue;const e=n.geometry.coords;for(let n=2;n<e.length;n+=3)e[n]*=t}}addFeature(e,t){e.features.push(t)}createFeature(){return new i.Z}createSpatialReference(){return{wkid:0}}createGeometry(){return new a.Z}addField(e,t){e.fields.push(t)}addCoordinate(e,t){e.coords.push(t)}addCoordinatePoint(e,t){e.coords.push(t)}addLength(e,t){e.lengths.push(t)}addQueryGeometry(e,t){e.queryGeometry=t.queryGeometry,e.queryGeometryType=t.queryGeometryType}createPointGeometry(){return new a.Z}}},91814:(e,t,n)=>{"use strict";n.d(t,{C:()=>s});var r=n(42162);function s(e,t){const n=(0,r.K9)(e,t),s=n.queryResult.featureResult,i=n.queryResult.queryGeometry,o=n.queryResult.queryGeometryType;if(s&&s.features&&s.features.length&&s.objectIdFieldName){const e=s.objectIdFieldName;for(const t of s.features)t.attributes&&(t.objectId=t.attributes[e])}return s&&(s.queryGeometry=i,s.queryGeometryType=o),s}},21561:(e,t,n)=>{"use strict";n.r(t),n.d(t,{executeQuery:()=>f,executeQueryForCount:()=>y,executeQueryForExtent:()=>_,executeQueryForIds:()=>m,executeQueryPBF:()=>p,executeQueryPBFBuffer:()=>g,queryToQueryStringParameters:()=>d,runQuery:()=>b});var r=n(59472),s=n(10923),i=n(56885),o=n(36654),a=n(91535),l=n(89867),u=n(91814),c=n(20892);const h="Layer does not support extent calculation.";function d(e,t){const n=e.geometry,s=e.toJSON(),o=s;if((0,r.pC)(n)&&(o.geometry=JSON.stringify(n),o.geometryType=(0,i.Ji)(n),o.inSR=n.spatialReference.wkid||JSON.stringify(n.spatialReference)),s.groupByFieldsForStatistics&&(o.groupByFieldsForStatistics=s.groupByFieldsForStatistics.join(",")),s.objectIds&&(o.objectIds=s.objectIds.join(",")),s.orderByFields&&(o.orderByFields=s.orderByFields.join(",")),!s.outFields||!s.returnDistinctValues&&(null!=t&&t.returnCountOnly||null!=t&&t.returnExtentOnly||null!=t&&t.returnIdsOnly)?delete o.outFields:-1!==s.outFields.indexOf("*")?o.outFields="*":o.outFields=s.outFields.join(","),s.outSR?o.outSR=s.outSR.wkid||JSON.stringify(s.outSR):n&&(s.returnGeometry||s.returnCentroid)&&(o.outSR=o.inSR),s.returnGeometry&&delete s.returnGeometry,s.outStatistics&&(o.outStatistics=JSON.stringify(s.outStatistics)),s.pixelSize&&(o.pixelSize=JSON.stringify(s.pixelSize)),s.quantizationParameters&&(o.quantizationParameters=JSON.stringify(s.quantizationParameters)),s.parameterValues&&(o.parameterValues=JSON.stringify(s.parameterValues)),s.rangeValues&&(o.rangeValues=JSON.stringify(s.rangeValues)),s.dynamicDataSource&&(o.layer=JSON.stringify({source:s.dynamicDataSource}),delete s.dynamicDataSource),s.timeExtent){const e=s.timeExtent,{start:t,end:n}=e;null==t&&null==n||(o.time=t===n?t:`${null==t?"null":t},${null==n?"null":n}`),delete s.timeExtent}return o}async function f(e,t,n,s){const i=(0,r.pC)(t.timeExtent)&&t.timeExtent.isEmpty?{data:{features:[]}}:await b(e,t,"json",s);return(0,l.p)(t,n,i.data),i}async function p(e,t,n,s){if((0,r.pC)(t.timeExtent)&&t.timeExtent.isEmpty)return Promise.resolve({data:n.createFeatureResult()});const i=await g(e,t,s),o=i;return o.data=(0,u.C)(i.data,n),o}function g(e,t,n){return b(e,t,"pbf",n)}function m(e,t,n){return(0,r.pC)(t.timeExtent)&&t.timeExtent.isEmpty?Promise.resolve({data:{objectIds:[]}}):b(e,t,"json",n,{returnIdsOnly:!0})}function y(e,t,n){return(0,r.pC)(t.timeExtent)&&t.timeExtent.isEmpty?Promise.resolve({data:{count:0}}):b(e,t,"json",n,{returnIdsOnly:!0,returnCountOnly:!0})}function _(e,t,n){return(0,r.pC)(t.timeExtent)&&t.timeExtent.isEmpty?Promise.resolve({data:{count:0,extent:null}}):b(e,t,"json",n,{returnExtentOnly:!0,returnCountOnly:!0}).then((e=>{const t=e.data;if(t.hasOwnProperty("extent"))return e;if(t.features)throw new Error(h);if(t.hasOwnProperty("count"))throw new Error(h);return e}))}function b(e,t,n,i={},l={}){const u="string"==typeof e?(0,s.mN)(e):e,h=t.geometry?[t.geometry]:[];return i.responseType="pbf"===n?"array-buffer":"json",(0,a.aX)(h,null,i).then((e=>{const a=e&&e[0];(0,r.pC)(a)&&((t=t.clone()).geometry=a);const h=(0,c.A)({...u.query,f:n,...l,...d(t,l)});return(0,o.default)((0,s.v_)(u.path,"query"),{...i,query:{...h,...i.query}})}))}},89867:(e,t,n)=>{"use strict";n.d(t,{p:()=>s});var r=n(72094);function s(e,t,n){if(!n||!n.features||!n.hasZ)return;const s=(0,r.k)(n.geometryType,t,e.outSpatialReference);if(s)for(const e of n.features)s(e.geometry)}},20892:(e,t,n)=>{"use strict";function r(e){const t={};for(const n in e){if("declaredClass"===n)continue;const s=e[n];if(null!=s&&"function"!=typeof s)if(Array.isArray(s)){t[n]=[];for(let e=0;e<s.length;e++)t[n][e]=r(s[e])}else"object"==typeof s?s.toJSON&&(t[n]=JSON.stringify(s)):t[n]=s}return t}n.d(t,{A:()=>r})},72094:(e,t,n)=>{"use strict";n.d(t,{k:()=>o,P:()=>l});var r=n(59472),s=n(27780),i=n(93533);function o(e,t,n){if((0,r.Wi)(t)||(0,r.Wi)(n)||n.vcsWkid||(0,s.fS)(t,n))return null;const o=(0,i._R)(t)/(0,i._R)(n);if(1===o)return null;switch(e){case"point":case"esriGeometryPoint":return e=>function(e,t){e&&null!=e.z&&(e.z*=t)}(e,o);case"polyline":case"esriGeometryPolyline":return e=>function(e,t){if(e)for(const n of e.paths)for(const e of n)e.length>2&&(e[2]*=t)}(e,o);case"polygon":case"esriGeometryPolygon":return e=>function(e,t){if(e)for(const n of e.rings)for(const e of n)e.length>2&&(e[2]*=t)}(e,o);case"multipoint":case"esriGeometryMultipoint":return e=>function(e,t){if(e)for(const n of e.points)n.length>2&&(n[2]*=t)}(e,o);default:return null}}function a(e,t,n){if(null==e.hasM||e.hasZ)for(const e of t)for(const t of e)t.length>2&&(t[2]*=n)}function l(e,t,n){if(!e&&!t||!n)return;const r=(0,i._R)(n);u(e,n,r),u(t,n,r)}function u(e,t,n){if(e)for(const r of e)c(r.geometry,t,n)}function c(e,t,n){if(!e||!e.spatialReference||(0,s.fS)(e.spatialReference,t))return;const r=(0,i._R)(e.spatialReference)/n;if(1!==r)if("x"in e)null!=e.z&&(e.z*=r);else if("rings"in e)a(e,e.rings,r);else if("paths"in e)a(e,e.paths,r);else if("points"in e&&(null==e.hasM||e.hasZ))for(const t of e.points)t.length>2&&(t[2]*=r)}},97951:(e,t,n)=>{"use strict";n.r(t),n.d(t,{FeatureServiceSnappingSourceWorker:()=>T,default:()=>F});var r=n(59472),s=n(39105),i=n(73032),o=n(80621),a=n(56602),l=n(31518),u=n(77142),c=n(21895),h=n(56140),d=(n(95830),n(36544)),f=(n(68055),n(79881)),p=n(87566),g=(n(10923),n(57002),n(86035),n(9419)),m=n(82677),y=n(59691),_=n(31036),b=n(57360),x=n(95157),I=n(21561);const v=d.Z.getLogger("esri.views.interactive.snapping.featureSources.FeatureFetcher");let w=class extends m.default{constructor(e){super(e),this.loading=!1,this.loadTask=null,this.handles=new y.Z}set filter(e){const t=this._get("filter");JSON.stringify(this.filterProperties(t))!==JSON.stringify(this.filterProperties(e))&&this._set("filter",e)}set customParameters(e){const t=this._get("customParameters");JSON.stringify(t)!==JSON.stringify(e)&&this._set("customParameters",e)}initialize(){this.handles.add((0,g.A8)((()=>({query:new l.Z(this.filterProperties(this.filter)),customParameters:this.customParameters})),(e=>this.load(e))))}destroy(){this.handles.destroy(),this.abort()}abort(){(0,r.pC)(this.loadTask)&&(this.loadTask.abort(),this.loadTask=null)}load({query:e,customParameters:t}){this.abort(),this._set("loading",!0),e.outSpatialReference=this.spatialReference,e.returnGeometry=!0,e.outFields=[this.objectIdField],e.quantizationParameters=new b.Z({mode:"edit"}),this.loadTask=(0,s.createTask)((async n=>{const{features:r}=await this.executeQuery(e,t,n);this.featureStore.clear(),this.featureStore.addMany(r)}));const n=()=>{((0,r.Wi)(this.loadTask)||this.loadTask.finished)&&this._set("loading",!1)};this.loadTask.promise.then(n,(e=>{(0,s.isAbortError)(e)||v.error("snapping-feature-fetcher","Failed to fetch features for snapping",e),n()}))}async executeQuery(e,t,n){return this.capabilities.query.supportsFormatPBF?this.executeQueryPBF(e,t,n):this.executeQueryJSON(e,t,n)}async executeQueryPBF(e,t,n){const{sourceSpatialReference:r}=this,{data:s}=await(0,I.executeQueryPBF)(this.url,e,new x.J({sourceSpatialReference:r}),{query:t,signal:n});return(0,_.lM)(s)}async executeQueryJSON(e,t,n){const{sourceSpatialReference:r}=this,{data:s}=await(0,I.executeQuery)(this.url,e,r,{query:t,signal:n});return(0,_.h_)(s,this.objectIdField)}filterProperties(e){return(0,r.Wi)(e)?{where:"1=1",geometry:void 0,distance:void 0,gdbVersion:void 0,timeExtent:void 0,spatialRelationship:void 0}:{where:e.where||"1=1",geometry:e.geometry,distance:e.distance,timeExtent:e.timeExtent,spatialRelationship:e.spatialRelationship,gdbVersion:e.gdbVersion}}};(0,h._)([(0,f.Cb)({constructOnly:!0})],w.prototype,"url",void 0),(0,h._)([(0,f.Cb)({constructOnly:!0})],w.prototype,"objectIdField",void 0),(0,h._)([(0,f.Cb)({constructOnly:!0})],w.prototype,"capabilities",void 0),(0,h._)([(0,f.Cb)({constructOnly:!0})],w.prototype,"sourceSpatialReference",void 0),(0,h._)([(0,f.Cb)({constructOnly:!0})],w.prototype,"spatialReference",void 0),(0,h._)([(0,f.Cb)({constructOnly:!0})],w.prototype,"featureStore",void 0),(0,h._)([(0,f.Cb)({readOnly:!0})],w.prototype,"loading",void 0),(0,h._)([(0,f.Cb)()],w.prototype,"filter",null),(0,h._)([(0,f.Cb)()],w.prototype,"customParameters",null),w=(0,h._)([(0,p.j)("esri.views.interactive.snapping.sources.FeatureFetcher")],w);class T{constructor(){this.initialized=(0,s.createDeferred)()}destroy(){this.featureFetcher.destroy(),this.queryEngine.destroy()}async initialize(e){const{geometryType:t,hasZ:n,hasM:r,objectIdField:s,timeInfo:o,fields:l}=e.serviceInfo;return this.featureStore=new u.Z(e.serviceInfo),this.queryEngine=new c.Z({spatialReference:e.spatialReference,featureStore:this.featureStore,geometryType:t,fields:l,hasZ:n,hasM:r,objectIdField:s,timeInfo:o?a.Z.fromJSON(o):null}),this.featureFetcher=new w({featureStore:this.featureStore,url:e.serviceInfo.url,objectIdField:e.serviceInfo.objectIdField,capabilities:e.serviceInfo.capabilities,spatialReference:i.Z.fromJSON(e.spatialReference),sourceSpatialReference:i.Z.fromJSON(e.serviceInfo.spatialReference)}),this.initialized.resolve(),this.configure(e.configuration)}async configure(e){return await this.initialized.promise,this.updateFeatureFetcherConfiguration(e),{result:{}}}async fetchCandidates(e,t){return await this.initialized.promise,(0,s.throwIfAborted)(t),{result:await this.queryEngine.executeQueryForSnapping({point:e.point,distance:e.distance,types:e.types,query:(0,r.pC)(e.filter)?e.filter:{where:"1=1"}},(0,r.pC)(t)?t.signal:null)}}async whenLoaded(e){return await this.initialized.promise,await(0,o.whenNotOnce)(this.featureFetcher,"loading"),{result:{}}}updateFeatureFetcherConfiguration(e){this.featureFetcher.filter=(0,r.pC)(e.filter)?l.Z.fromJSON(e.filter):null,this.featureFetcher.customParameters=e.customParameters}}const F=function(){return new T}}}]);
//# sourceMappingURL=7995.js.map