(self.webpackChunkimaps=self.webpackChunkimaps||[]).push([[9869],{67565:(e,t,i)=>{"use strict";i.r(t),i.d(t,{default:()=>m});var r=i(56140),n=(i(95830),i(36544),i(68055),i(79881)),o=i(51894),a=i(87566),s=(i(10923),i(57002),i(86035),i(39105)),l=(i(40450),i(9200)),c=i(90846),u=i(19401),d=i(90806),f=i(82677),p=i(93533),v=i(65867);let h=class extends f.default{constructor(e){super(e),this.activeTool=null,this.activeViewModel=null,this.view=null}get areaUnit(){return this.defaultUnit}set areaUnit(e){void 0!==e?this._override("areaUnit",e):this._clearOverride("areaUnit")}get linearUnit(){return this.defaultUnit}set linearUnit(e){void 0!==e?this._override("linearUnit",e):this._clearOverride("linearUnit")}get state(){const{activeViewModel:e}=this;return e?e.state:"disabled"}};(0,r._)([(0,n.Cb)({type:["area","distance","direct-line"]})],h.prototype,"activeTool",void 0),(0,r._)([(0,n.Cb)()],h.prototype,"activeViewModel",void 0),(0,r._)([(0,n.Cb)({type:p.fN,dependsOn:["defaultUnit"]})],h.prototype,"areaUnit",null),(0,r._)([(0,n.Cb)(v.Y)],h.prototype,"defaultUnit",void 0),(0,r._)([(0,n.Cb)({type:p.oD,dependsOn:["defaultUnit"]})],h.prototype,"linearUnit",null),(0,r._)([(0,n.Cb)({dependsOn:["activeViewModel","activeViewModel.state"],readOnly:!0})],h.prototype,"state",null),(0,r._)([(0,n.Cb)()],h.prototype,"view",void 0),h=(0,r._)([(0,a.j)("esri.widgets.Measurement.MeasurementViewModel")],h);const y=h;let w=class extends d.default{constructor(e,t){super(e,t),this._widgets=new Map,this.activeTool=null,this.activeWidget=null,this.areaUnit=null,this.iconClass="esri-icon-measure",this.label=void 0,this.linearUnit=null,this.messages=null,this.view=null,this.viewModel=new y}initialize(){this.activeWidget&&this.viewModel.set("activeViewModel",this.activeWidget.viewModel),this.view&&this.activeTool&&this._getActiveWidget().then((e=>{this._set("activeWidget",e)})),this.own([this.watch(["view","activeTool"],(()=>{this._getActiveWidget().then((e=>{this._set("activeWidget",e)}))})),this.watch("activeWidget",((e,t)=>{this.viewModel.set("activeViewModel",e?e.viewModel:null),t&&(t.visible=!1)})),this.watch(["areaUnit","linearUnit"],(()=>this._updateWidgetUnits()))])}destroy(){this._destroyWidgets()}render(){const{activeWidget:e}=this,t=e&&!e.destroyed?e.render():null;return(0,u.j)("div",{class:"esri-measurement"},t)}clear(){this.activeTool=null,this._destroyWidgets()}startMeasurement(){const{activeViewModel:e}=this.viewModel;e&&(0,s.ignoreAbortErrors)(e.start())}async _createWidget(e){const{areaUnit:t,linearUnit:r,view:n}=this;switch(e){case"area":{const{type:e}=n;switch(e){case"2d":return new(0,(await Promise.all([i.e(8696),i.e(6563),i.e(1518),i.e(8157),i.e(7333),i.e(2551),i.e(5988),i.e(6814),i.e(5798),i.e(5666),i.e(530),i.e(6205),i.e(1731),i.e(5062),i.e(2412),i.e(7551),i.e(9647),i.e(1394)]).then(i.bind(i,95550))).default)({view:n,unit:t});case"3d":return new(0,(await Promise.all([i.e(8696),i.e(6563),i.e(1518),i.e(8157),i.e(7333),i.e(2551),i.e(5988),i.e(6814),i.e(5798),i.e(5666),i.e(530),i.e(6205),i.e(1731),i.e(5062),i.e(8291),i.e(7025),i.e(7483)]).then(i.bind(i,17483))).default)({view:n,unit:t});default:return null}}case"distance":return new(0,(await Promise.all([i.e(8696),i.e(6563),i.e(1518),i.e(8157),i.e(7333),i.e(2551),i.e(5988),i.e(6814),i.e(5798),i.e(5666),i.e(530),i.e(6205),i.e(1731),i.e(5062),i.e(2412),i.e(7551),i.e(9647),i.e(2209)]).then(i.bind(i,51067))).default)({view:n,unit:r});case"direct-line":return new(0,(await Promise.all([i.e(8696),i.e(6563),i.e(1518),i.e(8157),i.e(7333),i.e(2551),i.e(5988),i.e(6814),i.e(5798),i.e(5666),i.e(530),i.e(6205),i.e(1731),i.e(5062),i.e(2412),i.e(8291),i.e(5736),i.e(7025),i.e(2793)]).then(i.bind(i,32793))).default)({view:n,unit:r});default:return null}}_destroyWidgets(){this._widgets.forEach((e=>e.destroy())),this._widgets.clear()}async _getActiveWidget(){const{activeTool:e,view:t}=this;if(!t||!e)return null;let i=null;if(this._widgets.has(e))i=this._widgets.get(e),i.visible=!0;else{if(i=await this._createWidget(e),!i)return null;await i.viewModel.start(),this._widgets.set(e,i)}return i}_updateWidgetUnits(){this._widgets.forEach((e=>{const{areaUnit:t,linearUnit:i}=this;e.unit=function(e){return e&&("esri.widgets.AreaMeasurement2D"===e.declaredClass||"esri.widgets.AreaMeasurement3D"===e.declaredClass)}(e)?t:i}))}};(0,r._)([(0,o.B)("viewModel.activeTool")],w.prototype,"activeTool",void 0),(0,r._)([(0,n.Cb)({readOnly:!0}),(0,c.G)()],w.prototype,"activeWidget",void 0),(0,r._)([(0,o.B)("viewModel.areaUnit")],w.prototype,"areaUnit",void 0),(0,r._)([(0,n.Cb)()],w.prototype,"iconClass",void 0),(0,r._)([(0,n.Cb)({aliasOf:{source:"messages.widgetLabel",overridable:!0}})],w.prototype,"label",void 0),(0,r._)([(0,o.B)("viewModel.linearUnit")],w.prototype,"linearUnit",void 0),(0,r._)([(0,n.Cb)(),(0,c.G)(),(0,l.H)("esri/widgets/Measurement/t9n/Measurement")],w.prototype,"messages",void 0),(0,r._)([(0,o.B)("viewModel.view"),(0,c.G)()],w.prototype,"view",void 0),(0,r._)([(0,n.Cb)({type:y}),(0,c.G)(["viewModel.state"])],w.prototype,"viewModel",void 0),w=(0,r._)([(0,a.j)("esri.widgets.Measurement")],w);const m=w},65867:(e,t,i)=>{"use strict";i.d(t,{Y:()=>n});var r=i(93533);const n={dependsOn:["view.map.portalItem?.portal.units","view.map.portalItem?.portal.user.units","view.spatialReference"],readOnly:!0,get(){const e="metric",{view:t}=this;if(!t)return e;const i=t.get("map.portalItem.portal");if(i)switch(i.get("user.units")||i.units){case e:return e;case"english":return"imperial"}return(0,r.yT)(t.spatialReference)||e}}},99218:function(e,t,i){"use strict";function r(e,t){for(var i=0;i<t.length;i++){var r=t[i];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function n(e,t){return(n=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function o(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var i,r=s(e);if(t){var n=s(this).constructor;i=Reflect.construct(r,arguments,n)}else i=r.apply(this,arguments);return a(this,i)}}function a(e,t){return!t||"object"!==l(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function s(e){return(s=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function l(e){return(l="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}var c=this&&this.__decorate||function(e,t,i,r){var n,o=arguments.length,a=o<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,i):r;if("object"===("undefined"==typeof Reflect?"undefined":l(Reflect))&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,i,r);else for(var s=e.length-1;s>=0;s--)(n=e[s])&&(a=(o<3?n(a):o>3?n(t,i,a):n(t,i))||a);return o>3&&a&&Object.defineProperty(t,i,a),a},u=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});var d=i(83781),f=i(73502),p=u(i(90806)),v=u(i(92896));i(20332);var h="esri-widget measure-base",y=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&n(e,t)}(l,e);var t,i,a,s=o(l);function l(e){var t;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,l),(t=s.call(this,e)).viewModel=new v.default,t._measureCreated=function(){t.measurement&&(t.measurement.container="measureWidget")},t}return t=l,(i=[{key:"render",value:function(){var e=this;return document.querySelectorAll("#measureDiv calcite-radio-group-item").forEach((function(t){null==t||t.addEventListener("calciteRadioGroupItemChange",(function(t){var i,r;t.target.hasAttribute("checked")||("clear"===(null===(i=t.target)||void 0===i?void 0:i.title)?e.measurement.clear():e.measurement.activeTool=null===(r=t.target)||void 0===r?void 0:r.title)}),{passive:!0})})),f.tsx("div",{class:h},f.tsx("calcite-radio-group",{width:"full"},f.tsx("calcite-radio-group-item",{title:"distance",value:"distance",id:"distanceItem",icon:"measure"},"Distance"),f.tsx("calcite-radio-group-item",{title:"area",value:"area",id:"areaItem",icon:"measure-area"},"Area"),f.tsx("calcite-radio-group-item",{title:"clear",value:"clear",id:"clearItem",icon:"trash"},"Clear")),f.tsx("div",{afterCreate:this._measureCreated,id:"measureWidget"}))}}])&&r(t.prototype,i),a&&r(t,a),l}(p.default);c([d.aliasOf("viewModel.view")],y.prototype,"view",void 0),c([d.aliasOf("viewModel.measurement")],y.prototype,"measurement",void 0),c([d.property({type:v.default}),f.renderable()],y.prototype,"viewModel",void 0),y=c([d.subclass("app.widgets.Measure")],y),t.default=y},92896:function(e,t,i){"use strict";function r(e,t){for(var i=0;i<t.length;i++){var r=t[i];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function n(e,t){return(n=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function o(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var i,r=l(e);if(t){var n=l(this).constructor;i=Reflect.construct(r,arguments,n)}else i=r.apply(this,arguments);return a(this,i)}}function a(e,t){return!t||"object"!==c(t)&&"function"!=typeof t?s(e):t}function s(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function l(e){return(l=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function c(e){return(c="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}var u=this&&this.__decorate||function(e,t,i,r){var n,o=arguments.length,a=o<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,i):r;if("object"===("undefined"==typeof Reflect?"undefined":c(Reflect))&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,i,r);else for(var s=e.length-1;s>=0;s--)(n=e[s])&&(a=(o<3?n(a):o>3?n(t,i,a):n(t,i))||a);return o>3&&a&&Object.defineProperty(t,i,a),a},d=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});var f=d(i(82677)),p=i(83781),v=i(80621),h=d(i(67565)),y=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&n(e,t)}(c,e);var t,i,a,l=o(c);function c(e){var t;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,c),t=l.call(this,e),v.whenDefinedOnce(s(t),"view",t.init.bind(s(t))),t}return t=c,(i=[{key:"init",value:function(e){this.measurement=new h.default({view:e,areaUnit:"square-feet",linearUnit:"feet"}),this.measurement.watch("activeTool",(function(e){e||document.querySelectorAll(".measure-base calcite-radio-group-item").forEach((function(e){"clear"===e.value?e.setAttribute("checked",""):e.removeAttribute("checked")}))}))}}])&&r(t.prototype,i),a&&r(t,a),c}(f.default);u([p.property()],y.prototype,"view",void 0),y=u([p.subclass("app.widgets.Measure.MeasureViewModel")],y),t.default=y},98090:(e,t,i)=>{"use strict";i.d(t,{Z:()=>s});var r=i(94015),n=i.n(r),o=i(23645),a=i.n(o)()(n());a.push([e.id,".measure-base{padding:0}","",{version:3,sources:["webpack://./src/widgets/Measure/styles/Measure.scss"],names:[],mappings:"AAAA,cACE,SAAA",sourcesContent:[".measure-base {\n  padding: 0;\n}"],sourceRoot:""}]);const s=a},20332:(e,t,i)=>{"use strict";i.r(t),i.d(t,{default:()=>s});var r=i(93379),n=i.n(r),o=i(98090),a={insert:"head",singleton:!1};n()(o.Z,a);const s=o.Z.locals||{}}},0,[[20332,3666,7383,3533],[99218,3666,7383,3533],[92896,3666,7383,3533]]]);
//# sourceMappingURL=measure.js.map