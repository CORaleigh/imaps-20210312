(self.webpackChunkimaps=self.webpackChunkimaps||[]).push([[6814],{69065:(e,t,r)=>{"use strict";function n(e,t,r,n){let i=null,s=1e3;"number"==typeof t?(s=t,n=r):(i=null!=t?t:null,s=r);let o,a=0;const l=()=>{a=0,e.apply(n,o)},c=(...e)=>{i&&i.apply(n,e),o=e,s?a||(a=setTimeout(l,s)):l()};return c.remove=()=>{a&&(clearTimeout(a),a=0)},c.forceUpdate=()=>{a&&(clearTimeout(a),l())},c.hasPendingUpdates=()=>!!a,c}r.d(t,{P:()=>n})},56888:(e,t,r)=>{"use strict";r.d(t,{Bs:()=>p,VG:()=>a,sS:()=>g,yc:()=>f,Ud:()=>d,Zv:()=>u,ld:()=>h,Rd:()=>l,Wv:()=>c});var n=r(88263),i=r(17427),s=r(33655),o=r(93533);function a(e,t,r,n=2,s="abbr"){return`${(0,i.uf)(t,{minimumFractionDigits:n,maximumFractionDigits:n})} ${function(e,t,r){return e.units[t][r]}(e,r,s)}`}function l(e,t,r,n=2,i="abbr"){const s=(0,o.KU)(t,r);return a(e,(0,o.En)(t,r,s),s,n,i)}function c(e,t,r,n=2,i="abbr"){const s=(0,o.OG)(t,r);return a(e,(0,o.En)(t,r,s),s,n,i)}function d(e,t,r,n=2,i="abbr"){const s=(0,o.FN)(t,r);return a(e,(0,o.En)(t,r,s),s,n,i)}function u(e,t,r,n=2,i="abbr"){const s=(0,o.qv)(t,r);return a(e,(0,o.En)(t,r,s),s,n,i)}function h(e,t,r,n=2,i="abbr"){const s=(0,o.tQ)(t,r);return a(e,(0,o.En)(t,r,s),s,n,i)}function f(e,t,r,n=2,i="abbr"){const s=(0,o.Yl)(t,r);return a(e,(0,o.En)(t,r,s),s,n,i)}function p(e,t,r=2){let n=(0,o.En)(e,t,"degrees"),i=n-Math.floor(n);n-=i,i*=60;let s=i-Math.floor(i);return i-=s,s*=60,`${n.toFixed()}Â° ${i.toFixed()}' ${s.toFixed(r)}"`}const m=["B","kB","MB","GB","TB"];function g(e,t){let r=0===t?0:Math.floor(Math.log(t)/Math.log(1024));r=(0,s.uZ)(r,0,m.length-1);const o=(0,i.uf)(t/Math.pow(1024,r),{maximumFractionDigits:2});return(0,n.gx)(e.units.bytes[m[r]],{fileSize:o})}},44195:(e,t,r)=>{"use strict";r.d(t,{Z:()=>i});class n{constructor(e=null,t={},r,n){this.displayId=0,this.geohashIndexed=!1,this.geohashX=0,this.geohashY=0,this.geometry=e,t&&(this.attributes=t),r&&(this.centroid=r),null!=n&&(this.objectId=n)}get hasGeometry(){return!(!this.geometry||!this.geometry.coords||!this.geometry.coords.length)}weakClone(){const e=new n(this.geometry,this.attributes,this.centroid,this.objectId);return e.displayId=this.displayId,e.geohashIndexed=this.geohashIndexed,e.geohashX=this.geohashX,e.geohashY=this.geohashY,e}}const i=n},60151:(e,t,r)=>{"use strict";r.d(t,{Z:()=>i});class n{constructor(){this.objectIdFieldName=null,this.globalIdFieldName=null,this.geohashFieldName=null,this.geometryProperties=null,this.geometryType=null,this.spatialReference=null,this.hasZ=!1,this.hasM=!1,this.features=[],this.fields=[],this.transform=null,this.exceededTransferLimit=!1,this.uniqueIdField=null,this.queryGeometryType=null,this.queryGeometry=null}weakClone(){const e=new n;return e.objectIdFieldName=this.objectIdFieldName,e.globalIdFieldName=this.globalIdFieldName,e.geohashFieldName=this.geohashFieldName,e.geometryProperties=this.geometryProperties,e.geometryType=this.geometryType,e.spatialReference=this.spatialReference,e.hasZ=this.hasZ,e.hasM=this.hasM,e.features=this.features,e.fields=this.fields,e.transform=this.transform,e.exceededTransferLimit=this.exceededTransferLimit,e.uniqueIdField=this.uniqueIdField,e.queryGeometry=this.queryGeometry,e.queryGeometryType=this.queryGeometryType,e}}const i=n},73127:(e,t,r)=>{"use strict";r.d(t,{Z:()=>i});class n{constructor(e=[],t=[],r=!1){this.lengths=null!=e?e:[],this.coords=null!=t?t:[],this.hasIndeterminateRingOrder=r}get isPoint(){return 0===this.lengths.length}forEachVertex(e){let t=0;this.lengths.length||e(this.coords[0],this.coords[1]);for(let r=0;r<this.lengths.length;r++){const n=this.lengths[r];for(let r=0;r<n;r++)e(this.coords[2*(r+t)],this.coords[2*(r+t)+1]);t+=n}}clone(){return new n(this.lengths.slice(),this.coords.slice(),this.hasIndeterminateRingOrder)}}const i=n},31036:(e,t,r)=>{"use strict";r.d(t,{XA:()=>V,h_:()=>Q,Yn:()=>U,GH:()=>H,E7:()=>D,ks:()=>q,Uy:()=>G,u0:()=>P,EI:()=>W,cn:()=>K,di:()=>Y,Iv:()=>E,fQ:()=>w,eG:()=>S,J6:()=>$,oB:()=>ce,zj:()=>te,$:()=>ie,lz:()=>le,RZ:()=>J,Nh:()=>ee,Jd:()=>y,IN:()=>b,hY:()=>oe,$g:()=>se});var n=r(36544),i=r(32656),s=r(56885),o=r(44195),a=r(60151),l=r(73127);function c(e,t){return e?t?4:3:t?3:2}const d=n.Z.getLogger("esri.tasks.support.optimizedFeatureSet"),u={esriGeometryPoint:0,esriGeometryPolyline:2,esriGeometryPolygon:3,esriGeometryMultipoint:0},h=(e,t,r,n,i,s)=>{e[r]=i,e[r+1]=s},f=(e,t,r,n,i,s)=>{e[r]=i,e[r+1]=s,e[r+2]=t[n+2]},p=(e,t,r,n,i,s)=>{e[r]=i,e[r+1]=s,e[r+2]=t[n+3]},m=(e,t,r,n,i,s)=>{e[r]=i,e[r+1]=s,e[r+2]=t[n+2],e[r+3]=t[n+3]};function g(e,t,r,n){if(e){if(r)return t&&n?m:f;if(t&&n)return p}else if(t&&n)return f;return h}function y({scale:e,translate:t},r){return Math.round((r-t[0])/e[0])}function b({scale:e,translate:t},r){return Math.round((t[1]-r)/e[1])}function v({scale:e,translate:t},r){return r*e[0]+t[0]}function _({scale:e,translate:t},r){return t[1]-r*e[1]}function w(e,t,r){return e?t?r?x(e):C(e):r?F(e):I(e):null}function I(e){const t=e.coords;return{x:t[0],y:t[1]}}function M(e,t){return e.coords[0]=t.x,e.coords[1]=t.y,e}function C(e){const t=e.coords;return{x:t[0],y:t[1],z:t[2]}}function A(e,t){return e.coords[0]=t.x,e.coords[1]=t.y,e.coords[2]=t.z,e}function F(e){const t=e.coords;return{x:t[0],y:t[1],m:t[2]}}function T(e,t){return e.coords[0]=t.x,e.coords[1]=t.y,e.coords[2]=t.m,e}function x(e){const t=e.coords;return{x:t[0],y:t[1],z:t[2],m:t[3]}}function j(e,t){return e.coords[0]=t.x,e.coords[1]=t.y,e.coords[2]=t.z,e.coords[3]=t.m,e}function k(e,t){return e&&t?j:e?A:t?T:M}function Z(e,t,r,n,i){const s=k(r,n);for(const r of t){const{geometry:t,attributes:n}=r;let a;t&&(a=s(new l.Z,t)),e.push(new o.Z(a,n,null,n[i]))}return e}function E(e,t,r){if(!e)return null;const n=c(t,r),i=[];for(let t=0;t<e.coords.length;t+=n){const r=[];for(let i=0;i<n;i++)r.push(e.coords[t+i]);i.push(r)}return t?r?{points:i,hasZ:t,hasM:r}:{points:i,hasZ:t}:r?{points:i,hasM:r}:{points:i}}function L(e,t,r,n,i){const s=c(r,n);for(const r of t){const t=r.geometry,n=r.attributes;let a;t&&(a=N(new l.Z,t,s)),e.push(new o.Z(a,n,null,n[i]))}return e}function N(e,t,r=c(t.hasZ,t.hasM)){e.lengths[0]=t.points.length;const n=e.coords;let i=0;for(const e of t.points)for(let t=0;t<r;t++)n[i++]=e[t];return e}function $(e,t,r){if(!e)return null;const n=c(t,r),{coords:i,lengths:s}=e,o=[];let a=0;for(const e of s){const t=[];for(let r=0;r<e;r++){const e=[];for(let t=0;t<n;t++)e.push(i[a++]);t.push(e)}o.push(t)}return t?r?{paths:o,hasZ:t,hasM:r}:{paths:o,hasZ:t}:r?{paths:o,hasM:r}:{paths:o}}function R(e,t,r,n,i){const s=c(r,n);for(const r of t){const t=r.geometry,n=r.attributes;let a;t&&(a=P(new l.Z,t,s)),e.push(new o.Z(a,n,null,n[i]))}return e}function P(e,t,r=c(t.hasZ,t.hasM)){const{lengths:n,coords:i}=e;let s=0;for(const e of t.paths){for(const t of e)for(let e=0;e<r;e++)i[s++]=t[e];n.push(e.length)}return e}function S(e,t,r){if(!e)return null;const n=c(t,r),{coords:i,lengths:s}=e,o=[];let a=0;for(const e of s){const t=[];for(let r=0;r<e;r++){const e=[];for(let t=0;t<n;t++)e.push(i[a++]);t.push(e)}o.push(t)}return t?r?{rings:o,hasZ:t,hasM:r}:{rings:o,hasZ:t}:r?{rings:o,hasM:r}:{rings:o}}function O(e,t,r,n,i){for(const s of t){const t=s.geometry,a=s.centroid,c=s.attributes;let d;t&&(d=G(new l.Z,t,r,n)),a?e.push(new o.Z(d,c,M(new l.Z,a),c[i])):e.push(new o.Z(d,c,null,c[i]))}return e}function G(e,t,r=t.hasZ,n=t.hasM){return q(e,t.rings,r,n),e}function q(e,t,r,n){const i=c(r,n),{lengths:s,coords:o}=e;let a=0;s.length=o.length=0;for(const e of t){for(const t of e)for(let e=0;e<i;e++)o[a++]=t[e];s.push(e.length)}return e}const z=[],B=[];function V(e,t,r,n,i){z[0]=e;const[s]=U(B,z,t,r,n,i);return z.length=B.length=0,s}function U(e,t,r,n,s,a){if(e.length=0,!r){for(const r of t){const t=r.attributes[a];e.push(new o.Z(null,r.attributes,null,t))}return e}switch(r){case"esriGeometryPoint":return Z(e,t,n,s,a);case"esriGeometryMultipoint":return L(e,t,n,s,a);case"esriGeometryPolyline":return R(e,t,n,s,a);case"esriGeometryPolygon":return O(e,t,n,s,a);default:d.error("convertToFeatureSet:unknown-geometry",new i.Z(`Unable to parse unknown geometry type '${r}'`)),e.length=0}return e}function D(e,t,r,n,s,o){const a=e.length;switch(r){case"esriGeometryPoint":Z(e,t,n,s,o);break;case"esriGeometryMultipoint":L(e,t,n,s,o);break;case"esriGeometryPolyline":R(e,t,n,s,o);break;case"esriGeometryPolygon":O(e,t,n,s,o);break;default:d.error("convertToFeatureSet:unknown-geometry",new i.Z(`Unable to parse unknown geometry type '${r}'`))}for(let n=0;n<t.length;n++)e[n+a].geometryType=r,e[n+a].insertAfter=t[n].insertAfter,e[n+a].groupId=t[n].groupId;return e}function W(e,t,r,n){B[0]=e,X(z,B,t,r,n);const i=z[0];return z.length=B.length=0,i}function H(e,t,r){if(!e)return null;const n=new l.Z;return"hasZ"in e&&null==t&&(t=e.hasZ),"hasM"in e&&null==r&&(r=e.hasM),(0,s.wp)(e)?k(null!=t?t:null!=e.z,null!=r?r:null!=e.m)(n,e):(0,s.oU)(e)?G(n,e,t,r):(0,s.l9)(e)?P(n,e,c(t,r)):(0,s.aW)(e)?N(n,e,c(t,r)):void d.error("convertFromGeometry:unknown-geometry",new i.Z(`Unable to parse unknown geometry type '${e}'`))}function Y(e,t,r,n){const s=e&&("coords"in e?e:e.geometry);if(!s)return null;switch(t){case"esriGeometryPoint":{let e=I;return r&&n?e=x:r?e=C:n&&(e=F),e(s)}case"esriGeometryMultipoint":return E(s,r,n);case"esriGeometryPolyline":return $(s,r,n);case"esriGeometryPolygon":return S(s,r,n);default:return void d.error("convertToGeometry:unknown-geometry",new i.Z(`Unable to parse unknown geometry type '${t}'`))}}function X(e,t,r,n,s){switch(e.length=0,r){case"esriGeometryPoint":return function(e,t,r,n){let i=I;r&&n?i=x:r?i=C:n&&(i=F);for(const r of t){const{geometry:t,attributes:n}=r,s=t?i(t):null;e.push({attributes:n,geometry:s})}return e}(e,t,n,s);case"esriGeometryMultipoint":return function(e,t,r,n){for(const i of t){const{geometry:t,attributes:s}=i;let o;t&&(o=E(t,r,n)),e.push({attributes:s,geometry:o})}return e}(e,t,n,s);case"esriGeometryPolyline":return function(e,t,r,n){for(const i of t){const{geometry:t,attributes:s}=i;let o;t&&(o=$(t,r,n)),e.push({attributes:s,geometry:o})}return e}(e,t,n,s);case"esriGeometryPolygon":return function(e,t,r,n){for(const i of t){const{geometry:t,attributes:s,centroid:o}=i;let a;if(t&&(a=S(t,r,n)),o){const t=I(o);e.push({attributes:s,centroid:t,geometry:a})}else e.push({attributes:s,geometry:a})}return e}(e,t,n,s);default:d.error("convertToFeatureSet:unknown-geometry",new i.Z(`Unable to parse unknown geometry type '${r}'`))}return e}function K(e){const{objectIdFieldName:t,spatialReference:r,transform:n,fields:i,hasM:s,hasZ:o,features:a,geometryType:l,exceededTransferLimit:c,uniqueIdField:d,queryGeometry:u,queryGeometryType:h}=e,f={features:X([],a,l,o,s),fields:i,geometryType:l,objectIdFieldName:t,spatialReference:r,uniqueIdField:d,queryGeometry:Y(u,h,!1,!1)};return n&&(f.transform=n),c&&(f.exceededTransferLimit=c),s&&(f.hasM=s),o&&(f.hasZ=o),f}function Q(e,t){const r=new a.Z,{hasM:n,hasZ:s,features:o,objectIdFieldName:l,spatialReference:c,geometryType:u,exceededTransferLimit:h,transform:f,fields:p}=e;return p&&(r.fields=p),r.geometryType=u,r.objectIdFieldName=l||t,r.spatialReference=c,r.objectIdFieldName?(o&&U(r.features,o,u,s,n,r.objectIdFieldName),h&&(r.exceededTransferLimit=h),n&&(r.hasM=n),s&&(r.hasZ=s),f&&(r.transform=f),r):(d.error(new i.Z("optimized-features:invalid-objectIdFieldName","objectIdFieldName is missing")),r)}function J(e,t){const{geometryType:r,features:n,hasM:i,hasZ:s}=t;if(!e)return t;for(let t=0;t<n.length;t++){const o=n[t],a=o.weakClone();a.geometry=new l.Z,ee(a.geometry,o.geometry,i,s,r,e),o.centroid&&(a.centroid=new l.Z,ee(a.centroid,o.centroid,i,s,"esriGeometryPoint",e)),n[t]=a}return t.transform=e,t}function ee(e,t,r,n,i,s,o=r,a=n){if(e.lengths.length&&(e.lengths.length=0),e.coords.length&&(e.coords.length=0),!t||!t.coords.length)return null;const l=u[i],{coords:d,lengths:h}=t,f=c(r,n),p=c(r&&o,n&&a),m=g(r,n,o,a);if(!h.length)return m(e.coords,d,0,0,y(s,d[0]),b(s,d[1])),e.lengths.length&&(e.lengths.length=0),e.coords.length=f,e;let v,_,w,I,M=0,C=0,A=C;for(const t of h){if(t<l)continue;let r=0;C=A,w=v=y(s,d[M]),I=_=b(s,d[M+1]),m(e.coords,d,C,M,w,I),r++,M+=f,C+=p;for(let n=1;n<t;n++,M+=f)w=y(s,d[M]),I=b(s,d[M+1]),w===v&&I===_||(m(e.coords,d,C,M,w-v,I-_),C+=p,r++,v=w,_=I);r>=l&&(e.lengths.push(r),A=C)}return e.coords.length=A,e.coords.length?e:null}function te(e,t,r,n,i,s,o=r,a=n){if(e.lengths.length&&(e.lengths.length=0),e.coords.length&&(e.coords.length=0),!t||!t.coords.length)return null;const l=u[i],{coords:d,lengths:h}=t,f=c(r,n),p=c(r&&o,n&&a),m=g(r,n,o,a);if(!h.length)return m(e.coords,d,0,0,d[0],d[1]),e.lengths.length&&(e.lengths.length=0),e.coords.length=f,e;let y=0;const b=s*s;for(const t of h){if(t<l){y+=t*f;continue}const r=e.coords.length/p,n=y,i=y+(t-1)*f;m(e.coords,d,e.coords.length,n,d[n],d[n+1]),ne(e.coords,d,f,b,m,n,i),m(e.coords,d,e.coords.length,i,d[i],d[i+1]);const s=e.coords.length/p-r;s>=l?e.lengths.push(s):e.coords.length=r*p,y+=t*f}return e.coords.length?e:null}function re(e,t,r,n){const i=e[t],s=e[t+1],o=e[r],a=e[r+1],l=e[n],c=e[n+1];let d=o,u=a,h=l-d,f=c-u;if(0!==h||0!==f){const e=((i-d)*h+(s-u)*f)/(h*h+f*f);e>1?(d=l,u=c):e>0&&(d+=h*e,u+=f*e)}return h=i-d,f=s-u,h*h+f*f}function ne(e,t,r,n,i,s,o){let a,l=n,c=0;for(let e=s+r;e<o;e+=r)a=re(t,e,s,o),a>l&&(c=e,l=a);l>n&&(c-s>r&&ne(e,t,r,n,i,s,c),i(e,t,e.length,c,t[c],t[c+1]),o-c>r&&ne(e,t,r,n,i,c,o))}function ie(e,t,r,n){if(!t||!t.coords||!t.coords.length)return null;const i=c(r,n);let s=Number.POSITIVE_INFINITY,o=Number.POSITIVE_INFINITY,a=Number.NEGATIVE_INFINITY,l=Number.NEGATIVE_INFINITY;if(t&&t.coords){const e=t.coords;for(let t=0;t<e.length;t+=i){const r=e[t],n=e[t+1];s=Math.min(s,r),a=Math.max(a,r),o=Math.min(o,n),l=Math.max(l,n)}}return e[0]=s,e[1]=o,e[2]=a,e[3]=l,e}function se(e,t,r,n,i){const{coords:s,lengths:o}=t,a=r?n?m:f:n?f:h,l=c(r,n);if(!s.length)return e!==t&&(e.lengths.length=0,e.coords.length=0),e;if(!o.length)return a(e.coords,s,0,0,v(i,s[0]),_(i,s[1])),e!==t&&(e.lengths.length=0,e.coords.length=l),e;const[d,u]=i.scale;let p=0;for(let t=0;t<o.length;t++){const r=o[t];e.lengths[t]=r;let n=v(i,s[p]),c=_(i,s[p+1]);a(e.coords,s,p,p,n,c),p+=l;for(let t=1;t<r;t++,p+=l)n+=s[p]*d,c-=s[p+1]*u,a(e.coords,s,p,p,n,c)}return e!==t&&(e.lengths.length=o.length,e.coords.length=s.length),e}function oe(e,t,r,n,i,s){const o=c(r,n),a=g(r,n,i,s),l=t.coords;e.coords.length=0,e.lengths.length=0,e.lengths.push(...t.lengths);for(let t=0;t<l.length;t+=o)a(e.coords,l,e.coords.length,t,l[t],l[t+1]);return e}function ae(e,t,r,n){let i=0,s=e[n*t],o=e[n*(t+1)];for(let a=1;a<r;a++){const r=s+e[n*(t+a)],l=o+e[n*(t+a)+1],c=(r-s)*(l+o);s=r,o=l,i+=c}return.5*i}function le(e,t){const{coords:r,lengths:n}=e;let i=0,s=0;for(let e=0;e<n.length;e++)s+=ae(r,i,n[e],t),i+=e;return Math.abs(s)}function ce(e,t){const r=e.clone(),n=e.coords,i=e.lengths;let s=0;for(let e=0;e<i.length;e++){const o=i[e];let a=n[t*s],l=n[t*s+1];for(let e=1;e<o;e++){const i=a+n[t*(s+e)],o=l+n[t*(s+e)+1];r.coords[t*(s+e)]=i,r.coords[t*(s+e)+1]=o,a=i,l=o}s+=o}return r}},89867:(e,t,r)=>{"use strict";r.d(t,{p:()=>i});var n=r(72094);function i(e,t,r){if(!r||!r.features||!r.hasZ)return;const i=(0,n.k)(r.geometryType,t,e.outSpatialReference);if(i)for(const e of r.features)i(e.geometry)}},72094:(e,t,r)=>{"use strict";r.d(t,{k:()=>o,P:()=>l});var n=r(59472),i=r(27780),s=r(93533);function o(e,t,r){if((0,n.Wi)(t)||(0,n.Wi)(r)||r.vcsWkid||(0,i.fS)(t,r))return null;const o=(0,s._R)(t)/(0,s._R)(r);if(1===o)return null;switch(e){case"point":case"esriGeometryPoint":return e=>{return r=o,void((t=e)&&null!=t.z&&(t.z*=r));var t,r};case"polyline":case"esriGeometryPolyline":return e=>function(e,t){if(e)for(const r of e.paths)for(const e of r)e.length>2&&(e[2]*=t)}(e,o);case"polygon":case"esriGeometryPolygon":return e=>function(e,t){if(e)for(const r of e.rings)for(const e of r)e.length>2&&(e[2]*=t)}(e,o);case"multipoint":case"esriGeometryMultipoint":return e=>function(e,t){if(e)for(const r of e.points)r.length>2&&(r[2]*=t)}(e,o);default:return null}}function a(e,t,r){if(null==e.hasM||e.hasZ)for(const e of t)for(const t of e)t.length>2&&(t[2]*=r)}function l(e,t,r){if(!e&&!t||!r)return;const n=(0,s._R)(r);c(e,r,n),c(t,r,n)}function c(e,t,r){if(e)for(const n of e)d(n.geometry,t,r)}function d(e,t,r){if(!e||!e.spatialReference||(0,i.fS)(e.spatialReference,t))return;const n=(0,s._R)(e.spatialReference)/r;if(1!==n)if("x"in e)null!=e.z&&(e.z*=n);else if("rings"in e)a(e,e.rings,n);else if("paths"in e)a(e,e.paths,n);else if("points"in e&&(null==e.hasM||e.hasZ))for(const t of e.points)t.length>2&&(t[2]*=n)}},7354:(e,t,r)=>{"use strict";r.d(t,{Z:()=>h});var n,i=r(56140),s=(r(95830),r(82550)),o=(r(36544),r(68055)),a=r(79881),l=r(87566),c=r(60538),d=(r(10923),r(57002),r(86035),r(58385));let u=n=class extends d.wq{constructor(e){super(e),this.attachmentTypes=null,this.attachmentsWhere=null,this.keywords=null,this.globalIds=null,this.name=null,this.num=null,this.objectIds=null,this.returnMetadata=!1,this.size=null,this.start=null,this.where=null}writeStart(e,t){t.resultOffset=this.start,t.resultRecordCount=this.num||10}clone(){return new n((0,s.d9)({attachmentTypes:this.attachmentTypes,attachmentsWhere:this.attachmentsWhere,keywords:this.keywords,where:this.where,globalIds:this.globalIds,name:this.name,num:this.num,objectIds:this.objectIds,returnMetadata:this.returnMetadata,size:this.size,start:this.start}))}};(0,i._)([(0,a.Cb)({type:[String],json:{write:!0}})],u.prototype,"attachmentTypes",void 0),(0,i._)([(0,a.Cb)({type:String,json:{read:{source:"attachmentsDefinitionExpression"},write:{target:"attachmentsDefinitionExpression"}}})],u.prototype,"attachmentsWhere",void 0),(0,i._)([(0,a.Cb)({type:[String],json:{write:!0}})],u.prototype,"keywords",void 0),(0,i._)([(0,a.Cb)({type:[Number],json:{write:!0}})],u.prototype,"globalIds",void 0),(0,i._)([(0,a.Cb)({json:{write:!0}})],u.prototype,"name",void 0),(0,i._)([(0,a.Cb)({type:Number,json:{read:{source:"resultRecordCount"}}})],u.prototype,"num",void 0),(0,i._)([(0,a.Cb)({type:[Number],json:{write:!0}})],u.prototype,"objectIds",void 0),(0,i._)([(0,a.Cb)({type:Boolean,json:{default:!1,write:!0}})],u.prototype,"returnMetadata",void 0),(0,i._)([(0,a.Cb)({type:[Number],json:{write:!0}})],u.prototype,"size",void 0),(0,i._)([(0,a.Cb)({type:Number,json:{read:{source:"resultOffset"}}})],u.prototype,"start",void 0),(0,i._)([(0,c.c)("start"),(0,c.c)("num")],u.prototype,"writeStart",null),(0,i._)([(0,a.Cb)({type:String,json:{read:{source:"definitionExpression"},write:{target:"definitionExpression"}}})],u.prototype,"where",void 0),u=n=(0,i._)([(0,l.j)("esri.tasks.support.AttachmentQuery")],u),u.from=(0,o.se)(u);const h=u},11047:(e,t,r)=>{"use strict";r.d(t,{Z:()=>p});var n,i=r(56140),s=(r(95830),r(82550)),o=(r(36544),r(68055)),a=r(79881),l=r(87566),c=r(60538),d=(r(10923),r(57002),r(86035),r(58385)),u=r(73032),h=(r(36348),r(60853));let f=n=class extends d.wq{constructor(e){super(e),this.dynamicDataSource=void 0,this.gdbVersion=null,this.geometryPrecision=void 0,this.historicMoment=null,this.maxAllowableOffset=void 0,this.objectIds=null,this.orderByFields=null,this.outFields=null,this.outSpatialReference=null,this.relationshipId=void 0,this.start=void 0,this.num=void 0,this.returnGeometry=!1,this.returnM=void 0,this.returnZ=void 0,this.where=null}_writeHistoricMoment(e,t){t.historicMoment=e&&e.getTime()}writeStart(e,t){t.resultOffset=this.start,t.resultRecordCount=this.num||10,t.where="1=1"}clone(){return new n((0,s.d9)({dynamicDataSource:this.dynamicDataSource,gdbVersion:this.gdbVersion,geometryPrecision:this.geometryPrecision,historicMoment:this.historicMoment&&new Date(this.historicMoment.getTime()),maxAllowableOffset:this.maxAllowableOffset,objectIds:this.objectIds,orderByFields:this.orderByFields,outFields:this.outFields,outSpatialReference:this.outSpatialReference,relationshipId:this.relationshipId,start:this.start,num:this.num,returnGeometry:this.returnGeometry,where:this.where,returnZ:this.returnZ,returnM:this.returnM}))}};(0,i._)([(0,a.Cb)({type:h.D,json:{write:!0}})],f.prototype,"dynamicDataSource",void 0),(0,i._)([(0,a.Cb)({type:String,json:{write:!0}})],f.prototype,"gdbVersion",void 0),(0,i._)([(0,a.Cb)({type:Number,json:{write:!0}})],f.prototype,"geometryPrecision",void 0),(0,i._)([(0,a.Cb)({type:Date})],f.prototype,"historicMoment",void 0),(0,i._)([(0,c.c)("historicMoment")],f.prototype,"_writeHistoricMoment",null),(0,i._)([(0,a.Cb)({type:Number,json:{write:!0}})],f.prototype,"maxAllowableOffset",void 0),(0,i._)([(0,a.Cb)({type:[Number],json:{write:!0}})],f.prototype,"objectIds",void 0),(0,i._)([(0,a.Cb)({type:[String],json:{write:!0}})],f.prototype,"orderByFields",void 0),(0,i._)([(0,a.Cb)({type:[String],json:{write:!0}})],f.prototype,"outFields",void 0),(0,i._)([(0,a.Cb)({type:u.Z,json:{read:{source:"outSR"},write:{target:"outSR"}}})],f.prototype,"outSpatialReference",void 0),(0,i._)([(0,a.Cb)({json:{write:!0}})],f.prototype,"relationshipId",void 0),(0,i._)([(0,a.Cb)({type:Number,json:{read:{source:"resultOffset"}}})],f.prototype,"start",void 0),(0,i._)([(0,c.c)("start"),(0,c.c)("num")],f.prototype,"writeStart",null),(0,i._)([(0,a.Cb)({type:Number,json:{read:{source:"resultRecordCount"}}})],f.prototype,"num",void 0),(0,i._)([(0,a.Cb)({json:{write:!0}})],f.prototype,"returnGeometry",void 0),(0,i._)([(0,a.Cb)({type:Boolean,json:{write:{overridePolicy:e=>({enabled:e})}}})],f.prototype,"returnM",void 0),(0,i._)([(0,a.Cb)({type:Boolean,json:{write:{overridePolicy:e=>({enabled:e})}}})],f.prototype,"returnZ",void 0),(0,i._)([(0,a.Cb)({type:String,json:{read:{source:"definitionExpression"},write:{target:"definitionExpression"}}})],f.prototype,"where",void 0),f=n=(0,i._)([(0,l.j)("esri.tasks.support.RelationshipQuery")],f),f.from=(0,o.se)(f);const p=f},69829:(e,t,r)=>{"use strict";function n(e){return e&&"function"==typeof e.highlight}r.d(t,{tl:()=>n})},95627:(e,t,r)=>{"use strict";r.d(t,{Z:()=>v});var n=r(56140),i=(r(95830),r(59472)),s=(r(36544),r(79881)),o=r(60263),a=r(87566),l=r(32656),c=(r(10923),r(57002),r(86035),r(83477)),d=r(15988),u=r(80621),h=r(7354),f=r(82905),p=r(77204),m=r(29209);const g={editing:!1,operations:{add:!0,update:!0,delete:!0}},y=c.Z.ofType(f.Z);let b=class extends p.r{constructor(e){super(e),this._getAttachmentsPromise=null,this._attachmentLayer=null,this.abilities={...g},this.activeAttachmentInfo=null,this.attachmentInfos=new y,this.graphic=null,this.mode="view",this.handles.add([(0,u.init)(this,"graphic",(()=>this._graphicChanged()))])}destroy(){this._attachmentLayer=null,this.graphic=null}castAbilities(e){return{...g,...e}}get state(){return this._getAttachmentsPromise?"loading":this.graphic?"ready":"disabled"}get supportsResizeAttachments(){return this.get("graphic.layer.capabilities.operations.supportsResizeAttachments")||!1}async getAttachments(){const{_attachmentLayer:e,attachmentInfos:t}=this;if(!e||"function"!=typeof e.queryAttachments)throw new l.Z("invalid-layer","getAttachments(): A valid layer is required.");const r=this._getFeatureId(),n=new h.Z({objectIds:[r],returnMetadata:!0}),i=[],s=e.queryAttachments(n).then((e=>e[r]||i)).catch((()=>i));this._getAttachmentsPromise=s,this.notifyChange("state");const o=await s;return t.removeAll(),o.length&&t.addMany(o),this._getAttachmentsPromise=null,this.notifyChange("state"),o}async addAttachment(e){const{_attachmentLayer:t,attachmentInfos:r,graphic:n,abilities:i}=this;if(!e)throw new l.Z("invalid-attachment","addAttachment(): An attachment is required.",{attachment:e});if(!i.operations.add)throw new l.Z("invalid-abilities","addAttachment(): add abilities are required.");if(!t||"function"!=typeof t.addAttachment)throw new l.Z("invalid-layer","addAttachment(): A valid layer is required.");const s=t.addAttachment(n,e).then((e=>this._queryAttachment(e.objectId))),o=await s;return r.add(o),o}async deleteAttachment(e){const{_attachmentLayer:t,attachmentInfos:r,graphic:n,abilities:i}=this;if(!e)throw new l.Z("invalid-attachment-info","deleteAttachment(): An attachmentInfo is required.",{attachmentInfo:e});if(!i.operations.delete)throw new l.Z("invalid-abilities","deleteAttachment(): delete abilities are required.");if(!t||"function"!=typeof t.deleteAttachments)throw new l.Z("invalid-layer","deleteAttachment(): A valid layer is required.");const s=t.deleteAttachments(n,[e.id]).then((()=>e)),o=await s;return r.remove(o),o}async updateAttachment(e,t=this.activeAttachmentInfo){const{_attachmentLayer:r,attachmentInfos:n,graphic:i,abilities:s}=this;if(!e)throw new l.Z("invalid-attachment","updateAttachment(): An attachment is required.",{attachment:e});if(!t)throw new l.Z("invalid-attachment-info","updateAttachment(): An attachmentInfo is required.",{attachmentInfo:t});if(!s.operations.update)throw new l.Z("invalid-abilities","updateAttachment(): Update abilities are required.");const o=n.findIndex((e=>e===t));if(!r||"function"!=typeof r.updateAttachment)throw new l.Z("invalid-layer","updateAttachment(): A valid layer is required.");const a=r.updateAttachment(i,t.id,e).then((e=>this._queryAttachment(e.objectId))),c=await a;return n.splice(o,1,c),c}async _queryAttachment(e){if(!e)throw new l.Z("invalid-attachment-id","Could not query attachment.");const{_attachmentLayer:t}=this,r=this._getFeatureId(),n=new h.Z({objectIds:[r],attachmentsWhere:`AttachmentId=${e}`,returnMetadata:!0});return t.queryAttachments(n).then((e=>e[r][0]))}_getFeatureId(){const{_attachmentLayer:e,graphic:t}=this;if(!e||!t)return null;const{objectIdField:r}=e,{attributes:n}=t;return n&&n[r]}_graphicChanged(){this.graphic&&(this._setAttachmentLayer(),this.getAttachments().catch((()=>{})))}_setAttachmentLayer(){const{graphic:e}=this,t=(0,m.l$)(e);this._attachmentLayer=t?"scene"===t.type&&(0,i.pC)(t.associatedLayer)?t.associatedLayer:t:null}};(0,n._)([(0,s.Cb)()],b.prototype,"abilities",void 0),(0,n._)([(0,o.p)("abilities")],b.prototype,"castAbilities",null),(0,n._)([(0,s.Cb)()],b.prototype,"activeAttachmentInfo",void 0),(0,n._)([(0,s.Cb)({readOnly:!0,type:y})],b.prototype,"attachmentInfos",void 0),(0,n._)([(0,s.Cb)({type:d.default})],b.prototype,"graphic",void 0),(0,n._)([(0,s.Cb)()],b.prototype,"mode",void 0),(0,n._)([(0,s.Cb)({dependsOn:["graphic"],readOnly:!0})],b.prototype,"state",null),(0,n._)([(0,s.Cb)({readOnly:!0,dependsOn:["graphic","graphic.layer","graphic.layer.loaded","graphic.layer.capabilities.operations.supportsResizeAttachments"]})],b.prototype,"supportsResizeAttachments",null),b=(0,n._)([(0,a.j)("esri.widgets.Attachments.AttachmentsViewModel")],b);const v=b},22292:(e,t,r)=>{"use strict";r.r(t),r.d(t,{default:()=>ye});var n=r(56140),i=(r(95830),r(36544),r(79881)),s=r(51894),o=r(60263),a=r(87566),l=(r(10923),r(57002),r(86035),r(61398)),c=(r(89771),r(80621)),d=r(40450),u=r(9200),h=r(90846),f=r(19401),p=r(90806),m=r(32656),g=r(56888),y=r(95627);const b=(0,r(12973).V)("esri/themes/base/images/files/");function v(e){return e?"text/plain"===e?`${b}text-32.svg`:"application/pdf"===e?`${b}pdf-32.svg`:"text/csv"===e?`${b}csv-32.svg`:"application/gpx+xml"===e?`${b}gpx-32.svg`:"application/x-dwf"===e?`${b}cad-32.svg`:"application/postscript"===e||"application/json"===e||"text/xml"===e||"model/vrml"===e?`${b}code-32.svg`:"application/x-zip-compressed"===e||"application/x-7z-compressed"===e||"application/x-gzip"===e||"application/x-tar"===e||"application/x-gtar"===e||"application/x-bzip2"===e||"application/gzip"===e||"application/x-compress"===e||"application/x-apple-diskimage"===e||"application/x-rar-compressed"===e||"application/zip"===e?`${b}zip-32.svg`:-1!==e.indexOf("image/")?`${b}image-32.svg`:-1!==e.indexOf("audio/")?`${b}sound-32.svg`:-1!==e.indexOf("video/")?`${b}video-32.svg`:-1!==e.indexOf("msexcel")||-1!==e.indexOf("ms-excel")||-1!==e.indexOf("spreadsheetml")?`${b}excel-32.svg`:-1!==e.indexOf("msword")||-1!==e.indexOf("ms-word")||-1!==e.indexOf("wordprocessingml")?`${b}word-32.svg`:-1!==e.indexOf("powerpoint")||-1!==e.indexOf("presentationml")?`${b}report-32.svg`:`${b}generic-32.svg`:`${b}generic-32.svg`}const _={addButton:!0,addSubmitButton:!0,cancelAddButton:!0,cancelUpdateButton:!0,deleteButton:!0,errorMessage:!0,progressBar:!0,updateButton:!0},w="esri-attachments__item-button",I="esri-attachments__form-node",M="esri-attachments__file-fieldset",C="esri-attachments__file-label",A="esri-attachments__file-name",F="esri-attachments__file-input",T="esri-attachments__metadata-fieldset",x="esri-button",j="esri-button--disabled",k="esri-button--secondary",Z="esri-button--tertiary",E="esri-button--third",L="esri-button--small",N="esri-button--half",$=window.CSS;let R=class extends p.default{constructor(e,t){super(e,t),this.abilities=null,this.displayType="list",this.graphic=null,this.label=void 0,this.messages=null,this.messagesUnits=null,this.selectedFile=null,this.submitting=!1,this.viewModel=new y.Z,this.visibleElements={..._},this._supportsImageOrientation=$&&$.supports&&$.supports("image-orientation","from-image"),this._addAttachmentForm=null,this._updateAttachmentForm=null}initialize(){this.own((0,c.on)(this,"viewModel.attachmentInfos","change",(()=>this.scheduleRender())),(0,c.init)(this,"viewModel.mode",(()=>this._modeChanged())))}castVisibleElements(e){return{..._,...e}}addAttachment(){const{_addAttachmentForm:e,viewModel:t}=this;return this._set("submitting",!0),this._set("error",null),t.addAttachment(e).then((e=>(this._set("submitting",!1),this._set("error",null),t.mode="view",e))).catch((e=>{throw this._set("submitting",!1),this._set("error",new m.Z("attachments:add-attachment",this.messages.addErrorMessage,e)),e}))}deleteAttachment(e){const{viewModel:t}=this;return this._set("submitting",!0),this._set("error",null),t.deleteAttachment(e).then((e=>(this._set("submitting",!1),this._set("error",null),t.mode="view",e))).catch((e=>{throw this._set("submitting",!1),this._set("error",new m.Z("attachments:delete-attachment",this.messages.deleteErrorMessage,e)),e}))}updateAttachment(){const{viewModel:e}=this,{_updateAttachmentForm:t}=this;return this._set("submitting",!0),this._set("error",null),e.updateAttachment(t).then((t=>(this._set("submitting",!1),this._set("error",null),e.mode="view",t))).catch((e=>{throw this._set("submitting",!1),this._set("error",new m.Z("attachments:update-attachment",this.messages.updateErrorMessage,e)),e}))}render(){const{submitting:e,viewModel:t}=this,{state:r}=t;return(0,f.j)("div",{class:this.classes("esri-attachments","esri-widget")},e?this.renderProgressBar():null,"loading"===r?this.renderLoading():this.renderAttachments(),this.renderErrorMessage())}renderErrorMessage(){const{error:e,visibleElements:t}=this;return e&&t.errorMessage?(0,f.j)("div",{key:"error-message",class:"esri-attachments__error-message"},e.message):null}renderAttachments(){const{mode:e,activeAttachmentInfo:t}=this.viewModel;return"add"===e?this.renderAddForm():"edit"===e?this.renderDetailsForm(t):this.renderAttachmentContainer()}renderLoading(){return(0,f.j)("div",{class:"esri-attachments__loader-container",key:"loader"},(0,f.j)("div",{class:"esri-attachments__loader"}))}renderProgressBar(){return this.visibleElements.progressBar?(0,f.j)("div",{class:"esri-attachments__progress-bar",key:"progress-bar"}):null}renderAddForm(){const{submitting:e,selectedFile:t}=this,r=e||!t,n=this.visibleElements.cancelAddButton?(0,f.j)("button",{type:"button",bind:this,disabled:e,onclick:this._cancelForm,class:this.classes(x,Z,L,N,e&&j)},this.messages.cancel):null,i=this.visibleElements.addSubmitButton?(0,f.j)("button",{type:"submit",disabled:r,class:this.classes(x,k,L,N,{[j]:r})},this.messages.add):null,s=t?(0,f.j)("span",{key:"file-name",class:A},t.name):null,o=(0,f.j)("form",{bind:this,afterCreate:d.Se,afterRemoved:d.pV,"data-node-ref":"_addAttachmentForm",onsubmit:this._submitAddAttachment},(0,f.j)("fieldset",{class:M},s,(0,f.j)("label",{class:this.classes(C,x,k)},t?this.messages.changeFile:this.messages.selectFile,(0,f.j)("input",{class:F,type:"file",name:"attachment",bind:this,onchange:this._handleFileInputChange}))),i,n);return(0,f.j)("div",{key:"add-form-container",class:I},o)}renderDetailsForm(e){const{visibleElements:t,viewModel:r,selectedFile:n,submitting:i}=this,{contentType:s,size:o,url:a}=e,{abilities:l}=r,c=i||!n,u=l.editing&&l.operations.delete&&t.deleteButton?(0,f.j)("button",{key:"delete-button",type:"button",disabled:i,bind:this,onclick:t=>this._submitDeleteAttachment(t,e),class:this.classes(x,L,Z,"esri-attachments__delete-button",{[j]:i})},this.messages.delete):null,h=l.editing&&l.operations.update&&t.updateButton?(0,f.j)("button",{disabled:c,key:"update-button",type:"submit",class:this.classes(x,L,E,{[j]:c})},this.messages.update):null,p=this.visibleElements.cancelUpdateButton?(0,f.j)("button",{disabled:i,key:"cancel-button",type:"button",bind:this,onclick:this._cancelForm,class:this.classes(x,L,Z,E,{[j]:i})},this.messages.cancel):null,m=n?(0,f.j)("span",{key:"file-name",class:A},n.name):null,y=l.editing&&l.operations.update?(0,f.j)("fieldset",{key:"file",class:M},m,(0,f.j)("label",{class:this.classes(C,x,k)},this.messages.changeFile,(0,f.j)("input",{class:F,type:"file",name:"attachment",bind:this,onchange:this._handleFileInputChange}))):null,b=(0,f.j)("fieldset",{key:"size",class:T},(0,f.j)("label",null,(0,g.sS)(this.messagesUnits,o))),v=(0,f.j)("fieldset",{key:"content-type",class:T},(0,f.j)("label",null,s)),_=(0,f.j)("form",{bind:this,afterCreate:d.Se,afterRemoved:d.pV,"data-node-ref":"_updateAttachmentForm",onsubmit:this._submitUpdateAttachment},(0,f.j)("div",{class:"esri-attachments__metadata"},b,v),y,(0,f.j)("div",{class:"esri-attachments__actions"},u,p,h));return(0,f.j)("div",{key:"edit-form-container",class:I},(0,f.j)("a",{class:"esri-attachments__item-link",href:a,rel:"noreferrer",target:"_blank",alt:name},this.renderImageMask({attachmentInfo:e,size:400}),(0,f.j)("div",{class:"esri-attachments__item-link-overlay"},(0,f.j)("span",{class:"esri-attachments__item-link-overlay-icon"},(0,f.j)("svg",{xmlns:"http://www.w3.org/2000/svg",width:"32",height:"32",viewBox:"0 0 32 32"},(0,f.j)("path",{d:"M28 13h1v16H3V3h16v1H4v24h24zm-5-9h4.293L15.646 15.638l.707.707L28 4.707V9h1V3h-6z"}),(0,f.j)("path",{fill:"none",d:"M0 0h32v32H0z"}))))),_)}renderImageMask({attachmentInfo:e,size:t}){const{supportsResizeAttachments:r}=this.viewModel,{contentType:n,url:i}=e,s=r&&function(e){const t=e.toLowerCase();return"image/bmp"===t||"image/emf"===t||"image/exif"===t||"image/gif"===t||"image/x-icon"===t||"image/jpeg"===t||"image/png"===t||"image/tiff"===t||"image/x-wmf"===t}(n),o=this._getCSSTransform(e,s),a=o?{transform:o,"image-orientation":"none"}:{},l=-1===i.indexOf("?")?"?":"&",c=s?`${i}${l}w=${t}`:v(n),d={"esri-attachments__item-mask--icon":!s},u={"esri-attachments__image--resizable":r};return(0,f.j)("div",{class:this.classes(d,"esri-attachments__item-mask")},(0,f.j)("img",{styles:a,alt:"",src:c,class:this.classes(u,"esri-attachments__image")}))}renderAttachmentInfo({attachmentInfo:e,displayType:t}){const{viewModel:r}=this,{abilities:n}=r,{name:i,url:s}=e,o=this.renderImageMask({attachmentInfo:e,size:"list"===t?48:400}),a=n.editing?(0,f.j)("span",{"aria-hidden":"true",class:this.classes("esri-attachments__item-chevron-icon",(0,d.dZ)()?"esri-icon-left":"esri-icon-right")}):null,l=[o,(0,f.j)("label",{class:"esri-attachments__label"},(0,f.j)("span",{class:"esri-attachments__filename"},i||this.messages.noTitle),a)],c=n.editing?(0,f.j)("button",{key:"details-button",bind:this,class:w,title:this.messages.attachmentDetails,"aria-label":this.messages.attachmentDetails,"data-attachment-info-id":e.id,onclick:()=>this._startEditAttachment(e),type:"button"},l):(0,f.j)("a",{key:"details-link",class:w,href:s,target:"_blank"},l);return(0,f.j)("li",{class:"esri-attachments__item",key:e},c)}renderAttachmentContainer(){const{displayType:e,viewModel:t,visibleElements:r}=this,{attachmentInfos:n,abilities:i}=t,s=n&&n.length,o={"esri-attachments__container--list":"preview"!==e,"esri-attachments__container--preview":"preview"===e},a=i.editing&&i.operations.add&&r.addButton?(0,f.j)("button",{bind:this,onclick:()=>this._startAddAttachment(),class:this.classes(x,Z,"esri-attachments__add-attachment-button"),type:"button"},(0,f.j)("span",{"aria-hidden":"true",class:this.classes("esri-attachments__item-add-icon","esri-icon-plus")}),this.messages.add):null,l=s?(0,f.j)("ul",{class:"esri-attachments__items"},n.toArray().map((t=>this.renderAttachmentInfo({attachmentInfo:t,displayType:e})))):(0,f.j)("div",{class:"esri-widget__content--empty"},this.messages.noAttachments);return(0,f.j)("div",{key:"attachments-container",class:this.classes("esri-attachments__container",o)},l,a)}_modeChanged(){this._set("error",null),this._set("selectedFile",null)}_handleFileInputChange(e){const t=e.target,r=t&&t.files&&t.files.item(0);this._set("selectedFile",r)}_submitDeleteAttachment(e,t){e.preventDefault(),this.deleteAttachment(t)}_submitAddAttachment(e){e.preventDefault(),this.addAttachment()}_submitUpdateAttachment(e){e.preventDefault(),this.updateAttachment()}_startEditAttachment(e){const{viewModel:t}=this;t.activeAttachmentInfo=e,t.mode="edit"}_startAddAttachment(){this.viewModel.mode="add"}_cancelForm(e){e.preventDefault(),this.viewModel.mode="view"}_getCSSTransform(e,t){const{orientationInfo:r}=e;return!this._supportsImageOrientation&&t&&r?[r.rotation?`rotate(${r.rotation}deg)`:"",r.mirrored?"scaleX(-1)":""].join(" "):""}};(0,n._)([(0,s.B)("viewModel.abilities")],R.prototype,"abilities",void 0),(0,n._)([(0,i.Cb)(),(0,h.G)()],R.prototype,"displayType",void 0),(0,n._)([(0,s.B)("viewModel.graphic")],R.prototype,"graphic",void 0),(0,n._)([(0,i.Cb)({aliasOf:{source:"messages.widgetLabel",overridable:!0}})],R.prototype,"label",void 0),(0,n._)([(0,i.Cb)(),(0,h.G)(),(0,u.H)("esri/widgets/Attachments/t9n/Attachments")],R.prototype,"messages",void 0),(0,n._)([(0,i.Cb)(),(0,h.G)(),(0,u.H)("esri/core/t9n/Units")],R.prototype,"messagesUnits",void 0),(0,n._)([(0,i.Cb)({readOnly:!0})],R.prototype,"selectedFile",void 0),(0,n._)([(0,h.G)(),(0,i.Cb)({readOnly:!0})],R.prototype,"submitting",void 0),(0,n._)([(0,h.G)(),(0,i.Cb)({readOnly:!0})],R.prototype,"error",void 0),(0,n._)([(0,i.Cb)({type:y.Z}),(0,h.G)(["viewModel.activeAttachmentInfo","viewModel.mode","viewModel.state","viewModel.supportsResizeAttachments","viewModel.attachmentInfos","viewModel.graphic","viewModel.abilities","viewModel.abilities.editing","viewModel.abilities.operations"])],R.prototype,"viewModel",void 0),(0,n._)([(0,i.Cb)(),(0,h.G)()],R.prototype,"visibleElements",void 0),(0,n._)([(0,o.p)("visibleElements")],R.prototype,"castVisibleElements",null),R=(0,n._)([(0,a.j)("esri.widgets.Attachments")],R);const P=R;r(68055);var S=r(73502),O=r(29209),G=r(39498);let q=class extends p.default{constructor(e,t){super(e,t),this.creator=null,this.graphic=null,this.viewModel=null,this._addTargetToAnchors=e=>{Array.from(e.querySelectorAll("a")).forEach((e=>{(0,O.or)(e.href)&&!e.hasAttribute("target")&&e.setAttribute("target","_blank")}))}}renderLoading(){return(0,f.j)("div",{class:"esri-feature-content__loader-container",key:"loader"},(0,f.j)("div",{class:"esri-feature-content__loader"}))}renderCreated(){var e;const t=null==(e=this.viewModel)?void 0:e.created;return t?t instanceof HTMLElement?(0,f.j)("div",{key:t,bind:t,afterCreate:this._attachToNode}):(0,S.isWidget)(t)?(0,f.j)("div",{key:t},!t.destroyed&&t.render()):(0,f.j)("div",{key:t,innerHTML:t,afterCreate:this._addTargetToAnchors}):null}render(){var e;const t=null==(e=this.viewModel)?void 0:e.state;return(0,f.j)("div",{class:"esri-feature-content"},"loading"===t?this.renderLoading():this.renderCreated())}_attachToNode(e){e.appendChild(this)}};(0,n._)([(0,s.B)("viewModel.creator")],q.prototype,"creator",void 0),(0,n._)([(0,s.B)("viewModel.graphic")],q.prototype,"graphic",void 0),(0,n._)([(0,h.G)(["viewModel.created","viewModel.state"]),(0,i.Cb)({type:G.Z})],q.prototype,"viewModel",void 0),q=(0,n._)([(0,a.j)("esri.widgets.Feature.FeatureContent")],q);const z=q;var B=r(54881),V=r(88263);const U=[{pattern:/^\s*(https?:\/\/([^\s]+))\s*$/i,target:"_blank",label:"{messages.view}"},{pattern:/^\s*(tel:([^\s]+))\s*$/i,label:"{hierPart}"},{pattern:/^\s*(mailto:([^\s]+))\s*$/i,label:"{hierPart}"},{pattern:/^\s*(arcgis-appstudio-player:\/\/([^\s]+))\s*$/i,label:"{messages.openInApp}",appName:"App Studio Player"},{pattern:/^\s*(arcgis-collector:\/\/([^\s]+))\s*$/i,label:"{messages.openInApp}",appName:"Collector"},{pattern:/^\s*(arcgis-explorer:\/\/([^\s]+))\s*$/i,label:"{messages.openInApp}",appName:"Explorer"},{pattern:/^\s*(arcgis-navigator:\/\/([^\s]+))\s*$/i,label:"{messages.openInApp}",appName:"Navigator"},{pattern:/^\s*(arcgis-survey123:\/\/([^\s]+))\s*$/i,label:"{messages.openInApp}",appName:"Survey123"},{pattern:/^\s*(arcgis-trek2there:\/\/([^\s]+))\s*$/i,label:"{messages.openInApp}",appName:"Trek2There"},{pattern:/^\s*(arcgis-workforce:\/\/([^\s]+))\s*$/i,label:"{messages.openInApp}",appName:"Workforce"},{pattern:/^\s*(iform:\/\/([^\s]+))\s*$/i,label:"{messages.openInApp}",appName:"iForm"},{pattern:/^\s*(flow:\/\/([^\s]+))\s*$/i,label:"{messages.openInApp}",appName:"FlowFinity"},{pattern:/^\s*(lfmobile:\/\/([^\s]+))\s*$/i,label:"{messages.openInApp}",appName:"Laserfische"},{pattern:/^\s*(mspbi:\/\/([^\s]+))\s*$/i,label:"{messages.openInApp}",appName:"Microsoft Power Bi"}];function D(e,t){if("string"!=typeof t||!t)return t;const r=function(e){let t=null;return U.some((r=>(r.pattern.test(e)&&(t=r),!!t))),t}(t);if(!r)return t;const n=t.match(r.pattern),i=n&&n[2],s=(0,V.gx)((0,V.gx)(r.label,{messages:e,hierPart:i}),{appName:r.appName}),o=r.target?` target="${r.target}"`:"",a="_blank"===r.target?' rel="noreferrer"':"";return t.replace(r.pattern,`<a${o} href="$1"${a}>${s}</a>`)}let W=class extends p.default{constructor(e,t){super(e,t),this.attributes=null,this.expressionInfos=null,this.fieldInfos=null,this.viewModel=new B.Z,this.messages=null,this.messagesURIUtils=null}renderFieldInfo(e,t){const{attributes:r}=this.viewModel,n=e.fieldName,i=e.label||n,s=r?null==r[n]?"":r[n]:"",o=!(!e.format||!e.format.dateFormat),a="number"!=typeof s||o?D(this.messagesURIUtils,s):this._forceLTR(s),l={"esri-feature-fields__field-data--date":o};return(0,f.j)("tr",{key:`fields-element-info-row-${n}-${t}`},(0,f.j)("th",{key:`fields-element-info-row-header-${n}-${t}`,class:"esri-feature-fields__field-header",innerHTML:i}),(0,f.j)("td",{key:`fields-element-info-row-data-${n}-${t}`,class:this.classes("esri-feature-fields__field-data",l),innerHTML:a}))}renderFields(){const{formattedFieldInfos:e}=this.viewModel;return e.length?(0,f.j)("table",{class:"esri-widget__table",summary:this.messages.fieldsSummary},(0,f.j)("tbody",null,e.map(((e,t)=>this.renderFieldInfo(e,t))))):null}render(){return(0,f.j)("div",{class:"esri-feature-fields"},this.renderFields())}_forceLTR(e){return`&lrm;${e}`}};(0,n._)([(0,s.B)("viewModel.attributes")],W.prototype,"attributes",void 0),(0,n._)([(0,s.B)("viewModel.expressionInfos")],W.prototype,"expressionInfos",void 0),(0,n._)([(0,s.B)("viewModel.fieldInfos")],W.prototype,"fieldInfos",void 0),(0,n._)([(0,i.Cb)({type:B.Z}),(0,h.G)(["viewModel.attributes","viewModel.formattedFieldInfos"])],W.prototype,"viewModel",void 0),(0,n._)([(0,i.Cb)(),(0,h.G)(),(0,u.H)("esri/widgets/Feature/t9n/Feature")],W.prototype,"messages",void 0),(0,n._)([(0,i.Cb)(),(0,h.G)(),(0,u.H)("esri/widgets/support/t9n/uriUtils")],W.prototype,"messagesURIUtils",void 0),W=(0,n._)([(0,a.j)("esri.widgets.Feature.FeatureFields")],W);const H=W;var Y=r(10180),X=r(36861),K=r(39105),Q=r(3766),J=["#ffffff","#858585","#ffbebe","#ffebbe","#ffebaf","#ffffbe","#e9ffbe","#d3ffbe","#beffe8","#bee8ff","#bed2ff","#e8beff","#ffbee8","#ebebeb","#707070","#ff7f7f","#ffa77f","#ffd37f","#ffff73","#d1ff73","#a3ff73","#73ffdf","#73dfff","#73b2ff","#df73ff","#ff73df","#d6d6d6","#5c5c5c","#ff0000","#ff5500","#ffaa00","#ffff00","#aaff00","#55ff00","#00ffc5","#00c5ff","#0070ff","#c500ff","#ff00c5","#c2c2c2","#474747","#e60000","#e64c00","#e69800","#e6e600","#98e600","#4ce600","#00e6a9","#00a9e6","#005ce6","#a900e6","#e600a9","#adadad","#242424","#a80000","#a83800","#a87000","#a8a800","#70a800","#38a800","#00a884","#0084a8","#004da8","#8400a8","#a80084","#999999","#1a1a1a","#730000","#732600","#734c00","#737300","#4c7300","#267300","#00734c","#004c73","#002673","#4c0073","#73004"],ee=[].concat(J.slice(30,39),J.slice(28,30).reverse()),te=[{name:"default",colors:ee},{name:"cat-dark",colors:["#ed5151","#149ece","#a7c636","#9e559c","#fc921f","#ffde3e","#f789d8","#b7814a","#3caf99","#6b6bd6","#b54779","#7f7f7f"]},{name:"tropical-bliss",colors:["#fce138","#ff9399","#fcd27e","#f1983c","#a553b7","#b1a9d0","#6ecffc","#4c81cd","#fc6f84","#fc3e5a","#6af689","#48885c"]},{name:"desert-blooms",colors:["#102432","#144d59","#ffc730","#ed9310","#a64f1b","#661510","#d9351a","#b31515","#4a0932","#8c213f","#18382e","#2c6954"]},{name:"under-the-sea",colors:["#bf9727","#607100","#00734c","#704489","#01acca","#024e76","#f09100","#ea311f","#c6004b","#7570b3","#666666","#333333"]},{name:"vibrant-rainbow",colors:["#fffb00","#f5cb11","#9fd40c","#46e39c","#32b8a6","#7ff2fa","#ac08cc","#dd33ff","#eb7200","#e8a784","#bf2e2e","#6c7000"]},{name:"ocean-bay",colors:["#191921","#11495c","#78b1c2","#454f4b","#8f8f82","#9be0c0","#87b051","#f7ec88","#ebdcc1","#dbb658","#c43541","#75351e"]},{name:"prairie-summer",colors:["#332424","#751555","#d47013","#d68989","#211173","#82aad6","#7bfaeb","#6ec9a8","#6b6408","#eada40","#ccc54a","#1fc235"]},{name:"pastel-chalk",colors:["#fffd99","#f5e6a4","#c1d48c","#b8e3d0","#a0b8b5","#cbf7fa","#d791f2","#dfc1eb","#f2b983","#e8c4b2","#bf8e8e","#94995c"]},{name:"seq-yellow-orange-red-bright",colors:["#910000","#b1260b","#c0370f","#e05919","#ef6a1d","#ff7b22","#ffa143","#ffb454","#ffda74","#ffed85"]},{name:"seq-reds-bright",colors:["#57453b","#7b4238","#9f4036","#c23d33","#d7483c","#ec5244","#f3696c","#f9816c","#ffc4ae","#fff0dc"]},{name:"seq-purples-bright",colors:["#4e465c","#5a4a78","#695291","#775baa","#8663c3","#946bdc","#aa89e8","#c1a6f3","#d7c4ff","#e6e1ff"]},{name:"seq-blues-bright",colors:["#404d54","#435c6c","#48799d","#4b88b6","#4d96ce","#50a5e7","#74bbed","#98d0f3","#bce6f9","#e6faff"]},{name:"seq-greens-bright",colors:["#39544c","#386757","#368165","#359b73","#33b581","#4bc392","#64d2a2","#7ce0b3","#cbf6d9","#f4ffea"]},{name:"seq-browns-bright",colors:["#524834","#715b38","#8f6e3c","#ae8140","#cc9444","#eba748","#eeb664","#f0c47f","#f9e0b7","#fff8eb"]}];const re=new Map([["ar",()=>r.e(5740).then(r.bind(r,75740)).then((function(e){return e.a}))],["bs-ba",()=>r.e(2094).then(r.bind(r,2094)).then((function(e){return e.b}))],["ca-es",()=>r.e(8340).then(r.bind(r,98340)).then((function(e){return e.c}))],["cs-cz",()=>r.e(4562).then(r.bind(r,44562)).then((function(e){return e.c}))],["da-dk",()=>r.e(6983).then(r.bind(r,76983)).then((function(e){return e.d}))],["de-de",()=>r.e(8973).then(r.bind(r,28973)).then((function(e){return e.d}))],["de-ch",()=>r.e(9645).then(r.bind(r,59645)).then((function(e){return e.d}))],["el-gr",()=>r.e(965).then(r.bind(r,50965)).then((function(e){return e.e}))],["en-us",()=>r.e(8724).then(r.bind(r,8724)).then((function(e){return e.e}))],["en-ca",()=>r.e(4488).then(r.bind(r,14488)).then((function(e){return e.e}))],["es-es",()=>r.e(699).then(r.bind(r,699)).then((function(e){return e.e}))],["et-ee",()=>r.e(8093).then(r.bind(r,48093)).then((function(e){return e.e}))],["fi-fi",()=>r.e(4894).then(r.bind(r,74894)).then((function(e){return e.f}))],["fr-fr",()=>r.e(7467).then(r.bind(r,47467)).then((function(e){return e.f}))],["he-il",()=>r.e(3824).then(r.bind(r,73824)).then((function(e){return e.h}))],["hr-hr",()=>r.e(3058).then(r.bind(r,83058)).then((function(e){return e.h}))],["hu-hu",()=>r.e(3952).then(r.bind(r,33952)).then((function(e){return e.h}))],["id-id",()=>r.e(4840).then(r.bind(r,94840)).then((function(e){return e.i}))],["it-it",()=>r.e(613).then(r.bind(r,20613)).then((function(e){return e.i}))],["ja-jp",()=>r.e(8613).then(r.bind(r,88613)).then((function(e){return e.j}))],["ko-kr",()=>r.e(152).then(r.bind(r,80152)).then((function(e){return e.k}))],["lt-lt",()=>r.e(9713).then(r.bind(r,99713)).then((function(e){return e.l}))],["lv-lv",()=>r.e(58).then(r.bind(r,58)).then((function(e){return e.l}))],["nb-no",()=>r.e(8745).then(r.bind(r,70169)).then((function(e){return e.n}))],["nl-nl",()=>r.e(6734).then(r.bind(r,46734)).then((function(e){return e.n}))],["pl-pl",()=>r.e(86).then(r.bind(r,70086)).then((function(e){return e.p}))],["pt-br",()=>r.e(3973).then(r.bind(r,13973)).then((function(e){return e.p}))],["pt-pt",()=>r.e(3566).then(r.bind(r,23566)).then((function(e){return e.p}))],["ro-ro",()=>r.e(885).then(r.bind(r,30885)).then((function(e){return e.r}))],["ru-ru",()=>r.e(2907).then(r.bind(r,22907)).then((function(e){return e.r}))],["sl-sl",()=>r.e(4294).then(r.bind(r,94294)).then((function(e){return e.s}))],["sr-rs",()=>r.e(8899).then(r.bind(r,78899)).then((function(e){return e.s}))],["sv-se",()=>r.e(3528).then(r.bind(r,33528)).then((function(e){return e.s}))],["th-th",()=>r.e(6311).then(r.bind(r,66311)).then((function(e){return e.t}))],["tr-tr",()=>r.e(8817).then(r.bind(r,8817)).then((function(e){return e.t}))],["uk-ua",()=>r.e(7863).then(r.bind(r,97863)).then((function(e){return e.u}))],["vi-vn",()=>r.e(4658).then(r.bind(r,74658)).then((function(e){return e.v}))],["zh-cn",()=>r.e(7892).then(r.bind(r,77892)).then((function(e){return e.z}))],["zh-hk",()=>r.e(5541).then(r.bind(r,45541)).then((function(e){return e.z}))],["zh-tw",()=>r.e(5541).then(r.bind(r,45541)).then((function(e){return e.z}))]]);let ne,ie;async function se(e=(0,Q.Kd)()){if(e=function(e){return e?re.has(e.toLowerCase())?e.toLowerCase():function(e){const t=e.split("-")[0].toLowerCase();let r=null;for(const e of re.keys())if(e.startsWith(t)){r=e;break}return r}(e)||"en-us":"en-us"}(e),ne&&e===ie)return ne;ne=r.e(5959).then(r.bind(r,95959)).then((function(e){return e.i})),ie=e;try{const[t,r]=await(0,K.all)([ne,re.get(ie)()]);ie===e&&(t.am4core.options.defaultLocale=r.default),t.am4core.options.suppressWarnings=!0,t.am4core.options.autoDispose=!0}catch{return ne=null,ie=null,null}return ne}const oe="esri-feature-media__button",ae="esri-feature-media__icon",le="esri-icon-left-triangle-arrow",ce="esri-icon-right-triangle-arrow";let de=class extends p.default{constructor(e,t){super(e,t),this._refreshTimer=null,this._refreshIntervalInfo=null,this.attributes=null,this.activeMediaInfoIndex=null,this.fieldInfoMap=null,this.layer=null,this.mediaInfos=null,this.popupTemplate=null,this.relatedInfos=null,this.viewModel=new X.Z,this.messages=null}initialize(){this.own((0,c.init)(this,["viewModel.activeMediaInfo","viewModel.activeMediaInfoIndex"],(()=>this._setupMediaRefreshTimer())))}destroy(){this._clearMediaRefreshTimer()}render(){return(0,f.j)("div",{bind:this,class:"esri-feature-media",onkeyup:this._handleMediaKeyup},this.renderMedia())}renderMedia(){const{formattedMediaInfoCount:e}=this.viewModel;return e?(0,f.j)("div",{key:"media-element-container",class:"esri-feature-media__container"},this.renderMediaPageButton("previous"),this.renderMediaInfo(),this.renderMediaPageButton("next")):null}renderImageMediaInfo(e){const{_refreshIntervalInfo:t}=this,{activeMediaInfoIndex:r,formattedMediaInfoCount:n}=this.viewModel,{value:i,refreshInterval:s,altText:o,title:a,type:l}=e,{sourceURL:c,linkURL:d}=i,u=(0,O.or)(d)?"_blank":"_self",h="_blank"===u?"noreferrer":"",p=s?t:null,m=p?p.timestamp:0,g=p?p.sourceURL:c,y=(0,f.j)("img",{alt:o||a,key:`media-${l}-${r}-${n}-${m}`,src:g});return(d?(0,f.j)("a",{title:a,href:d,rel:h,target:u},y):null)||y}renderChartMediaInfo(e){const{activeMediaInfoIndex:t,formattedMediaInfoCount:r}=this.viewModel;return(0,f.j)("div",{key:`media-${e.type}-${t}-${r}`,bind:this,class:"esri-feature-media__chart",afterCreate:this._getChartDependencies})}renderMediaInfoType(){const{activeMediaInfo:e}=this.viewModel;return e?"image"===e.type?this.renderImageMediaInfo(e):-1!==e.type.indexOf("chart")?this.renderChartMediaInfo(e):null:null}renderMediaInfo(){const{activeMediaInfo:e}=this.viewModel,t=e.title?(0,f.j)("div",{key:"media-title",class:"esri-feature-media__item-title",innerHTML:e.title}):null,r=e.caption?(0,f.j)("div",{key:"media-caption",class:"esri-feature-media__item-caption",innerHTML:e.caption}):null;return(0,f.j)("div",{key:"media-container",class:"esri-feature-media__item-container"},t,r,(0,f.j)("div",{key:"media-item-container",class:"esri-feature-media__item"},this.renderMediaInfoType()))}renderMediaPageButton(e){if(this.viewModel.formattedMediaInfoCount<2)return null;const t="previous"===e,r=t?this.messages.previous:this.messages.next,n=t?this.classes(oe,"esri-feature-media__previous"):this.classes(oe,"esri-feature-media__next"),i=t?this.classes(ae,"esri-feature-media__previous-icon",le):this.classes(ae,"esri-feature-media__next-icon",ce),s=t?this.classes(ae,"esri-feature-media__previous-icon--rtl",ce):this.classes(ae,"esri-feature-media__next-icon--rtl",le),o=t?"media-previous":"media-next",a=t?this._previous:this._next;return(0,f.j)("button",{type:"button",key:o,title:r,"aria-label":r,tabIndex:0,class:n,bind:this,onclick:a},(0,f.j)("span",{"aria-hidden":"true",class:i}),(0,f.j)("span",{"aria-hidden":"true",class:s}))}_next(){this.viewModel.next()}_previous(){this.viewModel.previous()}async _getChartDependencies(e){const t=await se(),{activeMediaInfo:r}=this.viewModel;this._renderChart({chartDiv:e,mediaInfo:r,chartsModule:t})}_handleMediaKeyup(e){const t=(0,Y.kK)(e);"ArrowLeft"===t&&(e.stopPropagation(),this.viewModel.previous()),"ArrowRight"===t&&(e.stopPropagation(),this.viewModel.next())}_renderChart(e){const{chartsModule:t,chartDiv:r,mediaInfo:n}=e,{value:i,type:s}=n,{am4core:o}=t,a=function(e,t="default"){const r=te.find((e=>e.name===t));return r?r.colors.map((t=>e.color(t))):null}(o);(0,d.$o)()&&o.useTheme(t.am4themes_dark),o.useTheme(t.am4themes_animated),o.useTheme((function(e){e instanceof o.ColorSet&&a&&(e.list=a)}));const l="pie-chart"===s?this._createPieChart(e):this._createXYChart(e);r.setAttribute("aria-label",n.altText||n.title),l.data=i.series.map((e=>({tooltip:e.tooltip,value:e.value}))).filter((e=>"pie-chart"!==s||e.value>0))}_customizeChartTooltip(e,t){e.label.wrap=!0,e.label.maxWidth=200,e.autoTextColor=!1,e.getFillFromObject=!1,e.label.fill=t.color("#ffffff"),e.background.fill=t.color({r:0,g:0,b:0,a:.7})}_createPieChart(e){const{chartDiv:t,chartsModule:r}=e,{am4core:n,am4charts:i}=r,s=n.create(t,i.PieChart);s.rtl=(0,d.dZ)();const o=s.series.push(new i.PieSeries);return o.labels.template.disabled=!0,o.ticks.template.disabled=!0,o.dataFields.value="value",o.dataFields.category="tooltip",this._customizeChartTooltip(o.tooltip,n),s}_getMinSeriesValue(e){let t=0;return e.forEach((e=>t=Math.min(e.value,t))),t}_createColumnChart(e,t){const{chartsModule:r,mediaInfo:n}=t,{value:i}=n,{am4core:s,am4charts:o}=r,a=e.xAxes.push(new o.CategoryAxis);a.dataFields.category="tooltip",a.renderer.labels.template.disabled=!0,this._customizeChartTooltip(a.tooltip,s),a.tooltip.events.on("sizechanged",(()=>{a.tooltip.dy=-a.tooltip.contentHeight}));const l=e.yAxes.push(new o.ValueAxis),c=l.renderer.labels.template;l.renderer.minLabelPosition=.05,l.renderer.maxLabelPosition=.95,l.min=this._getMinSeriesValue(i.series),this._customizeChartTooltip(l.tooltip,s),c.wrap=!0;const d=e.series.push(new o.ColumnSeries);d.dataFields.valueY="value",d.dataFields.categoryX="tooltip",e.cursor=new o.XYCursor,i.series.length>15&&(e.scrollbarX=new s.Scrollbar)}_createBarChart(e,t){const{chartsModule:r,mediaInfo:n}=t,{value:i}=n,{am4core:s,am4charts:o}=r,a=e.yAxes.push(new o.CategoryAxis);a.dataFields.category="tooltip",a.renderer.inversed=!0,a.renderer.labels.template.disabled=!0,this._customizeChartTooltip(a.tooltip,s),a.tooltip.events.on("sizechanged",(()=>{a.tooltip.dx=a.tooltip.contentWidth}));const l=e.xAxes.push(new o.ValueAxis),c=l.renderer.labels.template;l.renderer.minLabelPosition=.05,l.renderer.maxLabelPosition=.95,l.min=this._getMinSeriesValue(i.series),this._customizeChartTooltip(l.tooltip,s),c.wrap=!0;const d=e.series.push(new o.ColumnSeries);d.dataFields.valueX="value",d.dataFields.categoryY="tooltip",e.cursor=new o.XYCursor,i.series.length>15&&(e.scrollbarY=new s.Scrollbar)}_createLineChart(e,t){const{chartsModule:r,mediaInfo:n}=t,{value:i}=n,{am4core:s,am4charts:o}=r,a=e.xAxes.push(new o.CategoryAxis);a.dataFields.category="tooltip",a.renderer.labels.template.disabled=!0,this._customizeChartTooltip(a.tooltip,s),a.tooltip.events.on("sizechanged",(()=>{a.tooltip.dy=-a.tooltip.contentHeight}));const l=e.yAxes.push(new o.ValueAxis),c=l.renderer.labels.template;l.renderer.minLabelPosition=.05,l.renderer.maxLabelPosition=.95,l.min=this._getMinSeriesValue(i.series),this._customizeChartTooltip(l.tooltip,s),c.wrap=!0;const d=e.series.push(new o.LineSeries);d.dataFields.categoryX="tooltip",d.dataFields.valueY="value",e.cursor=new o.XYCursor,i.series.length>15&&(e.scrollbarX=new s.Scrollbar)}_createXYChart(e){const{chartDiv:t,chartsModule:r,mediaInfo:n}=e,{type:i}=n,{am4core:s,am4charts:o}=r,a=s.create(t,o.XYChart);return a.rtl=(0,d.dZ)(),"column-chart"===i&&this._createColumnChart(a,e),"bar-chart"===i&&this._createBarChart(a,e),"line-chart"===i&&this._createLineChart(a,e),a}_clearMediaRefreshTimer(){const{_refreshTimer:e}=this;e&&(clearTimeout(e),this._refreshTimer=null)}_updateMediaInfoTimestamp(e){const t=Date.now();this._refreshIntervalInfo={timestamp:t,sourceURL:this._getImageSource(e,t)},this.scheduleRender()}_setupMediaRefreshTimer(){this._clearMediaRefreshTimer();const{activeMediaInfo:e}=this.viewModel;e&&"image"===e.type&&e.refreshInterval&&this._setRefreshTimeout(e)}_setRefreshTimeout(e){const{refreshInterval:t,value:r}=e;if(!t)return;const n=6e4*t;this._updateMediaInfoTimestamp(r.sourceURL);const i=setInterval((()=>{this._updateMediaInfoTimestamp(r.sourceURL)}),n);this._refreshTimer=i}_getImageSource(e,t){const r=-1!==e.indexOf("?")?"&":"?",[n,i=""]=e.split("#");return`${n}${r}timestamp=${t}${i?"#":""}${i}`}};(0,n._)([(0,s.B)("viewModel.attributes")],de.prototype,"attributes",void 0),(0,n._)([(0,s.B)("viewModel.activeMediaInfoIndex")],de.prototype,"activeMediaInfoIndex",void 0),(0,n._)([(0,s.B)("viewModel.fieldInfoMap")],de.prototype,"fieldInfoMap",void 0),(0,n._)([(0,s.B)("viewModel.layer")],de.prototype,"layer",void 0),(0,n._)([(0,s.B)("viewModel.mediaInfos")],de.prototype,"mediaInfos",void 0),(0,n._)([(0,s.B)("viewModel.popupTemplate")],de.prototype,"popupTemplate",void 0),(0,n._)([(0,s.B)("viewModel.relatedInfos")],de.prototype,"relatedInfos",void 0),(0,n._)([(0,i.Cb)({type:X.Z}),(0,h.G)(["viewModel.formattedMediaInfos","viewModel.activeMediaInfoIndex","viewModel.activeMediaInfo"])],de.prototype,"viewModel",void 0),(0,n._)([(0,i.Cb)(),(0,h.G)(),(0,u.H)("esri/widgets/Feature/t9n/Feature")],de.prototype,"messages",void 0),de=(0,n._)([(0,a.j)("esri.widgets.Feature.FeatureMedia")],de);const ue=de;var he=r(45598),fe=r(22020);const pe="esri-feature__content-element",me={title:!0,content:!0,lastEditedInfo:!0};let ge=class extends((0,fe.q)(p.default)){constructor(e,t){super(e,t),this._contentWidgets=[],this.graphic=null,this.defaultPopupTemplateEnabled=!1,this.label=void 0,this.messages=null,this.messagesURIUtils=null,this.spatialReference=null,this.title=null,this.visibleElements={...me},this.map=null,this.view=null,this.viewModel=new he.Z}initialize(){this.own((0,c.init)(this,"viewModel.contentViewModels",(()=>this._setupContentWidgets())))}destroy(){this._destroyContentWidgets()}castVisibleElements(e){return{...me,...e}}render(){const{waitingForContent:e}=this.viewModel;return(0,f.j)("div",{class:this.classes("esri-feature","esri-widget")},(0,f.j)("div",{class:"esri-feature__size-container"},this.renderTitle(),e?this.renderLoading():this.renderContentContainer()))}setActiveMedia(e,t){this.viewModel.setActiveMedia(e,t)}nextMedia(e){this.viewModel.nextMedia(e)}previousMedia(e){this.viewModel.previousMedia(e)}renderLoading(){return(0,f.j)("div",{key:"loading-container",class:"esri-feature__loading-container"},(0,f.j)("span",{class:this.classes("esri-icon-loading-indicator esri-rotating","esri-feature__loading-spinner")}))}renderContentContainer(){const{visibleElements:e}=this;return e.content?(0,f.j)("div",{class:"esri-feature__main-container"},[this.renderContent(),this.renderLastEditInfo()]):null}renderTitle(){const{visibleElements:e,title:t}=this;return e.title?(0,f.j)("h4",{class:"esri-feature__title",innerHTML:t}):null}renderContent(){const e=this.viewModel.content;if(!e)return null;if(Array.isArray(e))return e.length?(0,f.j)("div",{key:"content-content-elements"},e.map(this.renderContentElement,this)):null;if("string"==typeof e){const e=this._contentWidgets[0];return!e||e.destroyed?null:(0,f.j)("div",{key:"content-content"},e.render())}return this.renderNodeContent(e)}renderContentElement(e,t){const{visibleElements:r}=this;if("boolean"!=typeof r.content&&!r.content[e.type])return null;switch(e.type){case"attachments":return this.renderAttachments(t);case"custom":return this.renderCustom(e,t);case"fields":return this.renderFields(t);case"media":return this.renderMedia(t);case"text":return this.renderText(e,t);default:return null}}renderAttachments(e){const t=this._contentWidgets[e];if(!t||t.destroyed)return null;const{state:r,attachmentInfos:n}=t.viewModel;return"loading"===r||n.length>0?(0,f.j)("div",{key:this._buildKey("attachments-element",e),class:this.classes("esri-feature__attachments",pe)},(0,f.j)("h2",null,this.messages.attach),t.render()):null}renderCustom(e,t){const{creator:r}=e,n=this._contentWidgets[t];return!n||n.destroyed?null:r?(0,f.j)("div",{key:this._buildKey("custom-element",t),class:pe},n.render()):null}renderFields(e){const t=this._contentWidgets[e];return!t||t.destroyed?null:(0,f.j)("div",{key:this._buildKey("fields-element",e),class:pe},t.render())}renderMedia(e){const t=this._contentWidgets[e];return!t||t.destroyed?null:(0,f.j)("div",{key:this._buildKey("media-element",e),class:pe},t.render())}renderLastEditInfo(){const{visibleElements:e,messages:t}=this,{lastEditInfo:r}=this.viewModel;if(!r||!e.lastEditedInfo)return null;const{date:n,user:i}=r,s="edit"===r.type?i?t.lastEditedByUser:t.lastEdited:i?t.lastCreatedByUser:t.lastCreated,o=(0,l.n)(s,{date:n,user:i});return(0,f.j)("div",{key:"edit-info-element",class:this.classes("esri-feature__last-edited-info",pe)},o)}renderText(e,t){const r=e.text,n=this._contentWidgets[t];return!n||n.destroyed?null:r?(0,f.j)("div",{key:this._buildKey("text-element",t),class:this.classes(pe,"esri-feature__text")},n.render()):null}_buildKey(e,...t){return`${e}__${this.get("viewModel.graphic.uid")||"0"}-${t.join("-")}`}_destroyContentWidgets(){this._contentWidgets.forEach((e=>{e.viewModel=null,e&&!e.destroyed&&e.destroy()})),this._contentWidgets=[]}_setupContentWidgets(){this._destroyContentWidgets();const e=this.get("viewModel.content"),{contentViewModels:t}=this.viewModel;if(Array.isArray(e))e.forEach(((e,r)=>{"attachments"===e.type&&(this._contentWidgets[r]=new P({displayType:e.displayType,viewModel:t[r]})),"fields"===e.type&&(this._contentWidgets[r]=new H({viewModel:t[r]})),"media"===e.type&&(this._contentWidgets[r]=new ue({viewModel:t[r]})),"text"===e.type&&(this._contentWidgets[r]=new z({viewModel:t[r]})),"custom"===e.type&&(this._contentWidgets[r]=new z({viewModel:t[r]}))}),this);else{const e=t[0];e&&!e.destroyed&&(this._contentWidgets[0]=new z({viewModel:e}))}this.scheduleRender()}};(0,n._)([(0,s.B)("viewModel.graphic")],ge.prototype,"graphic",void 0),(0,n._)([(0,s.B)("viewModel.defaultPopupTemplateEnabled")],ge.prototype,"defaultPopupTemplateEnabled",void 0),(0,n._)([(0,i.Cb)({aliasOf:{source:"messages.widgetLabel",overridable:!0}})],ge.prototype,"label",void 0),(0,n._)([(0,i.Cb)(),(0,h.G)(),(0,u.H)("esri/widgets/Feature/t9n/Feature")],ge.prototype,"messages",void 0),(0,n._)([(0,i.Cb)(),(0,h.G)(),(0,u.H)("esri/widgets/support/t9n/uriUtils")],ge.prototype,"messagesURIUtils",void 0),(0,n._)([(0,s.B)("viewModel.spatialReference")],ge.prototype,"spatialReference",void 0),(0,n._)([(0,s.B)("viewModel.title")],ge.prototype,"title",void 0),(0,n._)([(0,i.Cb)(),(0,h.G)()],ge.prototype,"visibleElements",void 0),(0,n._)([(0,o.p)("visibleElements")],ge.prototype,"castVisibleElements",null),(0,n._)([(0,s.B)("viewModel.map")],ge.prototype,"map",void 0),(0,n._)([(0,s.B)("viewModel.view")],ge.prototype,"view",void 0),(0,n._)([(0,i.Cb)({type:he.Z}),(0,h.G)(["viewModel.waitingForContent","viewModel.content","viewModel.lastEditInfo","viewModel.contentViewModels"])],ge.prototype,"viewModel",void 0),ge=(0,n._)([(0,a.j)("esri.widgets.Feature")],ge);const ye=ge},39498:(e,t,r)=>{"use strict";r.d(t,{Z:()=>h});var n=r(56140),i=(r(95830),r(36544),r(68055),r(79881)),s=r(87566),o=(r(10923),r(57002),r(86035),r(82677)),a=r(15988),l=r(80621),c=r(77204),d=r(29209);let u=class extends((0,c.p)(o.default)){constructor(e){super(e),this._loadingPromise=null,this.created=null,this.creator=null,this.destroyer=null,this.graphic=null,this.handles.add((0,l.init)(this,"creator",(e=>{this._destroyContent(),this._createContent(e)})))}destroy(){this._destroyContent()}get state(){return this._loadingPromise?"loading":"ready"}_destroyContent(){const{created:e,graphic:t,destroyer:r}=this;e&&((0,d.vD)(r,{graphic:t}).catch((()=>null)),this._set("created",null))}async _createContent(e){const{graphic:t}=this,r=(0,d.vD)(e,{graphic:t}).catch((()=>null));this._loadingPromise=r,this.notifyChange("state");const n=await r;r===this._loadingPromise&&(this._loadingPromise=null,this.notifyChange("state"),this._set("created",n))}};(0,n._)([(0,i.Cb)({readOnly:!0})],u.prototype,"created",void 0),(0,n._)([(0,i.Cb)()],u.prototype,"creator",void 0),(0,n._)([(0,i.Cb)()],u.prototype,"destroyer",void 0),(0,n._)([(0,i.Cb)({type:a.default})],u.prototype,"graphic",void 0),(0,n._)([(0,i.Cb)({readOnly:!0})],u.prototype,"state",null),u=(0,n._)([(0,s.j)("esri.widgets.Feature.FeatureContent.FeatureContentViewModel")],u);const h=u},54881:(e,t,r)=>{"use strict";r.d(t,{Z:()=>u});var n=r(56140),i=(r(95830),r(36544),r(68055),r(79881)),s=r(87566),o=(r(10923),r(57002),r(86035),r(82677)),a=r(20628),l=r(7417),c=r(29209);let d=class extends o.default{constructor(e){super(e),this.attributes=null,this.expressionInfos=null,this.fieldInfos=null}get formattedFieldInfos(){const{expressionInfos:e,fieldInfos:t}=this,r=[];return null==t||t.forEach((t=>{if(t.hasOwnProperty("visible")&&!t.visible)return;const n=t.clone();n.label=(0,c.JD)(n,e),r.push(n)})),r}};(0,n._)([(0,i.Cb)()],d.prototype,"attributes",void 0),(0,n._)([(0,i.Cb)({type:[l.Z]})],d.prototype,"expressionInfos",void 0),(0,n._)([(0,i.Cb)({type:[a.Z]})],d.prototype,"fieldInfos",void 0),(0,n._)([(0,i.Cb)({readOnly:!0,dependsOn:["expressionInfos","fieldInfos"]})],d.prototype,"formattedFieldInfos",null),d=(0,n._)([(0,s.j)("esri.widgets.Feature.FeatureFields.FeatureFieldsViewModel")],d);const u=d},36861:(e,t,r)=>{"use strict";r.d(t,{Z:()=>h});var n=r(56140),i=(r(95830),r(36544),r(68055),r(79881)),s=r(87566),o=(r(10923),r(57002),r(86035),r(82677)),a=r(20628),l=r(62813),c=r(29209),d=r(47873);let u=class extends o.default{constructor(e){super(e),this.activeMediaInfoIndex=0,this.attributes=null,this.fieldInfoMap=null,this.formattedAttributes=null,this.layer=null,this.mediaInfos=null,this.popupTemplate=null,this.relatedInfos=null}get activeMediaInfo(){return this.formattedMediaInfos[this.activeMediaInfoIndex]||null}get formattedMediaInfos(){return this._formatMediaInfos()||[]}get formattedMediaInfoCount(){return this.formattedMediaInfos.length}setActiveMedia(e){this._setContentElementMedia(e)}next(){this._pageContentElementMedia(1)}previous(){this._pageContentElementMedia(-1)}_setContentElementMedia(e){const{formattedMediaInfoCount:t}=this,r=(e+t)%t;this.activeMediaInfoIndex=r}_pageContentElementMedia(e){const{activeMediaInfoIndex:t}=this,r=t+e;this._setContentElementMedia(r)}_formatMediaInfos(){const{attributes:e,mediaInfos:t,formattedAttributes:r,fieldInfoMap:n,layer:i}=this,s={...r,...e};return null==t?void 0:t.map((t=>{if(!t)return null;const o=t.title?(0,c.f5)(t.title,s,i):"";t.title=o?(0,c.ar)({formattedAttributes:r,template:o,fieldInfoMap:n}):"";const a=t.caption?(0,c.f5)(t.caption,s,i):"";t.caption=a?(0,c.ar)({formattedAttributes:r,template:a,fieldInfoMap:n}):"";const l=t.altText?(0,c.f5)(t.altText,s,i):"";if(t.altText=l?(0,c.ar)({formattedAttributes:r,template:l,fieldInfoMap:n}):"","image"===t.type){const{value:e}=t;return this._setImageValue({value:e,formattedAttributes:r,layer:i}),t.value.sourceURL?t:void 0}if("pie-chart"===t.type||"line-chart"===t.type||"column-chart"===t.type||"bar-chart"===t.type){const{value:n}=t;return this._setChartValue({value:n,chartType:t.type,attributes:e,formattedAttributes:r,layer:i}),t}return null})).filter(Boolean)}_setImageValue(e){const{fieldInfoMap:t}=this,{value:r,formattedAttributes:n,layer:i}=e,{linkURL:s,sourceURL:o}=r;if(o){const e=(0,c.Qu)(o,i);r.sourceURL=(0,c.ar)({formattedAttributes:n,template:e,fieldInfoMap:t})}if(s){const e=(0,c.Qu)(s,i);r.linkURL=(0,c.ar)({formattedAttributes:n,template:e,fieldInfoMap:t})}}_setChartValue(e){const{value:t,attributes:r,formattedAttributes:n,chartType:i,layer:s}=e,{popupTemplate:o,relatedInfos:a}=this,{fields:l,normalizeField:d}=t;if(t.fields=(0,c.iJ)(l,s),d&&(t.normalizeField=(0,c.k6)(d,s)),!l.some((e=>!!(null!=n[e]||(0,c.oM)(e)&&a.size))))return;const u=null==o?void 0:o.fieldInfos;l.forEach((e=>{if((0,c.oM)(e))return void(t.series=[...t.series,...this._getRelatedChartInfos({fieldInfos:u,fieldName:e,formattedAttributes:n,chartType:i,value:t})]);const s=this._getChartOption({value:t,attributes:r,chartType:i,formattedAttributes:n,fieldName:e,fieldInfos:u});t.series.push(s)}))}_getRelatedChartInfos(e){var t;const{fieldInfos:r,fieldName:n,formattedAttributes:i,chartType:s,value:o}=e,a=[],l=(0,d.Bt)(n),{layerId:c,fieldName:u}=l,h=null==(t=this.relatedInfos)?void 0:t.get(c.toString());if(!h)return a;const{relatedFeatures:f,relation:p}=h;if(!p||!f)return a;const{cardinality:m}=p;return f.forEach((e=>{const{attributes:t}=e;t&&Object.keys(t).forEach((e=>{e===u&&a.push(this._getChartOption({value:o,attributes:t,formattedAttributes:i,fieldName:n,chartType:s,relatedFieldName:e,fieldInfos:r}))}))})),"one-to-many"===m||"many-to-many"===m?a:[a[0]]}_getTooltip({label:e,value:t,chartType:r}){return"pie-chart"===r?e:`${e}: ${t}`}_getChartOption(e){var t;const{value:r,attributes:n,formattedAttributes:i,fieldName:s,relatedFieldName:o,fieldInfos:u,chartType:h}=e,{layer:f}=this,{normalizeField:p,tooltipField:m}=r,g=p?(0,c.oM)(p)?n[(0,d.Bt)(p).fieldName]:n[p]:null,y=o&&void 0!==n[o]?n[o]:void 0!==n[s]?n[s]:i[s],b=void 0===y?null:y&&g?y/g:y,v=new l.Z({value:b});if((0,c.oM)(s)){const e=(0,d.Bt)(s),t=(0,d.Bt)(m),r=t?t.fieldName:null,i=(0,c.P_)(b,{fieldInfos:u,fieldName:o,layer:f,preventPlacesFormatting:!!g}),a=e?e.label||e.fieldName:o,l=r&&void 0!==n[r]?n[r]:a;return v.tooltip=this._getTooltip({label:l,value:i,chartType:h}),v}const _=(0,c._R)(u,s),w=(0,c.k6)(s,f),I=m&&void 0!==i[m]?i[m]:(0,c.JD)(_||new a.Z({fieldName:w}),null==(t=this.popupTemplate)?void 0:t.expressionInfos),M=i[w];return v.tooltip=this._getTooltip({label:I,value:M,chartType:h}),v}};(0,n._)([(0,i.Cb)()],u.prototype,"activeMediaInfoIndex",void 0),(0,n._)([(0,i.Cb)({readOnly:!0,dependsOn:["formattedMediaInfos","activeMediaInfoIndex"]})],u.prototype,"activeMediaInfo",null),(0,n._)([(0,i.Cb)()],u.prototype,"attributes",void 0),(0,n._)([(0,i.Cb)()],u.prototype,"fieldInfoMap",void 0),(0,n._)([(0,i.Cb)()],u.prototype,"formattedAttributes",void 0),(0,n._)([(0,i.Cb)({readOnly:!0,dependsOn:["attributes","fieldInfoMap","formattedAttributes","mediaInfos","popupTemplate","layer","relatedInfos"]})],u.prototype,"formattedMediaInfos",null),(0,n._)([(0,i.Cb)()],u.prototype,"layer",void 0),(0,n._)([(0,i.Cb)({readOnly:!0,dependsOn:["formattedMediaInfos"]})],u.prototype,"formattedMediaInfoCount",null),(0,n._)([(0,i.Cb)()],u.prototype,"mediaInfos",void 0),(0,n._)([(0,i.Cb)()],u.prototype,"popupTemplate",void 0),(0,n._)([(0,i.Cb)()],u.prototype,"relatedInfos",void 0),u=(0,n._)([(0,s.j)("esri.widgets.Feature.FeatureMedia.FeatureMediaViewModel")],u);const h=u},45598:(e,t,r)=>{"use strict";r.d(t,{Z:()=>T});var n=r(56140),i=(r(95830),r(59472)),s=r(36544),o=(r(68055),r(79881)),a=r(87566),l=(r(10923),r(57002),r(86035),r(39105)),c=r(82677),d=r(75107),u=r(15988),h=r(59691),f=r(80621),p=r(69065),m=r(29209),g=r(95627),y=r(39498),b=r(54881),v=r(47873),_=r(36861);const w=["$datastore","$map","$layer"],I=s.Z.getLogger("esri.widgets.Feature.support.arcadeFeatureUtils");async function M({expressionAttributes:e,info:t,arcadeUtils:r,spatialReference:n,map:i,graphic:s}){const o=`expression/${t.name}`,a=r.createSyntaxTree(t.expression),l=w.filter((e=>r.hasVariable(a,e)));await r.loadScriptDependencies(a,!0,l);const c=r.getViewInfo({spatialReference:n}),d=r.createExecContext(s,c);d.useAsync=!0,function({arcadeUtils:e,featureSetVars:t,context:r,viewInfo:n,map:i,graphic:s}){t.forEach((t=>{const o=t.toLowerCase(),a={map:i,spatialReference:n.sr};"$map"===o&&(r.vars[o]=e.convertMapToFeatureSetCollection(a)),"$layer"===o&&(r.vars[o]=e.convertFeatureLayerToFeatureSet(s.sourceLayer,n.sr)),"$datastore"===o&&(r.vars[o]=e.convertServiceUrlToWorkspace(s.sourceLayer.url,n.sr))}))}({arcadeUtils:r,featureSetVars:l,context:d,viewInfo:c,map:i,graphic:s});const u=r.createFunction(a,d),h=await r.executeAsyncFunction(u,d).catch((e=>I.error("arcade-execution-error",{error:e,graphic:s,expressionInfo:t})));var f;e[o]="string"==typeof h?(0,m.qD)((0,m.M3)(h)):Array.isArray(h)?function(e){return`<ul class="esri-widget__list">${e.map((e=>`<li>${"string"==typeof e?(0,m.qD)((0,m.M3)(e)):e}</li>`)).join("")}</ul>`}(h):h&&"esri.arcade.Dictionary"===h.declaredClass?`<table class="esri-widget__table">${(f=h).keys().map((e=>{const t=f.field(e);return`<tr><th>${e}</th><td>${"string"==typeof t?(0,m.qD)((0,m.M3)(t)):t}</td></tr>`})).join("")}</table>`:h}async function C({popupTemplate:e,spatialReference:t,graphic:n,map:i}){const s=e.expressionInfos,o=[],a={};if(!s||!s.length)return a;const c=await r.e(9043).then(r.bind(r,9043));for(const e of s)o.push(M({expressionAttributes:a,info:e,arcadeUtils:c,spatialReference:t,map:i,graphic:n}));return await(0,l.eachAlways)(o),a}const A=s.Z.getLogger("esri.widgets.FeatureViewModel");let F=class extends c.default{constructor(e){super(e),this._handles=new h.Z,this._featureAbortController=null,this.graphicChangedThrottled=(0,p.P)(this.graphicChanged,1,this),this.content=null,this.contentViewModels=[],this.defaultPopupTemplateEnabled=!1,this.formattedAttributes=null,this.lastEditInfo=null,this.relatedInfos=new Map,this.title="",this.view=null,this._handles.add((0,f.init)(this,["graphic","_effectivePopupTemplate"],(()=>this.graphicChangedThrottled())))}destroy(){this._clear(),this._cancelFeatureQuery(),this._handles.destroy(),this._handles=null,this.graphic=null,this._destroyContentViewModels(),this.relatedInfos.clear()}get _effectivePopupTemplate(){return(0,i.pC)(this.graphic)?this.graphic.getEffectivePopupTemplate(this.defaultPopupTemplateEnabled):null}get _fieldInfoMap(){return(0,m.cT)((0,m.Hs)(this._effectivePopupTemplate),this._sourceLayer)}get _sourceLayer(){return(0,m.l$)(this.graphic)}set graphic(e){this._set("graphic",e?e.clone():null)}get spatialReference(){return this.get("view.spatialReference")||null}set spatialReference(e){void 0!==e?this._override("spatialReference",e):this._clearOverride("spatialReference")}get map(){return this.get("view.map")||null}set map(e){void 0!==e?this._override("map",e):this._clearOverride("map")}get waitingForContent(){return!!this._featureAbortController}setActiveMedia(e,t){const r=this.contentViewModels[e];r instanceof _.Z&&r.setActiveMedia(t)}nextMedia(e){const t=this.contentViewModels[e];t instanceof _.Z&&t.next()}previousMedia(e){const t=this.contentViewModels[e];t instanceof _.Z&&t.previous()}_clear(){this._set("title",""),this._set("content",null),this._set("formattedAttributes",null)}async graphicChanged(){this._cancelFeatureQuery(),this._clear();const{graphic:e}=this;if(!e)return;const t=(0,l.createAbortController)();this._featureAbortController=t;try{await this._queryFeature({signal:t.signal})}catch(t){A.error("error","error loading popupTemplate for graphic",{error:t,graphic:e})}this._featureAbortController===t&&(this._featureAbortController=null)}_cancelFeatureQuery(){const{_featureAbortController:e}=this;e&&e.abort(),this._featureAbortController=null}_compileContent(e){if(this._destroyContentViewModels(),this.graphic)return Array.isArray(e)?e.map(((e,t)=>"attachments"===e.type?this._compileAttachments(e,t):"custom"===e.type?this._compileCustom(e,t):"fields"===e.type?this._compileFields(e,t):"media"===e.type?this._compileMedia(e,t):"text"===e.type?this._compileText(e,t):void 0)):"string"==typeof e?this._compileText(new d.Z({text:e}),0).text:e}_destroyContentViewModels(){this.contentViewModels.forEach((e=>e&&!e.destroyed&&e.destroy())),this._set("contentViewModels",[])}_compileAttachments(e,t){const{graphic:r}=this;return this.contentViewModels[t]=new g.Z({graphic:r}),e}_compileCustom(e,t){const{graphic:r}=this,{creator:n,destroyer:i}=e;return this.contentViewModels[t]=new y.Z({graphic:r,creator:n,destroyer:i}),e}_compileFields(e,t){const{_effectivePopupTemplate:r,formattedAttributes:n}=this,i=e.clone(),s=(null==e?void 0:e.fieldInfos)||(null==r?void 0:r.fieldInfos),o=null==r?void 0:r.expressionInfos,a={...n.global,...n.content[t]},l=new b.Z({attributes:a,expressionInfos:o,fieldInfos:s});return this.contentViewModels[t]=l,i.fieldInfos=l.formattedFieldInfos.slice(0),i}_compileMedia(e,t){const{graphic:r,_fieldInfoMap:n,_effectivePopupTemplate:i,relatedInfos:s,_sourceLayer:o}=this,{attributes:a}=r,l=this.formattedAttributes.global,c=e.clone(),{mediaInfos:d}=c,u=new _.Z({activeMediaInfoIndex:c.activeMediaInfoIndex||0,attributes:a,layer:o,fieldInfoMap:n,formattedAttributes:l,mediaInfos:d,popupTemplate:i,relatedInfos:s});return c.mediaInfos=u.formattedMediaInfos.slice(0),this.contentViewModels[t]=u,c}_compileText(e,t){const r=e.clone(),{graphic:n,_fieldInfoMap:i,_sourceLayer:s}=this;if(r&&r.text){const{attributes:e}=n,t=this.formattedAttributes.global,o=(0,m.f5)(r.text,{...t,...e},s);r.text=(0,m.ar)({formattedAttributes:t,template:o,fieldInfoMap:i})}return this.contentViewModels[t]=new y.Z({graphic:n,creator:r.text}),r}_compileLastEditInfo(){const{_effectivePopupTemplate:e,_sourceLayer:t,graphic:r}=this;if(!e)return;const{lastEditInfoEnabled:n}=e,i=null==t?void 0:t.editFieldsInfo;return n&&i?(0,m.Tj)(i,r.attributes):void 0}_compileTitle(e){const{_fieldInfoMap:t,_sourceLayer:r,graphic:n}=this,{attributes:i}=n,s=this.formattedAttributes.global;if(e){const n=(0,m.f5)(e,{...s,...i},r);return(0,m.ar)({formattedAttributes:s,template:n,fieldInfoMap:t})}return""}async _getTitle(){const{_effectivePopupTemplate:e,graphic:t}=this,r=null==e?void 0:e.title;return(0,m.vD)(r,{graphic:t})}async _getContent(){const{_effectivePopupTemplate:e,graphic:t}=this,r=null==e?void 0:e.content;return(0,m.vD)(r,{graphic:t})}async _queryFeature(e){const{_featureAbortController:t,_sourceLayer:r,graphic:n,_effectivePopupTemplate:i,spatialReference:s,map:o}=this,{content:{value:a},title:{value:c}}=await(0,l.eachAlways)({content:this._getContent(),title:this._getTitle()});if(t!==this._featureAbortController||!n)return;const{expressionAttributes:{value:d}}=await(0,l.eachAlways)({checkForRelatedFeatures:this._checkForRelatedFeatures(e),expressionAttributes:C({popupTemplate:this._effectivePopupTemplate,spatialReference:s,graphic:n,map:o}),queryUpdatedFeature:(0,m.Xh)({graphic:n,popupTemplate:i,layer:r},e)});t===this._featureAbortController&&n&&(this._set("formattedAttributes",this._createFormattedAttributes(a,d)),this._set("title",this._compileTitle(c)),this._set("lastEditInfo",this._compileLastEditInfo()||null),this._set("content",this._compileContent(a)||null))}_createFormattedAttributes(e,t){const{_effectivePopupTemplate:r,graphic:n,relatedInfos:i,_sourceLayer:s,_fieldInfoMap:o}=this,a=null==r?void 0:r.fieldInfos,l={...n.attributes,...t},c={global:(0,m.uI)({fieldInfos:a,graphic:n,attributes:l,layer:s,fieldInfoMap:o,relatedInfos:i}),content:[]};return Array.isArray(e)&&e.forEach(((e,t)=>{"fields"===e.type&&e.fieldInfos&&(c.content[t]=(0,m.uI)({fieldInfos:e.fieldInfos,graphic:n,attributes:l,layer:s,fieldInfoMap:o,relatedInfos:i}))})),c}_checkForRelatedFeatures(e){const{graphic:t,_effectivePopupTemplate:r}=this;return this._queryRelatedInfos(t,(0,m.Hs)(r),e)}async _queryRelatedInfos(e,t,r){const{relatedInfos:n,_sourceLayer:s}=this;n.clear();const o=(0,i.pC)(s.associatedLayer)?await s.associatedLayer.load(r):s;if(!o)return;const a=t.filter((e=>e&&(0,m.oM)(e.fieldName)));if(!a||!a.length)return;t.forEach((e=>this._configureRelatedInfo(e,o)));const l=await(0,v.Vb)({relatedInfos:n,layer:o},r);Object.keys(l).forEach((e=>{var t;const r=n.get(e.toString()),i=null==(t=l[e])?void 0:t.value;r&&i&&(r.layerInfo=i.data)}));const c=await(0,v.kp)({graphic:e,relatedInfos:n,layer:o},r);Object.keys(c).forEach((e=>{var t;(0,v.lg)(null==(t=c[e])?void 0:t.value,n.get(e.toString()))}))}_configureRelatedInfo(e,t){const{relatedInfos:r}=this,n=(0,v.Bt)(e.fieldName);if(!n)return;const{layerId:i,fieldName:s}=n;if(!i)return;const o=r.get(i.toString())||(0,v.uc)(i,t);o&&((0,v.NF)({relatedInfo:o,fieldName:s,fieldInfo:e}),this.relatedInfos.set(i,o))}};(0,n._)([(0,o.Cb)()],F.prototype,"_featureAbortController",void 0),(0,n._)([(0,o.Cb)({readOnly:!0,dependsOn:["graphic","graphic.sourceLayer.popupTemplate.title","graphic.sourceLayer.popupTemplate.content","graphic.sourceLayer.popupTemplate.expressionInfos","graphic.sourceLayer.popupTemplate.fieldInfos","graphic.sourceLayer.popupTemplate.lastEditInfoEnabled","graphic.sourceLayer.popupTemplate.outFields","graphic.sourceLayer.popupTemplate.relatedRecordsInfo","graphic.popupTemplate.title","graphic.popupTemplate.content","graphic.popupTemplate.expressionInfos","graphic.popupTemplate.fieldInfos","graphic.popupTemplate.lastEditInfoEnabled","graphic.popupTemplate.outFields","graphic.popupTemplate.relatedRecordsInfo","defaultPopupTemplateEnabled"]})],F.prototype,"_effectivePopupTemplate",null),(0,n._)([(0,o.Cb)({readOnly:!0,dependsOn:["_effectivePopupTemplate","_sourceLayer"]})],F.prototype,"_fieldInfoMap",null),(0,n._)([(0,o.Cb)({readOnly:!0,dependsOn:["graphic.layer","graphic.sourceLayer"]})],F.prototype,"_sourceLayer",null),(0,n._)([(0,o.Cb)({readOnly:!0})],F.prototype,"content",void 0),(0,n._)([(0,o.Cb)({readOnly:!0})],F.prototype,"contentViewModels",void 0),(0,n._)([(0,o.Cb)({type:Boolean})],F.prototype,"defaultPopupTemplateEnabled",void 0),(0,n._)([(0,o.Cb)({readOnly:!0})],F.prototype,"formattedAttributes",void 0),(0,n._)([(0,o.Cb)({type:u.default,value:null})],F.prototype,"graphic",null),(0,n._)([(0,o.Cb)({readOnly:!0})],F.prototype,"lastEditInfo",void 0),(0,n._)([(0,o.Cb)()],F.prototype,"relatedInfos",void 0),(0,n._)([(0,o.Cb)({dependsOn:["view"]})],F.prototype,"spatialReference",null),(0,n._)([(0,o.Cb)({readOnly:!0})],F.prototype,"title",void 0),(0,n._)([(0,o.Cb)({dependsOn:["view"]})],F.prototype,"map",null),(0,n._)([(0,o.Cb)({readOnly:!0,dependsOn:["_featureAbortController"]})],F.prototype,"waitingForContent",null),(0,n._)([(0,o.Cb)()],F.prototype,"view",void 0),F=(0,n._)([(0,a.j)("esri.widgets.FeatureViewModel")],F);const T=F},22020:(e,t,r)=>{"use strict";r.d(t,{q:()=>a});var n=r(56140),i=(r(95830),r(36544),r(68055),r(79881),r(87566)),s=(r(10923),r(57002),r(86035),r(19401)),o=r(73502);const a=e=>{let t=class extends e{constructor(){super(...arguments),this.renderNodeContent=e=>(0,o.isWidget)(e)&&!e.destroyed?(0,s.j)("div",{key:e},e.render()):e instanceof HTMLElement?(0,s.j)("div",{key:e,bind:e,afterCreate:this._attachToNode}):(0,o.hasDomNode)(e)?(0,s.j)("div",{key:e,bind:e.domNode,afterCreate:this._attachToNode}):null}_attachToNode(e){e.appendChild(this)}};return t=(0,n._)([(0,i.j)("esri.widgets.Feature.ContentMixin")],t),t}},29209:(e,t,r)=>{"use strict";r.d(t,{qD:()=>S,cT:()=>$,Qu:()=>k,uI:()=>O,Tj:()=>N,P_:()=>E,Hs:()=>R,_R:()=>L,JD:()=>C,k6:()=>A,iJ:()=>F,l$:()=>w,vD:()=>I,M3:()=>P,oM:()=>q,f5:()=>Z,Xh:()=>G,or:()=>M,ar:()=>j});var n=r(59472),i=r(88263),s=r(36544),o=r(32656),a=r(4665),l=r(21979),c=r(17427),d=r(99217);r(89771);const u=s.Z.getLogger("esri.widgets.Feature.support.featureUtils"),h=/href=(""|'')/gi,f=/(\{([^\{\r\n]+)\})/g,p=/\'/g,m=/^\s*expression\//i,g=/(\n)/gi,y=/[\u00A0-\u9999<>\&]/gim,b=/href\s*=\s*(?:\"([^\"]+)\"|\'([^\']+)\')/gi,v=/^(?:mailto:|tel:)/,_=(0,l.Ze)("short-date-short-time");function w(e){if(!(0,n.Wi)(e))return e.get("sourceLayer")||e.get("layer")}async function I(e,t){return"function"==typeof e?e.call(null,t):e}function M(e=""){if(e)return!v.test(e.trim().toLowerCase())}function C(e,t){const r=function(e,t){if(!function(e){return m.test(e)}(t)||!e)return null;const r=t.replace(m,"").toLowerCase();let n;return e.some((e=>e.name.toLowerCase()===r&&(n=e,!0))),n}(t,null==e?void 0:e.fieldName);return r?r.title||null:e?e.label||e.fieldName:null}function A(e,t){const r=T(t,e);return r?r.name:e}function F(e,t){return e&&e.map((e=>A(e,t)))}function T(e,t){return e&&"function"==typeof e.getField?e.getField(t):null}function x(e){return`${e}`.trim()}function j({formattedAttributes:e,template:t,fieldInfoMap:r}){return x((0,i.gx)((0,i.gx)(t,(e=>function(e,t){const r=t.get(e.toLowerCase());return`{${r&&r.fieldName||e}}`}(e,r))),e).replace(h,""))}function k(e,t){return e.replace(f,((e,r,n)=>{const i=T(t,n);return i?`{${i.name}}`:r}))}function Z(e,t,r){const n=k(e,r);return n?n.replace(b,((e,r,n)=>function(e,t,r){const n=(t=x(t))&&"{"!==t[0];return(0,i.gx)(e,function(e,t=!1){const r={...e};return Object.keys(r).forEach((e=>function(e,t,r=!1){const n=t[e];if("string"==typeof n){const i="%27",s=(r?encodeURIComponent(n):n).replace(p,i);t[e]=s}}(e,r,t))),r}(r,n))}(e,r||n,t))):n}function E(e,t){const r=t.fieldInfos,n=t.fieldName,i=L(r,n),s=null==i?void 0:i.clone(),o=t.preventPlacesFormatting,a=T(t.layer,n);if(s&&a&&"date"===a.type){const e=s.format||new d.Z;e.dateFormat=e.dateFormat||"short-date-short-time",s.format=e}const l=s&&s.format;return"string"==typeof(e=function(e,t){if("string"==typeof e&&t&&null==t.dateFormat&&(null!=t.places||null!=t.digitSeparator)){const t=Number(e);if(!isNaN(t))return t}return e}(e,l))||null==e||null==l?e:o?(0,c.uf)(e,{...(0,c.sh)(l),minimumFractionDigits:0,maximumFractionDigits:20}):l.format(e)}function L(e,t){if(!e||!e.length||!t)return;const r=t.toLowerCase();let n;return e.some((e=>!(!e.fieldName||e.fieldName.toLowerCase()!==r||(n=e,0)))),n}function N(e,t){const{creatorField:r,creationDateField:n,editorField:i,editDateField:s}=e;if(!t)return;const o=t[s];if("number"==typeof o){const e=t[i];return{type:"edit",date:(0,l.p6)(o,_),user:e}}const a=t[n];if("number"==typeof a){const e=t[r];return{type:"create",date:(0,l.p6)(a,_),user:e}}return null}function $(e,t){const r=new Map;return e&&e.forEach((e=>{const n=A(e.fieldName,t);e.fieldName=n,r.set(n.toLowerCase(),e)})),r}function R(e){const t=[];if(!e)return t;const{fieldInfos:r,content:n}=e;return r&&t.push(...r),n&&Array.isArray(n)?(n.forEach((e=>{if("fields"===e.type){const r=e&&e.fieldInfos;r&&t.push(...r)}})),t):t}function P(e){return e.replace(y,(e=>`&#${e.charCodeAt(0)};`))}function S(e){return"string"==typeof e?e.replace(g,'<br class="esri-text-new-line" />'):e}function O({fieldInfos:e,attributes:t,layer:r,graphic:n,fieldInfoMap:i,relatedInfos:s}){const o={...t};return null==s||s.forEach((e=>function(e,t){e&&t&&(t.relatedFeatures&&t.relatedFeatures&&t.relatedFeatures.forEach((r=>z({attributes:e,graphic:r,relatedInfo:t}))),t.relatedStatsFeatures&&t.relatedStatsFeatures&&t.relatedStatsFeatures.forEach((r=>z({attributes:e,graphic:r,relatedInfo:t}))))}(o,e))),Object.keys(o).forEach((t=>{const s=o[t];o[t]=function(e){const{value:t,fieldName:r,fieldInfos:n,fieldInfoMap:i,layer:s,graphic:o}=e;if(null==t)return"";const a=function({fieldName:e,value:t,graphic:r,layer:n}){if(q(e))return null;if(!n||"function"!=typeof n.getFieldDomain)return null;const i=n.getFieldDomain(e,{feature:r});return i&&"coded-value"===i.type?i.getName(t):null}({fieldName:r,value:t,graphic:o,layer:s});if(a)return a;const c=function({fieldName:e,graphic:t,layer:r}){if(q(e))return null;if(!r||"function"!=typeof r.getFeatureType)return null;const{typeIdField:n}=r;if(!n||e!==n)return null;const i=r.getFeatureType(t);return i?i.name:null}({fieldName:r,graphic:o,layer:s});if(c)return c;if(i.get(r.toLowerCase()))return E(t,{fieldInfos:n,fieldName:r,layer:s});const d=s&&s.fieldsIndex;return d&&d.isDateField(r)?(0,l.p6)(t,_):S(t)}({fieldName:t,fieldInfos:e,fieldInfoMap:i,layer:r,value:s,graphic:n})})),o}async function G({graphic:e,popupTemplate:t,layer:r},n){if(!r||!t)return;const{returnGeometry:i}=t;"function"==typeof r.load&&await r.load(n);const s=e.attributes[r.objectIdField];if(null==s)return;const l=[s],c=await t.getRequiredFields(r.fields),d=(0,a.R9)(c,e),h=d?[]:c;if(d&&!i)return;const f=await async function(e,t){const{layer:r,graphic:n,outFields:i,objectIds:s,returnGeometry:a}=e,l=s[0];if("number"!=typeof l){const e="Could not query required fields for the specified feature. The feature's ID is invalid.",t={layer:r,graphic:n,objectId:l,requiredFields:i},s=new o.Z("layer-query-features-invalid-objectid",e,t);throw u.warn(e,t),s}if("function"!=typeof r.queryFeatures){const e="The specified layer does not support the method 'queryFeatures'. The following fields will not be available.",t={layer:r,graphic:n,requiredFields:i},s=new o.Z("layer-query-features-unsupported",e,t);throw u.warn(e,t),s}const c=r.createQuery();return c.objectIds=s,c.outFields=i,c.returnGeometry=!!a,(await r.queryFeatures(c,t)).features[0]}({layer:r,graphic:e,outFields:h,objectIds:l,returnGeometry:i},n);f&&(f.geometry&&(e.geometry=f.geometry),f.attributes&&(e.attributes={...e.attributes,...f.attributes}))}function q(e=""){return!!e&&-1!==e.indexOf("relationships/")}function z({attributes:e,graphic:t,relatedInfo:r}){e&&t&&r&&Object.keys(t.attributes).forEach((n=>{const i=(s={layerId:r.relation.id.toString(),fieldName:n})?`relationships/${s.layerId}/${s.fieldName}`:"";var s;e[i]=t.attributes[n]}))}},47873:(e,t,r)=>{"use strict";r.d(t,{uc:()=>m,Bt:()=>p,Vb:()=>y,kp:()=>b,lg:()=>g,NF:()=>v});var n=r(36544),i=r(32656),s=r(39105),o=r(4665),a=r(54721),l=r(20624),c=r(31518),d=r(92551),u=r(29209);const h=n.Z.getLogger("esri.widgets.Feature.support.relatedFeatureUtils"),f=new Map;function p(e){if(!(0,u.oM)(e))return null;const[t,r]=e.split("/").slice(1);return{layerId:t,fieldName:r}}function m(e,t){const r=function(e,t){if(!t.relationships)return null;let r=null;const{relationships:n}=t;return n.some((t=>t.id===parseInt(e,10)&&(r=t,!0))),r}(e,t);if(!r)return;const n=`${t.url}/${r.relatedTableId}`;return{url:n,queryTask:new d.Z({url:n,sourceSpatialReference:t.spatialReference}),relation:r,relatedFields:[],outStatistics:[]}}function g(e,t){if(!t)return;if(!e)return;const{features:r,statsFeatures:n}=e,i=r&&r.value;t.relatedFeatures=i?i.features:[];const s=n&&n.value;t.relatedStatsFeatures=s?s.features:[]}function y({relatedInfos:e,layer:t},r){const n={};return e.forEach(((e,s)=>{const{relation:o}=e;if(!o){const e=new i.Z("relation-required","A relation is required on a layer to retrieve related records.");throw h.error(e),e}const{relatedTableId:l}=o;if("number"!=typeof l){const e=new i.Z("A related table ID is required on a layer to retrieve related records.");throw h.error(e),e}const c=`${t.url}/${l}`,d=f.get(c),u=d||function(e,t){return(0,a.default)(e,{query:{f:"json"},signal:t&&t.signal})}(c,r);d||f.set(c,u),n[s]=u})),(0,s.eachAlways)(n)}function b({graphic:e,relatedInfos:t,layer:r},n){const i={};return t.forEach(((t,a)=>{t.layerInfo&&(i[a]=async function(e,t,r,n){var i;const a=r.layerId.toString(),{layerInfo:l,queryTask:d,relation:u}=t,h=null==(i=function({originRelationship:e,relationships:t,layerId:r}){let n;return t&&t.some((t=>(`${t.relatedTableId}`===r&&t.id===e.id&&(n=t),!!n))),n}({originRelationship:u,relationships:l.relationships,layerId:a}))?void 0:i.keyField;if(h){const r=(0,o.H7)((0,o.rz)(l.fields,h)),i=function(e,t){const r=t.toLowerCase();for(const t in e)if(t.toLowerCase()===r)return e[t];return null}(e.attributes,u.keyField),a=r?`${h}=${i}`:`${h}='${i}'`,f=d.execute(new c.Z({where:a,outFields:t.relatedFields}),n),p=t.outStatistics&&t.outStatistics.length>0&&l.supportsStatistics?d.execute(new c.Z({where:a,outFields:t.relatedFields,outStatistics:t.outStatistics}),n):null,m={features:f};return p&&(m.statsFeatures=p),(0,s.eachAlways)(m)}return null}(e,t,r,n))})),(0,s.eachAlways)(i)}function v({relatedInfo:e,fieldName:t,fieldInfo:r}){if(e.relatedFields.push(t),r.statisticType){const n=new l.Z({statisticType:r.statisticType,onStatisticField:t,outStatisticFieldName:t});e.outStatistics.push(n)}}},4338:(e,t,r)=>{"use strict";r.d(t,{_:()=>o});var n=r(56140),i=(r(95830),r(36544),r(68055),r(79881)),s=r(87566);r(10923),r(57002),r(86035);const o=e=>{let t=class extends e{constructor(...e){super(...e),this.goToOverride=null,this.view=null}callGoTo(e){const{view:t}=this;return this.goToOverride?this.goToOverride(t,e):t.goTo(e.target,e.options)}};return(0,n._)([(0,i.Cb)()],t.prototype,"goToOverride",void 0),(0,n._)([(0,i.Cb)()],t.prototype,"view",void 0),t=(0,n._)([(0,s.j)("esri.widgets.support.GoTo")],t),t}}}]);
//# sourceMappingURL=6814.js.map